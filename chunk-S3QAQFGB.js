import{h as ci}from"./chunk-XOO7MZU6.js";import{E as xe,F as Oe,a as le,d as ye,e as Ve,f as we,h as ze,i as pt,j as oi,m as gt,n as L,o as ai}from"./chunk-OXX2SIMU.js";import{$ as ht,A as Qt,B as Me,C as lt,Ea as H,Ga as Le,Ha as Fe,Ka as De,Pa as ut,Qa as ft,R as Ne,S as qt,Ta as ti,U as Gt,Ua as ii,Wb as ri,X as z,Y as de,Z as Kt,Zb as pe,_ as x,a as me,ac as ni,b as Be,c as Ce,da as ue,dc as Z,e as Dr,ea as fe,ec as si,g as xr,h as k,i as ce,ia as Jt,j as ot,ja as dt,k as U,l as re,q as at,qa as je,ra as ne,sa as K,ua as se,y as ct,ya as ei}from"./chunk-FUI3C4R4.js";var ui=Dr((di,vt)=>{(function(u){if(typeof di=="object"&&typeof vt<"u")vt.exports=u();else if(typeof define=="function"&&define.amd)define([],u);else{var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.localforage=u()}})(function(){var u,e,d;return function t(i,s,h){function f(E,D){if(!s[E]){if(!i[E]){var w=typeof Ce=="function"&&Ce;if(!D&&w)return w(E,!0);if(m)return m(E,!0);var R=new Error("Cannot find module '"+E+"'");throw R.code="MODULE_NOT_FOUND",R}var I=s[E]={exports:{}};i[E][0].call(I.exports,function(T){var X=i[E][1][T];return f(X||T)},I,I.exports,t,i,s,h)}return s[E].exports}for(var m=typeof Ce=="function"&&Ce,C=0;C<h.length;C++)f(h[C]);return f}({1:[function(t,i,s){(function(h){"use strict";var f=h.MutationObserver||h.WebKitMutationObserver,m;if(f){var C=0,E=new f(T),D=h.document.createTextNode("");E.observe(D,{characterData:!0}),m=function(){D.data=C=++C%2}}else if(!h.setImmediate&&typeof h.MessageChannel<"u"){var w=new h.MessageChannel;w.port1.onmessage=T,m=function(){w.port2.postMessage(0)}}else"document"in h&&"onreadystatechange"in h.document.createElement("script")?m=function(){var V=h.document.createElement("script");V.onreadystatechange=function(){T(),V.onreadystatechange=null,V.parentNode.removeChild(V),V=null},h.document.documentElement.appendChild(V)}:m=function(){setTimeout(T,0)};var R,I=[];function T(){R=!0;for(var V,ee,Y=I.length;Y;){for(ee=I,I=[],V=-1;++V<Y;)ee[V]();Y=I.length}R=!1}i.exports=X;function X(V){I.push(V)===1&&!R&&m()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,i,s){"use strict";var h=t(1);function f(){}var m={},C=["REJECTED"],E=["FULFILLED"],D=["PENDING"];i.exports=w;function w(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=D,this.queue=[],this.outcome=void 0,b!==f&&X(this,b)}w.prototype.catch=function(b){return this.then(null,b)},w.prototype.then=function(b,A){if(typeof b!="function"&&this.state===E||typeof A!="function"&&this.state===C)return this;var P=new this.constructor(f);if(this.state!==D){var N=this.state===E?b:A;I(P,N,this.outcome)}else this.queue.push(new R(P,b,A));return P};function R(b,A,P){this.promise=b,typeof A=="function"&&(this.onFulfilled=A,this.callFulfilled=this.otherCallFulfilled),typeof P=="function"&&(this.onRejected=P,this.callRejected=this.otherCallRejected)}R.prototype.callFulfilled=function(b){m.resolve(this.promise,b)},R.prototype.otherCallFulfilled=function(b){I(this.promise,this.onFulfilled,b)},R.prototype.callRejected=function(b){m.reject(this.promise,b)},R.prototype.otherCallRejected=function(b){I(this.promise,this.onRejected,b)};function I(b,A,P){h(function(){var N;try{N=A(P)}catch(W){return m.reject(b,W)}N===b?m.reject(b,new TypeError("Cannot resolve promise with itself")):m.resolve(b,N)})}m.resolve=function(b,A){var P=V(T,A);if(P.status==="error")return m.reject(b,P.value);var N=P.value;if(N)X(b,N);else{b.state=E,b.outcome=A;for(var W=-1,$=b.queue.length;++W<$;)b.queue[W].callFulfilled(A)}return b},m.reject=function(b,A){b.state=C,b.outcome=A;for(var P=-1,N=b.queue.length;++P<N;)b.queue[P].callRejected(A);return b};function T(b){var A=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof A=="function")return function(){A.apply(b,arguments)}}function X(b,A){var P=!1;function N(q){P||(P=!0,m.reject(b,q))}function W(q){P||(P=!0,m.resolve(b,q))}function $(){A(W,N)}var Q=V($);Q.status==="error"&&N(Q.value)}function V(b,A){var P={};try{P.value=b(A),P.status="success"}catch(N){P.status="error",P.value=N}return P}w.resolve=ee;function ee(b){return b instanceof this?b:m.resolve(new this(f),b)}w.reject=Y;function Y(b){var A=new this(f);return m.reject(A,b)}w.all=Qe;function Qe(b){var A=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var P=b.length,N=!1;if(!P)return this.resolve([]);for(var W=new Array(P),$=0,Q=-1,q=new this(f);++Q<P;)te(b[Q],Q);return q;function te(Se,ke){A.resolve(Se).then(qe,function(_e){N||(N=!0,m.reject(q,_e))});function qe(_e){W[ke]=_e,++$===P&&!N&&(N=!0,m.resolve(q,W))}}}w.race=he;function he(b){var A=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var P=b.length,N=!1;if(!P)return this.resolve([]);for(var W=-1,$=new this(f);++W<P;)Q(b[W]);return $;function Q(q){A.resolve(q).then(function(te){N||(N=!0,m.resolve($,te))},function(te){N||(N=!0,m.reject($,te))})}}},{1:1}],3:[function(t,i,s){(function(h){"use strict";typeof h.Promise!="function"&&(h.Promise=t(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,i,s){"use strict";var h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r};function f(r,o){if(!(r instanceof o))throw new TypeError("Cannot call a class as a function")}function m(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var C=m();function E(){try{if(!C||!C.open)return!1;var r=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),o=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!r||o)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function D(r,o){r=r||[],o=o||{};try{return new Blob(r,o)}catch(a){if(a.name!=="TypeError")throw a;for(var n=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,c=new n,l=0;l<r.length;l+=1)c.append(r[l]);return c.getBlob(o.type)}}typeof Promise>"u"&&t(3);var w=Promise;function R(r,o){o&&r.then(function(n){o(null,n)},function(n){o(n)})}function I(r,o,n){typeof o=="function"&&r.then(o),typeof n=="function"&&r.catch(n)}function T(r){return typeof r!="string"&&(console.warn(r+" used as a key, but it is not a string."),r=String(r)),r}function X(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var V="local-forage-detect-blob-support",ee=void 0,Y={},Qe=Object.prototype.toString,he="readonly",b="readwrite";function A(r){for(var o=r.length,n=new ArrayBuffer(o),c=new Uint8Array(n),l=0;l<o;l++)c[l]=r.charCodeAt(l);return n}function P(r){return new w(function(o){var n=r.transaction(V,b),c=D([""]);n.objectStore(V).put(c,"key"),n.onabort=function(l){l.preventDefault(),l.stopPropagation(),o(!1)},n.oncomplete=function(){var l=navigator.userAgent.match(/Chrome\/(\d+)/),a=navigator.userAgent.match(/Edge\//);o(a||!l||parseInt(l[1],10)>=43)}}).catch(function(){return!1})}function N(r){return typeof ee=="boolean"?w.resolve(ee):P(r).then(function(o){return ee=o,ee})}function W(r){var o=Y[r.name],n={};n.promise=new w(function(c,l){n.resolve=c,n.reject=l}),o.deferredOperations.push(n),o.dbReady?o.dbReady=o.dbReady.then(function(){return n.promise}):o.dbReady=n.promise}function $(r){var o=Y[r.name],n=o.deferredOperations.pop();if(n)return n.resolve(),n.promise}function Q(r,o){var n=Y[r.name],c=n.deferredOperations.pop();if(c)return c.reject(o),c.promise}function q(r,o){return new w(function(n,c){if(Y[r.name]=Y[r.name]||Pt(),r.db)if(o)W(r),r.db.close();else return n(r.db);var l=[r.name];o&&l.push(r.version);var a=C.open.apply(C,l);o&&(a.onupgradeneeded=function(p){var g=a.result;try{g.createObjectStore(r.storeName),p.oldVersion<=1&&g.createObjectStore(V)}catch(_){if(_.name==="ConstraintError")console.warn('The database "'+r.name+'" has been upgraded from version '+p.oldVersion+" to version "+p.newVersion+', but the storage "'+r.storeName+'" already exists.');else throw _}}),a.onerror=function(p){p.preventDefault(),c(a.error)},a.onsuccess=function(){var p=a.result;p.onversionchange=function(g){g.target.close()},n(p),$(r)}})}function te(r){return q(r,!1)}function Se(r){return q(r,!0)}function ke(r,o){if(!r.db)return!0;var n=!r.db.objectStoreNames.contains(r.storeName),c=r.version<r.db.version,l=r.version>r.db.version;if(c&&(r.version!==o&&console.warn('The database "'+r.name+`" can't be downgraded from version `+r.db.version+" to version "+r.version+"."),r.version=r.db.version),l||n){if(n){var a=r.db.version+1;a>r.version&&(r.version=a)}return!0}return!1}function qe(r){return new w(function(o,n){var c=new FileReader;c.onerror=n,c.onloadend=function(l){var a=btoa(l.target.result||"");o({__local_forage_encoded_blob:!0,data:a,type:r.type})},c.readAsBinaryString(r)})}function _e(r){var o=A(atob(r.data));return D([o],{type:r.type})}function Ot(r){return r&&r.__local_forage_encoded_blob}function xi(r){var o=this,n=o._initReady().then(function(){var c=Y[o._dbInfo.name];if(c&&c.dbReady)return c.dbReady});return I(n,r,r),n}function Oi(r){W(r);for(var o=Y[r.name],n=o.forages,c=0;c<n.length;c++){var l=n[c];l._dbInfo.db&&(l._dbInfo.db.close(),l._dbInfo.db=null)}return r.db=null,te(r).then(function(a){return r.db=a,ke(r)?Se(r):a}).then(function(a){r.db=o.db=a;for(var p=0;p<n.length;p++)n[p]._dbInfo.db=a}).catch(function(a){throw Q(r,a),a})}function ie(r,o,n,c){c===void 0&&(c=1);try{var l=r.db.transaction(r.storeName,o);n(null,l)}catch(a){if(c>0&&(!r.db||a.name==="InvalidStateError"||a.name==="NotFoundError"))return w.resolve().then(function(){if(!r.db||a.name==="NotFoundError"&&!r.db.objectStoreNames.contains(r.storeName)&&r.version<=r.db.version)return r.db&&(r.version=r.db.version+1),Se(r)}).then(function(){return Oi(r).then(function(){ie(r,o,n,c-1)})}).catch(n);n(a)}}function Pt(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Pi(r){var o=this,n={db:null};if(r)for(var c in r)n[c]=r[c];var l=Y[n.name];l||(l=Pt(),Y[n.name]=l),l.forages.push(o),o._initReady||(o._initReady=o.ready,o.ready=xi);var a=[];function p(){return w.resolve()}for(var g=0;g<l.forages.length;g++){var _=l.forages[g];_!==o&&a.push(_._initReady().catch(p))}var v=l.forages.slice(0);return w.all(a).then(function(){return n.db=l.db,te(n)}).then(function(y){return n.db=y,ke(n,o._defaultConfig.version)?Se(n):y}).then(function(y){n.db=l.db=y,o._dbInfo=n;for(var S=0;S<v.length;S++){var O=v[S];O!==o&&(O._dbInfo.db=n.db,O._dbInfo.version=n.version)}})}function Ii(r,o){var n=this;r=T(r);var c=new w(function(l,a){n.ready().then(function(){ie(n._dbInfo,he,function(p,g){if(p)return a(p);try{var _=g.objectStore(n._dbInfo.storeName),v=_.get(r);v.onsuccess=function(){var y=v.result;y===void 0&&(y=null),Ot(y)&&(y=_e(y)),l(y)},v.onerror=function(){a(v.error)}}catch(y){a(y)}})}).catch(a)});return R(c,o),c}function ki(r,o){var n=this,c=new w(function(l,a){n.ready().then(function(){ie(n._dbInfo,he,function(p,g){if(p)return a(p);try{var _=g.objectStore(n._dbInfo.storeName),v=_.openCursor(),y=1;v.onsuccess=function(){var S=v.result;if(S){var O=S.value;Ot(O)&&(O=_e(O));var B=r(O,S.key,y++);B!==void 0?l(B):S.continue()}else l()},v.onerror=function(){a(v.error)}}catch(S){a(S)}})}).catch(a)});return R(c,o),c}function Ti(r,o,n){var c=this;r=T(r);var l=new w(function(a,p){var g;c.ready().then(function(){return g=c._dbInfo,Qe.call(o)==="[object Blob]"?N(g.db).then(function(_){return _?o:qe(o)}):o}).then(function(_){ie(c._dbInfo,b,function(v,y){if(v)return p(v);try{var S=y.objectStore(c._dbInfo.storeName);_===null&&(_=void 0);var O=S.put(_,r);y.oncomplete=function(){_===void 0&&(_=null),a(_)},y.onabort=y.onerror=function(){var B=O.error?O.error:O.transaction.error;p(B)}}catch(B){p(B)}})}).catch(p)});return R(l,n),l}function Ai(r,o){var n=this;r=T(r);var c=new w(function(l,a){n.ready().then(function(){ie(n._dbInfo,b,function(p,g){if(p)return a(p);try{var _=g.objectStore(n._dbInfo.storeName),v=_.delete(r);g.oncomplete=function(){l()},g.onerror=function(){a(v.error)},g.onabort=function(){var y=v.error?v.error:v.transaction.error;a(y)}}catch(y){a(y)}})}).catch(a)});return R(c,o),c}function Bi(r){var o=this,n=new w(function(c,l){o.ready().then(function(){ie(o._dbInfo,b,function(a,p){if(a)return l(a);try{var g=p.objectStore(o._dbInfo.storeName),_=g.clear();p.oncomplete=function(){c()},p.onabort=p.onerror=function(){var v=_.error?_.error:_.transaction.error;l(v)}}catch(v){l(v)}})}).catch(l)});return R(n,r),n}function Mi(r){var o=this,n=new w(function(c,l){o.ready().then(function(){ie(o._dbInfo,he,function(a,p){if(a)return l(a);try{var g=p.objectStore(o._dbInfo.storeName),_=g.count();_.onsuccess=function(){c(_.result)},_.onerror=function(){l(_.error)}}catch(v){l(v)}})}).catch(l)});return R(n,r),n}function Ni(r,o){var n=this,c=new w(function(l,a){if(r<0){l(null);return}n.ready().then(function(){ie(n._dbInfo,he,function(p,g){if(p)return a(p);try{var _=g.objectStore(n._dbInfo.storeName),v=!1,y=_.openKeyCursor();y.onsuccess=function(){var S=y.result;if(!S){l(null);return}r===0||v?l(S.key):(v=!0,S.advance(r))},y.onerror=function(){a(y.error)}}catch(S){a(S)}})}).catch(a)});return R(c,o),c}function ji(r){var o=this,n=new w(function(c,l){o.ready().then(function(){ie(o._dbInfo,he,function(a,p){if(a)return l(a);try{var g=p.objectStore(o._dbInfo.storeName),_=g.openKeyCursor(),v=[];_.onsuccess=function(){var y=_.result;if(!y){c(v);return}v.push(y.key),y.continue()},_.onerror=function(){l(_.error)}}catch(y){l(y)}})}).catch(l)});return R(n,r),n}function Li(r,o){o=X.apply(this,arguments);var n=this.config();r=typeof r!="function"&&r||{},r.name||(r.name=r.name||n.name,r.storeName=r.storeName||n.storeName);var c=this,l;if(!r.name)l=w.reject("Invalid arguments");else{var a=r.name===n.name&&c._dbInfo.db,p=a?w.resolve(c._dbInfo.db):te(r).then(function(g){var _=Y[r.name],v=_.forages;_.db=g;for(var y=0;y<v.length;y++)v[y]._dbInfo.db=g;return g});r.storeName?l=p.then(function(g){if(g.objectStoreNames.contains(r.storeName)){var _=g.version+1;W(r);var v=Y[r.name],y=v.forages;g.close();for(var S=0;S<y.length;S++){var O=y[S];O._dbInfo.db=null,O._dbInfo.version=_}var B=new w(function(M,F){var j=C.open(r.name,_);j.onerror=function(G){var Re=j.result;Re.close(),F(G)},j.onupgradeneeded=function(){var G=j.result;G.deleteObjectStore(r.storeName)},j.onsuccess=function(){var G=j.result;G.close(),M(G)}});return B.then(function(M){v.db=M;for(var F=0;F<y.length;F++){var j=y[F];j._dbInfo.db=M,$(j._dbInfo)}}).catch(function(M){throw(Q(r,M)||w.resolve()).catch(function(){}),M})}}):l=p.then(function(g){W(r);var _=Y[r.name],v=_.forages;g.close();for(var y=0;y<v.length;y++){var S=v[y];S._dbInfo.db=null}var O=new w(function(B,M){var F=C.deleteDatabase(r.name);F.onerror=function(){var j=F.result;j&&j.close(),M(F.error)},F.onblocked=function(){console.warn('dropInstance blocked for database "'+r.name+'" until all open connections are closed')},F.onsuccess=function(){var j=F.result;j&&j.close(),B(j)}});return O.then(function(B){_.db=B;for(var M=0;M<v.length;M++){var F=v[M];$(F._dbInfo)}}).catch(function(B){throw(Q(r,B)||w.resolve()).catch(function(){}),B})})}return R(l,o),l}var Fi={_driver:"asyncStorage",_initStorage:Pi,_support:E(),iterate:ki,getItem:Ii,setItem:Ti,removeItem:Ai,clear:Bi,length:Mi,key:Ni,keys:ji,dropInstance:Li};function Vi(){return typeof openDatabase=="function"}var oe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zi="~~local_forage_type~",It=/^~~local_forage_type~([^~]+)~/,Te="__lfsc__:",Ge=Te.length,Ke="arbf",Je="blob",kt="si08",Tt="ui08",At="uic8",Bt="si16",Mt="si32",Nt="ur16",jt="ui32",Lt="fl32",Ft="fl64",Vt=Ge+Ke.length,zt=Object.prototype.toString;function Yt(r){var o=r.length*.75,n=r.length,c,l=0,a,p,g,_;r[r.length-1]==="="&&(o--,r[r.length-2]==="="&&o--);var v=new ArrayBuffer(o),y=new Uint8Array(v);for(c=0;c<n;c+=4)a=oe.indexOf(r[c]),p=oe.indexOf(r[c+1]),g=oe.indexOf(r[c+2]),_=oe.indexOf(r[c+3]),y[l++]=a<<2|p>>4,y[l++]=(p&15)<<4|g>>2,y[l++]=(g&3)<<6|_&63;return v}function et(r){var o=new Uint8Array(r),n="",c;for(c=0;c<o.length;c+=3)n+=oe[o[c]>>2],n+=oe[(o[c]&3)<<4|o[c+1]>>4],n+=oe[(o[c+1]&15)<<2|o[c+2]>>6],n+=oe[o[c+2]&63];return o.length%3===2?n=n.substring(0,n.length-1)+"=":o.length%3===1&&(n=n.substring(0,n.length-2)+"=="),n}function Yi(r,o){var n="";if(r&&(n=zt.call(r)),r&&(n==="[object ArrayBuffer]"||r.buffer&&zt.call(r.buffer)==="[object ArrayBuffer]")){var c,l=Te;r instanceof ArrayBuffer?(c=r,l+=Ke):(c=r.buffer,n==="[object Int8Array]"?l+=kt:n==="[object Uint8Array]"?l+=Tt:n==="[object Uint8ClampedArray]"?l+=At:n==="[object Int16Array]"?l+=Bt:n==="[object Uint16Array]"?l+=Nt:n==="[object Int32Array]"?l+=Mt:n==="[object Uint32Array]"?l+=jt:n==="[object Float32Array]"?l+=Lt:n==="[object Float64Array]"?l+=Ft:o(new Error("Failed to get type for BinaryArray"))),o(l+et(c))}else if(n==="[object Blob]"){var a=new FileReader;a.onload=function(){var p=zi+r.type+"~"+et(this.result);o(Te+Je+p)},a.readAsArrayBuffer(r)}else try{o(JSON.stringify(r))}catch(p){console.error("Couldn't convert value into a JSON string: ",r),o(null,p)}}function Wi(r){if(r.substring(0,Ge)!==Te)return JSON.parse(r);var o=r.substring(Vt),n=r.substring(Ge,Vt),c;if(n===Je&&It.test(o)){var l=o.match(It);c=l[1],o=o.substring(l[0].length)}var a=Yt(o);switch(n){case Ke:return a;case Je:return D([a],{type:c});case kt:return new Int8Array(a);case Tt:return new Uint8Array(a);case At:return new Uint8ClampedArray(a);case Bt:return new Int16Array(a);case Nt:return new Uint16Array(a);case Mt:return new Int32Array(a);case jt:return new Uint32Array(a);case Lt:return new Float32Array(a);case Ft:return new Float64Array(a);default:throw new Error("Unkown type: "+n)}}var tt={serialize:Yi,deserialize:Wi,stringToBuffer:Yt,bufferToString:et};function Wt(r,o,n,c){r.executeSql("CREATE TABLE IF NOT EXISTS "+o.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,c)}function Hi(r){var o=this,n={db:null};if(r)for(var c in r)n[c]=typeof r[c]!="string"?r[c].toString():r[c];var l=new w(function(a,p){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(g){return p(g)}n.db.transaction(function(g){Wt(g,n,function(){o._dbInfo=n,a()},function(_,v){p(v)})},p)});return n.serializer=tt,l}function ae(r,o,n,c,l,a){r.executeSql(n,c,l,function(p,g){g.code===g.SYNTAX_ERR?p.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[o.storeName],function(_,v){v.rows.length?a(_,g):Wt(_,o,function(){_.executeSql(n,c,l,a)},a)},a):a(p,g)},a)}function Xi(r,o){var n=this;r=T(r);var c=new w(function(l,a){n.ready().then(function(){var p=n._dbInfo;p.db.transaction(function(g){ae(g,p,"SELECT * FROM "+p.storeName+" WHERE key = ? LIMIT 1",[r],function(_,v){var y=v.rows.length?v.rows.item(0).value:null;y&&(y=p.serializer.deserialize(y)),l(y)},function(_,v){a(v)})})}).catch(a)});return R(c,o),c}function Ui(r,o){var n=this,c=new w(function(l,a){n.ready().then(function(){var p=n._dbInfo;p.db.transaction(function(g){ae(g,p,"SELECT * FROM "+p.storeName,[],function(_,v){for(var y=v.rows,S=y.length,O=0;O<S;O++){var B=y.item(O),M=B.value;if(M&&(M=p.serializer.deserialize(M)),M=r(M,B.key,O+1),M!==void 0){l(M);return}}l()},function(_,v){a(v)})})}).catch(a)});return R(c,o),c}function Ht(r,o,n,c){var l=this;r=T(r);var a=new w(function(p,g){l.ready().then(function(){o===void 0&&(o=null);var _=o,v=l._dbInfo;v.serializer.serialize(o,function(y,S){S?g(S):v.db.transaction(function(O){ae(O,v,"INSERT OR REPLACE INTO "+v.storeName+" (key, value) VALUES (?, ?)",[r,y],function(){p(_)},function(B,M){g(M)})},function(O){if(O.code===O.QUOTA_ERR){if(c>0){p(Ht.apply(l,[r,_,n,c-1]));return}g(O)}})})}).catch(g)});return R(a,n),a}function $i(r,o,n){return Ht.apply(this,[r,o,n,1])}function Zi(r,o){var n=this;r=T(r);var c=new w(function(l,a){n.ready().then(function(){var p=n._dbInfo;p.db.transaction(function(g){ae(g,p,"DELETE FROM "+p.storeName+" WHERE key = ?",[r],function(){l()},function(_,v){a(v)})})}).catch(a)});return R(c,o),c}function Qi(r){var o=this,n=new w(function(c,l){o.ready().then(function(){var a=o._dbInfo;a.db.transaction(function(p){ae(p,a,"DELETE FROM "+a.storeName,[],function(){c()},function(g,_){l(_)})})}).catch(l)});return R(n,r),n}function qi(r){var o=this,n=new w(function(c,l){o.ready().then(function(){var a=o._dbInfo;a.db.transaction(function(p){ae(p,a,"SELECT COUNT(key) as c FROM "+a.storeName,[],function(g,_){var v=_.rows.item(0).c;c(v)},function(g,_){l(_)})})}).catch(l)});return R(n,r),n}function Gi(r,o){var n=this,c=new w(function(l,a){n.ready().then(function(){var p=n._dbInfo;p.db.transaction(function(g){ae(g,p,"SELECT key FROM "+p.storeName+" WHERE id = ? LIMIT 1",[r+1],function(_,v){var y=v.rows.length?v.rows.item(0).key:null;l(y)},function(_,v){a(v)})})}).catch(a)});return R(c,o),c}function Ki(r){var o=this,n=new w(function(c,l){o.ready().then(function(){var a=o._dbInfo;a.db.transaction(function(p){ae(p,a,"SELECT key FROM "+a.storeName,[],function(g,_){for(var v=[],y=0;y<_.rows.length;y++)v.push(_.rows.item(y).key);c(v)},function(g,_){l(_)})})}).catch(l)});return R(n,r),n}function Ji(r){return new w(function(o,n){r.transaction(function(c){c.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(l,a){for(var p=[],g=0;g<a.rows.length;g++)p.push(a.rows.item(g).name);o({db:r,storeNames:p})},function(l,a){n(a)})},function(c){n(c)})})}function er(r,o){o=X.apply(this,arguments);var n=this.config();r=typeof r!="function"&&r||{},r.name||(r.name=r.name||n.name,r.storeName=r.storeName||n.storeName);var c=this,l;return r.name?l=new w(function(a){var p;r.name===n.name?p=c._dbInfo.db:p=openDatabase(r.name,"","",0),r.storeName?a({db:p,storeNames:[r.storeName]}):a(Ji(p))}).then(function(a){return new w(function(p,g){a.db.transaction(function(_){function v(B){return new w(function(M,F){_.executeSql("DROP TABLE IF EXISTS "+B,[],function(){M()},function(j,G){F(G)})})}for(var y=[],S=0,O=a.storeNames.length;S<O;S++)y.push(v(a.storeNames[S]));w.all(y).then(function(){p()}).catch(function(B){g(B)})},function(_){g(_)})})}):l=w.reject("Invalid arguments"),R(l,o),l}var tr={_driver:"webSQLStorage",_initStorage:Hi,_support:Vi(),iterate:Ui,getItem:Xi,setItem:$i,removeItem:Zi,clear:Qi,length:qi,key:Gi,keys:Ki,dropInstance:er};function ir(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Xt(r,o){var n=r.name+"/";return r.storeName!==o.storeName&&(n+=r.storeName+"/"),n}function rr(){var r="_localforage_support_test";try{return localStorage.setItem(r,!0),localStorage.removeItem(r),!1}catch{return!0}}function nr(){return!rr()||localStorage.length>0}function sr(r){var o=this,n={};if(r)for(var c in r)n[c]=r[c];return n.keyPrefix=Xt(r,o._defaultConfig),nr()?(o._dbInfo=n,n.serializer=tt,w.resolve()):w.reject()}function or(r){var o=this,n=o.ready().then(function(){for(var c=o._dbInfo.keyPrefix,l=localStorage.length-1;l>=0;l--){var a=localStorage.key(l);a.indexOf(c)===0&&localStorage.removeItem(a)}});return R(n,r),n}function ar(r,o){var n=this;r=T(r);var c=n.ready().then(function(){var l=n._dbInfo,a=localStorage.getItem(l.keyPrefix+r);return a&&(a=l.serializer.deserialize(a)),a});return R(c,o),c}function cr(r,o){var n=this,c=n.ready().then(function(){for(var l=n._dbInfo,a=l.keyPrefix,p=a.length,g=localStorage.length,_=1,v=0;v<g;v++){var y=localStorage.key(v);if(y.indexOf(a)===0){var S=localStorage.getItem(y);if(S&&(S=l.serializer.deserialize(S)),S=r(S,y.substring(p),_++),S!==void 0)return S}}});return R(c,o),c}function lr(r,o){var n=this,c=n.ready().then(function(){var l=n._dbInfo,a;try{a=localStorage.key(r)}catch{a=null}return a&&(a=a.substring(l.keyPrefix.length)),a});return R(c,o),c}function hr(r){var o=this,n=o.ready().then(function(){for(var c=o._dbInfo,l=localStorage.length,a=[],p=0;p<l;p++){var g=localStorage.key(p);g.indexOf(c.keyPrefix)===0&&a.push(g.substring(c.keyPrefix.length))}return a});return R(n,r),n}function dr(r){var o=this,n=o.keys().then(function(c){return c.length});return R(n,r),n}function ur(r,o){var n=this;r=T(r);var c=n.ready().then(function(){var l=n._dbInfo;localStorage.removeItem(l.keyPrefix+r)});return R(c,o),c}function fr(r,o,n){var c=this;r=T(r);var l=c.ready().then(function(){o===void 0&&(o=null);var a=o;return new w(function(p,g){var _=c._dbInfo;_.serializer.serialize(o,function(v,y){if(y)g(y);else try{localStorage.setItem(_.keyPrefix+r,v),p(a)}catch(S){(S.name==="QuotaExceededError"||S.name==="NS_ERROR_DOM_QUOTA_REACHED")&&g(S),g(S)}})})});return R(l,n),l}function pr(r,o){if(o=X.apply(this,arguments),r=typeof r!="function"&&r||{},!r.name){var n=this.config();r.name=r.name||n.name,r.storeName=r.storeName||n.storeName}var c=this,l;return r.name?l=new w(function(a){r.storeName?a(Xt(r,c._defaultConfig)):a(r.name+"/")}).then(function(a){for(var p=localStorage.length-1;p>=0;p--){var g=localStorage.key(p);g.indexOf(a)===0&&localStorage.removeItem(g)}}):l=w.reject("Invalid arguments"),R(l,o),l}var gr={_driver:"localStorageWrapper",_initStorage:sr,_support:ir(),iterate:cr,getItem:ar,setItem:fr,removeItem:ur,clear:or,length:dr,key:lr,keys:hr,dropInstance:pr},_r=function(o,n){return o===n||typeof o=="number"&&typeof n=="number"&&isNaN(o)&&isNaN(n)},vr=function(o,n){for(var c=o.length,l=0;l<c;){if(_r(o[l],n))return!0;l++}return!1},Ut=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"},Ee={},$t={},ve={INDEXEDDB:Fi,WEBSQL:tr,LOCALSTORAGE:gr},mr=[ve.INDEXEDDB._driver,ve.WEBSQL._driver,ve.LOCALSTORAGE._driver],Ae=["dropInstance"],it=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ae),yr={description:"",driver:mr.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function wr(r,o){r[o]=function(){var n=arguments;return r.ready().then(function(){return r[o].apply(r,n)})}}function rt(){for(var r=1;r<arguments.length;r++){var o=arguments[r];if(o)for(var n in o)o.hasOwnProperty(n)&&(Ut(o[n])?arguments[0][n]=o[n].slice():arguments[0][n]=o[n])}return arguments[0]}var br=function(){function r(o){f(this,r);for(var n in ve)if(ve.hasOwnProperty(n)){var c=ve[n],l=c._driver;this[n]=l,Ee[l]||this.defineDriver(c)}this._defaultConfig=rt({},yr),this._config=rt({},this._defaultConfig,o),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return r.prototype.config=function(n){if((typeof n>"u"?"undefined":h(n))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var c in n){if(c==="storeName"&&(n[c]=n[c].replace(/\W/g,"_")),c==="version"&&typeof n[c]!="number")return new Error("Database version must be a number.");this._config[c]=n[c]}return"driver"in n&&n.driver?this.setDriver(this._config.driver):!0}else return typeof n=="string"?this._config[n]:this._config},r.prototype.defineDriver=function(n,c,l){var a=new w(function(p,g){try{var _=n._driver,v=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!n._driver){g(v);return}for(var y=it.concat("_initStorage"),S=0,O=y.length;S<O;S++){var B=y[S],M=!vr(Ae,B);if((M||n[B])&&typeof n[B]!="function"){g(v);return}}var F=function(){for(var Re=function(Rr){return function(){var Cr=new Error("Method "+Rr+" is not implemented by the current driver"),Zt=w.reject(Cr);return R(Zt,arguments[arguments.length-1]),Zt}},nt=0,Er=Ae.length;nt<Er;nt++){var st=Ae[nt];n[st]||(n[st]=Re(st))}};F();var j=function(Re){Ee[_]&&console.info("Redefining LocalForage driver: "+_),Ee[_]=n,$t[_]=Re,p()};"_support"in n?n._support&&typeof n._support=="function"?n._support().then(j,g):j(!!n._support):j(!0)}catch(G){g(G)}});return I(a,c,l),a},r.prototype.driver=function(){return this._driver||null},r.prototype.getDriver=function(n,c,l){var a=Ee[n]?w.resolve(Ee[n]):w.reject(new Error("Driver not found."));return I(a,c,l),a},r.prototype.getSerializer=function(n){var c=w.resolve(tt);return I(c,n),c},r.prototype.ready=function(n){var c=this,l=c._driverSet.then(function(){return c._ready===null&&(c._ready=c._initDriver()),c._ready});return I(l,n,n),l},r.prototype.setDriver=function(n,c,l){var a=this;Ut(n)||(n=[n]);var p=this._getSupportedDrivers(n);function g(){a._config.driver=a.driver()}function _(S){return a._extend(S),g(),a._ready=a._initStorage(a._config),a._ready}function v(S){return function(){var O=0;function B(){for(;O<S.length;){var M=S[O];return O++,a._dbInfo=null,a._ready=null,a.getDriver(M).then(_).catch(B)}g();var F=new Error("No available storage method found.");return a._driverSet=w.reject(F),a._driverSet}return B()}}var y=this._driverSet!==null?this._driverSet.catch(function(){return w.resolve()}):w.resolve();return this._driverSet=y.then(function(){var S=p[0];return a._dbInfo=null,a._ready=null,a.getDriver(S).then(function(O){a._driver=O._driver,g(),a._wrapLibraryMethodsWithReady(),a._initDriver=v(p)})}).catch(function(){g();var S=new Error("No available storage method found.");return a._driverSet=w.reject(S),a._driverSet}),I(this._driverSet,c,l),this._driverSet},r.prototype.supports=function(n){return!!$t[n]},r.prototype._extend=function(n){rt(this,n)},r.prototype._getSupportedDrivers=function(n){for(var c=[],l=0,a=n.length;l<a;l++){var p=n[l];this.supports(p)&&c.push(p)}return c},r.prototype._wrapLibraryMethodsWithReady=function(){for(var n=0,c=it.length;n<c;n++)wr(this,it[n])},r.prototype.createInstance=function(n){return new r(n)},r}(),Sr=new br;i.exports=Sr},{3:3}]},{},[4])(4)})});var li=class{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(e=!1,d,t=!0,i){this._multiple=e,this._emitChanges=t,this.compareWith=i,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new U,d&&d.length&&(e?d.forEach(s=>this._markSelected(s)):this._markSelected(d[0]),this._selectedToEmit.length=0)}select(...e){this._verifyValueAssignment(e),e.forEach(t=>this._markSelected(t));let d=this._hasQueuedChanges();return this._emitChangeEvent(),d}deselect(...e){this._verifyValueAssignment(e),e.forEach(t=>this._unmarkSelected(t));let d=this._hasQueuedChanges();return this._emitChangeEvent(),d}setSelection(...e){this._verifyValueAssignment(e);let d=this.selected,t=new Set(e);e.forEach(s=>this._markSelected(s)),d.filter(s=>!t.has(this._getConcreteValue(s,t))).forEach(s=>this._unmarkSelected(s));let i=this._hasQueuedChanges();return this._emitChangeEvent(),i}toggle(e){return this.isSelected(e)?this.deselect(e):this.select(e)}clear(e=!0){this._unmarkAll();let d=this._hasQueuedChanges();return e&&this._emitChangeEvent(),d}isSelected(e){return this._selection.has(this._getConcreteValue(e))}isEmpty(){return this._selection.size===0}hasValue(){return!this.isEmpty()}sort(e){this._multiple&&this.selected&&this._selected.sort(e)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(e){e=this._getConcreteValue(e),this.isSelected(e)||(this._multiple||this._unmarkAll(),this.isSelected(e)||this._selection.add(e),this._emitChanges&&this._selectedToEmit.push(e))}_unmarkSelected(e){e=this._getConcreteValue(e),this.isSelected(e)&&(this._selection.delete(e),this._emitChanges&&this._deselectedToEmit.push(e))}_unmarkAll(){this.isEmpty()||this._selection.forEach(e=>this._unmarkSelected(e))}_verifyValueAssignment(e){e.length>1&&this._multiple}_hasQueuedChanges(){return!!(this._deselectedToEmit.length||this._selectedToEmit.length)}_getConcreteValue(e,d){if(this.compareWith){d=d??this._selection;for(let t of d)if(this.compareWith(e,t))return t;return e}else return e}};var Kr=(()=>{let e=class e{constructor(){this._listeners=[]}notify(t,i){for(let s of this._listeners)s(t,i)}listen(t){return this._listeners.push(t),()=>{this._listeners=this._listeners.filter(i=>t!==i)}}ngOnDestroy(){this._listeners=[]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})();var Tr=20,Ye=(()=>{let e=class e{constructor(t,i,s){this._ngZone=t,this._platform=i,this._scrolled=new U,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=s}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){let i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=Tr){return this._platform.isBrowser?new ot(i=>{this._globalSubscription||this._addGlobalListener();let s=t>0?this._scrolled.pipe(lt(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{s.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):at()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){let s=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(Me(h=>!h||s.indexOf(h)>-1))}getAncestorScrollContainers(t){let i=[];return this.scrollContainers.forEach((s,h)=>{this._scrollableContainsElement(h,t)&&i.push(h)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let s=ai(i),h=t.getElementRef().nativeElement;do if(s==h)return!0;while(s=s.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let t=this._getWindow();return ct(t.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}};e.\u0275fac=function(i){return new(i||e)(x(K),x(le),x(Z,8))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})(),Ar=(()=>{let e=class e{constructor(t,i,s,h){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=s,this.dir=h,this._destroyed=new U,this._elementScrolled=new ot(f=>this.ngZone.runOutsideAngular(()=>ct(this.elementRef.nativeElement,"scroll").pipe(Ne(this._destroyed)).subscribe(f)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){let i=this.elementRef.nativeElement,s=this.dir&&this.dir.value=="rtl";t.left==null&&(t.left=s?t.end:t.start),t.right==null&&(t.right=s?t.start:t.end),t.bottom!=null&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),s&&we()!=ye.NORMAL?(t.left!=null&&(t.right=i.scrollWidth-i.clientWidth-t.left),we()==ye.INVERTED?t.left=t.right:we()==ye.NEGATED&&(t.left=t.right?-t.right:t.right)):t.right!=null&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){let i=this.elementRef.nativeElement;Ve()?i.scrollTo(t):(t.top!=null&&(i.scrollTop=t.top),t.left!=null&&(i.scrollLeft=t.left))}measureScrollOffset(t){let i="left",s="right",h=this.elementRef.nativeElement;if(t=="top")return h.scrollTop;if(t=="bottom")return h.scrollHeight-h.clientHeight-h.scrollTop;let f=this.dir&&this.dir.value=="rtl";return t=="start"?t=f?s:i:t=="end"&&(t=f?i:s),f&&we()==ye.INVERTED?t==i?h.scrollWidth-h.clientWidth-h.scrollLeft:h.scrollLeft:f&&we()==ye.NEGATED?t==i?h.scrollLeft+h.scrollWidth-h.clientWidth:-h.scrollLeft:t==i?h.scrollLeft:h.scrollWidth-h.clientWidth-h.scrollLeft}};e.\u0275fac=function(i){return new(i||e)(H(se),H(Ye),H(K),H(xe,8))},e.\u0275dir=fe({type:e,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0});let u=e;return u})(),Br=20,We=(()=>{let e=class e{constructor(t,i,s){this._platform=t,this._change=new U,this._changeListener=h=>{this._change.next(h)},this._document=s,i.runOutsideAngular(()=>{if(t.isBrowser){let h=this._getWindow();h.addEventListener("resize",this._changeListener),h.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){let t=this.getViewportScrollPosition(),{width:i,height:s}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+s,right:t.left+i,height:s,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let t=this._document,i=this._getWindow(),s=t.documentElement,h=s.getBoundingClientRect(),f=-h.top||t.body.scrollTop||i.scrollY||s.scrollTop||0,m=-h.left||t.body.scrollLeft||i.scrollX||s.scrollLeft||0;return{top:f,left:m}}change(t=Br){return t>0?this._change.pipe(lt(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}};e.\u0275fac=function(i){return new(i||e)(x(le),x(K),x(Z,8))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})();var hi=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ue({type:e}),e.\u0275inj=de({});let u=e;return u})(),_t=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ue({type:e}),e.\u0275inj=de({imports:[Oe,hi,Oe,hi]});let u=e;return u})();var J=xr(ui());var fi=(()=>{let e=class e{constructor(){this.metadataSubject=new re(null),this.projectsSubject=new re([]),this.projectStatsSubject=new re({}),this.userStore=J.default.createInstance({driver:J.default.INDEXEDDB,name:"angor-hub",version:1,storeName:"users",description:"Store for user metadata"}),this.projectsStore=J.default.createInstance({driver:J.default.INDEXEDDB,name:"angor-hub",version:1,storeName:"projects",description:"Store for projects"}),this.projectStatsStore=J.default.createInstance({driver:J.default.INDEXEDDB,name:"angor-hub",version:1,storeName:"projectStats",description:"Store for project statistics"}),this.chatStore=J.default.createInstance({driver:J.default.INDEXEDDB,name:"angor-hub",version:1,storeName:"chats",description:"Store for chat information"}),this.timestampStore=J.default.createInstance({driver:J.default.INDEXEDDB,name:"angor-hub",version:1,storeName:"timestamps",description:"Store for last update timestamps"}),this.loadAllProjectsFromDB(),this.loadAllProjectStatsFromDB()}getProjectsObservable(){return this.projectsSubject.asObservable()}saveProject(t){return k(this,null,function*(){try{yield this.projectsStore.setItem(t.projectIdentifier,t);let i=yield this.getAllProjects();this.projectsSubject.next(i)}catch(i){console.error(`Error saving project ${t.projectIdentifier} to IndexedDB:`,i)}})}getProject(t){return k(this,null,function*(){try{return(yield this.projectsStore.getItem(t))||null}catch(i){return console.error(`Error getting project ${t} from IndexedDB:`,i),null}})}getAllProjects(){return k(this,null,function*(){try{let t=[];return yield this.projectsStore.iterate(i=>{t.push(i)}),t}catch(t){return console.error("Error getting all projects from IndexedDB:",t),[]}})}getProjectStatsObservable(){return this.projectStatsSubject.asObservable()}saveProjectStats(t,i){return k(this,null,function*(){try{yield this.projectStatsStore.setItem(t,i);let s=yield this.getAllProjectStats();this.projectStatsSubject.next(s)}catch(s){console.error(`Error saving project stats for ${t} to IndexedDB:`,s)}})}getProjectStats(t){return k(this,null,function*(){try{return(yield this.projectStatsStore.getItem(t))||null}catch(i){return console.error(`Error getting project stats for ${t} from IndexedDB:`,i),null}})}getMetadataStream(){return this.metadataSubject.asObservable()}getUserMetadata(t){return k(this,null,function*(){try{return yield this.userStore.getItem(t)}catch(i){return console.error("Error getting metadata from IndexedDB:",i),null}})}saveUserMetadata(t,i){return k(this,null,function*(){try{i.pubKey=t,yield this.userStore.setItem(t,i),this.metadataSubject.next({pubKey:t,metadata:i})}catch(s){console.error("Error saving metadata to IndexedDB:",s)}})}removeUserMetadata(t){return k(this,null,function*(){try{yield this.userStore.removeItem(t),this.metadataSubject.next({pubkey:t,metadata:null})}catch(i){console.error("Error removing metadata from IndexedDB:",i)}})}loadAllProjectsFromDB(){return k(this,null,function*(){try{let t=yield this.getAllProjects();this.projectsSubject.next(t)}catch(t){console.error("Error loading projects from IndexedDB:",t)}})}getAllProjectStats(){return k(this,null,function*(){try{let t={};return yield this.projectStatsStore.iterate((i,s)=>{t[s]=i}),t}catch(t){return console.error("Error getting all project stats from IndexedDB:",t),{}}})}loadAllProjectStatsFromDB(){return k(this,null,function*(){try{let t=yield this.getAllProjectStats();this.projectStatsSubject.next(t)}catch(t){console.error("Error loading project stats from IndexedDB:",t)}})}getAllUsers(){return k(this,null,function*(){try{let t=[];return yield this.userStore.iterate(i=>{t.push(i)}),t}catch(t){return console.error("Error getting all users from IndexedDB:",t),[]}})}clearAllMetadata(){return k(this,null,function*(){try{yield this.userStore.clear(),this.metadataSubject.next(null)}catch(t){console.error("Error clearing all metadata:",t)}})}searchUsersByMetadata(t){return k(this,null,function*(){try{let i=[],s=t.toLowerCase();return yield this.userStore.iterate((h,f)=>{JSON.stringify(h).toLowerCase().includes(s)&&i.push({pubkey:f,user:h})}),i}catch(i){return console.error("Error searching users by metadata from IndexedDB:",i),[]}})}saveChat(t){return k(this,null,function*(){try{yield this.chatStore.setItem(t.id,t)}catch(i){console.error("Error saving chat to IndexedDB:",i)}})}getChat(t){return k(this,null,function*(){try{let i=yield this.chatStore.getItem(t);return i||(console.warn(`Chat with pubKey ${t} not found in IndexedDB.`),null)}catch(i){return console.error(`Error retrieving chat with pubKey ${t} from IndexedDB:`,i),null}})}getAllChats(){return k(this,null,function*(){try{let t=[];return yield this.chatStore.iterate(i=>{t.push(i)}),t.sort((i,s)=>{let h=Number(i.lastMessageAt);return Number(s.lastMessageAt)-h}),t}catch(t){return console.error("Error getting chats from IndexedDB:",t),[]}})}saveLastSavedTimestamp(t){return k(this,null,function*(){try{yield this.timestampStore.setItem("lastSavedTimestamp",t)}catch(i){console.error("Error saving last update timestamp in IndexedDB:",i)}})}getLastSavedTimestamp(){return k(this,null,function*(){try{return(yield this.timestampStore.getItem("lastSavedTimestamp"))||0}catch(t){return console.error("Error getting last saved timestamp from IndexedDB:",t),0}})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})();var pi=(()=>{let e=class e{constructor(){this.relays=[],this.maxRetries=10,this.retryDelay=15e3,this.eventSubject=new re(null),this.relaysSubject=new re([]),this.pool=new ci,this.relays=this.loadRelaysFromLocalStorage(),this.connectToRelays(),this.setupVisibilityChangeHandling(),this.relaysSubject.next(this.relays)}loadRelaysFromLocalStorage(){let t=JSON.parse(localStorage.getItem("nostrRelays")||"[]"),i=[{url:"wss://relay.angor.io",connected:!1,retries:0,retryTimeout:null,accessType:"read-write",ws:void 0},{url:"wss://relay2.angor.io",connected:!1,retries:0,retryTimeout:null,accessType:"read-write",ws:void 0}];return t.length>0?t.map(s=>Be(me({},s),{connected:!1,retries:0,retryTimeout:null,ws:void 0})):i}saveRelaysToLocalStorage(){let t=this.relays.map(i=>({url:i.url,accessType:i.accessType,connected:i.connected,retries:i.retries,retryTimeout:i.retryTimeout}));localStorage.setItem("nostrRelays",JSON.stringify(t)),this.relaysSubject.next(this.relays)}connectToRelay(t){t.connected||(t.ws=new WebSocket(t.url),t.ws.onopen=()=>{t.connected=!0,t.retries=0,clearTimeout(t.retryTimeout),this.saveRelaysToLocalStorage(),console.log(`Connected to relay: ${t.url}`)},t.ws.onerror=()=>{this.handleRelayError(t)},t.ws.onclose=()=>{t.connected=!1,this.handleRelayError(t)},t.ws.onmessage=i=>{try{let s=typeof i.data=="string"?i.data:i.data.toString("utf-8"),h=JSON.parse(s);this.eventSubject.next(h)}catch(s){console.error("Error parsing WebSocket message:",s)}})}handleRelayError(t){if(t.retries>=this.maxRetries){console.error(`Max retries reached for relay: ${t.url}. No further attempts will be made.`);return}let i=this.retryDelay*t.retries;t.retries++,t.retryTimeout=setTimeout(()=>{this.connectToRelay(t),console.log(`Retrying connection to relay: ${t.url} (Attempt ${t.retries})`)},i)}connectToRelays(){this.relays.forEach(t=>{t.connected||this.connectToRelay(t)})}ensureConnectedRelays(){return k(this,null,function*(){return this.connectToRelays(),new Promise(t=>{let i=()=>{this.getConnectedRelays().length>0?t():setTimeout(i,1e3)};i()})})}setupVisibilityChangeHandling(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.connectToRelays()}),window.addEventListener("beforeunload",()=>{this.relays.forEach(t=>{t.ws&&t.ws.close()})})}getConnectedRelays(){return this.relays.filter(t=>t.connected).map(t=>t.url)}getRelays(){return this.relaysSubject.asObservable()}publishEventToWriteRelays(t){this.relays.filter(s=>s.accessType==="write"||s.accessType==="read-write").forEach(s=>{s.connected&&s.ws?.readyState===WebSocket.OPEN&&(s.ws.send(JSON.stringify(t)),console.log(`Event published to ${s.url}`))})}publishEventToRelays(t){return k(this,null,function*(){let i=this.getPool(),s=this.getConnectedRelays();if(s.length===0)throw new Error("No connected relays");let h=s.map(f=>k(this,null,function*(){try{return yield i.publish([f],t),console.log(`Event published to relay: ${f}`),this.eventSubject.next(t),t}catch(m){throw console.error(`Failed to publish event to relay: ${f}`,m),m}}));try{return yield Promise.any(h),t}catch(f){throw console.error("Failed to publish event: AggregateError",f),this.handlePublishFailure(f),f}})}handlePublishFailure(t){t instanceof AggregateError?console.error("All relays failed to publish the event. Retrying..."):console.error("An unexpected error occurred:",t)}addRelay(t,i="read-write"){if(this.relays.some(s=>s.url===t))console.log(`Relay with URL ${t} already exists.`);else{let s={url:t,connected:!1,retries:0,retryTimeout:null,accessType:i,ws:void 0};this.relays.push(s),this.connectToRelay(s),this.saveRelaysToLocalStorage()}}removeRelay(t){this.relays=this.relays.filter(i=>i.url!==t),this.saveRelaysToLocalStorage()}removeAllCustomRelays(){let t=["wss://relay.angor.io","wss://relay2.angor.io"];this.relays=this.relays.filter(i=>t.includes(i.url)),this.saveRelaysToLocalStorage()}updateRelayAccessType(t,i){let s=this.relays.find(h=>h.url===t);s&&(s.accessType=i,this.saveRelaysToLocalStorage())}getPool(){return this.pool}getEventStream(){return this.eventSubject.asObservable()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})();var Ln=(()=>{let e=class e{constructor(t,i){this.indexedDBService=t,this.relayService=i,this.metadataSubject=new re(null),this.requestQueue=new Set,this.isProcessingQueue=!1,this.maxRequestsPerBatch=3,this.requestDelay=5e3}getMetadataStream(){return this.metadataSubject.asObservable().pipe(Gt(2e3))}enqueueRequest(t){this.requestQueue.add(t),this.processQueue()}fetchMetadataForMultipleKeys(t){return k(this,null,function*(){let i={kinds:[0],authors:t};try{yield this.relayService.ensureConnectedRelays();let s=this.relayService.getConnectedRelays();if(s.length===0)return console.error("No relays are connected."),[];let h=[],f=this.relayService.getPool().subscribeMany(s,[i],{onevent:m=>k(this,null,function*(){if(m.kind===0)try{let C=JSON.parse(m.content);yield this.indexedDBService.saveUserMetadata(m.pubkey,C),h.push({pubkey:m.pubkey,metadata:C})}catch(C){console.error("Error parsing metadata:",C)}}),oneose:()=>{console.log("Relay connection closed.")}});return setTimeout(()=>{f.close()},10*60*1e3),h}catch(s){return console.error("Failed to fetch metadata for multiple keys:",s),[]}})}processQueue(){return k(this,null,function*(){if(!(this.isProcessingQueue||this.requestQueue.size===0)){for(this.isProcessingQueue=!0;this.requestQueue.size>0;){let t=Array.from(this.requestQueue).slice(0,this.maxRequestsPerBatch);this.requestQueue=new Set(Array.from(this.requestQueue).slice(this.maxRequestsPerBatch)),yield Promise.all(t.map(i=>k(this,null,function*(){try{let s=yield this.fetchMetadataRealtime(i);s&&(yield this.indexedDBService.saveUserMetadata(i,s),this.metadataSubject.next(s))}catch(s){console.error(`Failed to update metadata for user: ${i}`,s)}}))),yield new Promise(i=>setTimeout(i,this.requestDelay))}this.isProcessingQueue=!1}})}fetchMetadataWithCache(t){return k(this,null,function*(){let i=yield this.indexedDBService.getUserMetadata(t);return i?this.metadataSubject.next(i):this.enqueueRequest(t),this.subscribeToMetadataUpdates(t),i})}subscribeToMetadataUpdates(t){this.relayService.ensureConnectedRelays().then(()=>{let i={authors:[t],kinds:[0]};this.relayService.getPool().subscribeMany(this.relayService.getConnectedRelays(),[i],{onevent:s=>k(this,null,function*(){if(s.pubkey===t&&s.kind===0)try{let h=JSON.parse(s.content);yield this.indexedDBService.saveUserMetadata(t,h),this.metadataSubject.next(h)}catch(h){console.error("Error parsing updated metadata:",h)}}),oneose(){}})})}fetchMetadataRealtime(t){return k(this,null,function*(){yield this.relayService.ensureConnectedRelays();let i=this.relayService.getConnectedRelays();if(i.length===0)throw new Error("No connected relays");return new Promise(s=>{let h=this.relayService.getPool().subscribeMany(i,[{authors:[t],kinds:[0]}],{onevent:f=>{if(f.pubkey===t&&f.kind===0)try{let m=JSON.parse(f.content);s(m)}catch(m){console.error("Error parsing event content:",m),s(null)}finally{h.close()}},oneose(){h.close(),s(null)}})})})}refreshAllStoredMetadata(){return k(this,null,function*(){let t=yield this.indexedDBService.getAllUsers();if(!t||t.length===0){console.log("No stored users found in IndexedDB");return}t.forEach(i=>this.enqueueRequest(i.pubkey))})}getUserMetadata(t){return k(this,null,function*(){try{let i=yield this.indexedDBService.getUserMetadata(t);if(i)return i;let s=yield this.fetchMetadataRealtime(t);return s?(yield this.indexedDBService.saveUserMetadata(t,s),s):null}catch(i){return console.error(`Error fetching metadata for user ${t}:`,i),null}})}};e.\u0275fac=function(i){return new(i||e)(x(fi),x(pi))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})();var Pe=class{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;e!=null&&(this._attachedHost=null,e.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(e){this._attachedHost=e}},mt=class extends Pe{constructor(e,d,t,i,s){super(),this.component=e,this.viewContainerRef=d,this.injector=t,this.componentFactoryResolver=i,this.projectableNodes=s}},Ie=class extends Pe{constructor(e,d,t,i){super(),this.templateRef=e,this.viewContainerRef=d,this.context=t,this.injector=i}get origin(){return this.templateRef.elementRef}attach(e,d=this.context){return this.context=d,super.attach(e)}detach(){return this.context=void 0,super.detach()}},yt=class extends Pe{constructor(e){super(),this.element=e instanceof se?e.nativeElement:e}},He=class{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){if(e instanceof mt)return this._attachedPortal=e,this.attachComponentPortal(e);if(e instanceof Ie)return this._attachedPortal=e,this.attachTemplatePortal(e);if(this.attachDomPortal&&e instanceof yt)return this._attachedPortal=e,this.attachDomPortal(e)}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var Xe=class extends He{constructor(e,d,t,i,s){super(),this.outletElement=e,this._componentFactoryResolver=d,this._appRef=t,this._defaultInjector=i,this.attachDomPortal=h=>{this._document;let f=h.element;f.parentNode;let m=this._document.createComment("dom-portal");f.parentNode.insertBefore(m,f),this.outletElement.appendChild(f),this._attachedPortal=h,super.setDisposeFn(()=>{m.parentNode&&m.parentNode.replaceChild(f,m)})},this._document=s}attachComponentPortal(e){let t=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),i;return e.viewContainerRef?(i=e.viewContainerRef.createComponent(t,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>i.destroy())):(i=t.create(e.injector||this._defaultInjector||je.NULL),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(i.hostView),i.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(i)),this._attachedPortal=e,i}attachTemplatePortal(e){let d=e.viewContainerRef,t=d.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return t.rootNodes.forEach(i=>this.outletElement.appendChild(i)),t.detectChanges(),this.setDisposeFn(()=>{let i=d.indexOf(t);i!==-1&&d.remove(i)}),this._attachedPortal=e,t}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}};var Qn=(()=>{let e=class e extends He{constructor(t,i,s){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new ne,this.attachDomPortal=h=>{this._document;let f=h.element;f.parentNode;let m=this._document.createComment("dom-portal");h.setAttachedHost(this),f.parentNode.insertBefore(m,f),this._getRootNode().appendChild(f),this._attachedPortal=h,super.setDisposeFn(()=>{m.parentNode&&m.parentNode.replaceChild(f,m)})},this._document=s}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);let i=t.viewContainerRef!=null?t.viewContainerRef:this._viewContainerRef,h=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),f=i.createComponent(h,i.length,t.injector||i.injector,t.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(f.hostView.rootNodes[0]),super.setDisposeFn(()=>f.destroy()),this._attachedPortal=t,this._attachedRef=f,this.attached.emit(f),f}attachTemplatePortal(t){t.setAttachedHost(this);let i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){let t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}};e.\u0275fac=function(i){return new(i||e)(H(Fe),H(De),H(Z))},e.\u0275dir=fe({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[ut]});let u=e;return u})();var gi=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ue({type:e}),e.\u0275inj=de({});let u=e;return u})();var _i=Ve(),wt=class{constructor(e,d){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=d}attach(){}enable(){if(this._canBeEnabled()){let e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=L(-this._previousScrollPosition.left),e.style.top=L(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let e=this._document.documentElement,d=this._document.body,t=e.style,i=d.style,s=t.scrollBehavior||"",h=i.scrollBehavior||"";this._isEnabled=!1,t.left=this._previousHTMLStyles.left,t.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),_i&&(t.scrollBehavior=i.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),_i&&(t.scrollBehavior=s,i.scrollBehavior=h)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let d=this._document.body,t=this._viewportRuler.getViewportSize();return d.scrollHeight>t.height||d.scrollWidth>t.width}};var bt=class{constructor(e,d,t,i){this._scrollDispatcher=e,this._ngZone=d,this._viewportRuler=t,this._config=i,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(this._scrollSubscription)return;let e=this._scrollDispatcher.scrolled(0).pipe(Me(d=>!d||!this._overlayRef.overlayElement.contains(d.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{let d=this._viewportRuler.getViewportScrollPosition().top;Math.abs(d-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},Ue=class{enable(){}disable(){}attach(){}};function St(u,e){return e.some(d=>{let t=u.bottom<d.top,i=u.top>d.bottom,s=u.right<d.left,h=u.left>d.right;return t||i||s||h})}function vi(u,e){return e.some(d=>{let t=u.top<d.top,i=u.bottom>d.bottom,s=u.left<d.left,h=u.right>d.right;return t||i||s||h})}var Et=class{constructor(e,d,t,i){this._scrollDispatcher=e,this._viewportRuler=d,this._ngZone=t,this._config=i,this._scrollSubscription=null}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(!this._scrollSubscription){let e=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(e).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let d=this._overlayRef.overlayElement.getBoundingClientRect(),{width:t,height:i}=this._viewportRuler.getViewportSize();St(d,[{width:t,height:i,bottom:i,right:t,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},Fr=(()=>{let e=class e{constructor(t,i,s,h){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=s,this.noop=()=>new Ue,this.close=f=>new bt(this._scrollDispatcher,this._ngZone,this._viewportRuler,f),this.block=()=>new wt(this._viewportRuler,this._document),this.reposition=f=>new Et(this._scrollDispatcher,this._viewportRuler,this._ngZone,f),this._document=h}};e.\u0275fac=function(i){return new(i||e)(x(Ye),x(We),x(K),x(Z))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})(),$e=class{constructor(e){if(this.scrollStrategy=new Ue,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){let d=Object.keys(e);for(let t of d)e[t]!==void 0&&(this[t]=e[t])}}};var Rt=class{constructor(e,d){this.connectionPair=e,this.scrollableViewProperties=d}};var Ri=(()=>{let e=class e{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){let i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),this._attachedOverlays.length===0&&this.detach()}};e.\u0275fac=function(i){return new(i||e)(x(Z))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})(),Vr=(()=>{let e=class e extends Ri{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=s=>{let h=this._attachedOverlays;for(let f=h.length-1;f>-1;f--)if(h[f]._keydownEvents.observers.length>0){let m=h[f]._keydownEvents;this._ngZone?this._ngZone.run(()=>m.next(s)):m.next(s);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}};e.\u0275fac=function(i){return new(i||e)(x(Z),x(K,8))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})(),zr=(()=>{let e=class e extends Ri{constructor(t,i,s){super(t),this._platform=i,this._ngZone=s,this._cursorStyleIsSet=!1,this._pointerDownListener=h=>{this._pointerDownEventTarget=ze(h)},this._clickListener=h=>{let f=ze(h),m=h.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:f;this._pointerDownEventTarget=null;let C=this._attachedOverlays.slice();for(let E=C.length-1;E>-1;E--){let D=C[E];if(D._outsidePointerEvents.observers.length<1||!D.hasAttached())continue;if(mi(D.overlayElement,f)||mi(D.overlayElement,m))break;let w=D._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>w.next(h)):w.next(h)}}}add(t){if(super.add(t),!this._isAttached){let i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}};e.\u0275fac=function(i){return new(i||e)(x(Z),x(le),x(K,8))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})();function mi(u,e){let d=typeof ShadowRoot<"u"&&ShadowRoot,t=e;for(;t;){if(t===u)return!0;t=d&&t instanceof ShadowRoot?t.host:t.parentNode}return!1}var Ci=(()=>{let e=class e{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let t="cdk-overlay-container";if(this._platform.isBrowser||pt()){let s=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let h=0;h<s.length;h++)s[h].remove()}let i=this._document.createElement("div");i.classList.add(t),pt()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}};e.\u0275fac=function(i){return new(i||e)(x(Z),x(le))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})(),Ct=class{constructor(e,d,t,i,s,h,f,m,C,E=!1,D){this._portalOutlet=e,this._host=d,this._pane=t,this._config=i,this._ngZone=s,this._keyboardDispatcher=h,this._document=f,this._location=m,this._outsideClickDispatcher=C,this._animationsDisabled=E,this._injector=D,this._backdropElement=null,this._backdropClick=new U,this._attachments=new U,this._detachments=new U,this._locationChanges=ce.EMPTY,this._backdropClickHandler=w=>this._backdropClick.next(w),this._backdropTransitionendHandler=w=>{this._disposeBackdrop(w.target)},this._keydownEvents=new U,this._outsidePointerEvents=new U,this._renders=new U,i.scrollStrategy&&(this._scrollStrategy=i.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=i.positionStrategy,this._afterRenderRef=ni(()=>ti(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let d=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=ii(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof d?.onDestroy=="function"&&d.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),d}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){let e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config=me(me({},this._config),e),this._updateElementSize()}setDirection(e){this._config=Be(me({},this._config),{direction:e}),this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){let e=this._config.direction;return e?typeof e=="string"?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let e=this._pane.style;e.width=L(this._config.width),e.height=L(this._config.height),e.minWidth=L(this._config.minWidth),e.minHeight=L(this._config.minHeight),e.maxWidth=L(this._config.maxWidth),e.maxHeight=L(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){let e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let e=this._backdropElement;if(e){if(this._animationsDisabled){this._disposeBackdrop(e);return}e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,d,t){let i=gt(d||[]).filter(s=>!!s);i.length&&(t?e.classList.add(...i):e.classList.remove(...i))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{let e=this._renders.pipe(Ne(Qt(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){let e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},yi="cdk-overlay-connected-position-bounding-box",Yr=/([A-Za-z%]+)$/,Dt=class{get positions(){return this._preferredPositions}constructor(e,d,t,i,s){this._viewportRuler=d,this._document=t,this._platform=i,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new U,this._resizeSubscription=ce.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._overlayRef&&this._overlayRef,this._validatePositions(),e.hostElement.classList.add(yi),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let e=this._originRect,d=this._overlayRect,t=this._viewportRect,i=this._containerRect,s=[],h;for(let f of this._preferredPositions){let m=this._getOriginPoint(e,i,f),C=this._getOverlayPoint(m,d,f),E=this._getOverlayFit(C,d,t,f);if(E.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(f,m);return}if(this._canFitWithFlexibleDimensions(E,C,t)){s.push({position:f,origin:m,overlayRect:d,boundingBoxRect:this._calculateBoundingBoxRect(m,f)});continue}(!h||h.overlayFit.visibleArea<E.visibleArea)&&(h={overlayFit:E,overlayPoint:C,originPoint:m,position:f,overlayRect:d})}if(s.length){let f=null,m=-1;for(let C of s){let E=C.boundingBoxRect.width*C.boundingBoxRect.height*(C.position.weight||1);E>m&&(m=E,f=C)}this._isPushed=!1,this._applyPosition(f.position,f.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(h.position,h.originPoint);return}this._applyPosition(h.position,h.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&ge(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(yi),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let d=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,d)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,e.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,d,t){let i;if(t.originX=="center")i=e.left+e.width/2;else{let h=this._isRtl()?e.right:e.left,f=this._isRtl()?e.left:e.right;i=t.originX=="start"?h:f}d.left<0&&(i-=d.left);let s;return t.originY=="center"?s=e.top+e.height/2:s=t.originY=="top"?e.top:e.bottom,d.top<0&&(s-=d.top),{x:i,y:s}}_getOverlayPoint(e,d,t){let i;t.overlayX=="center"?i=-d.width/2:t.overlayX==="start"?i=this._isRtl()?-d.width:0:i=this._isRtl()?0:-d.width;let s;return t.overlayY=="center"?s=-d.height/2:s=t.overlayY=="top"?0:-d.height,{x:e.x+i,y:e.y+s}}_getOverlayFit(e,d,t,i){let s=bi(d),{x:h,y:f}=e,m=this._getOffset(i,"x"),C=this._getOffset(i,"y");m&&(h+=m),C&&(f+=C);let E=0-h,D=h+s.width-t.width,w=0-f,R=f+s.height-t.height,I=this._subtractOverflows(s.width,E,D),T=this._subtractOverflows(s.height,w,R),X=I*T;return{visibleArea:X,isCompletelyWithinViewport:s.width*s.height===X,fitsInViewportVertically:T===s.height,fitsInViewportHorizontally:I==s.width}}_canFitWithFlexibleDimensions(e,d,t){if(this._hasFlexibleDimensions){let i=t.bottom-d.y,s=t.right-d.x,h=wi(this._overlayRef.getConfig().minHeight),f=wi(this._overlayRef.getConfig().minWidth),m=e.fitsInViewportVertically||h!=null&&h<=i,C=e.fitsInViewportHorizontally||f!=null&&f<=s;return m&&C}return!1}_pushOverlayOnScreen(e,d,t){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};let i=bi(d),s=this._viewportRect,h=Math.max(e.x+i.width-s.width,0),f=Math.max(e.y+i.height-s.height,0),m=Math.max(s.top-t.top-e.y,0),C=Math.max(s.left-t.left-e.x,0),E=0,D=0;return i.width<=s.width?E=C||-h:E=e.x<this._viewportMargin?s.left-t.left-e.x:0,i.height<=s.height?D=m||-f:D=e.y<this._viewportMargin?s.top-t.top-e.y:0,this._previousPushAmount={x:E,y:D},{x:e.x+E,y:e.y+D}}_applyPosition(e,d){if(this._setTransformOrigin(e),this._setOverlayElementStyles(d,e),this._setBoundingBoxStyles(d,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){let t=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!Wr(this._lastScrollVisibility,t)){let i=new Rt(e,t);this._positionChanges.next(i)}this._lastScrollVisibility=t}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;let d=this._boundingBox.querySelectorAll(this._transformOriginSelector),t,i=e.overlayY;e.overlayX==="center"?t="center":this._isRtl()?t=e.overlayX==="start"?"right":"left":t=e.overlayX==="start"?"left":"right";for(let s=0;s<d.length;s++)d[s].style.transformOrigin=`${t} ${i}`}_calculateBoundingBoxRect(e,d){let t=this._viewportRect,i=this._isRtl(),s,h,f;if(d.overlayY==="top")h=e.y,s=t.height-h+this._viewportMargin;else if(d.overlayY==="bottom")f=t.height-e.y+this._viewportMargin*2,s=t.height-f+this._viewportMargin;else{let R=Math.min(t.bottom-e.y+t.top,e.y),I=this._lastBoundingBoxSize.height;s=R*2,h=e.y-R,s>I&&!this._isInitialRender&&!this._growAfterOpen&&(h=e.y-I/2)}let m=d.overlayX==="start"&&!i||d.overlayX==="end"&&i,C=d.overlayX==="end"&&!i||d.overlayX==="start"&&i,E,D,w;if(C)w=t.width-e.x+this._viewportMargin*2,E=e.x-this._viewportMargin;else if(m)D=e.x,E=t.right-e.x;else{let R=Math.min(t.right-e.x+t.left,e.x),I=this._lastBoundingBoxSize.width;E=R*2,D=e.x-R,E>I&&!this._isInitialRender&&!this._growAfterOpen&&(D=e.x-I/2)}return{top:h,left:D,bottom:f,right:w,width:E,height:s}}_setBoundingBoxStyles(e,d){let t=this._calculateBoundingBoxRect(e,d);!this._isInitialRender&&!this._growAfterOpen&&(t.height=Math.min(t.height,this._lastBoundingBoxSize.height),t.width=Math.min(t.width,this._lastBoundingBoxSize.width));let i={};if(this._hasExactPosition())i.top=i.left="0",i.bottom=i.right=i.maxHeight=i.maxWidth="",i.width=i.height="100%";else{let s=this._overlayRef.getConfig().maxHeight,h=this._overlayRef.getConfig().maxWidth;i.height=L(t.height),i.top=L(t.top),i.bottom=L(t.bottom),i.width=L(t.width),i.left=L(t.left),i.right=L(t.right),d.overlayX==="center"?i.alignItems="center":i.alignItems=d.overlayX==="end"?"flex-end":"flex-start",d.overlayY==="center"?i.justifyContent="center":i.justifyContent=d.overlayY==="bottom"?"flex-end":"flex-start",s&&(i.maxHeight=L(s)),h&&(i.maxWidth=L(h))}this._lastBoundingBoxSize=t,ge(this._boundingBox.style,i)}_resetBoundingBoxStyles(){ge(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){ge(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,d){let t={},i=this._hasExactPosition(),s=this._hasFlexibleDimensions,h=this._overlayRef.getConfig();if(i){let E=this._viewportRuler.getViewportScrollPosition();ge(t,this._getExactOverlayY(d,e,E)),ge(t,this._getExactOverlayX(d,e,E))}else t.position="static";let f="",m=this._getOffset(d,"x"),C=this._getOffset(d,"y");m&&(f+=`translateX(${m}px) `),C&&(f+=`translateY(${C}px)`),t.transform=f.trim(),h.maxHeight&&(i?t.maxHeight=L(h.maxHeight):s&&(t.maxHeight="")),h.maxWidth&&(i?t.maxWidth=L(h.maxWidth):s&&(t.maxWidth="")),ge(this._pane.style,t)}_getExactOverlayY(e,d,t){let i={top:"",bottom:""},s=this._getOverlayPoint(d,this._overlayRect,e);if(this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,t)),e.overlayY==="bottom"){let h=this._document.documentElement.clientHeight;i.bottom=`${h-(s.y+this._overlayRect.height)}px`}else i.top=L(s.y);return i}_getExactOverlayX(e,d,t){let i={left:"",right:""},s=this._getOverlayPoint(d,this._overlayRect,e);this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,t));let h;if(this._isRtl()?h=e.overlayX==="end"?"left":"right":h=e.overlayX==="end"?"right":"left",h==="right"){let f=this._document.documentElement.clientWidth;i.right=`${f-(s.x+this._overlayRect.width)}px`}else i.left=L(s.x);return i}_getScrollVisibility(){let e=this._getOriginRect(),d=this._pane.getBoundingClientRect(),t=this._scrollables.map(i=>i.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:vi(e,t),isOriginOutsideView:St(e,t),isOverlayClipped:vi(d,t),isOverlayOutsideView:St(d,t)}}_subtractOverflows(e,...d){return d.reduce((t,i)=>t-Math.max(i,0),e)}_getNarrowedViewportRect(){let e=this._document.documentElement.clientWidth,d=this._document.documentElement.clientHeight,t=this._viewportRuler.getViewportScrollPosition();return{top:t.top+this._viewportMargin,left:t.left+this._viewportMargin,right:t.left+e-this._viewportMargin,bottom:t.top+d-this._viewportMargin,width:e-2*this._viewportMargin,height:d-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,d){return d==="x"?e.offsetX==null?this._offsetX:e.offsetX:e.offsetY==null?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&gt(e).forEach(d=>{d!==""&&this._appliedPanelClasses.indexOf(d)===-1&&(this._appliedPanelClasses.push(d),this._pane.classList.add(d))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){let e=this._origin;if(e instanceof se)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();let d=e.width||0,t=e.height||0;return{top:e.y,bottom:e.y+t,left:e.x,right:e.x+d,height:t,width:d}}};function ge(u,e){for(let d in e)e.hasOwnProperty(d)&&(u[d]=e[d]);return u}function wi(u){if(typeof u!="number"&&u!=null){let[e,d]=u.split(Yr);return!d||d==="px"?parseFloat(e):null}return u||null}function bi(u){return{top:Math.floor(u.top),right:Math.floor(u.right),bottom:Math.floor(u.bottom),left:Math.floor(u.left),width:Math.floor(u.width),height:Math.floor(u.height)}}function Wr(u,e){return u===e?!0:u.isOriginClipped===e.isOriginClipped&&u.isOriginOutsideView===e.isOriginOutsideView&&u.isOverlayClipped===e.isOverlayClipped&&u.isOverlayOutsideView===e.isOverlayOutsideView}var Si="cdk-global-overlay-wrapper",xt=class{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){let d=e.getConfig();this._overlayRef=e,this._width&&!d.width&&e.updateSize({width:this._width}),this._height&&!d.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(Si),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let e=this._overlayRef.overlayElement.style,d=this._overlayRef.hostElement.style,t=this._overlayRef.getConfig(),{width:i,height:s,maxWidth:h,maxHeight:f}=t,m=(i==="100%"||i==="100vw")&&(!h||h==="100%"||h==="100vw"),C=(s==="100%"||s==="100vh")&&(!f||f==="100%"||f==="100vh"),E=this._xPosition,D=this._xOffset,w=this._overlayRef.getConfig().direction==="rtl",R="",I="",T="";m?T="flex-start":E==="center"?(T="center",w?I=D:R=D):w?E==="left"||E==="end"?(T="flex-end",R=D):(E==="right"||E==="start")&&(T="flex-start",I=D):E==="left"||E==="start"?(T="flex-start",R=D):(E==="right"||E==="end")&&(T="flex-end",I=D),e.position=this._cssPosition,e.marginLeft=m?"0":R,e.marginTop=C?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=m?"0":I,d.justifyContent=T,d.alignItems=C?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let e=this._overlayRef.overlayElement.style,d=this._overlayRef.hostElement,t=d.style;d.classList.remove(Si),t.justifyContent=t.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}},Hr=(()=>{let e=class e{constructor(t,i,s,h){this._viewportRuler=t,this._document=i,this._platform=s,this._overlayContainer=h}global(){return new xt}flexibleConnectedTo(t){return new Dt(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}};e.\u0275fac=function(i){return new(i||e)(x(We),x(Z),x(le),x(Ci))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})(),Xr=0,Ze=(()=>{let e=class e{constructor(t,i,s,h,f,m,C,E,D,w,R,I){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=s,this._positionBuilder=h,this._keyboardDispatcher=f,this._injector=m,this._ngZone=C,this._document=E,this._directionality=D,this._location=w,this._outsideClickDispatcher=R,this._animationsModuleType=I}create(t){let i=this._createHostElement(),s=this._createPaneElement(i),h=this._createPortalOutlet(s),f=new $e(t);return f.direction=f.direction||this._directionality.value,new Ct(h,i,s,f,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations",this._injector.get(Jt))}position(){return this._positionBuilder}_createPaneElement(t){let i=this._document.createElement("div");return i.id=`cdk-overlay-${Xr++}`,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){let t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(ri)),new Xe(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}};e.\u0275fac=function(i){return new(i||e)(x(Fr),x(Ci),x(Fe),x(Hr),x(Vr),x(je),x(K),x(Z),x(xe),x(si),x(zr),x(ei,8))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let u=e;return u})(),Ur=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],Di=new Kt("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let u=ht(Ze);return()=>u.scrollStrategies.reposition()}}),Ei=(()=>{let e=class e{constructor(t){this.elementRef=t}};e.\u0275fac=function(i){return new(i||e)(H(se))},e.\u0275dir=fe({type:e,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0});let u=e;return u})(),gs=(()=>{let e=class e{get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t,this._position&&this._updatePositionStrategy(this._position)}get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(t){this._disposeOnNavigation=t}constructor(t,i,s,h,f){this._overlay=t,this._dir=f,this._backdropSubscription=ce.EMPTY,this._attachSubscription=ce.EMPTY,this._detachSubscription=ce.EMPTY,this._positionSubscription=ce.EMPTY,this._disposeOnNavigation=!1,this._ngZone=ht(K),this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.hasBackdrop=!1,this.lockPosition=!1,this.flexibleDimensions=!1,this.growAfterOpen=!1,this.push=!1,this.backdropClick=new ne,this.positionChange=new ne,this.attach=new ne,this.detach=new ne,this.overlayKeydown=new ne,this.overlayOutsideClick=new ne,this._templatePortal=new Ie(i,s),this._scrollStrategyFactory=h,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(t){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),t.origin&&this.open&&this._position.apply()),t.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=Ur);let t=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=t.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=t.detachments().subscribe(()=>this.detach.emit()),t.keydownEvents().subscribe(i=>{this.overlayKeydown.next(i),i.keyCode===27&&!this.disableClose&&!oi(i)&&(i.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(i=>{let s=this._getOriginElement(),h=ze(i);(!s||s!==h&&!s.contains(h))&&this.overlayOutsideClick.next(i)})}_buildConfig(){let t=this._position=this.positionStrategy||this._createPositionStrategy(),i=new $e({direction:this._dir,positionStrategy:t,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||this.width===0)&&(i.width=this.width),(this.height||this.height===0)&&(i.height=this.height),(this.minWidth||this.minWidth===0)&&(i.minWidth=this.minWidth),(this.minHeight||this.minHeight===0)&&(i.minHeight=this.minHeight),this.backdropClass&&(i.backdropClass=this.backdropClass),this.panelClass&&(i.panelClass=this.panelClass),i}_updatePositionStrategy(t){let i=this.positions.map(s=>({originX:s.originX,originY:s.originY,overlayX:s.overlayX,overlayY:s.overlayY,offsetX:s.offsetX||this.offsetX,offsetY:s.offsetY||this.offsetY,panelClass:s.panelClass||void 0}));return t.setOrigin(this._getOrigin()).withPositions(i).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){let t=this._overlay.position().flexibleConnectedTo(this._getOrigin());return this._updatePositionStrategy(t),t}_getOrigin(){return this.origin instanceof Ei?this.origin.elementRef:this.origin}_getOriginElement(){return this.origin instanceof Ei?this.origin.elementRef.nativeElement:this.origin instanceof se?this.origin.nativeElement:typeof Element<"u"&&this.origin instanceof Element?this.origin:null}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(t=>{this.backdropClick.emit(t)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(qt(()=>this.positionChange.observers.length>0)).subscribe(t=>{this._ngZone.run(()=>this.positionChange.emit(t)),this.positionChange.observers.length===0&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)(H(Ze),H(Le),H(De),H(Di),H(xe,8))},e.\u0275dir=fe({type:e,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[0,"cdkConnectedOverlayOrigin","origin"],positions:[0,"cdkConnectedOverlayPositions","positions"],positionStrategy:[0,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[0,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[0,"cdkConnectedOverlayOffsetY","offsetY"],width:[0,"cdkConnectedOverlayWidth","width"],height:[0,"cdkConnectedOverlayHeight","height"],minWidth:[0,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[0,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[0,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[0,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[0,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[0,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[0,"cdkConnectedOverlayOpen","open"],disableClose:[0,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[0,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[2,"cdkConnectedOverlayHasBackdrop","hasBackdrop",pe],lockPosition:[2,"cdkConnectedOverlayLockPosition","lockPosition",pe],flexibleDimensions:[2,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",pe],growAfterOpen:[2,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",pe],push:[2,"cdkConnectedOverlayPush","push",pe],disposeOnNavigation:[2,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",pe]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[ft,dt]});let u=e;return u})();function $r(u){return()=>u.scrollStrategies.reposition()}var Zr={provide:Di,deps:[Ze],useFactory:$r},_s=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ue({type:e}),e.\u0275inj=de({providers:[Ze,Zr],imports:[Oe,gi,_t,_t]});let u=e;return u})();export{li as a,Kr as b,Ye as c,Ar as d,We as e,hi as f,mt as g,Ie as h,He as i,Qn as j,gi as k,Fr as l,$e as m,Ci as n,Ct as o,Ze as p,Ei as q,gs as r,_s as s,fi as t,pi as u,Ln as v};
