import{g as Vt}from"./chunk-PBUAGAEI.js";import{b as Yt,e as zt,f as jt,o as ue,r as kt}from"./chunk-2Z2LT7IR.js";import{B as Bt,C as Ft,D as Ut,G as Le,a as Ot,c as Nt,j as Lt,k as Oe,l as Ne,t as Mt}from"./chunk-VAJTLVRB.js";import{Aa as ft,Cb as wt,Dc as Pt,Fa as dt,Fb as Pe,Ha as le,Ma as ht,Mb as It,Nb as St,Ob as Et,Qb as Tt,Rb as Rt,Sa as mt,Ta as Y,Xb as xt,_a as pt,a as ee,b as nt,bb as vt,c as ae,ca as J,cb as _t,e as Kr,fa as ot,g as Jr,h as N,ia as ie,ja as st,la as Re,lb as yt,mb as gt,n as ce,na as xe,nb as Ae,nc as Dt,o as me,oa as De,ra as at,sa as ct,ta as lt,tc as At,wb as Ce,wc as Ct,xb as bt,za as ut}from"./chunk-CGW5RYE2.js";var Xt=Kr((Wt,Be)=>{(function(E){if(typeof Wt=="object"&&typeof Be<"u")Be.exports=E();else if(typeof define=="function"&&define.amd)define([],E);else{var y;typeof window<"u"?y=window:typeof global<"u"?y=global:typeof self<"u"?y=self:y=this,y.localforage=E()}})(function(){var E,y,di;return function r(s,l,m){function w(L,z){if(!l[L]){if(!s[L]){var v=typeof ae=="function"&&ae;if(!z&&v)return v(L,!0);if(b)return b(L,!0);var g=new Error("Cannot find module '"+L+"'");throw g.code="MODULE_NOT_FOUND",g}var A=l[L]={exports:{}};s[L][0].call(A.exports,function(M){var H=s[L][1][M];return w(H||M)},A,A.exports,r,s,l,m)}return l[L].exports}for(var b=typeof ae=="function"&&ae,C=0;C<m.length;C++)w(m[C]);return w}({1:[function(r,s,l){(function(m){"use strict";var w=m.MutationObserver||m.WebKitMutationObserver,b;if(w){var C=0,L=new w(M),z=m.document.createTextNode("");L.observe(z,{characterData:!0}),b=function(){z.data=C=++C%2}}else if(!m.setImmediate&&typeof m.MessageChannel<"u"){var v=new m.MessageChannel;v.port1.onmessage=M,b=function(){v.port2.postMessage(0)}}else"document"in m&&"onreadystatechange"in m.document.createElement("script")?b=function(){var B=m.document.createElement("script");B.onreadystatechange=function(){M(),B.onreadystatechange=null,B.parentNode.removeChild(B),B=null},m.document.documentElement.appendChild(B)}:b=function(){setTimeout(M,0)};var g,A=[];function M(){g=!0;for(var B,$,F=A.length;F;){for($=A,A=[],B=-1;++B<F;)$[B]();F=A.length}g=!1}s.exports=H;function H(B){A.push(B)===1&&!g&&b()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(r,s,l){"use strict";var m=r(1);function w(){}var b={},C=["REJECTED"],L=["FULFILLED"],z=["PENDING"];s.exports=v;function v(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=z,this.queue=[],this.outcome=void 0,p!==w&&H(this,p)}v.prototype.catch=function(p){return this.then(null,p)},v.prototype.then=function(p,T){if(typeof p!="function"&&this.state===L||typeof T!="function"&&this.state===C)return this;var S=new this.constructor(w);if(this.state!==z){var D=this.state===L?p:T;A(S,D,this.outcome)}else this.queue.push(new g(S,p,T));return S};function g(p,T,S){this.promise=p,typeof T=="function"&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}g.prototype.callFulfilled=function(p){b.resolve(this.promise,p)},g.prototype.otherCallFulfilled=function(p){A(this.promise,this.onFulfilled,p)},g.prototype.callRejected=function(p){b.reject(this.promise,p)},g.prototype.otherCallRejected=function(p){A(this.promise,this.onRejected,p)};function A(p,T,S){m(function(){var D;try{D=T(S)}catch(U){return b.reject(p,U)}D===p?b.reject(p,new TypeError("Cannot resolve promise with itself")):b.resolve(p,D)})}b.resolve=function(p,T){var S=B(M,T);if(S.status==="error")return b.reject(p,S.value);var D=S.value;if(D)H(p,D);else{p.state=L,p.outcome=T;for(var U=-1,j=p.queue.length;++U<j;)p.queue[U].callFulfilled(T)}return p},b.reject=function(p,T){p.state=C,p.outcome=T;for(var S=-1,D=p.queue.length;++S<D;)p.queue[S].callRejected(T);return p};function M(p){var T=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof T=="function")return function(){T.apply(p,arguments)}}function H(p,T){var S=!1;function D(V){S||(S=!0,b.reject(p,V))}function U(V){S||(S=!0,b.resolve(p,V))}function j(){T(U,D)}var k=B(j);k.status==="error"&&D(k.value)}function B(p,T){var S={};try{S.value=p(T),S.status="success"}catch(D){S.status="error",S.value=D}return S}v.resolve=$;function $(p){return p instanceof this?p:b.resolve(new this(w),p)}v.reject=F;function F(p){var T=new this(w);return b.reject(T,p)}v.all=pe;function pe(p){var T=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=p.length,D=!1;if(!S)return this.resolve([]);for(var U=new Array(S),j=0,k=-1,V=new this(w);++k<S;)q(p[k],k);return V;function q(ne,fe){T.resolve(ne).then(ve,function(te){D||(D=!0,b.reject(V,te))});function ve(te){U[fe]=te,++j===S&&!D&&(D=!0,b.resolve(V,U))}}}v.race=Z;function Z(p){var T=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=p.length,D=!1;if(!S)return this.resolve([]);for(var U=-1,j=new this(w);++U<S;)k(p[U]);return j;function k(V){T.resolve(V).then(function(q){D||(D=!0,b.resolve(j,q))},function(q){D||(D=!0,b.reject(j,q))})}}},{1:1}],3:[function(r,s,l){(function(m){"use strict";typeof m.Promise!="function"&&(m.Promise=r(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(r,s,l){"use strict";var m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function w(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function b(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var C=b();function L(){try{if(!C||!C.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),i=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||i)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function z(e,i){e=e||[],i=i||{};try{return new Blob(e,i)}catch(n){if(n.name!=="TypeError")throw n;for(var t=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,o=new t,a=0;a<e.length;a+=1)o.append(e[a]);return o.getBlob(i.type)}}typeof Promise>"u"&&r(3);var v=Promise;function g(e,i){i&&e.then(function(t){i(null,t)},function(t){i(t)})}function A(e,i,t){typeof i=="function"&&e.then(i),typeof t=="function"&&e.catch(t)}function M(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function H(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var B="local-forage-detect-blob-support",$=void 0,F={},pe=Object.prototype.toString,Z="readonly",p="readwrite";function T(e){for(var i=e.length,t=new ArrayBuffer(i),o=new Uint8Array(t),a=0;a<i;a++)o[a]=e.charCodeAt(a);return t}function S(e){return new v(function(i){var t=e.transaction(B,p),o=z([""]);t.objectStore(B).put(o,"key"),t.onabort=function(a){a.preventDefault(),a.stopPropagation(),i(!1)},t.oncomplete=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);i(n||!a||parseInt(a[1],10)>=43)}}).catch(function(){return!1})}function D(e){return typeof $=="boolean"?v.resolve($):S(e).then(function(i){return $=i,$})}function U(e){var i=F[e.name],t={};t.promise=new v(function(o,a){t.resolve=o,t.reject=a}),i.deferredOperations.push(t),i.dbReady?i.dbReady=i.dbReady.then(function(){return t.promise}):i.dbReady=t.promise}function j(e){var i=F[e.name],t=i.deferredOperations.pop();if(t)return t.resolve(),t.promise}function k(e,i){var t=F[e.name],o=t.deferredOperations.pop();if(o)return o.reject(i),o.promise}function V(e,i){return new v(function(t,o){if(F[e.name]=F[e.name]||Ue(),e.db)if(i)U(e),e.db.close();else return t(e.db);var a=[e.name];i&&a.push(e.version);var n=C.open.apply(C,a);i&&(n.onupgradeneeded=function(c){var u=n.result;try{u.createObjectStore(e.storeName),c.oldVersion<=1&&u.createObjectStore(B)}catch(f){if(f.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+c.oldVersion+" to version "+c.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw f}}),n.onerror=function(c){c.preventDefault(),o(n.error)},n.onsuccess=function(){var c=n.result;c.onversionchange=function(u){u.target.close()},t(c),j(e)}})}function q(e){return V(e,!1)}function ne(e){return V(e,!0)}function fe(e,i){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),o=e.version<e.db.version,a=e.version>e.db.version;if(o&&(e.version!==i&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),a||t){if(t){var n=e.db.version+1;n>e.version&&(e.version=n)}return!0}return!1}function ve(e){return new v(function(i,t){var o=new FileReader;o.onerror=t,o.onloadend=function(a){var n=btoa(a.target.result||"");i({__local_forage_encoded_blob:!0,data:n,type:e.type})},o.readAsBinaryString(e)})}function te(e){var i=T(atob(e.data));return z([i],{type:e.type})}function Fe(e){return e&&e.__local_forage_encoded_blob}function Jt(e){var i=this,t=i._initReady().then(function(){var o=F[i._dbInfo.name];if(o&&o.dbReady)return o.dbReady});return A(t,e,e),t}function Zt(e){U(e);for(var i=F[e.name],t=i.forages,o=0;o<t.length;o++){var a=t[o];a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null)}return e.db=null,q(e).then(function(n){return e.db=n,fe(e)?ne(e):n}).then(function(n){e.db=i.db=n;for(var c=0;c<t.length;c++)t[c]._dbInfo.db=n}).catch(function(n){throw k(e,n),n})}function W(e,i,t,o){o===void 0&&(o=1);try{var a=e.db.transaction(e.storeName,i);t(null,a)}catch(n){if(o>0&&(!e.db||n.name==="InvalidStateError"||n.name==="NotFoundError"))return v.resolve().then(function(){if(!e.db||n.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),ne(e)}).then(function(){return Zt(e).then(function(){W(e,i,t,o-1)})}).catch(t);t(n)}}function Ue(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function er(e){var i=this,t={db:null};if(e)for(var o in e)t[o]=e[o];var a=F[t.name];a||(a=Ue(),F[t.name]=a),a.forages.push(i),i._initReady||(i._initReady=i.ready,i.ready=Jt);var n=[];function c(){return v.resolve()}for(var u=0;u<a.forages.length;u++){var f=a.forages[u];f!==i&&n.push(f._initReady().catch(c))}var d=a.forages.slice(0);return v.all(n).then(function(){return t.db=a.db,q(t)}).then(function(h){return t.db=h,fe(t,i._defaultConfig.version)?ne(t):h}).then(function(h){t.db=a.db=h,i._dbInfo=t;for(var _=0;_<d.length;_++){var I=d[_];I!==i&&(I._dbInfo.db=t.db,I._dbInfo.version=t.version)}})}function tr(e,i){var t=this;e=M(e);var o=new v(function(a,n){t.ready().then(function(){W(t._dbInfo,Z,function(c,u){if(c)return n(c);try{var f=u.objectStore(t._dbInfo.storeName),d=f.get(e);d.onsuccess=function(){var h=d.result;h===void 0&&(h=null),Fe(h)&&(h=te(h)),a(h)},d.onerror=function(){n(d.error)}}catch(h){n(h)}})}).catch(n)});return g(o,i),o}function rr(e,i){var t=this,o=new v(function(a,n){t.ready().then(function(){W(t._dbInfo,Z,function(c,u){if(c)return n(c);try{var f=u.objectStore(t._dbInfo.storeName),d=f.openCursor(),h=1;d.onsuccess=function(){var _=d.result;if(_){var I=_.value;Fe(I)&&(I=te(I));var R=e(I,_.key,h++);R!==void 0?a(R):_.continue()}else a()},d.onerror=function(){n(d.error)}}catch(_){n(_)}})}).catch(n)});return g(o,i),o}function ir(e,i,t){var o=this;e=M(e);var a=new v(function(n,c){var u;o.ready().then(function(){return u=o._dbInfo,pe.call(i)==="[object Blob]"?D(u.db).then(function(f){return f?i:ve(i)}):i}).then(function(f){W(o._dbInfo,p,function(d,h){if(d)return c(d);try{var _=h.objectStore(o._dbInfo.storeName);f===null&&(f=void 0);var I=_.put(f,e);h.oncomplete=function(){f===void 0&&(f=null),n(f)},h.onabort=h.onerror=function(){var R=I.error?I.error:I.transaction.error;c(R)}}catch(R){c(R)}})}).catch(c)});return g(a,t),a}function nr(e,i){var t=this;e=M(e);var o=new v(function(a,n){t.ready().then(function(){W(t._dbInfo,p,function(c,u){if(c)return n(c);try{var f=u.objectStore(t._dbInfo.storeName),d=f.delete(e);u.oncomplete=function(){a()},u.onerror=function(){n(d.error)},u.onabort=function(){var h=d.error?d.error:d.transaction.error;n(h)}}catch(h){n(h)}})}).catch(n)});return g(o,i),o}function or(e){var i=this,t=new v(function(o,a){i.ready().then(function(){W(i._dbInfo,p,function(n,c){if(n)return a(n);try{var u=c.objectStore(i._dbInfo.storeName),f=u.clear();c.oncomplete=function(){o()},c.onabort=c.onerror=function(){var d=f.error?f.error:f.transaction.error;a(d)}}catch(d){a(d)}})}).catch(a)});return g(t,e),t}function sr(e){var i=this,t=new v(function(o,a){i.ready().then(function(){W(i._dbInfo,Z,function(n,c){if(n)return a(n);try{var u=c.objectStore(i._dbInfo.storeName),f=u.count();f.onsuccess=function(){o(f.result)},f.onerror=function(){a(f.error)}}catch(d){a(d)}})}).catch(a)});return g(t,e),t}function ar(e,i){var t=this,o=new v(function(a,n){if(e<0){a(null);return}t.ready().then(function(){W(t._dbInfo,Z,function(c,u){if(c)return n(c);try{var f=u.objectStore(t._dbInfo.storeName),d=!1,h=f.openKeyCursor();h.onsuccess=function(){var _=h.result;if(!_){a(null);return}e===0||d?a(_.key):(d=!0,_.advance(e))},h.onerror=function(){n(h.error)}}catch(_){n(_)}})}).catch(n)});return g(o,i),o}function cr(e){var i=this,t=new v(function(o,a){i.ready().then(function(){W(i._dbInfo,Z,function(n,c){if(n)return a(n);try{var u=c.objectStore(i._dbInfo.storeName),f=u.openKeyCursor(),d=[];f.onsuccess=function(){var h=f.result;if(!h){o(d);return}d.push(h.key),h.continue()},f.onerror=function(){a(f.error)}}catch(h){a(h)}})}).catch(a)});return g(t,e),t}function lr(e,i){i=H.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,a;if(!e.name)a=v.reject("Invalid arguments");else{var n=e.name===t.name&&o._dbInfo.db,c=n?v.resolve(o._dbInfo.db):q(e).then(function(u){var f=F[e.name],d=f.forages;f.db=u;for(var h=0;h<d.length;h++)d[h]._dbInfo.db=u;return u});e.storeName?a=c.then(function(u){if(u.objectStoreNames.contains(e.storeName)){var f=u.version+1;U(e);var d=F[e.name],h=d.forages;u.close();for(var _=0;_<h.length;_++){var I=h[_];I._dbInfo.db=null,I._dbInfo.version=f}var R=new v(function(x,O){var P=C.open(e.name,f);P.onerror=function(Q){var se=P.result;se.close(),O(Q)},P.onupgradeneeded=function(){var Q=P.result;Q.deleteObjectStore(e.storeName)},P.onsuccess=function(){var Q=P.result;Q.close(),x(Q)}});return R.then(function(x){d.db=x;for(var O=0;O<h.length;O++){var P=h[O];P._dbInfo.db=x,j(P._dbInfo)}}).catch(function(x){throw(k(e,x)||v.resolve()).catch(function(){}),x})}}):a=c.then(function(u){U(e);var f=F[e.name],d=f.forages;u.close();for(var h=0;h<d.length;h++){var _=d[h];_._dbInfo.db=null}var I=new v(function(R,x){var O=C.deleteDatabase(e.name);O.onerror=function(){var P=O.result;P&&P.close(),x(O.error)},O.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},O.onsuccess=function(){var P=O.result;P&&P.close(),R(P)}});return I.then(function(R){f.db=R;for(var x=0;x<d.length;x++){var O=d[x];j(O._dbInfo)}}).catch(function(R){throw(k(e,R)||v.resolve()).catch(function(){}),R})})}return g(a,i),a}var ur={_driver:"asyncStorage",_initStorage:er,_support:L(),iterate:rr,getItem:tr,setItem:ir,removeItem:nr,clear:or,length:sr,key:ar,keys:cr,dropInstance:lr};function fr(){return typeof openDatabase=="function"}var G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",dr="~~local_forage_type~",Ye=/^~~local_forage_type~([^~]+)~/,de="__lfsc__:",_e=de.length,ye="arbf",ge="blob",ze="si08",je="ui08",ke="uic8",Ve="si16",Qe="si32",He="ur16",$e="ui32",qe="fl32",We="fl64",Xe=_e+ye.length,Ge=Object.prototype.toString;function Ke(e){var i=e.length*.75,t=e.length,o,a=0,n,c,u,f;e[e.length-1]==="="&&(i--,e[e.length-2]==="="&&i--);var d=new ArrayBuffer(i),h=new Uint8Array(d);for(o=0;o<t;o+=4)n=G.indexOf(e[o]),c=G.indexOf(e[o+1]),u=G.indexOf(e[o+2]),f=G.indexOf(e[o+3]),h[a++]=n<<2|c>>4,h[a++]=(c&15)<<4|u>>2,h[a++]=(u&3)<<6|f&63;return d}function be(e){var i=new Uint8Array(e),t="",o;for(o=0;o<i.length;o+=3)t+=G[i[o]>>2],t+=G[(i[o]&3)<<4|i[o+1]>>4],t+=G[(i[o+1]&15)<<2|i[o+2]>>6],t+=G[i[o+2]&63];return i.length%3===2?t=t.substring(0,t.length-1)+"=":i.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}function hr(e,i){var t="";if(e&&(t=Ge.call(e)),e&&(t==="[object ArrayBuffer]"||e.buffer&&Ge.call(e.buffer)==="[object ArrayBuffer]")){var o,a=de;e instanceof ArrayBuffer?(o=e,a+=ye):(o=e.buffer,t==="[object Int8Array]"?a+=ze:t==="[object Uint8Array]"?a+=je:t==="[object Uint8ClampedArray]"?a+=ke:t==="[object Int16Array]"?a+=Ve:t==="[object Uint16Array]"?a+=He:t==="[object Int32Array]"?a+=Qe:t==="[object Uint32Array]"?a+=$e:t==="[object Float32Array]"?a+=qe:t==="[object Float64Array]"?a+=We:i(new Error("Failed to get type for BinaryArray"))),i(a+be(o))}else if(t==="[object Blob]"){var n=new FileReader;n.onload=function(){var c=dr+e.type+"~"+be(this.result);i(de+ge+c)},n.readAsArrayBuffer(e)}else try{i(JSON.stringify(e))}catch(c){console.error("Couldn't convert value into a JSON string: ",e),i(null,c)}}function mr(e){if(e.substring(0,_e)!==de)return JSON.parse(e);var i=e.substring(Xe),t=e.substring(_e,Xe),o;if(t===ge&&Ye.test(i)){var a=i.match(Ye);o=a[1],i=i.substring(a[0].length)}var n=Ke(i);switch(t){case ye:return n;case ge:return z([n],{type:o});case ze:return new Int8Array(n);case je:return new Uint8Array(n);case ke:return new Uint8ClampedArray(n);case Ve:return new Int16Array(n);case He:return new Uint16Array(n);case Qe:return new Int32Array(n);case $e:return new Uint32Array(n);case qe:return new Float32Array(n);case We:return new Float64Array(n);default:throw new Error("Unkown type: "+t)}}var we={serialize:hr,deserialize:mr,stringToBuffer:Ke,bufferToString:be};function Je(e,i,t,o){e.executeSql("CREATE TABLE IF NOT EXISTS "+i.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],t,o)}function pr(e){var i=this,t={db:null};if(e)for(var o in e)t[o]=typeof e[o]!="string"?e[o].toString():e[o];var a=new v(function(n,c){try{t.db=openDatabase(t.name,String(t.version),t.description,t.size)}catch(u){return c(u)}t.db.transaction(function(u){Je(u,t,function(){i._dbInfo=t,n()},function(f,d){c(d)})},c)});return t.serializer=we,a}function K(e,i,t,o,a,n){e.executeSql(t,o,a,function(c,u){u.code===u.SYNTAX_ERR?c.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[i.storeName],function(f,d){d.rows.length?n(f,u):Je(f,i,function(){f.executeSql(t,o,a,n)},n)},n):n(c,u)},n)}function vr(e,i){var t=this;e=M(e);var o=new v(function(a,n){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(u){K(u,c,"SELECT * FROM "+c.storeName+" WHERE key = ? LIMIT 1",[e],function(f,d){var h=d.rows.length?d.rows.item(0).value:null;h&&(h=c.serializer.deserialize(h)),a(h)},function(f,d){n(d)})})}).catch(n)});return g(o,i),o}function _r(e,i){var t=this,o=new v(function(a,n){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(u){K(u,c,"SELECT * FROM "+c.storeName,[],function(f,d){for(var h=d.rows,_=h.length,I=0;I<_;I++){var R=h.item(I),x=R.value;if(x&&(x=c.serializer.deserialize(x)),x=e(x,R.key,I+1),x!==void 0){a(x);return}}a()},function(f,d){n(d)})})}).catch(n)});return g(o,i),o}function Ze(e,i,t,o){var a=this;e=M(e);var n=new v(function(c,u){a.ready().then(function(){i===void 0&&(i=null);var f=i,d=a._dbInfo;d.serializer.serialize(i,function(h,_){_?u(_):d.db.transaction(function(I){K(I,d,"INSERT OR REPLACE INTO "+d.storeName+" (key, value) VALUES (?, ?)",[e,h],function(){c(f)},function(R,x){u(x)})},function(I){if(I.code===I.QUOTA_ERR){if(o>0){c(Ze.apply(a,[e,f,t,o-1]));return}u(I)}})})}).catch(u)});return g(n,t),n}function yr(e,i,t){return Ze.apply(this,[e,i,t,1])}function gr(e,i){var t=this;e=M(e);var o=new v(function(a,n){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(u){K(u,c,"DELETE FROM "+c.storeName+" WHERE key = ?",[e],function(){a()},function(f,d){n(d)})})}).catch(n)});return g(o,i),o}function br(e){var i=this,t=new v(function(o,a){i.ready().then(function(){var n=i._dbInfo;n.db.transaction(function(c){K(c,n,"DELETE FROM "+n.storeName,[],function(){o()},function(u,f){a(f)})})}).catch(a)});return g(t,e),t}function wr(e){var i=this,t=new v(function(o,a){i.ready().then(function(){var n=i._dbInfo;n.db.transaction(function(c){K(c,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],function(u,f){var d=f.rows.item(0).c;o(d)},function(u,f){a(f)})})}).catch(a)});return g(t,e),t}function Ir(e,i){var t=this,o=new v(function(a,n){t.ready().then(function(){var c=t._dbInfo;c.db.transaction(function(u){K(u,c,"SELECT key FROM "+c.storeName+" WHERE id = ? LIMIT 1",[e+1],function(f,d){var h=d.rows.length?d.rows.item(0).key:null;a(h)},function(f,d){n(d)})})}).catch(n)});return g(o,i),o}function Sr(e){var i=this,t=new v(function(o,a){i.ready().then(function(){var n=i._dbInfo;n.db.transaction(function(c){K(c,n,"SELECT key FROM "+n.storeName,[],function(u,f){for(var d=[],h=0;h<f.rows.length;h++)d.push(f.rows.item(h).key);o(d)},function(u,f){a(f)})})}).catch(a)});return g(t,e),t}function Er(e){return new v(function(i,t){e.transaction(function(o){o.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(a,n){for(var c=[],u=0;u<n.rows.length;u++)c.push(n.rows.item(u).name);i({db:e,storeNames:c})},function(a,n){t(n)})},function(o){t(o)})})}function Tr(e,i){i=H.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,a;return e.name?a=new v(function(n){var c;e.name===t.name?c=o._dbInfo.db:c=openDatabase(e.name,"","",0),e.storeName?n({db:c,storeNames:[e.storeName]}):n(Er(c))}).then(function(n){return new v(function(c,u){n.db.transaction(function(f){function d(R){return new v(function(x,O){f.executeSql("DROP TABLE IF EXISTS "+R,[],function(){x()},function(P,Q){O(Q)})})}for(var h=[],_=0,I=n.storeNames.length;_<I;_++)h.push(d(n.storeNames[_]));v.all(h).then(function(){c()}).catch(function(R){u(R)})},function(f){u(f)})})}):a=v.reject("Invalid arguments"),g(a,i),a}var Rr={_driver:"webSQLStorage",_initStorage:pr,_support:fr(),iterate:_r,getItem:vr,setItem:yr,removeItem:gr,clear:br,length:wr,key:Ir,keys:Sr,dropInstance:Tr};function xr(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function et(e,i){var t=e.name+"/";return e.storeName!==i.storeName&&(t+=e.storeName+"/"),t}function Dr(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}function Ar(){return!Dr()||localStorage.length>0}function Cr(e){var i=this,t={};if(e)for(var o in e)t[o]=e[o];return t.keyPrefix=et(e,i._defaultConfig),Ar()?(i._dbInfo=t,t.serializer=we,v.resolve()):v.reject()}function Pr(e){var i=this,t=i.ready().then(function(){for(var o=i._dbInfo.keyPrefix,a=localStorage.length-1;a>=0;a--){var n=localStorage.key(a);n.indexOf(o)===0&&localStorage.removeItem(n)}});return g(t,e),t}function Or(e,i){var t=this;e=M(e);var o=t.ready().then(function(){var a=t._dbInfo,n=localStorage.getItem(a.keyPrefix+e);return n&&(n=a.serializer.deserialize(n)),n});return g(o,i),o}function Nr(e,i){var t=this,o=t.ready().then(function(){for(var a=t._dbInfo,n=a.keyPrefix,c=n.length,u=localStorage.length,f=1,d=0;d<u;d++){var h=localStorage.key(d);if(h.indexOf(n)===0){var _=localStorage.getItem(h);if(_&&(_=a.serializer.deserialize(_)),_=e(_,h.substring(c),f++),_!==void 0)return _}}});return g(o,i),o}function Lr(e,i){var t=this,o=t.ready().then(function(){var a=t._dbInfo,n;try{n=localStorage.key(e)}catch{n=null}return n&&(n=n.substring(a.keyPrefix.length)),n});return g(o,i),o}function Mr(e){var i=this,t=i.ready().then(function(){for(var o=i._dbInfo,a=localStorage.length,n=[],c=0;c<a;c++){var u=localStorage.key(c);u.indexOf(o.keyPrefix)===0&&n.push(u.substring(o.keyPrefix.length))}return n});return g(t,e),t}function Br(e){var i=this,t=i.keys().then(function(o){return o.length});return g(t,e),t}function Fr(e,i){var t=this;e=M(e);var o=t.ready().then(function(){var a=t._dbInfo;localStorage.removeItem(a.keyPrefix+e)});return g(o,i),o}function Ur(e,i,t){var o=this;e=M(e);var a=o.ready().then(function(){i===void 0&&(i=null);var n=i;return new v(function(c,u){var f=o._dbInfo;f.serializer.serialize(i,function(d,h){if(h)u(h);else try{localStorage.setItem(f.keyPrefix+e,d),c(n)}catch(_){(_.name==="QuotaExceededError"||_.name==="NS_ERROR_DOM_QUOTA_REACHED")&&u(_),u(_)}})})});return g(a,t),a}function Yr(e,i){if(i=H.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}var o=this,a;return e.name?a=new v(function(n){e.storeName?n(et(e,o._defaultConfig)):n(e.name+"/")}).then(function(n){for(var c=localStorage.length-1;c>=0;c--){var u=localStorage.key(c);u.indexOf(n)===0&&localStorage.removeItem(u)}}):a=v.reject("Invalid arguments"),g(a,i),a}var zr={_driver:"localStorageWrapper",_initStorage:Cr,_support:xr(),iterate:Nr,getItem:Or,setItem:Ur,removeItem:Fr,clear:Pr,length:Br,key:Lr,keys:Mr,dropInstance:Yr},jr=function(i,t){return i===t||typeof i=="number"&&typeof t=="number"&&isNaN(i)&&isNaN(t)},kr=function(i,t){for(var o=i.length,a=0;a<o;){if(jr(i[a],t))return!0;a++}return!1},tt=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},oe={},rt={},re={INDEXEDDB:ur,WEBSQL:Rr,LOCALSTORAGE:zr},Vr=[re.INDEXEDDB._driver,re.WEBSQL._driver,re.LOCALSTORAGE._driver],he=["dropInstance"],Ie=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(he),Qr={description:"",driver:Vr.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Hr(e,i){e[i]=function(){var t=arguments;return e.ready().then(function(){return e[i].apply(e,t)})}}function Se(){for(var e=1;e<arguments.length;e++){var i=arguments[e];if(i)for(var t in i)i.hasOwnProperty(t)&&(tt(i[t])?arguments[0][t]=i[t].slice():arguments[0][t]=i[t])}return arguments[0]}var $r=function(){function e(i){w(this,e);for(var t in re)if(re.hasOwnProperty(t)){var o=re[t],a=o._driver;this[t]=a,oe[a]||this.defineDriver(o)}this._defaultConfig=Se({},Qr),this._config=Se({},this._defaultConfig,i),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(t){if((typeof t>"u"?"undefined":m(t))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var o in t){if(o==="storeName"&&(t[o]=t[o].replace(/\W/g,"_")),o==="version"&&typeof t[o]!="number")return new Error("Database version must be a number.");this._config[o]=t[o]}return"driver"in t&&t.driver?this.setDriver(this._config.driver):!0}else return typeof t=="string"?this._config[t]:this._config},e.prototype.defineDriver=function(t,o,a){var n=new v(function(c,u){try{var f=t._driver,d=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver){u(d);return}for(var h=Ie.concat("_initStorage"),_=0,I=h.length;_<I;_++){var R=h[_],x=!kr(he,R);if((x||t[R])&&typeof t[R]!="function"){u(d);return}}var O=function(){for(var se=function(Xr){return function(){var Gr=new Error("Method "+Xr+" is not implemented by the current driver"),it=v.reject(Gr);return g(it,arguments[arguments.length-1]),it}},Ee=0,Wr=he.length;Ee<Wr;Ee++){var Te=he[Ee];t[Te]||(t[Te]=se(Te))}};O();var P=function(se){oe[f]&&console.info("Redefining LocalForage driver: "+f),oe[f]=t,rt[f]=se,c()};"_support"in t?t._support&&typeof t._support=="function"?t._support().then(P,u):P(!!t._support):P(!0)}catch(Q){u(Q)}});return A(n,o,a),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(t,o,a){var n=oe[t]?v.resolve(oe[t]):v.reject(new Error("Driver not found."));return A(n,o,a),n},e.prototype.getSerializer=function(t){var o=v.resolve(we);return A(o,t),o},e.prototype.ready=function(t){var o=this,a=o._driverSet.then(function(){return o._ready===null&&(o._ready=o._initDriver()),o._ready});return A(a,t,t),a},e.prototype.setDriver=function(t,o,a){var n=this;tt(t)||(t=[t]);var c=this._getSupportedDrivers(t);function u(){n._config.driver=n.driver()}function f(_){return n._extend(_),u(),n._ready=n._initStorage(n._config),n._ready}function d(_){return function(){var I=0;function R(){for(;I<_.length;){var x=_[I];return I++,n._dbInfo=null,n._ready=null,n.getDriver(x).then(f).catch(R)}u();var O=new Error("No available storage method found.");return n._driverSet=v.reject(O),n._driverSet}return R()}}var h=this._driverSet!==null?this._driverSet.catch(function(){return v.resolve()}):v.resolve();return this._driverSet=h.then(function(){var _=c[0];return n._dbInfo=null,n._ready=null,n.getDriver(_).then(function(I){n._driver=I._driver,u(),n._wrapLibraryMethodsWithReady(),n._initDriver=d(c)})}).catch(function(){u();var _=new Error("No available storage method found.");return n._driverSet=v.reject(_),n._driverSet}),A(this._driverSet,o,a),this._driverSet},e.prototype.supports=function(t){return!!rt[t]},e.prototype._extend=function(t){Se(this,t)},e.prototype._getSupportedDrivers=function(t){for(var o=[],a=0,n=t.length;a<n;a++){var c=t[a];this.supports(c)&&o.push(c)}return o},e.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,o=Ie.length;t<o;t++)Hr(this,Ie[t])},e.prototype.createInstance=function(t){return new e(t)},e}(),qr=new $r;s.exports=qr},{3:3}]},{},[4])(4)})});var ei=["tooltip"],$t=20;var qt=new Re("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{let E=De(ue);return()=>E.scrollStrategies.reposition({scrollThrottle:$t})}});function ti(E){return()=>E.scrollStrategies.reposition({scrollThrottle:$t})}var ri={provide:qt,deps:[ue],useFactory:ti};function ii(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}var ni=new Re("mat-tooltip-default-options",{providedIn:"root",factory:ii});var Qt="tooltip-panel",Ht=Nt({passive:!0}),oi=8,si=8,ai=24,ci=200,Yi=(()=>{let y=class y{get position(){return this._position}set position(r){r!==this._position&&(this._position=r,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(r){this._positionAtOrigin=Oe(r),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(r){this._disabled=Oe(r),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(r){this._showDelay=Ne(r)}get hideDelay(){return this._hideDelay}set hideDelay(r){this._hideDelay=Ne(r),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(r){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=r!=null?String(r).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(r){this._tooltipClass=r,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(r,s,l,m,w,b,C,L,z,v,g,A){this._overlay=r,this._elementRef=s,this._scrollDispatcher=l,this._viewContainerRef=m,this._ngZone=w,this._platform=b,this._ariaDescriber=C,this._focusMonitor=L,this._dir=v,this._defaultOptions=g,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._tooltipComponent=li,this._viewportMargin=8,this._cssClassPrefix="mat-mdc",this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new ce,this._injector=De(dt),this._scrollStrategy=z,this._document=A,g&&(this._showDelay=g.showDelay,this._hideDelay=g.hideDelay,g.position&&(this.position=g.position),g.positionAtOrigin&&(this.positionAtOrigin=g.positionAtOrigin),g.touchGestures&&(this.touchGestures=g.touchGestures)),v.change.pipe(J(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)}),this._viewportMargin=oi}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(J(this._destroyed)).subscribe(r=>{r?r==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){let r=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([s,l])=>{r.removeEventListener(s,l,Ht)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(r,this.message,"tooltip"),this._focusMonitor.stopMonitoring(r)}show(r=this.showDelay,s){if(this.disabled||!this.message||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let l=this._createOverlay(s);this._detach(),this._portal=this._portal||new jt(this._tooltipComponent,this._viewContainerRef);let m=this._tooltipInstance=l.attach(this._portal).instance;m._triggerElement=this._elementRef.nativeElement,m._mouseLeaveHideDelay=this._hideDelay,m.afterHidden().pipe(J(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),m.show(r)}hide(r=this.hideDelay){let s=this._tooltipInstance;s&&(s.isVisible()?s.hide(r):(s._cancelPendingAnimations(),this._detach()))}toggle(r){this._isTooltipVisible()?this.hide():this.show(void 0,r)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(r){if(this._overlayRef){let m=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!r)&&m._origin instanceof le)return this._overlayRef;this._detach()}let s=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),l=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin?r||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(s);return l.positionChanges.pipe(J(this._destroyed)).subscribe(m=>{this._updateCurrentPositionClass(m.connectionPair),this._tooltipInstance&&m.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:l,panelClass:`${this._cssClassPrefix}-${Qt}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(J(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(J(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(J(this._destroyed)).subscribe(m=>{this._isTooltipVisible()&&m.keyCode===27&&!Lt(m)&&(m.preventDefault(),m.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(r){let s=r.getConfig().positionStrategy,l=this._getOrigin(),m=this._getOverlayPosition();s.withPositions([this._addOffset(ee(ee({},l.main),m.main)),this._addOffset(ee(ee({},l.fallback),m.fallback))])}_addOffset(r){let s=si,l=!this._dir||this._dir.value=="ltr";return r.originY==="top"?r.offsetY=-s:r.originY==="bottom"?r.offsetY=s:r.originX==="start"?r.offsetX=l?-s:s:r.originX==="end"&&(r.offsetX=l?s:-s),r}_getOrigin(){let r=!this._dir||this._dir.value=="ltr",s=this.position,l;s=="above"||s=="below"?l={originX:"center",originY:s=="above"?"top":"bottom"}:s=="before"||s=="left"&&r||s=="right"&&!r?l={originX:"start",originY:"center"}:(s=="after"||s=="right"&&r||s=="left"&&!r)&&(l={originX:"end",originY:"center"});let{x:m,y:w}=this._invertPosition(l.originX,l.originY);return{main:l,fallback:{originX:m,originY:w}}}_getOverlayPosition(){let r=!this._dir||this._dir.value=="ltr",s=this.position,l;s=="above"?l={overlayX:"center",overlayY:"bottom"}:s=="below"?l={overlayX:"center",overlayY:"top"}:s=="before"||s=="left"&&r||s=="right"&&!r?l={overlayX:"end",overlayY:"center"}:(s=="after"||s=="right"&&r||s=="left"&&!r)&&(l={overlayX:"start",overlayY:"center"});let{x:m,y:w}=this._invertPosition(l.overlayX,l.overlayY);return{main:l,fallback:{overlayX:m,overlayY:w}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),vt(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(r){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=r,this._tooltipInstance._markForCheck())}_invertPosition(r,s){return this.position==="above"||this.position==="below"?s==="top"?s="bottom":s==="bottom"&&(s="top"):r==="end"?r="start":r==="start"&&(r="end"),{x:r,y:s}}_updateCurrentPositionClass(r){let{overlayY:s,originX:l,originY:m}=r,w;if(s==="center"?this._dir&&this._dir.value==="rtl"?w=l==="end"?"left":"right":w=l==="start"?"left":"right":w=s==="bottom"&&m==="top"?"above":"below",w!==this._currentPosition){let b=this._overlayRef;if(b){let C=`${this._cssClassPrefix}-${Qt}-`;b.removePanelClass(C+this._currentPosition),b.addPanelClass(C+w)}this._currentPosition=w}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",r=>{this._setupPointerExitEventsIfNeeded();let s;r.x!==void 0&&r.y!==void 0&&(s=r),this.show(void 0,s)}]):this.touchGestures!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",r=>{let s=r.targetTouches?.[0],l=s?{x:s.clientX,y:s.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout);let m=500;this._touchstartTimeout=setTimeout(()=>this.show(void 0,l),this._defaultOptions.touchLongPressShowDelay??m)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let r=[];if(this._platformSupportsMouseEvents())r.push(["mouseleave",s=>{let l=s.relatedTarget;(!l||!this._overlayRef?.overlayElement.contains(l))&&this.hide()}],["wheel",s=>this._wheelListener(s)]);else if(this.touchGestures!=="off"){this._disableNativeGesturesIfNecessary();let s=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};r.push(["touchend",s],["touchcancel",s])}this._addListeners(r),this._passiveListeners.push(...r)}_addListeners(r){r.forEach(([s,l])=>{this._elementRef.nativeElement.addEventListener(s,l,Ht)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(r){if(this._isTooltipVisible()){let s=this._document.elementFromPoint(r.clientX,r.clientY),l=this._elementRef.nativeElement;s!==l&&!l.contains(s)&&this.hide()}}_disableNativeGesturesIfNecessary(){let r=this.touchGestures;if(r!=="off"){let s=this._elementRef.nativeElement,l=s.style;(r==="on"||s.nodeName!=="INPUT"&&s.nodeName!=="TEXTAREA")&&(l.userSelect=l.msUserSelect=l.webkitUserSelect=l.MozUserSelect="none"),(r==="on"||!s.draggable)&&(l.webkitUserDrag="none"),l.touchAction="none",l.webkitTapHighlightColor="transparent"}}};y.\u0275fac=function(s){return new(s||y)(Y(ue),Y(le),Y(Yt),Y(_t),Y(pt),Y(Ot),Y(Mt),Y(Bt),Y(qt),Y(Ut),Y(ni,8),Y(At))},y.\u0275dir=lt({type:y,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(s,l){s&2&&Ae("mat-mdc-tooltip-disabled",l.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"],standalone:!0});let E=y;return E})(),li=(()=>{let y=class y{constructor(r,s,l){this._changeDetectorRef=r,this._elementRef=s,this._isMultiline=!1,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new ce,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide",this._animationsDisabled=l==="NoopAnimations"}show(r){this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},r)}hide(r){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},r)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:r}){(!r||!this._triggerElement.contains(r))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){let r=this._elementRef.nativeElement.getBoundingClientRect();return r.height>ai&&r.width>=ci}_handleAnimationEnd({animationName:r}){(r===this._showAnimation||r===this._hideAnimation)&&this._finalizeAnimation(r===this._showAnimation)}_cancelPendingAnimations(){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(r){r?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(r){let s=this._tooltip.nativeElement,l=this._showAnimation,m=this._hideAnimation;if(s.classList.remove(r?m:l),s.classList.add(r?l:m),this._isVisible!==r&&(this._isVisible=r,this._changeDetectorRef.markForCheck()),r&&!this._animationsDisabled&&typeof getComputedStyle=="function"){let w=getComputedStyle(s);(w.getPropertyValue("animation-duration")==="0s"||w.getPropertyValue("animation-name")==="none")&&(this._animationsDisabled=!0)}r&&this._onShow(),this._animationsDisabled&&(s.classList.add("_mat-animation-noopable"),this._finalizeAnimation(r))}};y.\u0275fac=function(s){return new(s||y)(Y(Dt),Y(le),Y(ht,8))},y.\u0275cmp=at({type:y,selectors:[["mat-tooltip-component"]],viewQuery:function(s,l){if(s&1&&It(ei,7),s&2){let m;St(m=Et())&&(l._tooltip=m.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(s,l){s&1&&Pe("mouseleave",function(w){return l._handleMouseLeave(w)}),s&2&&gt("zoom",l.isVisible()?1:null)},standalone:!0,features:[xt],decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mdc-tooltip--shown","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mdc-tooltip__surface","mdc-tooltip__surface-animation"]],template:function(s,l){if(s&1){let m=wt();Ce(0,"div",1,0),Pe("animationend",function(b){return ut(m),ft(l._handleAnimationEnd(b))}),Ce(2,"div",2),Tt(3),bt()()}s&2&&(Ae("mdc-tooltip--multiline",l._isMultiline),yt("ngClass",l.tooltipClass),mt(3),Rt(l.message))},dependencies:[Ct],styles:['.mdc-tooltip__surface{word-break:break-all;word-break:var(--mdc-tooltip-word-break, normal);overflow-wrap:anywhere}.mdc-tooltip--showing-transition .mdc-tooltip__surface-animation{transition:opacity 150ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-tooltip--hide-transition .mdc-tooltip__surface-animation{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-tooltip{position:fixed;display:none;z-index:9}.mdc-tooltip-wrapper--rich{position:relative}.mdc-tooltip--shown,.mdc-tooltip--showing,.mdc-tooltip--hide{display:inline-flex}.mdc-tooltip--shown.mdc-tooltip--rich,.mdc-tooltip--showing.mdc-tooltip--rich,.mdc-tooltip--hide.mdc-tooltip--rich{display:inline-block;left:-320px;position:absolute}.mdc-tooltip__surface{line-height:16px;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center}.mdc-tooltip__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-tooltip__surface::before{border-color:CanvasText}}.mdc-tooltip--rich .mdc-tooltip__surface{align-items:flex-start;display:flex;flex-direction:column;min-height:24px;min-width:40px;max-width:320px;position:relative}.mdc-tooltip--multiline .mdc-tooltip__surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mdc-tooltip__surface,.mdc-tooltip--multiline .mdc-tooltip__surface[dir=rtl]{text-align:right}.mdc-tooltip__surface .mdc-tooltip__title{margin:0 8px}.mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(200px - 2*8px);margin:8px;text-align:left}[dir=rtl] .mdc-tooltip__surface .mdc-tooltip__content,.mdc-tooltip__surface .mdc-tooltip__content[dir=rtl]{text-align:right}.mdc-tooltip--rich .mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(320px - 2*8px);align-self:stretch}.mdc-tooltip__surface .mdc-tooltip__content-link{text-decoration:none}.mdc-tooltip--rich-actions,.mdc-tooltip__content,.mdc-tooltip__title{z-index:1}.mdc-tooltip__surface-animation{opacity:0;transform:scale(0.8);will-change:transform,opacity}.mdc-tooltip--shown .mdc-tooltip__surface-animation{transform:scale(1);opacity:1}.mdc-tooltip--hide .mdc-tooltip__surface-animation{transform:scale(1)}.mdc-tooltip__caret-surface-top,.mdc-tooltip__caret-surface-bottom{position:absolute;height:24px;width:24px;transform:rotate(35deg) skewY(20deg) scaleX(0.9396926208)}.mdc-tooltip__caret-surface-top .mdc-elevation-overlay,.mdc-tooltip__caret-surface-bottom .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-tooltip__caret-surface-bottom{box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12);outline:1px solid rgba(0,0,0,0);z-index:-1}@media screen and (forced-colors: active){.mdc-tooltip__caret-surface-bottom{outline-color:CanvasText}}.mat-mdc-tooltip .mdc-tooltip__surface{background-color:var(--mdc-plain-tooltip-container-color)}.mat-mdc-tooltip .mdc-tooltip__surface{border-radius:var(--mdc-plain-tooltip-container-shape)}.mat-mdc-tooltip .mdc-tooltip__caret-surface-top,.mat-mdc-tooltip .mdc-tooltip__caret-surface-bottom{border-radius:var(--mdc-plain-tooltip-container-shape)}.mat-mdc-tooltip .mdc-tooltip__surface{color:var(--mdc-plain-tooltip-supporting-text-color)}.mat-mdc-tooltip .mdc-tooltip__surface{font-family:var(--mdc-plain-tooltip-supporting-text-font);line-height:var(--mdc-plain-tooltip-supporting-text-line-height);font-size:var(--mdc-plain-tooltip-supporting-text-size);font-weight:var(--mdc-plain-tooltip-supporting-text-weight);letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking)}.mat-mdc-tooltip{position:relative;transform:scale(0)}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0});let E=y;return E})();var zi=(()=>{let y=class y{};y.\u0275fac=function(s){return new(s||y)},y.\u0275mod=ct({type:y}),y.\u0275inj=st({providers:[ri],imports:[Ft,Pt,kt,Le,Le,zt]});let E=y;return E})();var X=Jr(Xt());var Gt=(()=>{let y=class y{constructor(){this.metadataSubject=new me(null),X.default.config({driver:X.default.INDEXEDDB,name:"user-database",version:1,storeName:"users",description:"Store for user metadata"})}getMetadataStream(){return this.metadataSubject.asObservable()}getUserMetadata(r){return N(this,null,function*(){try{return yield X.default.getItem(r)}catch(s){return console.error("Error getting metadata from IndexedDB:",s),null}})}saveUserMetadata(r,s){return N(this,null,function*(){try{yield X.default.setItem(r,s),this.metadataSubject.next({pubkey:r,metadata:s})}catch(l){console.error("Error saving metadata to IndexedDB:",l)}})}removeUserMetadata(r){return N(this,null,function*(){try{yield X.default.removeItem(r),this.metadataSubject.next({pubkey:r,metadata:null})}catch(s){console.error("Error removing metadata from IndexedDB:",s)}})}clearAllMetadata(){return N(this,null,function*(){try{yield X.default.clear(),this.metadataSubject.next(null)}catch(r){console.error("Error clearing all metadata:",r)}})}getAllUsers(){return N(this,null,function*(){try{let r=yield X.default.keys(),s=[];for(let l of r){let m=yield X.default.getItem(l);m&&s.push(m)}return s}catch(r){return console.error("Error getting all users from IndexedDB:",r),[]}})}};y.\u0275fac=function(s){return new(s||y)},y.\u0275prov=ie({token:y,factory:y.\u0275fac,providedIn:"root"});let E=y;return E})();var Kt=(()=>{let y=class y{constructor(){this.relays=[],this.maxRetries=10,this.retryDelay=15e3,this.eventSubject=new ce,this.requestQueue=new Set,this.isProcessingQueue=!1,this.maxConcurrentRequests=2,this.pool=new Vt,this.relays=this.loadRelaysFromLocalStorage(),this.connectToRelays(),this.setupVisibilityChangeHandling()}loadRelaysFromLocalStorage(){let r=[{url:"wss://relay.angor.io",connected:!1,retries:0,retryTimeout:null,ws:void 0},{url:"wss://relay2.angor.io",connected:!1,retries:0,retryTimeout:null,ws:void 0}],s=JSON.parse(localStorage.getItem("nostrRelays")||"[]").map(l=>nt(ee({},l),{connected:!1,retries:0,retryTimeout:null,ws:void 0}));return[...r,...s]}connectToRelay(r){r.connected||(r.ws=new WebSocket(r.url),r.ws.onopen=()=>{try{r.connected=!0,r.retries=0,clearTimeout(r.retryTimeout),this.saveRelaysToLocalStorage()}catch(s){console.error("Error parsing WebSocket message:",s)}},r.ws.onerror=s=>{try{this.handleRelayError(r)}catch(l){console.error("Error parsing WebSocket message:",l)}},r.ws.onclose=()=>{try{r.connected=!1,this.handleRelayError(r)}catch(s){console.error("Error parsing WebSocket message:",s)}},r.ws.onmessage=s=>{try{let l=typeof s.data=="string"?s.data:s.data.toString("utf-8"),m=JSON.parse(l);this.eventSubject.next(m)}catch(l){console.error("Error parsing WebSocket message:",l)}})}handleRelayError(r){if(r.retries>=this.maxRetries){console.error(`Max retries reached for relay: ${r.url}. No further attempts will be made.`);return}let s=this.retryDelay*r.retries;r.retries++,r.retryTimeout=setTimeout(()=>{this.connectToRelay(r),console.log(`Retrying connection to relay: ${r.url} (Attempt ${r.retries})`)},s)}connectToRelays(){this.relays.forEach(r=>{r.connected||this.connectToRelay(r)})}ensureConnectedRelays(){return N(this,null,function*(){return this.connectToRelays(),new Promise(r=>{let s=()=>{this.getConnectedRelays().length>0?r():setTimeout(s,1e3)};s()})})}setupVisibilityChangeHandling(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.connectToRelays()}),window.addEventListener("beforeunload",()=>{this.relays.forEach(r=>{r.ws&&r.ws.close()})})}getConnectedRelays(){return this.relays.filter(r=>r.connected).map(r=>r.url)}saveRelaysToLocalStorage(){let r=this.relays.filter(s=>!["wss://relay.angor.io","wss://relay2.angor.io"].includes(s.url));localStorage.setItem("nostrRelays",JSON.stringify(r))}getEventStream(){return this.eventSubject.asObservable()}addRelay(r){if(!this.relays.some(s=>s.url===r)){let s={url:r,connected:!1,retries:0,retryTimeout:null,ws:void 0};this.relays.push(s),this.connectToRelay(s),this.saveRelaysToLocalStorage()}}removeRelay(r){this.relays=this.relays.filter(s=>s.url!==r),this.saveRelaysToLocalStorage()}removeAllCustomRelays(){let r=["wss://relay.angor.io","wss://relay2.angor.io"];this.relays=this.relays.filter(s=>r.includes(s.url)),this.saveRelaysToLocalStorage()}processRequestQueue(){return N(this,null,function*(){if(!this.isProcessingQueue){for(this.isProcessingQueue=!0;this.requestQueue.size>0;){let r=Array.from(this.requestQueue).slice(0,this.maxConcurrentRequests);this.requestQueue=new Set(Array.from(this.requestQueue).slice(this.maxConcurrentRequests)),yield Promise.all(r.map(s=>N(this,null,function*(){console.log(`Processing request for filter: ${s}`)}))),yield new Promise(s=>setTimeout(s,this.retryDelay))}this.isProcessingQueue=!1}})}subscribeToFilter(r){return N(this,null,function*(){try{this.requestQueue.add(JSON.stringify(r)),this.processRequestQueue()}catch(s){console.error("Failed to subscribe to filter:",s)}})}getPool(){return this.pool}getRelays(){return this.relays}};y.\u0275fac=function(s){return new(s||y)},y.\u0275prov=ie({token:y,factory:y.\u0275fac,providedIn:"root"});let E=y;return E})();var Ki=(()=>{let y=class y{constructor(r,s){this.indexedDBService=r,this.relayService=s,this.metadataSubject=new me(null),this.requestQueue=new Set,this.isProcessingQueue=!1,this.maxRequestsPerBatch=3,this.requestDelay=5e3}getMetadataStream(){return this.metadataSubject.asObservable().pipe(ot(2e3))}enqueueRequest(r){this.requestQueue.add(r),this.processQueue()}fetchMetadataForMultipleKeys(r){return N(this,null,function*(){let s={kinds:[0],authors:r};try{yield this.relayService.ensureConnectedRelays();let l=this.relayService.getConnectedRelays();if(l.length===0){console.error("No relays are connected.");return}let m=this.relayService.getPool().subscribeMany(l,[s],{onevent:w=>N(this,null,function*(){if(w.kind===0)try{let b=JSON.parse(w.content);yield this.indexedDBService.saveUserMetadata(w.pubkey,b),this.metadataSubject.next({pubkey:w.pubkey,metadata:b})}catch(b){console.error("Error parsing metadata:",b)}}),oneose:()=>{}});setTimeout(()=>{m.close()},10*60*1e3)}catch(l){console.error("Failed to fetch metadata for multiple keys:",l)}})}processQueue(){return N(this,null,function*(){if(!(this.isProcessingQueue||this.requestQueue.size===0)){for(this.isProcessingQueue=!0;this.requestQueue.size>0;){let r=Array.from(this.requestQueue).slice(0,this.maxRequestsPerBatch);this.requestQueue=new Set(Array.from(this.requestQueue).slice(this.maxRequestsPerBatch)),yield Promise.all(r.map(s=>N(this,null,function*(){try{let l=yield this.fetchMetadataRealtime(s);l&&(yield this.indexedDBService.saveUserMetadata(s,l),this.metadataSubject.next(l))}catch(l){console.error(`Failed to update metadata for user: ${s}`,l)}}))),yield new Promise(s=>setTimeout(s,this.requestDelay))}this.isProcessingQueue=!1}})}fetchMetadataWithCache(r){return N(this,null,function*(){let s=yield this.indexedDBService.getUserMetadata(r);return s?this.metadataSubject.next(s):this.enqueueRequest(r),this.subscribeToMetadataUpdates(r),s})}subscribeToMetadataUpdates(r){this.relayService.ensureConnectedRelays().then(()=>{let s={authors:[r],kinds:[0]};this.relayService.getPool().subscribeMany(this.relayService.getConnectedRelays(),[s],{onevent:l=>N(this,null,function*(){if(l.pubkey===r&&l.kind===0)try{let m=JSON.parse(l.content);yield this.indexedDBService.saveUserMetadata(r,m),this.metadataSubject.next(m)}catch(m){console.error("Error parsing updated metadata:",m)}}),oneose(){}})})}fetchMetadataRealtime(r){return N(this,null,function*(){yield this.relayService.ensureConnectedRelays();let s=this.relayService.getConnectedRelays();if(s.length===0)throw new Error("No connected relays");return new Promise(l=>{let m=this.relayService.getPool().subscribeMany(s,[{authors:[r],kinds:[0]}],{onevent:w=>{if(w.pubkey===r&&w.kind===0)try{let b=JSON.parse(w.content);l(b)}catch(b){console.error("Error parsing event content:",b),l(null)}finally{m.close()}},oneose(){m.close(),l(null)}})})})}refreshAllStoredMetadata(){return N(this,null,function*(){let r=yield this.indexedDBService.getAllUsers();if(!r||r.length===0){console.log("No stored users found in IndexedDB");return}r.forEach(s=>this.enqueueRequest(s.pubkey))})}};y.\u0275fac=function(s){return new(s||y)(xe(Gt),xe(Kt))},y.\u0275prov=ie({token:y,factory:y.\u0275fac,providedIn:"root"});let E=y;return E})();export{Yi as a,zi as b,Gt as c,Kt as d,Ki as e};
