"use strict";(self.webpackChunkangor=self.webpackChunkangor||[]).push([[632],{6632:(rt,$,r)=>{r.r($),r.d($,{default:()=>ot});var k=r(5167),f=r(177),j=r(8834),F=r(6600),x=r(2102),I=r(9213),P=r(9042),M=r(7575),G=r(2798),C=r(450),T=r(4823),N=r(1413),d=r(6977),t=r(4438),m=r(4412),h=r(7673),p=r(6648),v=r(8141),b=r(6354),S=r(1397),w=r(5964),B=r(6649),R=r(9974);const D=(o,c)=>(o.push(c),o);function y(){return(0,R.N)((o,c)=>{(function Y(o,c){return(0,R.N)((0,B.S)(o,c,arguments.length>=2,!1,!0))})(D,[])(o).subscribe(c)})}var E=r(5558),u=r(9437),V=r(1626),A=r(833),X=r(7291);let O=(()=>{class o{constructor(e,n,s){this.http=e,this.indexerService=n,this.storageService=s,this.offset=0,this.limit=50,this.totalProjects=0,this.loading=!1,this.noMoreProjects=!1,this.totalProjectsFetched=!1,this.selectedNetwork="testnet",this.projectsSubject=new m.t([]),this.projects$=this.projectsSubject.asObservable(),this.loadingSubject=new m.t(!1),this.loading$=this.loadingSubject.asObservable(),this.noMoreProjectsSubject=new m.t(!1),this.noMoreProjects$=this.noMoreProjectsSubject.asObservable(),this.projectStatsSubject=new m.t({}),this.projectStats$=this.projectStatsSubject.asObservable(),this.loadNetwork()}loadNetwork(){this.selectedNetwork=this.indexerService.getNetwork(),console.log("Selected network:",this.selectedNetwork)}fetchProjects(){if(this.loading||this.noMoreProjects)return console.log("Skipping fetch: Already loading or no more projects."),(0,h.of)([]);this.loadingSubject.next(!0);const e=this.indexerService.getPrimaryIndexer(this.selectedNetwork);return this.http.get(this.totalProjectsFetched?`${e}api/query/Angor/projects?offset=${this.offset}&limit=${this.limit}`:`${e}api/query/Angor/projects?limit=${this.limit}`,{observe:"response"}).pipe((0,v.M)(s=>{if(console.log("Received project data from API:",s.body),!this.totalProjectsFetched&&s&&s.headers){const i=s.headers.get("pagination-total");this.totalProjects=i?+i:0,this.totalProjectsFetched=!0,this.offset=Math.max(this.totalProjects-this.limit,0),console.log("Total projects available:",this.totalProjects)}}),(0,b.T)(s=>s.body||[]),(0,S.Z)(s=>(0,p.H)(s).pipe((0,w.p)(i=>!this.projectsSubject.value.some(g=>g.projectIdentifier===i.projectIdentifier)),y())),(0,E.n)(s=>{if(!s.length)return this.noMoreProjectsSubject.next(!0),(0,h.of)([]);const i=(0,p.H)(s).pipe((0,S.Z)(l=>(0,p.H)(this.storageService.saveProject(l))),y()),g=(0,p.H)(s).pipe((0,S.Z)(l=>(0,p.H)(this.storageService.getProjectStats(l.projectIdentifier)).pipe((0,b.T)(a=>(l.totalInvestmentsCount=a?.investorCount??0,this.projectStatsSubject.next({...this.projectStatsSubject.value,[l.projectIdentifier]:a}),l)),(0,u.W)(a=>(console.error(`Error fetching details for project ${l.projectIdentifier}:`,a),(0,h.of)(l))))),y());return i.pipe((0,E.n)(()=>g),(0,b.T)(l=>{const a=[...this.projectsSubject.value,...s];return this.projectsSubject.next(a),this.offset=Math.max(this.offset-this.limit,0),console.log("Updated projects list:",a),l}))}),(0,u.W)(s=>(console.error("Error fetching projects:",s),(0,h.of)([]))),(0,v.M)(()=>this.loadingSubject.next(!1)))}fetchProjectStats(e){const s=`${this.indexerService.getPrimaryIndexer(this.selectedNetwork)}api/query/Angor/projects/${e}/stats`;return this.http.get(s).pipe((0,v.M)(i=>{this.projectStatsSubject.next({...this.projectStatsSubject.value,[e]:i}),console.log("Fetched stats for project:",e,i)}),(0,u.W)(i=>(console.error(`Error fetching stats for project ${e}:`,i),(0,h.of)({}))))}fetchProjectDetails(e){const s=`${this.indexerService.getPrimaryIndexer(this.selectedNetwork)}api/query/Angor/projects/${e}`;return this.http.get(s).pipe((0,u.W)(i=>(console.error(`Error fetching details for project ${e}:`,i),(0,h.of)({}))))}resetProjects(){this.projectsSubject.next([]),this.noMoreProjectsSubject.next(!1),this.loadingSubject.next(!1),this.projectStatsSubject.next({}),this.offset=0,this.totalProjectsFetched=!1,console.log("Projects and states have been reset.")}static{this.\u0275fac=function(n){return new(n||o)(t.KVO(V.Qq),t.KVO(A.F),t.KVO(X.n))}}static{this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();const U=()=>[],_=o=>({"-ml-3":o});function z(o,c){if(1&o){const e=t.RV6();t.j41(0,"button",27),t.bIt("click",function(){t.eBV(e);const s=t.XpG(),i=t.sdS(20);return t.Njj(s.resetSearch(i))}),t.nrm(1,"mat-icon",28),t.k0s()}2&o&&(t.R7$(),t.Y8G("svgIcon","heroicons_solid:x-mark"))}function H(o,c){if(1&o){const e=t.RV6();t.j41(0,"button",29),t.bIt("click",function(){t.eBV(e);const s=t.XpG(),i=t.sdS(20);return t.Njj(s.filterByQuery(i.value))}),t.nrm(1,"mat-icon",28),t.k0s()}2&o&&(t.R7$(),t.Y8G("svgIcon","heroicons_solid:magnifying-glass"))}function Q(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",47),t.bIt("click",function(){t.eBV(e);const s=t.XpG().$implicit,i=t.XpG();return t.Njj(i.goToProjectDetails(s))}),t.EFF(1),t.k0s()}if(2&o){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",e.displayName||e.nostrPubKey," ")}}function K(o,c){if(1&o&&(t.j41(0,"div",40),t.EFF(1),t.k0s()),2&o){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",e.displayName||e.nostrPubKey," ")}}function L(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",42)(1,"button",48),t.bIt("click",function(){t.eBV(e);const s=t.XpG().$implicit,i=t.XpG();return t.Njj(i.openChat(s.nostrPubKey))}),t.nrm(2,"mat-icon",49),t.k0s()()}2&o&&(t.R7$(2),t.Y8G("svgIcon","heroicons_outline:chat-bubble-left-right"))}function W(o,c){if(1&o&&(t.qex(0),t.nrm(1,"img",50),t.bVm()),2&o){const e=t.XpG().index,n=t.XpG().$implicit;t.R7$(),t.Mz_("alt","Investor avatar ",e+1,""),t.Y8G("ngClass",t.eq3(4,_,n.totalInvestmentsCount>1&&e>0))("src","images/avatars/avatar-placeholder.png",t.B4B)}}function Z(o,c){if(1&o&&(t.qex(0),t.DNE(1,W,2,6,"ng-container",24),t.bVm()),2&o){const e=c.index;t.R7$(),t.Y8G("ngIf",e<10)}}function J(o,c){if(1&o&&(t.qex(0),t.j41(1,"angor-card",30)(2,"div",31),t.nrm(3,"img",32),t.k0s(),t.j41(4,"div",33)(5,"div",34),t.nrm(6,"img",35),t.k0s()(),t.j41(7,"div",36)(8,"div",37)(9,"div",38),t.DNE(10,Q,2,1,"div",39)(11,K,2,1,"div",40),t.j41(12,"div",41),t.EFF(13),t.k0s()(),t.DNE(14,L,3,1,"div",42),t.k0s(),t.nrm(15,"hr",43),t.j41(16,"div",37)(17,"div",44),t.EFF(18),t.k0s(),t.j41(19,"div",45),t.DNE(20,Z,2,1,"ng-container",46),t.k0s()()()(),t.bVm()),2&o){const e=c.$implicit;t.R7$(3),t.Y8G("src","images/pages/profile/cover.jpg",t.B4B),t.R7$(3),t.Y8G("src","images/avatars/avatar-placeholder.png",t.B4B),t.R7$(4),t.vxM(e.displayName||e.name?10:-1),t.R7$(),t.vxM(e.name||e.displayName?-1:11),t.R7$(2),t.SpI(" ",e.about||"No description available"," "),t.R7$(),t.vxM(e.displayName||e.name?14:-1),t.R7$(4),t.SpI(" ",e.totalInvestmentsCount||0," investors "),t.R7$(2),t.Y8G("ngForOf",t.lJ4(8,U).constructor(e.totalInvestmentsCount||0))}}function q(o,c){1&o&&(t.qex(0),t.j41(1,"div",51),t.nrm(2,"mat-icon",52),t.j41(3,"div",53),t.EFF(4," No project "),t.k0s()(),t.bVm()),2&o&&(t.R7$(2),t.Y8G("svgIcon","heroicons_outline:archive-box-x-mark"))}function tt(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",54)(1,"button",55),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.loadMoreProjects())}),t.EFF(2),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(),t.Y8G("disabled",e.loading),t.R7$(),t.SpI(" ",e.loading?"Loading...":"Load More Projects"," ")}}function et(o,c){if(1&o&&(t.j41(0,"div",56),t.EFF(1),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.SpI(" ",e.errorMessage," ")}}const ot=[{path:"",component:(()=>{class o{constructor(e,n){this._projectsService=e,this._changeDetectorRef=n,this.filteredProjects=[],this.showCloseSearchButton=!1,this.projects=[],this.loading=!1,this.errorMessage="",this.noMoreProjects=!1,this._unsubscribeAll=new N.B}ngOnInit(){this.loadInitialProjects(),this.subscribeToProjects(),this.subscribeToLoading(),this.subscribeToNoMoreProjects()}loadInitialProjects(){this._projectsService.resetProjects(),this._projectsService.fetchProjects().pipe((0,d.Q)(this._unsubscribeAll)).subscribe({next:e=>{this.projects=e,console.log("Initial projects loaded:",e),this._changeDetectorRef.detectChanges()},error:e=>{this.errorMessage="Error loading projects",console.error(this.errorMessage,e),this._changeDetectorRef.detectChanges()}})}loadMoreProjects(){this._projectsService.fetchProjects().pipe((0,d.Q)(this._unsubscribeAll)).subscribe({next:e=>{if(e.length>0){const n=e.filter(s=>!this.projects.some(i=>i.projectIdentifier===s.projectIdentifier));this.projects=[...this.projects,...n],console.log("Loaded more projects:",n)}else this.noMoreProjects=!0;this._changeDetectorRef.detectChanges()},error:e=>{this.errorMessage="Error loading more projects",console.error(this.errorMessage,e),this._changeDetectorRef.detectChanges()}})}subscribeToProjects(){this._projectsService.projects$.pipe((0,d.Q)(this._unsubscribeAll)).subscribe(e=>{this.projects=e,this._changeDetectorRef.detectChanges()})}subscribeToLoading(){this._projectsService.loading$.pipe((0,d.Q)(this._unsubscribeAll)).subscribe(e=>{this.loading=e,this._changeDetectorRef.detectChanges()})}subscribeToNoMoreProjects(){this._projectsService.noMoreProjects$.pipe((0,d.Q)(this._unsubscribeAll)).subscribe(e=>{this.noMoreProjects=e,this._changeDetectorRef.detectChanges()})}trackByFn(e,n){return n.projectIdentifier||e}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}static{this.\u0275fac=function(n){return new(n||o)(t.rXU(O),t.rXU(t.gRc))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["explore"]],standalone:!0,features:[t.aNF],decls:31,vars:10,consts:[["query",""],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-y-auto"],[1,"dark","relative","flex-0","overflow-hidden","bg-gray-800","px-4","py-8","sm:p-16"],["viewBox","0 0 960 540","width","100%","height","100%","preserveAspectRatio","xMidYMax slice","xmlns","http://www.w3.org/2000/svg",1,"pointer-events-none","absolute","inset-0"],["fill","none","stroke","currentColor","stroke-width","100",1,"text-gray-700","opacity-25"],["r","234","cx","196","cy","23"],["r","234","cx","790","cy","491"],[1,"relative","z-10","flex","flex-col","items-center"],[1,"text-xl","font-semibold"],[1,"mt-1","text-center","text-4xl","font-extrabold","leading-tight","tracking-tight","sm:text-7xl"],[1,"text-secondary","mt-6","max-w-2xl","text-center","tracking-tight","sm:text-2xl"],[1,"p-6","sm:p-10"],[1,"mx-auto","flex","w-full","max-w-xs","flex-auto","flex-col","sm:max-w-5xl"],[1,"flex","w-full","max-w-xs","flex-col","items-center","justify-between","sm:max-w-none","sm:flex-row"],[1,"flex","w-full","items-center","space-x-2","sm:w-auto"],[1,"mt-4","w-full","sm:w-80",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["placeholder","Search ...","matInput",""],["mat-icon-button","","color","warn","class","mt-4",3,"click",4,"ngIf"],["mat-icon-button","","color","success","class","mt-4",3,"click",4,"ngIf"],[1,"mt-8","sm:ml-auto","sm:mt-0",3,"color"],[1,"mx-auto","flex","w-full","flex-auto","flex-col","sm:max-w-5xl"],[1,"mt-10","grid","w-full","min-w-0","grid-cols-1","gap-6","sm:grid-cols-1","md:grid-cols-1","lg:grid-cols-2"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],["class","mt-10 flex justify-center",4,"ngIf"],["class","error-message",4,"ngIf"],["mat-icon-button","","color","warn",1,"mt-4",3,"click"],[3,"svgIcon"],["mat-icon-button","","color","success",1,"mt-4",3,"click"],[1,"filter-info","flex","w-full","flex-col"],[1,"flex","h-32"],["onerror","this.onerror=null; this.src='/images/pages/profile/cover.jpg';","alt","Card cover image",1,"object-cover",3,"src"],[1,"flex","px-8"],[1,"bg-card","-mt-12","rounded-full","p-1"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';","alt","Project logo",1,"h-24","w-24","rounded-full","object-cover",3,"src"],[1,"flex","flex-col","px-8","pb-6","pt-4"],[1,"flex","items-center","justify-between"],[1,"min-w-0","flex-1"],["role","button",1,"truncate","text-2xl","font-semibold","leading-tight"],[1,"truncate","text-2xl","font-semibold","leading-tight"],[1,"text-secondary","mt-1","truncate","leading-tight"],[1,"absolute","top-2","right-2","flex","h-10","w-10","items-center","justify-center","rounded-full","border","bg-white","shadow-md"],[1,"my-6","w-full","border-t"],[1,"text-secondary","mr-3","text-md","font-medium"],[1,"flex","items-center"],[4,"ngFor","ngForOf"],["role","button",1,"truncate","text-2xl","font-semibold","leading-tight",3,"click"],["mat-icon-button","",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"text-card","ring-bg-card","m-0.5","h-6","w-6","rounded-full","ring-2",3,"ngClass","src","alt"],[1,"flex","flex-auto","flex-col","items-center","justify-center","bg-gray-100","dark:bg-transparent"],[1,"icon-size-24",3,"svgIcon"],[1,"text-secondary","mt-4","text-2xl","font-semibold","tracking-tight"],[1,"mt-10","flex","justify-center"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"error-message"]],template:function(n,s){1&n&&(t.j41(0,"div",1)(1,"div",2),t.qSk(),t.j41(2,"svg",3)(3,"g",4),t.nrm(4,"circle",5)(5,"circle",6),t.k0s()(),t.joV(),t.j41(6,"div",7)(7,"h2",8),t.EFF(8,"Explore Projects"),t.k0s(),t.j41(9,"div",9),t.EFF(10," What\u2019s your next investment? "),t.k0s(),t.j41(11,"div",10),t.EFF(12," Check out our projects and find your next investment opportunity. "),t.k0s()()(),t.j41(13,"div",11)(14,"div",12)(15,"div",13)(16,"div",14)(17,"mat-form-field",15),t.nrm(18,"mat-icon",16)(19,"input",17,0),t.k0s(),t.DNE(21,z,2,1,"button",18)(22,H,2,1,"button",19),t.k0s(),t.j41(23,"mat-slide-toggle",20),t.EFF(24," Hide completed "),t.k0s()()(),t.j41(25,"div",21)(26,"div",22),t.DNE(27,J,21,9,"ng-container",23),t.k0s(),t.DNE(28,q,5,1,"ng-container",24)(29,tt,3,2,"div",25)(30,et,2,1,"div",26),t.k0s()()()),2&n&&(t.R7$(17),t.Y8G("subscriptSizing","dynamic"),t.R7$(),t.Y8G("svgIcon","heroicons_solid:magnifying-glass"),t.R7$(3),t.Y8G("ngIf",s.showCloseSearchButton),t.R7$(),t.Y8G("ngIf",!s.showCloseSearchButton),t.R7$(),t.Y8G("color","primary"),t.R7$(4),t.Y8G("ngForOf",s.projects)("ngForTrackBy",s.trackByFn),t.R7$(),t.Y8G("ngIf",0==s.projects.length),t.R7$(),t.Y8G("ngIf",s.projects.length>0),t.R7$(),t.Y8G("ngIf",!s.loading&&s.errorMessage))},dependencies:[j.Hl,j.$z,j.iY,I.m_,I.An,k.n,x.RG,x.rl,x.JW,G.Ve,F.Sy,P.fS,P.fg,C.mV,C.sG,f.YU,T.uc,M.PO,f.MD,f.Sq,f.bT],encapsulation:2})}}return o})()}]}}]);