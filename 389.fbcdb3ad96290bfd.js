(self.webpackChunkangor=self.webpackChunkangor||[]).push([[389],{1146:Ee=>{"use strict";for(var U="qpzry9x8gf2tvdw0s3jn54khce6mua7l",S={},x=0;x<32;x++){var y=U.charAt(x);if(void 0!==S[y])throw new TypeError(y+" is ambiguous");S[y]=x}function v(j){var F=j>>25;return(33554431&j)<<5^996825010&-(1&F)^642813549&-(F>>1&1)^513874426&-(F>>2&1)^1027748829&-(F>>3&1)^705979059&-(F>>4&1)}function A(j){for(var F=1,he=0;he<j.length;++he){var W=j.charCodeAt(he);if(W<33||W>126)return"Invalid prefix ("+j+")";F=v(F)^W>>5}for(F=v(F),he=0;he<j.length;++he){var ne=j.charCodeAt(he);F=v(F)^31&ne}return F}function T(j,F){if(j.length<8)return j+" too short";if(j.length>(F=F||90))return"Exceeds length limit";var he=j.toLowerCase(),W=j.toUpperCase();if(j!==he&&j!==W)return"Mixed-case string "+j;var ne=(j=he).lastIndexOf("1");if(-1===ne)return"No separator character for "+j;if(0===ne)return"Missing prefix for "+j;var o=j.slice(0,ne),ae=j.slice(ne+1);if(ae.length<6)return"Data too short";var ke=A(o);if("string"==typeof ke)return ke;for(var $e=[],de=0;de<ae.length;++de){var we=ae.charAt(de),se=S[we];if(void 0===se)return"Unknown character "+we;ke=v(ke)^se,!(de+6>=ae.length)&&$e.push(se)}return 1!==ke?"Invalid checksum for "+j:{prefix:o,words:$e}}function q(j,F,he,W){for(var ne=0,o=0,ae=(1<<he)-1,ke=[],$e=0;$e<j.length;++$e)for(ne=ne<<F|j[$e],o+=F;o>=he;)ke.push(ne>>(o-=he)&ae);if(W)o>0&&ke.push(ne<<he-o&ae);else{if(o>=F)return"Excess padding";if(ne<<he-o&ae)return"Non-zero padding"}return ke}Ee.exports={decodeUnsafe:function B(){var j=T.apply(null,arguments);if("object"==typeof j)return j},decode:function N(j){var F=T.apply(null,arguments);if("object"==typeof F)return F;throw new Error(F)},encode:function h(j,F,he){if(j.length+7+F.length>(he=he||90))throw new TypeError("Exceeds length limit");var W=A(j=j.toLowerCase());if("string"==typeof W)throw new Error(W);for(var ne=j+"1",o=0;o<F.length;++o){var ae=F[o];if(ae>>5)throw new Error("Non 5-bit word");W=v(W)^ae,ne+=U.charAt(ae)}for(o=0;o<6;++o)W=v(W);for(W^=1,o=0;o<6;++o)ne+=U.charAt(W>>5*(5-o)&31);return ne},toWordsUnsafe:function oe(j){var F=q(j,8,5,!0);if(Array.isArray(F))return F},toWords:function le(j){var F=q(j,8,5,!0);if(Array.isArray(F))return F;throw new Error(F)},fromWordsUnsafe:function ee(j){var F=q(j,5,8,!1);if(Array.isArray(F))return F},fromWords:function te(j){var F=q(j,5,8,!1);if(Array.isArray(F))return F;throw new Error(F)}}},7389:(Ee,U,S)=>{"use strict";S.r(U),S.d(U,{default:()=>Jc});var x={};S.r(x),S.d(x,{OG:()=>Rr,My:()=>mn,Ph:()=>At,lX:()=>Ir,Id:()=>sn,fg:()=>Fi,qj:()=>xt,aT:()=>yn,lq:()=>Jt,z:()=>$i,Q5:()=>Un});var y=S(467),v=S(5167),A=S(7403),h=S(177),T=S(9417),B=S(8834),N=S(1997),q=S(2102),oe=S(9213),le=S(9042),ee=S(9115),te=S(9183),j=S(450),F=S(4823),he=S(5245),W=S(8865),ne=S(3813),o=S(4438),ae=S(2577),ke=S(345);const $e=["qrcElement"];let de=(()=>{class t{constructor(e,r){this.renderer=e,this.sanitizer=r,this.allowEmptyString=!1,this.colorDark="#000000ff",this.colorLight="#ffffffff",this.cssClass="qrcode",this.elementType="canvas",this.errorCorrectionLevel="M",this.margin=4,this.qrdata="",this.scale=4,this.width=10,this.qrCodeURL=new o.bkB,this.context=null}ngOnChanges(){var e=this;return(0,y.A)(function*(){yield e.createQRCode()})()}isValidQrCodeText(e){return!1===this.allowEmptyString?!(typeof e>"u"||""===e||"null"===e||null===e):!(typeof e>"u")}toDataURL(e){return new Promise((r,i)=>{(0,ae.dY)(this.qrdata,e,(s,u)=>{s?i(s):r(u)})})}toCanvas(e,r){return new Promise((i,s)=>{(0,ae.mo)(e,this.qrdata,r,u=>{u?s(u):i("success")})})}toSVG(e){return new Promise((r,i)=>{(0,ae.toString)(this.qrdata,e,(s,u)=>{s?i(s):r(u)})})}renderElement(e){for(const r of this.qrcElement.nativeElement.childNodes)this.renderer.removeChild(this.qrcElement.nativeElement,r);this.renderer.appendChild(this.qrcElement.nativeElement,e)}createQRCode(){var e=this;return(0,y.A)(function*(){e.version&&e.version>40?(console.warn("[angularx-qrcode] max value for `version` is 40"),e.version=40):e.version&&e.version<1?(console.warn("[angularx-qrcode]`min value for `version` is 1"),e.version=1):void 0!==e.version&&isNaN(e.version)&&(console.warn("[angularx-qrcode] version should be a number, defaulting to auto."),e.version=void 0);try{if(!e.isValidQrCodeText(e.qrdata))throw new Error("[angularx-qrcode] Field `qrdata` is empty, set 'allowEmptyString=\"true\"' to overwrite this behaviour.");e.isValidQrCodeText(e.qrdata)&&""===e.qrdata&&(e.qrdata=" ");const r={color:{dark:e.colorDark,light:e.colorLight},errorCorrectionLevel:e.errorCorrectionLevel,margin:e.margin,scale:e.scale,version:e.version,width:e.width},i=e.imageSrc,s=e.imageHeight||40,u=e.imageWidth||40;switch(e.elementType){case"canvas":{const f=e.renderer.createElement("canvas");e.context=f.getContext("2d"),e.toCanvas(f,r).then(()=>{if(e.ariaLabel&&e.renderer.setAttribute(f,"aria-label",`${e.ariaLabel}`),e.title&&e.renderer.setAttribute(f,"title",`${e.title}`),i&&e.context){e.centerImage=new Image(u,s),i!==e.centerImage.src&&(e.centerImage.crossOrigin="anonymous",e.centerImage.src=i),s!==e.centerImage.height&&(e.centerImage.height=s),u!==e.centerImage.width&&(e.centerImage.width=u);const g=e.centerImage;g&&(g.onload=()=>{e.context?.drawImage(g,f.width/2-u/2,f.height/2-s/2,u,s)})}e.renderElement(f),e.emitQRCodeURL(f)}).catch(g=>{console.error("[angularx-qrcode] canvas error:",g)});break}case"svg":{const f=e.renderer.createElement("div");e.toSVG(r).then(g=>{e.renderer.setProperty(f,"innerHTML",g);const m=f.firstChild;e.renderer.setAttribute(m,"height",`${e.width}`),e.renderer.setAttribute(m,"width",`${e.width}`),e.renderElement(m),e.emitQRCodeURL(m)}).catch(g=>{console.error("[angularx-qrcode] svg error:",g)});break}default:{const f=e.renderer.createElement("img");e.toDataURL(r).then(g=>{e.alt&&f.setAttribute("alt",e.alt),e.ariaLabel&&f.setAttribute("aria-label",e.ariaLabel),f.setAttribute("src",g),e.title&&f.setAttribute("title",e.title),e.renderElement(f),e.emitQRCodeURL(f)}).catch(g=>{console.error("[angularx-qrcode] img/url error:",g)})}}}catch(r){console.error("[angularx-qrcode] Error generating QR Code:",r.message)}})()}convertBase64ImageUrlToBlob(e){const r=e.split(";base64,"),i=r[0].split(":")[1],s=atob(r[1]),u=new Uint8Array(s.length);for(let f=0;f<s.length;++f)u[f]=s.charCodeAt(f);return new Blob([u],{type:i})}emitQRCodeURL(e){const r=e.constructor.name;if(r===SVGSVGElement.name){const m=new Blob([e.outerHTML],{type:"image/svg+xml"}),M=URL.createObjectURL(m),k=this.sanitizer.bypassSecurityTrustUrl(M);return void this.qrCodeURL.emit(k)}let i="";r===HTMLCanvasElement.name&&(i=e.toDataURL("image/png")),r===HTMLImageElement.name&&(i=e.src);const s=this.convertBase64ImageUrlToBlob(i),u=URL.createObjectURL(s),f=this.sanitizer.bypassSecurityTrustUrl(u);this.qrCodeURL.emit(f)}static{this.\u0275fac=function(r){return new(r||t)(o.rXU(o.sFG),o.rXU(ke.up))}}static{this.\u0275cmp=o.VBU({type:t,selectors:[["qrcode"]],viewQuery:function(r,i){if(1&r&&o.GBs($e,7),2&r){let s;o.mGM(s=o.lsd())&&(i.qrcElement=s.first)}},inputs:{allowEmptyString:"allowEmptyString",colorDark:"colorDark",colorLight:"colorLight",cssClass:"cssClass",elementType:"elementType",errorCorrectionLevel:"errorCorrectionLevel",imageSrc:"imageSrc",imageHeight:"imageHeight",imageWidth:"imageWidth",margin:"margin",qrdata:"qrdata",scale:"scale",version:"version",width:"width",alt:"alt",ariaLabel:"ariaLabel",title:"title"},outputs:{qrCodeURL:"qrCodeURL"},features:[o.OA$],decls:2,vars:2,consts:[["qrcElement",""]],template:function(r,i){1&r&&o.nrm(0,"div",null,0),2&r&&o.HbH(i.cssClass)},encapsulation:2,changeDetection:0})}}return t})(),we=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=o.$C({type:t})}static{this.\u0275inj=o.G2t({})}}return t})(),Yn=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=o.$C({type:t})}static{this.\u0275inj=o.G2t({})}}return t})();var Ge=S(1413),Pe=S(5351),kn=S(2798),Ve=S(882);S(6371);var et=S(6218),tt=S(600);function un(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Ye(t,...n){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(n.length>0&&!n.includes(t.length))throw new Error(`Expected Uint8Array of length ${n}, not of length=${t.length}`)}const Le={number:un,bool:function nt(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)},bytes:Ye,hash:function Zn(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");un(t.outputLen),un(t.blockLen)},exists:function rt(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called")},output:function it(t,n){Ye(t);const e=n.outputLen;if(t.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}},ze="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,fn=t=>t instanceof Uint8Array,hn=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Oe=(t,n)=>t<<32-n|t>>>n;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");const Xn=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));function Be(t){if(!fn(t))throw new Error("Uint8Array expected");let n="";for(let e=0;e<t.length;e++)n+=Xn[t[e]];return n}function De(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const n=t.length;if(n%2)throw new Error("padded hex string expected, got unpadded hex of length "+n);const e=new Uint8Array(n/2);for(let r=0;r<e.length;r++){const i=2*r,s=t.slice(i,i+2),u=Number.parseInt(s,16);if(Number.isNaN(u)||u<0)throw new Error("Invalid byte sequence");e[r]=u}return e}function je(t){if("string"==typeof t&&(t=function Jn(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),!fn(t))throw new Error("expected Uint8Array, got "+typeof t);return t}function Fe(...t){const n=new Uint8Array(t.reduce((r,i)=>r+i.length,0));let e=0;return t.forEach(r=>{if(!fn(r))throw new Error("Uint8Array expected");n.set(r,e),e+=r.length}),n}class Sn{clone(){return this._cloneInto()}}function dn(t){const n=r=>t().update(je(r)).digest(),e=t();return n.outputLen=e.outputLen,n.blockLen=e.blockLen,n.create=()=>t(),n}function Zt(t=32){if(ze&&"function"==typeof ze.getRandomValues)return ze.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class Cn extends Sn{constructor(n,e,r,i){super(),this.blockLen=n,this.outputLen=e,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(n),this.view=hn(this.buffer)}update(n){Le.exists(this);const{view:e,buffer:r,blockLen:i}=this,s=(n=je(n)).length;for(let u=0;u<s;){const f=Math.min(i-this.pos,s-u);if(f!==i)r.set(n.subarray(u,u+f),this.pos),this.pos+=f,u+=f,this.pos===i&&(this.process(e,0),this.pos=0);else{const g=hn(n);for(;i<=s-u;u+=i)this.process(g,u)}}return this.length+=n.length,this.roundClean(),this}digestInto(n){Le.exists(this),Le.output(n,this),this.finished=!0;const{buffer:e,view:r,blockLen:i,isLE:s}=this;let{pos:u}=this;e[u++]=128,this.buffer.subarray(u).fill(0),this.padOffset>i-u&&(this.process(r,0),u=0);for(let k=u;k<i;k++)e[k]=0;(function An(t,n,e,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(n,e,r);const i=BigInt(32),s=BigInt(4294967295),u=Number(e>>i&s),f=Number(e&s),m=r?0:4;t.setUint32(n+(r?4:0),u,r),t.setUint32(n+m,f,r)})(r,i-8,BigInt(8*this.length),s),this.process(r,0);const f=hn(n),g=this.outputLen;if(g%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const m=g/4,M=this.get();if(m>M.length)throw new Error("_sha2: outputLen bigger than state");for(let k=0;k<m;k++)f.setUint32(4*k,M[k],s)}digest(){const{buffer:n,outputLen:e}=this;this.digestInto(n);const r=n.slice(0,e);return this.destroy(),r}_cloneInto(n){n||(n=new this.constructor),n.set(...this.get());const{blockLen:e,buffer:r,length:i,finished:s,destroyed:u,pos:f}=this;return n.length=i,n.pos=f,n.finished=s,n.destroyed=u,i%e&&n.buffer.set(r),n}}const Tn=(t,n,e)=>t&n^~t&e,In=(t,n,e)=>t&n^t&e^n&e,Rn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Bt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Nt=new Uint32Array(64);class gn extends Cn{constructor(){super(64,32,8,!1),this.A=0|Bt[0],this.B=0|Bt[1],this.C=0|Bt[2],this.D=0|Bt[3],this.E=0|Bt[4],this.F=0|Bt[5],this.G=0|Bt[6],this.H=0|Bt[7]}get(){const{A:n,B:e,C:r,D:i,E:s,F:u,G:f,H:g}=this;return[n,e,r,i,s,u,f,g]}set(n,e,r,i,s,u,f,g){this.A=0|n,this.B=0|e,this.C=0|r,this.D=0|i,this.E=0|s,this.F=0|u,this.G=0|f,this.H=0|g}process(n,e){for(let k=0;k<16;k++,e+=4)Nt[k]=n.getUint32(e,!1);for(let k=16;k<64;k++){const O=Nt[k-15],L=Nt[k-2],P=Oe(O,7)^Oe(O,18)^O>>>3,I=Oe(L,17)^Oe(L,19)^L>>>10;Nt[k]=I+Nt[k-7]+P+Nt[k-16]|0}let{A:r,B:i,C:s,D:u,E:f,F:g,G:m,H:M}=this;for(let k=0;k<64;k++){const L=M+(Oe(f,6)^Oe(f,11)^Oe(f,25))+Tn(f,g,m)+Rn[k]+Nt[k]|0,I=(Oe(r,2)^Oe(r,13)^Oe(r,22))+In(r,i,s)|0;M=m,m=g,g=f,f=u+L|0,u=s,s=i,i=r,r=L+I|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,u=u+this.D|0,f=f+this.E|0,g=g+this.F|0,m=m+this.G|0,M=M+this.H|0,this.set(r,i,s,u,f,g,m,M)}roundClean(){Nt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Bn extends gn{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Tt=dn(()=>new gn),Xt=(dn(()=>new Bn),BigInt(0),BigInt(1)),Nn=BigInt(2),Qt=t=>t instanceof Uint8Array,ps=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));function mn(t){if(!Qt(t))throw new Error("Uint8Array expected");let n="";for(let e=0;e<t.length;e++)n+=ps[t[e]];return n}function ji(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function yn(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const n=t.length;if(n%2)throw new Error("padded hex string expected, got unpadded hex of length "+n);const e=new Uint8Array(n/2);for(let r=0;r<e.length;r++){const i=2*r,s=t.slice(i,i+2),u=Number.parseInt(s,16);if(Number.isNaN(u)||u<0)throw new Error("Invalid byte sequence");e[r]=u}return e}function At(t){return ji(mn(t))}function Ir(t){if(!Qt(t))throw new Error("Uint8Array expected");return ji(mn(Uint8Array.from(t).reverse()))}function Jt(t,n){return yn(t.toString(16).padStart(2*n,"0"))}function $i(t,n){return Jt(t,n).reverse()}function xt(t,n,e){let r;if("string"==typeof n)try{r=yn(n)}catch(s){throw new Error(`${t} must be valid hex string, got "${n}". Cause: ${s}`)}else{if(!Qt(n))throw new Error(`${t} must be hex string or Uint8Array`);r=Uint8Array.from(n)}const i=r.length;if("number"==typeof e&&i!==e)throw new Error(`${t} expected ${e} bytes, got ${i}`);return r}function sn(...t){const n=new Uint8Array(t.reduce((r,i)=>r+i.length,0));let e=0;return t.forEach(r=>{if(!Qt(r))throw new Error("Uint8Array expected");n.set(r,e),e+=r.length}),n}const Rr=t=>(Nn<<BigInt(t-1))-Xt,Br=t=>new Uint8Array(t),Di=t=>Uint8Array.from(t);function Fi(t,n,e){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof n||n<2)throw new Error("qByteLen must be a number");if("function"!=typeof e)throw new Error("hmacFn must be a function");let r=Br(t),i=Br(t),s=0;const u=()=>{r.fill(1),i.fill(0),s=0},f=(...k)=>e(i,r,...k),g=(k=Br())=>{i=f(Di([0]),k),r=f(),0!==k.length&&(i=f(Di([1]),k),r=f())},m=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let k=0;const O=[];for(;k<n;){r=f();const L=r.slice();O.push(L),k+=r.length}return sn(...O)};return(k,O)=>{let L;for(u(),g(k);!(L=O(m()));)g();return u(),L}}const ys={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,n)=>n.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function Un(t,n,e={}){const r=(i,s,u)=>{const f=ys[s];if("function"!=typeof f)throw new Error(`Invalid validator "${s}", expected function`);const g=t[i];if(!(u&&void 0===g||f(g,t)))throw new Error(`Invalid param ${String(i)}=${g} (${typeof g}), expected ${s}`)};for(const[i,s]of Object.entries(n))r(i,s,!1);for(const[i,s]of Object.entries(e))r(i,s,!0);return t}const bt=BigInt(0),qe=BigInt(1),en=BigInt(2),vs=BigInt(3),Nr=BigInt(4),qi=BigInt(5),Gi=BigInt(8);function _t(t,n){const e=t%n;return e>=bt?e:n+e}function _s(t,n,e){if(e<=bt||n<bt)throw new Error("Expected power/modulo > 0");if(e===qe)return bt;let r=qe;for(;n>bt;)n&qe&&(r=r*t%e),t=t*t%e,n>>=qe;return r}function Ut(t,n,e){let r=t;for(;n-- >bt;)r*=r,r%=e;return r}function rr(t,n){if(t===bt||n<=bt)throw new Error(`invert: expected positive integers, got n=${t} mod=${n}`);let e=_t(t,n),r=n,i=bt,s=qe,u=qe,f=bt;for(;e!==bt;){const m=r/e,M=r%e,k=i-u*m,O=s-f*m;r=e,e=M,i=u,s=f,u=k,f=O}if(r!==qe)throw new Error("invert: does not exist");return _t(i,n)}BigInt(9),BigInt(16);const Ms=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ur(t,n){const e=void 0!==n?n:t.toString(2).length;return{nBitLength:e,nByteLength:Math.ceil(e/8)}}const Is=BigInt(0),Pr=BigInt(1);function zi(t){return function ks(t){Un(t,Ms.reduce((r,i)=>(r[i]="function",r),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}(t.Fp),Un(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Ur(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const{Ph:Ns,aT:Us}=x,an={Err:class extends Error{constructor(n=""){super(n)}},_parseInt(t){const{Err:n}=an;if(t.length<2||2!==t[0])throw new n("Invalid signature integer tag");const e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new n("Invalid signature integer: wrong length");if(128&r[0])throw new n("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new n("Invalid signature integer: unnecessary leading zero");return{d:Ns(r),l:t.subarray(e+2)}},toSig(t){const{Err:n}=an,e="string"==typeof t?Us(t):t;if(!(e instanceof Uint8Array))throw new Error("ui8a expected");let r=e.length;if(r<2||48!=e[0])throw new n("Invalid signature tag");if(e[1]!==r-2)throw new n("Invalid signature: incorrect length");const{d:i,l:s}=an._parseInt(e.subarray(2)),{d:u,l:f}=an._parseInt(s);if(f.length)throw new n("Invalid signature: left bytes after parsing");return{r:i,s:u}},hexFromSig(t){const n=m=>8&Number.parseInt(m[0],16)?"00"+m:m,e=m=>{const M=m.toString(16);return 1&M.length?`0${M}`:M},r=n(e(t.s)),i=n(e(t.r)),s=r.length/2,u=i.length/2,f=e(s),g=e(u);return`30${e(u+s+4)}02${g}${i}02${f}${r}`}},Ot=BigInt(0),st=BigInt(1),ir=(BigInt(2),BigInt(3));function Os(t){const n=function Ls(t){const n=zi(t);return Un(n,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...n})}(t),{Fp:e,n:r}=n,i=e.BYTES+1,s=2*e.BYTES+1;function f(z){return _t(z,r)}function g(z){return rr(z,r)}const{ProjectivePoint:m,normPrivateKeyToScalar:M,weierstrassEquation:k,isWithinCurveOrder:O}=function Ps(t){const n=function Bs(t){const n=zi(t);Un(n,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:e,Fp:r,a:i}=n;if(e){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof e||"bigint"!=typeof e.beta||"function"!=typeof e.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...n})}(t),{Fp:e}=n,r=n.toBytes||((P,I,$)=>{const D=I.toAffine();return sn(Uint8Array.from([4]),e.toBytes(D.x),e.toBytes(D.y))}),i=n.fromBytes||(P=>{const I=P.subarray(1);return{x:e.fromBytes(I.subarray(0,e.BYTES)),y:e.fromBytes(I.subarray(e.BYTES,2*e.BYTES))}});function s(P){const{a:I,b:$}=n,D=e.sqr(P),H=e.mul(D,P);return e.add(e.add(H,e.mul(P,I)),$)}if(!e.eql(e.sqr(n.Gy),s(n.Gx)))throw new Error("bad generator point: equation left != right");function u(P){return"bigint"==typeof P&&Ot<P&&P<n.n}function f(P){if(!u(P))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function g(P){const{allowedPrivateKeyLengths:I,nByteLength:$,wrapPrivateKey:D,n:H}=n;if(I&&"bigint"!=typeof P){if(P instanceof Uint8Array&&(P=mn(P)),"string"!=typeof P||!I.includes(P.length))throw new Error("Invalid key");P=P.padStart(2*$,"0")}let Z;try{Z="bigint"==typeof P?P:At(xt("private key",P,$))}catch{throw new Error(`private key must be ${$} bytes, hex or bigint, not ${typeof P}`)}return D&&(Z=_t(Z,H)),f(Z),Z}const m=new Map;function M(P){if(!(P instanceof k))throw new Error("ProjectivePoint expected")}class k{constructor(I,$,D){if(this.px=I,this.py=$,this.pz=D,null==I||!e.isValid(I))throw new Error("x required");if(null==$||!e.isValid($))throw new Error("y required");if(null==D||!e.isValid(D))throw new Error("z required")}static fromAffine(I){const{x:$,y:D}=I||{};if(!I||!e.isValid($)||!e.isValid(D))throw new Error("invalid affine point");if(I instanceof k)throw new Error("projective point not allowed");const H=Z=>e.eql(Z,e.ZERO);return H($)&&H(D)?k.ZERO:new k($,D,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(I){const $=e.invertBatch(I.map(D=>D.pz));return I.map((D,H)=>D.toAffine($[H])).map(k.fromAffine)}static fromHex(I){const $=k.fromAffine(i(xt("pointHex",I)));return $.assertValidity(),$}static fromPrivateKey(I){return k.BASE.multiply(g(I))}_setWindowSize(I){this._WINDOW_SIZE=I,m.delete(this)}assertValidity(){if(this.is0()){if(n.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:I,y:$}=this.toAffine();if(!e.isValid(I)||!e.isValid($))throw new Error("bad point: x or y not FE");const D=e.sqr($),H=s(I);if(!e.eql(D,H))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:I}=this.toAffine();if(e.isOdd)return!e.isOdd(I);throw new Error("Field doesn't support isOdd")}equals(I){M(I);const{px:$,py:D,pz:H}=this,{px:Z,py:V,pz:J}=I,G=e.eql(e.mul($,J),e.mul(Z,H)),Y=e.eql(e.mul(D,J),e.mul(V,H));return G&&Y}negate(){return new k(this.px,e.neg(this.py),this.pz)}double(){const{a:I,b:$}=n,D=e.mul($,ir),{px:H,py:Z,pz:V}=this;let J=e.ZERO,G=e.ZERO,Y=e.ZERO,Q=e.mul(H,H),X=e.mul(Z,Z),pe=e.mul(V,V),ie=e.mul(H,Z);return ie=e.add(ie,ie),Y=e.mul(H,V),Y=e.add(Y,Y),J=e.mul(I,Y),G=e.mul(D,pe),G=e.add(J,G),J=e.sub(X,G),G=e.add(X,G),G=e.mul(J,G),J=e.mul(ie,J),Y=e.mul(D,Y),pe=e.mul(I,pe),ie=e.sub(Q,pe),ie=e.mul(I,ie),ie=e.add(ie,Y),Y=e.add(Q,Q),Q=e.add(Y,Q),Q=e.add(Q,pe),Q=e.mul(Q,ie),G=e.add(G,Q),pe=e.mul(Z,V),pe=e.add(pe,pe),Q=e.mul(pe,ie),J=e.sub(J,Q),Y=e.mul(pe,X),Y=e.add(Y,Y),Y=e.add(Y,Y),new k(J,G,Y)}add(I){M(I);const{px:$,py:D,pz:H}=this,{px:Z,py:V,pz:J}=I;let G=e.ZERO,Y=e.ZERO,Q=e.ZERO;const X=n.a,pe=e.mul(n.b,ir);let ie=e.mul($,Z),ve=e.mul(D,V),_e=e.mul(H,J),Ae=e.add($,D),z=e.add(Z,V);Ae=e.mul(Ae,z),z=e.add(ie,ve),Ae=e.sub(Ae,z),z=e.add($,H);let K=e.add(Z,J);return z=e.mul(z,K),K=e.add(ie,_e),z=e.sub(z,K),K=e.add(D,H),G=e.add(V,J),K=e.mul(K,G),G=e.add(ve,_e),K=e.sub(K,G),Q=e.mul(X,z),G=e.mul(pe,_e),Q=e.add(G,Q),G=e.sub(ve,Q),Q=e.add(ve,Q),Y=e.mul(G,Q),ve=e.add(ie,ie),ve=e.add(ve,ie),_e=e.mul(X,_e),z=e.mul(pe,z),ve=e.add(ve,_e),_e=e.sub(ie,_e),_e=e.mul(X,_e),z=e.add(z,_e),ie=e.mul(ve,z),Y=e.add(Y,ie),ie=e.mul(K,z),G=e.mul(Ae,G),G=e.sub(G,ie),ie=e.mul(Ae,ve),Q=e.mul(K,Q),Q=e.add(Q,ie),new k(G,Y,Q)}subtract(I){return this.add(I.negate())}is0(){return this.equals(k.ZERO)}wNAF(I){return L.wNAFCached(this,m,I,$=>{const D=e.invertBatch($.map(H=>H.pz));return $.map((H,Z)=>H.toAffine(D[Z])).map(k.fromAffine)})}multiplyUnsafe(I){const $=k.ZERO;if(I===Ot)return $;if(f(I),I===st)return this;const{endo:D}=n;if(!D)return L.unsafeLadder(this,I);let{k1neg:H,k1:Z,k2neg:V,k2:J}=D.splitScalar(I),G=$,Y=$,Q=this;for(;Z>Ot||J>Ot;)Z&st&&(G=G.add(Q)),J&st&&(Y=Y.add(Q)),Q=Q.double(),Z>>=st,J>>=st;return H&&(G=G.negate()),V&&(Y=Y.negate()),Y=new k(e.mul(Y.px,D.beta),Y.py,Y.pz),G.add(Y)}multiply(I){f(I);let D,H,$=I;const{endo:Z}=n;if(Z){const{k1neg:V,k1:J,k2neg:G,k2:Y}=Z.splitScalar($);let{p:Q,f:X}=this.wNAF(J),{p:pe,f:ie}=this.wNAF(Y);Q=L.constTimeNegate(V,Q),pe=L.constTimeNegate(G,pe),pe=new k(e.mul(pe.px,Z.beta),pe.py,pe.pz),D=Q.add(pe),H=X.add(ie)}else{const{p:V,f:J}=this.wNAF($);D=V,H=J}return k.normalizeZ([D,H])[0]}multiplyAndAddUnsafe(I,$,D){const H=k.BASE,Z=(J,G)=>G!==Ot&&G!==st&&J.equals(H)?J.multiply(G):J.multiplyUnsafe(G),V=Z(this,$).add(Z(I,D));return V.is0()?void 0:V}toAffine(I){const{px:$,py:D,pz:H}=this,Z=this.is0();null==I&&(I=Z?e.ONE:e.inv(H));const V=e.mul($,I),J=e.mul(D,I),G=e.mul(H,I);if(Z)return{x:e.ZERO,y:e.ZERO};if(!e.eql(G,e.ONE))throw new Error("invZ was invalid");return{x:V,y:J}}isTorsionFree(){const{h:I,isTorsionFree:$}=n;if(I===st)return!0;if($)return $(k,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:I,clearCofactor:$}=n;return I===st?this:$?$(k,this):this.multiplyUnsafe(n.h)}toRawBytes(I=!0){return this.assertValidity(),r(k,this,I)}toHex(I=!0){return mn(this.toRawBytes(I))}}k.BASE=new k(n.Gx,n.Gy,e.ONE),k.ZERO=new k(e.ZERO,e.ONE,e.ZERO);const O=n.nBitLength,L=function Rs(t,n){const e=(i,s)=>{const u=s.negate();return i?u:s},r=i=>({windows:Math.ceil(n/i)+1,windowSize:2**(i-1)});return{constTimeNegate:e,unsafeLadder(i,s){let u=t.ZERO,f=i;for(;s>Is;)s&Pr&&(u=u.add(f)),f=f.double(),s>>=Pr;return u},precomputeWindow(i,s){const{windows:u,windowSize:f}=r(s),g=[];let m=i,M=m;for(let k=0;k<u;k++){M=m,g.push(M);for(let O=1;O<f;O++)M=M.add(m),g.push(M);m=M.double()}return g},wNAF(i,s,u){const{windows:f,windowSize:g}=r(i);let m=t.ZERO,M=t.BASE;const k=BigInt(2**i-1),O=2**i,L=BigInt(i);for(let P=0;P<f;P++){const I=P*g;let $=Number(u&k);u>>=L,$>g&&($-=O,u+=Pr);const D=I,H=I+Math.abs($)-1,V=$<0;0===$?M=M.add(e(P%2!=0,s[D])):m=m.add(e(V,s[H]))}return{p:m,f:M}},wNAFCached(i,s,u,f){const g=i._WINDOW_SIZE||1;let m=s.get(i);return m||(m=this.precomputeWindow(i,g),1!==g&&s.set(i,f(m))),this.wNAF(g,m,u)}}}(k,n.endo?Math.ceil(O/2):O);return{CURVE:n,ProjectivePoint:k,normPrivateKeyToScalar:g,weierstrassEquation:s,isWithinCurveOrder:u}}({...n,toBytes(z,K,fe){const be=K.toAffine(),re=e.toBytes(be.x),Me=sn;return fe?Me(Uint8Array.from([K.hasEvenY()?2:3]),re):Me(Uint8Array.from([4]),re,e.toBytes(be.y))},fromBytes(z){const K=z.length,fe=z[0],be=z.subarray(1);if(K!==i||2!==fe&&3!==fe){if(K===s&&4===fe)return{x:e.fromBytes(be.subarray(0,e.BYTES)),y:e.fromBytes(be.subarray(e.BYTES,2*e.BYTES))};throw new Error(`Point of length ${K} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}{const re=At(be);if(!function u(z){return Ot<z&&z<e.ORDER}(re))throw new Error("Point is not on curve");const Me=k(re);let Re=e.sqrt(Me);return!(1&~fe)!=((Re&st)===st)&&(Re=e.neg(Re)),{x:re,y:Re}}}}),L=z=>mn(Jt(z,n.nByteLength));function P(z){return z>r>>st}const $=(z,K,fe)=>At(z.slice(K,fe));class D{constructor(K,fe,be){this.r=K,this.s=fe,this.recovery=be,this.assertValidity()}static fromCompact(K){const fe=n.nByteLength;return K=xt("compactSignature",K,2*fe),new D($(K,0,fe),$(K,fe,2*fe))}static fromDER(K){const{r:fe,s:be}=an.toSig(xt("DER",K));return new D(fe,be)}assertValidity(){if(!O(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!O(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(K){return new D(this.r,this.s,K)}recoverPublicKey(K){const{r:fe,s:be,recovery:re}=this,Me=Y(xt("msgHash",K));if(null==re||![0,1,2,3].includes(re))throw new Error("recovery id invalid");const Re=2===re||3===re?fe+n.n:fe;if(Re>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");const Et=m.fromHex((1&re?"03":"02")+L(Re)),kt=g(Re),Rt=f(-Me*kt),Lt=f(be*kt),St=m.BASE.multiplyAndAddUnsafe(Et,Rt,Lt);if(!St)throw new Error("point at infinify");return St.assertValidity(),St}hasHighS(){return P(this.s)}normalizeS(){return this.hasHighS()?new D(this.r,f(-this.s),this.recovery):this}toDERRawBytes(){return yn(this.toDERHex())}toDERHex(){return an.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return yn(this.toCompactHex())}toCompactHex(){return L(this.r)+L(this.s)}}const H={isValidPrivateKey(z){try{return M(z),!0}catch{return!1}},normPrivateKeyToScalar:M,randomPrivateKey:()=>{const K=function Ts(t,n,e=!1){const r=(t=xt("privateHash",t)).length,i=Ur(n).nByteLength+8;if(i<24||r<i||r>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${r}`);return _t(e?Ir(t):At(t),n-qe)+qe}(n.randomBytes(e.BYTES+8),r);return Jt(K,n.nByteLength)},precompute:(z=8,K=m.BASE)=>(K._setWindowSize(z),K.multiply(BigInt(3)),K)};function V(z){const K=z instanceof Uint8Array,fe="string"==typeof z,be=(K||fe)&&z.length;return K?be===i||be===s:fe?be===2*i||be===2*s:z instanceof m}const G=n.bits2int||function(z){const K=At(z),fe=8*z.length-n.nBitLength;return fe>0?K>>BigInt(fe):K},Y=n.bits2int_modN||function(z){return f(G(z))},Q=Rr(n.nBitLength);function X(z){if("bigint"!=typeof z)throw new Error("bigint expected");if(!(Ot<=z&&z<Q))throw new Error(`bigint expected < 2^${n.nBitLength}`);return Jt(z,n.nByteLength)}const ie={lowS:n.lowS,prehash:!1},ve={lowS:n.lowS,prehash:!1};return m.BASE._setWindowSize(8),{CURVE:n,getPublicKey:function Z(z,K=!0){return m.fromPrivateKey(z).toRawBytes(K)},getSharedSecret:function J(z,K,fe=!0){if(V(z))throw new Error("first arg must be private key");if(!V(K))throw new Error("second arg must be public key");return m.fromHex(K).multiply(M(z)).toRawBytes(fe)},sign:function _e(z,K,fe=ie){const{seed:be,k2sig:re}=function pe(z,K,fe=ie){if(["recovered","canonical"].some(Ct=>Ct in fe))throw new Error("sign() legacy options not supported");const{hash:be,randomBytes:re}=n;let{lowS:Me,prehash:Re,extraEntropy:Ie}=fe;null==Me&&(Me=!0),z=xt("msgHash",z),Re&&(z=xt("prehashed msgHash",be(z)));const Et=Y(z),kt=M(K),Rt=[X(kt),X(Et)];if(null!=Ie){const Ct=!0===Ie?re(e.BYTES):Ie;Rt.push(xt("extraEntropy",Ct,e.BYTES))}const Lt=sn(...Rt),St=Et;return{seed:Lt,k2sig:function Gt(Ct){const xn=G(Ct);if(!O(xn))return;const hs=g(xn),zt=m.BASE.multiply(xn).toAffine(),Mn=f(zt.x);if(Mn===Ot)return;const Sr=f(hs*f(St+Mn*kt));if(Sr===Ot)return;let ds=(zt.x===Mn?0:2)|Number(zt.y&st),gs=Sr;return Me&&P(Sr)&&(gs=function I(z){return P(z)?f(-z):z}(Sr),ds^=1),new D(Mn,gs,ds)}}}(z,K,fe);return Fi(n.hash.outputLen,n.nByteLength,n.hmac)(be,re)},verify:function Ae(z,K,fe,be=ve){const re=z;if(K=xt("msgHash",K),fe=xt("publicKey",fe),"strict"in be)throw new Error("options.strict was renamed to lowS");const{lowS:Me,prehash:Re}=be;let Ie,Et;try{if("string"==typeof re||re instanceof Uint8Array)try{Ie=D.fromDER(re)}catch(zt){if(!(zt instanceof an.Err))throw zt;Ie=D.fromCompact(re)}else{if("object"!=typeof re||"bigint"!=typeof re.r||"bigint"!=typeof re.s)throw new Error("PARSE");{const{r:zt,s:Mn}=re;Ie=new D(zt,Mn)}}Et=m.fromHex(fe)}catch(zt){if("PARSE"===zt.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(Me&&Ie.hasHighS())return!1;Re&&(K=n.hash(K));const{r:kt,s:Rt}=Ie,Lt=Y(K),St=g(Rt),Gt=f(Lt*St),Ct=f(kt*St),xn=m.BASE.multiplyAndAddUnsafe(Et,Gt,Ct)?.toAffine();return!!xn&&f(xn.x)===kt},ProjectivePoint:m,Signature:D,utils:H}}BigInt(4);class Vi extends Sn{constructor(n,e){super(),this.finished=!1,this.destroyed=!1,Le.hash(n);const r=je(e);if(this.iHash=n.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?n.create().update(r).digest():r);for(let u=0;u<s.length;u++)s[u]^=54;this.iHash.update(s),this.oHash=n.create();for(let u=0;u<s.length;u++)s[u]^=106;this.oHash.update(s),s.fill(0)}update(n){return Le.exists(this),this.iHash.update(n),this}digestInto(n){Le.exists(this),Le.bytes(n,this.outputLen),this.finished=!0,this.iHash.digestInto(n),this.oHash.update(n),this.oHash.digestInto(n),this.destroy()}digest(){const n=new Uint8Array(this.oHash.outputLen);return this.digestInto(n),n}_cloneInto(n){n||(n=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:i,destroyed:s,blockLen:u,outputLen:f}=this;return n.finished=i,n.destroyed=s,n.blockLen=u,n.outputLen=f,n.oHash=e._cloneInto(n.oHash),n.iHash=r._cloneInto(n.iHash),n}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const vn=(t,n,e)=>new Vi(t,n).update(e).digest();function zs(t){return{hash:t,hmac:(n,...e)=>vn(t,n,Fe(...e)),randomBytes:Zt}}vn.create=(t,n)=>new Vi(t,n);const or=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),sr=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Yi=BigInt(1),ar=BigInt(2),Ki=(t,n)=>(t+n/ar)/n;function Zi(t){const n=or,e=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),u=BigInt(23),f=BigInt(44),g=BigInt(88),m=t*t*t%n,M=m*m*t%n,k=Ut(M,e,n)*M%n,O=Ut(k,e,n)*M%n,L=Ut(O,ar,n)*m%n,P=Ut(L,i,n)*L%n,I=Ut(P,s,n)*P%n,$=Ut(I,f,n)*I%n,D=Ut($,g,n)*$%n,H=Ut(D,f,n)*I%n,Z=Ut(H,e,n)*M%n,V=Ut(Z,u,n)*P%n,J=Ut(V,r,n)*m%n,G=Ut(J,ar,n);if(!Or.eql(Or.sqr(G),t))throw new Error("Cannot find square root");return G}const Or=function Cs(t,n,e=!1,r={}){if(t<=bt)throw new Error(`Expected Fp ORDER > 0, got ${t}`);const{nBitLength:i,nByteLength:s}=Ur(t,n);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const u=function xs(t){if(t%Nr===vs){const n=(t+qe)/Nr;return function(r,i){const s=r.pow(i,n);if(!r.eql(r.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%Gi===qi){const n=(t-qi)/Gi;return function(r,i){const s=r.mul(i,en),u=r.pow(s,n),f=r.mul(i,u),g=r.mul(r.mul(f,en),u),m=r.mul(f,r.sub(g,r.ONE));if(!r.eql(r.sqr(m),i))throw new Error("Cannot find square root");return m}}return function Es(t){const n=(t-qe)/en;let e,r,i;for(e=t-qe,r=0;e%en===bt;e/=en,r++);for(i=en;i<t&&_s(i,n,t)!==t-qe;i++);if(1===r){const u=(t+qe)/Nr;return function(g,m){const M=g.pow(m,u);if(!g.eql(g.sqr(M),m))throw new Error("Cannot find square root");return M}}const s=(e+qe)/en;return function(f,g){if(f.pow(g,n)===f.neg(f.ONE))throw new Error("Cannot find square root");let m=r,M=f.pow(f.mul(f.ONE,i),e),k=f.pow(g,s),O=f.pow(g,e);for(;!f.eql(O,f.ONE);){if(f.eql(O,f.ZERO))return f.ZERO;let L=1;for(let I=f.sqr(O);L<m&&!f.eql(I,f.ONE);L++)I=f.sqr(I);const P=f.pow(M,qe<<BigInt(m-L-1));M=f.sqr(P),k=f.mul(k,P),O=f.mul(O,M),m=L}return k}}(t)}(t),f=Object.freeze({ORDER:t,BITS:i,BYTES:s,MASK:Rr(i),ZERO:bt,ONE:qe,create:g=>_t(g,t),isValid:g=>{if("bigint"!=typeof g)throw new Error("Invalid field element: expected bigint, got "+typeof g);return bt<=g&&g<t},is0:g=>g===bt,isOdd:g=>(g&qe)===qe,neg:g=>_t(-g,t),eql:(g,m)=>g===m,sqr:g=>_t(g*g,t),add:(g,m)=>_t(g+m,t),sub:(g,m)=>_t(g-m,t),mul:(g,m)=>_t(g*m,t),pow:(g,m)=>function Ss(t,n,e){if(e<bt)throw new Error("Expected power > 0");if(e===bt)return t.ONE;if(e===qe)return n;let r=t.ONE,i=n;for(;e>bt;)e&qe&&(r=t.mul(r,i)),i=t.sqr(i),e>>=qe;return r}(f,g,m),div:(g,m)=>_t(g*rr(m,t),t),sqrN:g=>g*g,addN:(g,m)=>g+m,subN:(g,m)=>g-m,mulN:(g,m)=>g*m,inv:g=>rr(g,t),sqrt:r.sqrt||(g=>u(f,g)),invertBatch:g=>function As(t,n){const e=new Array(n.length),r=n.reduce((s,u,f)=>t.is0(u)?s:(e[f]=s,t.mul(s,u)),t.ONE),i=t.inv(r);return n.reduceRight((s,u,f)=>t.is0(u)?s:(e[f]=t.mul(s,e[f]),t.mul(s,u)),i),e}(f,g),cmov:(g,m,M)=>M?m:g,toBytes:g=>e?$i(g,s):Jt(g,s),fromBytes:g=>{if(g.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${g.length}`);return e?Ir(g):At(g)}});return Object.freeze(f)}(or,void 0,void 0,{sqrt:Zi}),wn=function Ws(t,n){const e=r=>Os({...t,...zs(r)});return Object.freeze({...e(n),create:e})}({a:BigInt(0),b:BigInt(7),Fp:Or,n:sr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const n=sr,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Yi*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=e,u=BigInt("0x100000000000000000000000000000000"),f=Ki(s*t,n),g=Ki(-r*t,n);let m=_t(t-f*e-g*i,n),M=_t(-f*r-g*s,n);const k=m>u,O=M>u;if(k&&(m=n-m),O&&(M=n-M),m>u||M>u)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:k,k1:m,k2neg:O,k2:M}}}},Tt),lr=BigInt(0),Xi=t=>"bigint"==typeof t&&lr<t&&t<or,Qi={};function cr(t,...n){let e=Qi[t];if(void 0===e){const r=Tt(Uint8Array.from(t,i=>i.charCodeAt(0)));e=sn(r,r),Qi[t]=e}return Tt(sn(e,...n))}const jr=t=>t.toRawBytes(!0).slice(1),$r=t=>Jt(t,32),Dr=t=>_t(t,or),Ln=t=>_t(t,sr),Fr=wn.ProjectivePoint;function qr(t){let n=wn.utils.normPrivateKeyToScalar(t),e=Fr.fromPrivateKey(n);return{scalar:e.hasEvenY()?n:Ln(-n),bytes:jr(e)}}function Ji(t){if(!Xi(t))throw new Error("bad x: need 0 < x < p");const n=Dr(t*t);let r=Zi(Dr(n*t+BigInt(7)));r%ar!==lr&&(r=Dr(-r));const i=new Fr(t,r,Yi);return i.assertValidity(),i}function eo(...t){return Ln(At(cr("BIP0340/challenge",...t)))}function to(t,n,e){const r=xt("signature",t,64),i=xt("message",n),s=xt("publicKey",e,32);try{const u=Ji(At(s)),f=At(r.subarray(0,32));if(!Xi(f))return!1;const g=At(r.subarray(32,64));if(!(t=>"bigint"==typeof t&&lr<t&&t<sr)(g))return!1;const m=eo($r(f),jr(u),i),M=((t,n,e)=>Fr.BASE.multiplyAndAddUnsafe(t,n,e))(u,g,Ln(-m));return!(!M||!M.hasEvenY()||M.toAffine().x!==f)}catch{return!1}}const bn={getPublicKey:function Ys(t){return qr(t).bytes},sign:function Ks(t,n,e=Zt(32)){const r=xt("message",t),{bytes:i,scalar:s}=qr(n),u=xt("auxRand",e,32),f=$r(s^At(cr("BIP0340/aux",u))),g=cr("BIP0340/nonce",f,i,r),m=Ln(At(g));if(m===lr)throw new Error("sign failed: k is zero");const{bytes:M,scalar:k}=qr(m),O=eo(M,i,r),L=new Uint8Array(64);if(L.set(M,0),L.set($r(Ln(k+O*s)),32),!to(L,r,i))throw new Error("sign: Invalid signature produced");return L},verify:to,utils:{randomPrivateKey:wn.utils.randomPrivateKey,lift_x:Ji,pointToBytes:jr,numberToBytesBE:Jt,bytesToNumberBE:At,taggedHash:cr,mod:_t}};function ln(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function jt(...t){const n=(i,s)=>u=>i(s(u));return{encode:Array.from(t).reverse().reduce((i,s)=>i?n(i,s.encode):s.encode,void 0),decode:t.reduce((i,s)=>i?n(i,s.decode):s.decode,void 0)}}function $t(t){return{encode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("alphabet.encode input should be an array of numbers");return n.map(e=>{if(ln(e),e<0||e>=t.length)throw new Error(`Digit index outside alphabet: ${e} (alphabet: ${t.length})`);return t[e]})},decode:n=>{if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("alphabet.decode input should be array of strings");return n.map(e=>{if("string"!=typeof e)throw new Error(`alphabet.decode: not string element=${e}`);const r=t.indexOf(e);if(-1===r)throw new Error(`Unknown letter: "${e}". Allowed: ${t}`);return r})}}}function Dt(t=""){if("string"!=typeof t)throw new Error("join separator should be string");return{encode:n=>{if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("join.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`join.encode: non-string input=${e}`);return n.join(t)},decode:n=>{if("string"!=typeof n)throw new Error("join.decode input should be string");return n.split(t)}}}function On(t,n="="){if(ln(t),"string"!=typeof n)throw new Error("padding chr should be string");return{encode(e){if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("padding.encode input should be array of strings");for(let r of e)if("string"!=typeof r)throw new Error(`padding.encode: non-string input=${r}`);for(;e.length*t%8;)e.push(n);return e},decode(e){if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("padding.encode input should be array of strings");for(let i of e)if("string"!=typeof i)throw new Error(`padding.decode: non-string input=${i}`);let r=e.length;if(r*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&e[r-1]===n;r--)if(!((r-1)*t%8))throw new Error("Invalid padding: string has too much padding");return e.slice(0,r)}}}function no(t){if("function"!=typeof t)throw new Error("normalize fn should be function");return{encode:n=>n,decode:n=>t(n)}}function ro(t,n,e){if(n<2)throw new Error(`convertRadix: wrong from=${n}, base cannot be less than 2`);if(e<2)throw new Error(`convertRadix: wrong to=${e}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let r=0;const i=[],s=Array.from(t);for(s.forEach(u=>{if(ln(u),u<0||u>=n)throw new Error(`Wrong integer: ${u}`)});;){let u=0,f=!0;for(let g=r;g<s.length;g++){const m=s[g],M=n*u+m;if(!Number.isSafeInteger(M)||n*u/n!==u||M-m!=n*u)throw new Error("convertRadix: carry overflow");if(u=M%e,s[g]=Math.floor(M/e),!Number.isSafeInteger(s[g])||s[g]*e+u!==M)throw new Error("convertRadix: carry overflow");f&&(s[g]?f=!1:r=g)}if(i.push(u),f)break}for(let u=0;u<t.length-1&&0===t[u];u++)i.push(0);return i.reverse()}const io=(t,n)=>n?io(n,t%n):t,ur=(t,n)=>t+(n-io(t,n));function Gr(t,n,e,r){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(n<=0||n>32)throw new Error(`convertRadix2: wrong from=${n}`);if(e<=0||e>32)throw new Error(`convertRadix2: wrong to=${e}`);if(ur(n,e)>32)throw new Error(`convertRadix2: carry overflow from=${n} to=${e} carryBits=${ur(n,e)}`);let i=0,s=0;const u=2**e-1,f=[];for(const g of t){if(ln(g),g>=2**n)throw new Error(`convertRadix2: invalid data word=${g} from=${n}`);if(i=i<<n|g,s+n>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${n}`);for(s+=n;s>=e;s-=e)f.push((i>>s-e&u)>>>0);i&=2**s-1}if(i=i<<e-s&u,!r&&s>=n)throw new Error("Excess padding");if(!r&&i)throw new Error(`Non-zero padding: ${i}`);return r&&s>0&&f.push(i>>>0),f}function Wt(t,n=!1){if(ln(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(ur(8,t)>32||ur(t,8)>32)throw new Error("radix2: carry overflow");return{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return Gr(Array.from(e),8,t,!n)},decode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(Gr(e,t,8,n))}}}function so(t){if("function"!=typeof t)throw new Error("unsafeWrapper fn should be function");return function(...n){try{return t.apply(null,n)}catch{}}}jt(Wt(4),$t("0123456789ABCDEF"),Dt("")),jt(Wt(5),$t("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),On(5),Dt(""));const Ht=(jt(Wt(5),$t("0123456789ABCDEFGHIJKLMNOPQRSTUV"),On(5),Dt("")),jt(Wt(5),$t("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Dt(""),no(t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),jt(Wt(6),$t("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),On(6),Dt(""))),zr=(jt(Wt(6),$t("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),On(6),Dt("")),t=>jt(function oo(t){return ln(t),{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return ro(Array.from(n),256,t)},decode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(ro(n,t,256))}}}(58),$t(t),Dt(""))),Wr=(zr("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),zr("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),zr("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),jt($t("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Dt(""))),co=[996825010,642813549,513874426,1027748829,705979059];function jn(t){const n=t>>25;let e=(33554431&t)<<5;for(let r=0;r<co.length;r++)1==(n>>r&1)&&(e^=co[r]);return e}function uo(t,n,e=1){const r=t.length;let i=1;for(let s=0;s<r;s++){const u=t.charCodeAt(s);if(u<33||u>126)throw new Error(`Invalid prefix (${t})`);i=jn(i)^u>>5}i=jn(i);for(let s=0;s<r;s++)i=jn(i)^31&t.charCodeAt(s);for(let s of n)i=jn(i)^s;for(let s=0;s<6;s++)i=jn(i);return i^=e,Wr.encode(Gr([i%2**30],30,5,!1))}function fo(t){const n="bech32"===t?1:734539939,e=Wt(5),r=e.decode,i=e.encode,s=so(r);function f(M,k=90){if("string"!=typeof M)throw new Error("bech32.decode input should be string, not "+typeof M);if(M.length<8||!1!==k&&M.length>k)throw new TypeError(`Wrong string length: ${M.length} (${M}). Expected (8..${k})`);const O=M.toLowerCase();if(M!==O&&M!==M.toUpperCase())throw new Error("String must be lowercase or uppercase");const L=(M=O).lastIndexOf("1");if(0===L||-1===L)throw new Error('Letter "1" must be present between prefix and data only');const P=M.slice(0,L),I=M.slice(L+1);if(I.length<6)throw new Error("Data must be at least 6 characters long");const $=Wr.decode(I).slice(0,-6),D=uo(P,$,n);if(!I.endsWith(D))throw new Error(`Invalid checksum in ${M}: expected "${D}"`);return{prefix:P,words:$}}return{encode:function u(M,k,O=90){if("string"!=typeof M)throw new Error("bech32.encode prefix should be string, not "+typeof M);if(!Array.isArray(k)||k.length&&"number"!=typeof k[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof k);const L=M.length+7+k.length;if(!1!==O&&L>O)throw new TypeError(`Length ${L} exceeds limit ${O}`);return`${M=M.toLowerCase()}1${Wr.encode(k)}${uo(M,k,n)}`},decode:f,decodeToBytes:function m(M){const{prefix:k,words:O}=f(M,!1);return{prefix:k,words:O,bytes:r(O)}},decodeUnsafe:so(f),fromWords:r,fromWordsUnsafe:s,toWords:i}}const _n=fo("bech32");fo("bech32m"),jt(Wt(4),$t("0123456789abcdef"),Dt(""),no(t=>{if("string"!=typeof t||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()}));var go=S(5693),Hr=S(9673),na=S(9608);const Ft=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function Kr(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function Zr(t){if("string"==typeof t&&(t=Kr(t)),!(t=>t instanceof Uint8Array)(t))throw new Error("expected Uint8Array, got "+typeof t);return t}function Xr(t,n){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");if("number"==typeof n&&t.length!==n)throw new Error(`Uint8Array length ${n} expected`)}function Qr(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function po(t,...n){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(n.length>0&&!n.includes(t.length))throw new Error(`Expected Uint8Array of length ${n}, not of length=${t.length}`)}const It={number:Qr,bool:function la(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)},bytes:po,hash:function ca(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("hash must be wrapped by utils.wrapConstructor");Qr(t.outputLen),Qr(t.blockLen)},exists:function ua(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called")},output:function fa(t,n){po(t);const e=n.outputLen;if(t.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}},Mt=(t,n)=>255&t[n++]|(255&t[n++])<<8;class ha{constructor(n){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,Xr(n=Zr(n),32);const e=Mt(n,0),r=Mt(n,2),i=Mt(n,4),s=Mt(n,6),u=Mt(n,8),f=Mt(n,10),g=Mt(n,12),m=Mt(n,14);this.r[0]=8191&e,this.r[1]=8191&(e>>>13|r<<3),this.r[2]=7939&(r>>>10|i<<6),this.r[3]=8191&(i>>>7|s<<9),this.r[4]=255&(s>>>4|u<<12),this.r[5]=u>>>1&8190,this.r[6]=8191&(u>>>14|f<<2),this.r[7]=8065&(f>>>11|g<<5),this.r[8]=8191&(g>>>8|m<<8),this.r[9]=m>>>5&127;for(let M=0;M<8;M++)this.pad[M]=Mt(n,16+2*M)}process(n,e,r=!1){const i=r?0:2048,{h:s,r:u}=this,f=u[0],g=u[1],m=u[2],M=u[3],k=u[4],O=u[5],L=u[6],P=u[7],I=u[8],$=u[9],D=Mt(n,e+0),H=Mt(n,e+2),Z=Mt(n,e+4),V=Mt(n,e+6),J=Mt(n,e+8),G=Mt(n,e+10),Y=Mt(n,e+12),Q=Mt(n,e+14);let X=s[0]+(8191&D),pe=s[1]+(8191&(D>>>13|H<<3)),ie=s[2]+(8191&(H>>>10|Z<<6)),ve=s[3]+(8191&(Z>>>7|V<<9)),_e=s[4]+(8191&(V>>>4|J<<12)),Ae=s[5]+(J>>>1&8191),z=s[6]+(8191&(J>>>14|G<<2)),K=s[7]+(8191&(G>>>11|Y<<5)),fe=s[8]+(8191&(Y>>>8|Q<<8)),be=s[9]+(Q>>>5|i),re=0,Me=re+X*f+pe*(5*$)+ie*(5*I)+ve*(5*P)+_e*(5*L);re=Me>>>13,Me&=8191,Me+=Ae*(5*O)+z*(5*k)+K*(5*M)+fe*(5*m)+be*(5*g),re+=Me>>>13,Me&=8191;let Re=re+X*g+pe*f+ie*(5*$)+ve*(5*I)+_e*(5*P);re=Re>>>13,Re&=8191,Re+=Ae*(5*L)+z*(5*O)+K*(5*k)+fe*(5*M)+be*(5*m),re+=Re>>>13,Re&=8191;let Ie=re+X*m+pe*g+ie*f+ve*(5*$)+_e*(5*I);re=Ie>>>13,Ie&=8191,Ie+=Ae*(5*P)+z*(5*L)+K*(5*O)+fe*(5*k)+be*(5*M),re+=Ie>>>13,Ie&=8191;let Et=re+X*M+pe*m+ie*g+ve*f+_e*(5*$);re=Et>>>13,Et&=8191,Et+=Ae*(5*I)+z*(5*P)+K*(5*L)+fe*(5*O)+be*(5*k),re+=Et>>>13,Et&=8191;let kt=re+X*k+pe*M+ie*m+ve*g+_e*f;re=kt>>>13,kt&=8191,kt+=Ae*(5*$)+z*(5*I)+K*(5*P)+fe*(5*L)+be*(5*O),re+=kt>>>13,kt&=8191;let Rt=re+X*O+pe*k+ie*M+ve*m+_e*g;re=Rt>>>13,Rt&=8191,Rt+=Ae*f+z*(5*$)+K*(5*I)+fe*(5*P)+be*(5*L),re+=Rt>>>13,Rt&=8191;let Lt=re+X*L+pe*O+ie*k+ve*M+_e*m;re=Lt>>>13,Lt&=8191,Lt+=Ae*g+z*f+K*(5*$)+fe*(5*I)+be*(5*P),re+=Lt>>>13,Lt&=8191;let St=re+X*P+pe*L+ie*O+ve*k+_e*M;re=St>>>13,St&=8191,St+=Ae*m+z*g+K*f+fe*(5*$)+be*(5*I),re+=St>>>13,St&=8191;let Gt=re+X*I+pe*P+ie*L+ve*O+_e*k;re=Gt>>>13,Gt&=8191,Gt+=Ae*M+z*m+K*g+fe*f+be*(5*$),re+=Gt>>>13,Gt&=8191;let Ct=re+X*$+pe*I+ie*P+ve*L+_e*O;re=Ct>>>13,Ct&=8191,Ct+=Ae*k+z*M+K*m+fe*g+be*f,re+=Ct>>>13,Ct&=8191,re=(re<<2)+re|0,re=re+Me|0,Me=8191&re,re>>>=13,Re+=re,s[0]=Me,s[1]=Re,s[2]=Ie,s[3]=Et,s[4]=kt,s[5]=Rt,s[6]=Lt,s[7]=St,s[8]=Gt,s[9]=Ct}finalize(){const{h:n,pad:e}=this,r=new Uint16Array(10);let i=n[1]>>>13;n[1]&=8191;for(let f=2;f<10;f++)n[f]+=i,i=n[f]>>>13,n[f]&=8191;n[0]+=5*i,i=n[0]>>>13,n[0]&=8191,n[1]+=i,i=n[1]>>>13,n[1]&=8191,n[2]+=i,r[0]=n[0]+5,i=r[0]>>>13,r[0]&=8191;for(let f=1;f<10;f++)r[f]=n[f]+i,i=r[f]>>>13,r[f]&=8191;r[9]-=8192;let s=(1^i)-1;for(let f=0;f<10;f++)r[f]&=s;s=~s;for(let f=0;f<10;f++)n[f]=n[f]&s|r[f];n[0]=65535&(n[0]|n[1]<<13),n[1]=65535&(n[1]>>>3|n[2]<<10),n[2]=65535&(n[2]>>>6|n[3]<<7),n[3]=65535&(n[3]>>>9|n[4]<<4),n[4]=65535&(n[4]>>>12|n[5]<<1|n[6]<<14),n[5]=65535&(n[6]>>>2|n[7]<<11),n[6]=65535&(n[7]>>>5|n[8]<<8),n[7]=65535&(n[8]>>>8|n[9]<<5);let u=n[0]+e[0];n[0]=65535&u;for(let f=1;f<8;f++)u=(n[f]+e[f]|0)+(u>>>16)|0,n[f]=65535&u}update(n){It.exists(this);const{buffer:e,blockLen:r}=this,i=(n=Zr(n)).length;for(let s=0;s<i;){const u=Math.min(r-this.pos,i-s);if(u!==r)e.set(n.subarray(s,s+u),this.pos),this.pos+=u,s+=u,this.pos===r&&(this.process(e,0,!1),this.pos=0);else for(;r<=i-s;s+=r)this.process(n,s)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(n){It.exists(this),It.output(n,this),this.finished=!0;const{buffer:e,h:r}=this;let{pos:i}=this;if(i){for(e[i++]=1;i<16;i++)e[i]=0;this.process(e,0,!0)}this.finalize();let s=0;for(let u=0;u<8;u++)n[s++]=r[u]>>>0,n[s++]=r[u]>>>8;return n}digest(){const{buffer:n,outputLen:e}=this;this.digestInto(n);const r=n.slice(0,e);return this.destroy(),r}}!function da(t){const n=(r,i)=>t(i).update(Zr(r)).digest(),e=t(new Uint8Array(32));n.outputLen=e.outputLen,n.blockLen=e.blockLen,n.create=r=>t(r)}(t=>new ha(t));const ga=Kr("expand 16-byte k"),pa=Kr("expand 32-byte k"),ma=Ft(ga),ya=Ft(pa),mo=t=>!(t.byteOffset%4),ge=(t,n)=>t<<n|t>>>32-n;const yo=(t=>{const{core:n,rounds:e,counterRight:r,counterLen:i,allow128bitKeys:s,extendNonceFn:u,blockLen:f}=function sa(t,n){if(void 0!==n&&("object"!=typeof n||!(t=>"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object)(n)))throw new Error("options must be object or undefined");return Object.assign(t,n)}({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},t);It.number(i),It.number(e),It.number(f),It.bool(r),It.bool(s);const g=f/4;if(f%4!=0)throw new Error("Salsa/ChaCha: blockLen must be aligned to 4 bytes");return(m,M,k,O,L=0)=>{if(It.bytes(m),It.bytes(M),It.bytes(k),O||(O=new Uint8Array(k.length)),It.bytes(O),It.number(L),L<0||L>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(O.length<k.length)throw new Error(`Salsa/ChaCha: output (${O.length}) is shorter than data (${k.length})`);const P=[];let I,$;if(32===m.length)I=m,$=ya;else{if(16!==m.length||!s)throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${m.length}`);I=new Uint8Array(32),I.set(m),I.set(m,16),$=ma,P.push(I)}if(u){if(M.length<=16)throw new Error("Salsa/ChaCha: extended nonce must be bigger than 16 bytes");I=u($,I,M.subarray(0,16),new Uint8Array(32)),P.push(I),M=M.subarray(16)}const D=16-i;if(M.length!==D)throw new Error(`Salsa/ChaCha: nonce must be ${D} or 16 bytes`);if(12!==D){const X=new Uint8Array(12);X.set(M,r?0:12-M.length),P.push(M=X)}const H=new Uint8Array(f),Z=Ft(H),V=Ft(I),J=Ft(M),G=mo(k)&&Ft(k),Y=mo(O)&&Ft(O);P.push(Z);const Q=k.length;for(let X=0,pe=L;X<Q;pe++){if(n($,V,J,Z,pe,e),pe>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");const ie=Math.min(f,Q-X);if(ie===f&&Y&&G){const ve=X/4;if(X%4!=0)throw new Error("Salsa/ChaCha: invalid block position");for(let _e=0;_e<g;_e++)Y[ve+_e]=G[ve+_e]^Z[_e];X+=f}else{for(let ve=0;ve<ie;ve++)O[X+ve]=k[X+ve]^H[ve];X+=ie}}for(let X=0;X<P.length;X++)P[X].fill(0);return O}})({core:function Dn(t,n,e,r,i,s=20){let u=t[0],f=t[1],g=t[2],m=t[3],M=n[0],k=n[1],O=n[2],L=n[3],P=n[4],I=n[5],$=n[6],D=n[7],H=i,Z=e[0],V=e[1],J=e[2],G=u,Y=f,Q=g,X=m,pe=M,ie=k,ve=O,_e=L,Ae=P,z=I,K=$,fe=D,be=H,re=Z,Me=V,Re=J;for(let Et=0;Et<s;Et+=2)G=G+pe|0,be=ge(be^G,16),Ae=Ae+be|0,pe=ge(pe^Ae,12),G=G+pe|0,be=ge(be^G,8),Ae=Ae+be|0,pe=ge(pe^Ae,7),Y=Y+ie|0,re=ge(re^Y,16),z=z+re|0,ie=ge(ie^z,12),Y=Y+ie|0,re=ge(re^Y,8),z=z+re|0,ie=ge(ie^z,7),Q=Q+ve|0,Me=ge(Me^Q,16),K=K+Me|0,ve=ge(ve^K,12),Q=Q+ve|0,Me=ge(Me^Q,8),K=K+Me|0,ve=ge(ve^K,7),X=X+_e|0,Re=ge(Re^X,16),fe=fe+Re|0,_e=ge(_e^fe,12),X=X+_e|0,Re=ge(Re^X,8),fe=fe+Re|0,_e=ge(_e^fe,7),G=G+ie|0,Re=ge(Re^G,16),K=K+Re|0,ie=ge(ie^K,12),G=G+ie|0,Re=ge(Re^G,8),K=K+Re|0,ie=ge(ie^K,7),Y=Y+ve|0,be=ge(be^Y,16),fe=fe+be|0,ve=ge(ve^fe,12),Y=Y+ve|0,be=ge(be^Y,8),fe=fe+be|0,ve=ge(ve^fe,7),Q=Q+_e|0,re=ge(re^Q,16),Ae=Ae+re|0,_e=ge(_e^Ae,12),Q=Q+_e|0,re=ge(re^Q,8),Ae=Ae+re|0,_e=ge(_e^Ae,7),X=X+pe|0,Me=ge(Me^X,16),z=z+Me|0,pe=ge(pe^z,12),X=X+pe|0,Me=ge(Me^X,8),z=z+Me|0,pe=ge(pe^z,7);let Ie=0;r[Ie++]=u+G|0,r[Ie++]=f+Y|0,r[Ie++]=g+Q|0,r[Ie++]=m+X|0,r[Ie++]=M+pe|0,r[Ie++]=k+ie|0,r[Ie++]=O+ve|0,r[Ie++]=L+_e|0,r[Ie++]=P+Ae|0,r[Ie++]=I+z|0,r[Ie++]=$+K|0,r[Ie++]=D+fe|0,r[Ie++]=H+be|0,r[Ie++]=Z+re|0,r[Ie++]=V+Me|0,r[Ie++]=J+Re|0},counterRight:!1,counterLen:4,allow128bitKeys:!1}),Jr=new Uint8Array([0]),bo=new Uint8Array;var xa=Object.defineProperty,vt=(t,n)=>{for(var e in n)xa(t,e,{get:n[e],enumerable:!0})};function _o(){return Be(bn.utils.randomPrivateKey())}function ei(t){return Be(bn.getPublicKey(t))}vt({},{MessageNode:()=>Eo,MessageQueue:()=>xo,insertEventIntoAscendingList:()=>Sa,insertEventIntoDescendingList:()=>ka,normalizeURL:()=>ti,utf8Decoder:()=>qt,utf8Encoder:()=>Pt});var qt=new TextDecoder("utf-8"),Pt=new TextEncoder;function ti(t){let n=new URL(t);return n.pathname=n.pathname.replace(/\/+/g,"/"),n.pathname.endsWith("/")&&(n.pathname=n.pathname.slice(0,-1)),("80"===n.port&&"ws:"===n.protocol||"443"===n.port&&"wss:"===n.protocol)&&(n.port=""),n.searchParams.sort(),n.hash="",n.toString()}function ka(t,n){let i,e=0,r=t.length-1,s=e;if(r<0)s=0;else if(n.created_at<t[r].created_at)s=r+1;else if(n.created_at>=t[e].created_at)s=e;else for(;;){if(r<=e+1){s=r;break}if(i=Math.floor(e+(r-e)/2),t[i].created_at>n.created_at)e=i;else{if(!(t[i].created_at<n.created_at)){s=i;break}r=i}}return t[s]?.id!==n.id?[...t.slice(0,s),n,...t.slice(s)]:t}function Sa(t,n){let i,e=0,r=t.length-1,s=e;if(r<0)s=0;else if(n.created_at>t[r].created_at)s=r+1;else if(n.created_at<=t[e].created_at)s=e;else for(;;){if(r<=e+1){s=r;break}if(i=Math.floor(e+(r-e)/2),t[i].created_at<n.created_at)e=i;else{if(!(t[i].created_at>n.created_at)){s=i;break}r=i}}return t[s]?.id!==n.id?[...t.slice(0,s),n,...t.slice(s)]:t}var Eo=class{_value;_next;get value(){return this._value}set value(t){this._value=t}get next(){return this._next}set next(t){this._next=t}constructor(t){this._value=t,this._next=null}},xo=class{_first;_last;get first(){return this._first}set first(t){this._first=t}get last(){return this._last}set last(t){this._last=t}_size;get size(){return this._size}set size(t){this._size=t}constructor(){this._first=null,this._last=null,this._size=0}enqueue(t){const n=new Eo(t);return 0!==this._size&&this._last?(this._last.next=n,this._last=n):(this._first=n,this._last=n),this._size++,!0}dequeue(){if(0===this._size||!this._first)return null;let t=this._first;return this._first=t.next,t.next=null,this._size--,t.value}},En=Symbol("verified");function Vt(t,n){const e=t;return e.pubkey=ei(n),e.id=Fn(e),e.sig=function Mo(t,n){return Be(bn.sign(Fn(t),n))}(e,n),e[En]=!0,e}function Fn(t){let n=Tt(Pt.encode(function Ta(t){if(!ni(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}(t)));return Be(n)}var Ia=t=>t instanceof Object;function ni(t){if(!Ia(t)||"number"!=typeof t.kind||"string"!=typeof t.content||"number"!=typeof t.created_at||"string"!=typeof t.pubkey||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let n=0;n<t.tags.length;n++){let e=t.tags[n];if(!Array.isArray(e))return!1;for(let r=0;r<e.length;r++)if("object"==typeof e[r])return!1}return!0}function dr(t){if("boolean"==typeof t[En])return t[En];const n=Fn(t);if(n!==t.id)return t[En]=!1;try{return t[En]=bn.verify(t.sig,n,t.pubkey)}catch{return t[En]=!1}}function Ra(t,n){if(t.ids&&-1===t.ids.indexOf(n.id)&&!t.ids.some(e=>n.id.startsWith(e))||t.kinds&&-1===t.kinds.indexOf(n.kind)||t.authors&&-1===t.authors.indexOf(n.pubkey)&&!t.authors.some(e=>n.pubkey.startsWith(e)))return!1;for(let e in t)if("#"===e[0]){let i=t[`#${e.slice(1)}`];if(i&&!n.tags.find(([s,u])=>s===e.slice(1)&&-1!==i.indexOf(u)))return!1}return!(t.since&&n.created_at<t.since||t.until&&n.created_at>t.until)}function gr(t,n){let e=n.length+3,r=t.indexOf(`"${n}":`)+e,i=t.slice(r).indexOf('"')+r+1;return t.slice(i,i+64)}function So(t,n){let e=n.length,r=t.indexOf(`"${n}":`)+e+3,i=t.slice(r),s=Math.min(i.indexOf(","),i.indexOf("}"));return parseInt(i.slice(0,s),10)}function Ao(t){let n=t.slice(0,22).indexOf('"EVENT"');if(-1===n)return null;let e=t.slice(n+7+1).indexOf('"');if(-1===e)return null;let r=n+7+1+e,i=t.slice(r+1,80).indexOf('"');return-1===i?null:t.slice(r+1,r+1+i)}function Ua(t,n){return n===gr(t,"id")}function Pa(t,n){return n===gr(t,"pubkey")}function La(t,n){return n===So(t,"kind")}function To(t,n={}){let{listTimeout:e=3e3,getTimeout:r=3e3,countTimeout:i=3e3}=n;var s,M,u={},f={connect:[],disconnect:[],error:[],notice:[],auth:[]},g={},m={};function O(){return(O=(0,y.A)(function*(){return M||(M=new Promise((V,J)=>{try{s=new WebSocket(t)}catch(X){J(X)}s.onopen=()=>{f.connect.forEach(X=>X()),V()},s.onerror=()=>{M=void 0,f.error.forEach(X=>X()),J()},s.onclose=(0,y.A)(function*(){M=void 0,f.disconnect.forEach(X=>X())});let Y,G=new xo;function Q(){if(0===G.size)return clearInterval(Y),void(Y=null);var X=G.dequeue();if(!X)return;let pe=Ao(X);if(pe){let ie=u[pe];if(ie&&ie.alreadyHaveEvent&&ie.alreadyHaveEvent(gr(X,"id"),t))return}try{let ie=JSON.parse(X);switch(ie[0]){case"EVENT":{let z=ie[1],K=ie[2];return void(ni(K)&&u[z]&&(u[z].skipVerification||dr(K))&&function ko(t,n){for(let e=0;e<t.length;e++)if(Ra(t[e],n))return!0;return!1}(u[z].filters,K)&&(g[z]?.event||[]).forEach(fe=>fe(K)))}case"COUNT":let ve=ie[1],_e=ie[2];return void(u[ve]&&(g[ve]?.count||[]).forEach(z=>z(_e)));case"EOSE":{let z=ie[1];return void(z in g&&(g[z].eose.forEach(K=>K()),g[z].eose=[]))}case"OK":{let z=ie[1],K=ie[2],fe=ie[3]||"";if(z in m){let{resolve:be,reject:re}=m[z];K?be(null):re(new Error(fe))}return}case"NOTICE":let Ae=ie[1];return void f.notice.forEach(z=>z(Ae));case"AUTH":{let z=ie[1];return void f.auth?.forEach(K=>K(z))}}}catch{return}}s.onmessage=X=>{G.enqueue(X.data),Y||(Y=setInterval(Q,0))}}))})).apply(this,arguments)}function L(){return 1===s?.readyState}function I(){return I=(0,y.A)(function*(){L()||(yield function k(){return O.apply(this,arguments)}())}),I.apply(this,arguments)}function $(V){return D.apply(this,arguments)}function D(){return(D=(0,y.A)(function*(V){let J=JSON.stringify(V);if(L()||(yield new Promise(G=>setTimeout(G,1e3)),L()))try{s.send(J)}catch(G){console.log(G)}})).apply(this,arguments)}const H=(V,{verb:J="REQ",skipVerification:G=!1,alreadyHaveEvent:Y=null,id:Q=Math.random().toString().slice(2)}={})=>{let X=Q;u[X]={id:X,filters:V,skipVerification:G,alreadyHaveEvent:Y},$([J,X,...V]);let pe={sub:(ie,ve={})=>H(ie||V,{skipVerification:ve.skipVerification||G,alreadyHaveEvent:ve.alreadyHaveEvent||Y,id:X}),unsub:()=>{delete u[X],delete g[X],$(["CLOSE",X])},on:(ie,ve)=>{g[X]=g[X]||{event:[],count:[],eose:[]},g[X][ie].push(ve)},off:(ie,ve)=>{let _e=g[X],Ae=_e[ie].indexOf(ve);Ae>=0&&_e[ie].splice(Ae,1)},get events(){return function Io(t){return ri.apply(this,arguments)}(pe)}};return pe};function Z(V,J){return new Promise((G,Y)=>{if(!V.id)return void Y(new Error(`event ${V} has no id`));let Q=V.id;$([J,V]),m[Q]={resolve:G,reject:Y}})}return{url:t,sub:H,on:(V,J)=>{f[V].push(J),"connect"===V&&1===s?.readyState&&J()},off:(V,J)=>{let G=f[V].indexOf(J);-1!==G&&f[V].splice(G,1)},list:(V,J)=>new Promise(G=>{let Y=H(V,J),Q=[],X=setTimeout(()=>{Y.unsub(),G(Q)},e);Y.on("eose",()=>{Y.unsub(),clearTimeout(X),G(Q)}),Y.on("event",pe=>{Q.push(pe)})}),get:(V,J)=>new Promise(G=>{let Y=H([V],J),Q=setTimeout(()=>{Y.unsub(),G(null)},r);Y.on("event",X=>{Y.unsub(),clearTimeout(Q),G(X)})}),count:V=>new Promise(J=>{let G=H(V,{...H,verb:"COUNT"}),Y=setTimeout(()=>{G.unsub(),J(null)},i);G.on("count",Q=>{G.unsub(),clearTimeout(Y),J(Q)})}),publish:V=>(0,y.A)(function*(){yield Z(V,"EVENT")})(),auth:V=>(0,y.A)(function*(){yield Z(V,"AUTH")})(),connect:function P(){return I.apply(this,arguments)},close(){f={connect:[],disconnect:[],error:[],notice:[],auth:[]},g={},m={},s?.readyState===WebSocket.OPEN&&s.close()},get status(){return s?.readyState??3}}}function ri(){return(ri=(0,tt.A)(function*(t){let n;const e=[],r=i=>{n?(n(i),n=void 0):e.push(i)};t.on("event",r);try{for(;;)e.length>0?yield e.shift():yield yield(0,et.A)(new Promise(s=>{n=s}))}finally{t.off("event",r)}})).apply(this,arguments)}vt({},{getHex64:()=>gr,getInt:()=>So,getSubscriptionId:()=>Ao,matchEventId:()=>Ua,matchEventKind:()=>La,matchEventPubkey:()=>Pa});var ii={};vt(ii,{BECH32_REGEX:()=>Bo,decode:()=>qn,naddrEncode:()=>Ga,neventEncode:()=>qa,noteEncode:()=>Da,nprofileEncode:()=>Fa,npubEncode:()=>$a,nrelayEncode:()=>za,nsecEncode:()=>ja});var Ro=5e3,Bo=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function qn(t){let{prefix:n,words:e}=_n.decode(t,Ro),r=new Uint8Array(_n.fromWords(e));switch(n){case"nprofile":{let i=pr(r);if(!i[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(32!==i[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:Be(i[0][0]),relays:i[1]?i[1].map(s=>qt.decode(s)):[]}}}case"nevent":{let i=pr(r);if(!i[0]?.[0])throw new Error("missing TLV 0 for nevent");if(32!==i[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(i[2]&&32!==i[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(i[3]&&4!==i[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:Be(i[0][0]),relays:i[1]?i[1].map(s=>qt.decode(s)):[],author:i[2]?.[0]?Be(i[2][0]):void 0,kind:i[3]?.[0]?parseInt(Be(i[3][0]),16):void 0}}}case"naddr":{let i=pr(r);if(!i[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!i[2]?.[0])throw new Error("missing TLV 2 for naddr");if(32!==i[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!i[3]?.[0])throw new Error("missing TLV 3 for naddr");if(4!==i[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:qt.decode(i[0][0]),pubkey:Be(i[2][0]),kind:parseInt(Be(i[3][0]),16),relays:i[1]?i[1].map(s=>qt.decode(s)):[]}}}case"nrelay":{let i=pr(r);if(!i[0]?.[0])throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:qt.decode(i[0][0])}}case"nsec":case"npub":case"note":return{type:n,data:Be(r)};default:throw new Error(`unknown prefix ${n}`)}}function pr(t){let n={},e=t;for(;e.length>0;){let r=e[0],i=e[1];if(!i)throw new Error(`malformed TLV ${r}`);let s=e.slice(2,2+i);if(e=e.slice(2+i),s.length<i)throw new Error(`not enough data to read on TLV ${r}`);n[r]=n[r]||[],n[r].push(s)}return n}function ja(t){return oi("nsec",t)}function $a(t){return oi("npub",t)}function Da(t){return oi("note",t)}function Gn(t,n){let e=_n.toWords(n);return _n.encode(t,e,Ro)}function oi(t,n){return Gn(t,De(n))}function Fa(t){return Gn("nprofile",mr({0:[De(t.pubkey)],1:(t.relays||[]).map(e=>Pt.encode(e))}))}function qa(t){let n;return null!=t.kind&&(n=function Oa(t){const n=new Uint8Array(4);return n[0]=t>>24&255,n[1]=t>>16&255,n[2]=t>>8&255,n[3]=255&t,n}(t.kind)),Gn("nevent",mr({0:[De(t.id)],1:(t.relays||[]).map(r=>Pt.encode(r)),2:t.author?[De(t.author)]:[],3:n?[new Uint8Array(n)]:[]}))}function Ga(t){let n=new ArrayBuffer(4);return new DataView(n).setUint32(0,t.kind,!1),Gn("naddr",mr({0:[Pt.encode(t.identifier)],1:(t.relays||[]).map(r=>Pt.encode(r)),2:[De(t.pubkey)],3:[new Uint8Array(n)]}))}function za(t){return Gn("nrelay",mr({0:[Pt.encode(t)]}))}function mr(t){let n=[];return Object.entries(t).forEach(([e,r])=>{r.forEach(i=>{let s=new Uint8Array(i.length+2);s.set([parseInt(e)],0),s.set([i.length],1),s.set(i,2),n.push(s)})}),Fe(...n)}var si={};function No(t,n,e){return ai.apply(this,arguments)}function ai(){return(ai=(0,y.A)(function*(t,n,e){const i=Uo(wn.getSharedSecret(t,"02"+n));let s=Uint8Array.from(Zt(16)),u=Pt.encode(e),f=yield crypto.subtle.importKey("raw",i,{name:"AES-CBC"},!1,["encrypt"]),g=yield crypto.subtle.encrypt({name:"AES-CBC",iv:s},f,u);return`${Ht.encode(new Uint8Array(g))}?iv=${Ht.encode(new Uint8Array(s.buffer))}`})).apply(this,arguments)}function Ha(t,n,e){return li.apply(this,arguments)}function li(){return(li=(0,y.A)(function*(t,n,e){let[r,i]=e.split("?iv="),u=Uo(wn.getSharedSecret(t,"02"+n)),f=yield crypto.subtle.importKey("raw",u,{name:"AES-CBC"},!1,["decrypt"]),g=Ht.decode(r),m=Ht.decode(i),M=yield crypto.subtle.decrypt({name:"AES-CBC",iv:m},f,g);return qt.decode(M)})).apply(this,arguments)}function Uo(t){return t.slice(1,33)}vt(si,{decrypt:()=>Ha,encrypt:()=>No}),typeof crypto<"u"&&!crypto.subtle&&crypto.webcrypto&&(crypto.subtle=crypto.webcrypto.subtle),vt({},{NIP05_REGEX:()=>Po,queryProfile:()=>Za,searchDomain:()=>Ka,useFetchImplementation:()=>Ya});var yr,Po=/^(?:([\w.+-]+)@)?([\w.-]+)$/;try{yr=fetch}catch{}function Ya(t){yr=t}function Ka(t){return ci.apply(this,arguments)}function ci(){return(ci=(0,y.A)(function*(t,n=""){try{return(yield(yield yr(`https://${t}/.well-known/nostr.json?name=${n}`)).json()).names}catch{return{}}})).apply(this,arguments)}function Za(t){return ui.apply(this,arguments)}function ui(){return(ui=(0,y.A)(function*(t){const n=t.match(Po);if(!n)return null;const[e,r="_",i]=n;try{const s=yield yr(`https://${i}/.well-known/nostr.json?name=${r}`),{names:u,relays:f}=function Xa(t){const n={names:{}};for(const[e,r]of Object.entries(t.names))"string"==typeof e&&"string"==typeof r&&(n.names[e]=r);if(t.relays){n.relays={};for(const[e,r]of Object.entries(t.relays))"string"==typeof e&&Array.isArray(r)&&(n.relays[e]=r.filter(i=>"string"==typeof i))}return n}(yield s.json()),g=u[r];return g?{pubkey:g,relays:f?.[g]}:null}catch{return null}})).apply(this,arguments)}function Ja(t,n){let r=na.c.fromMasterSeed((0,Hr.kw)(t,n)).derive("m/44'/1237'/0'/0/0").privateKey;if(!r)throw new Error("could not derive private key");return Be(r)}function el(){return(0,Hr.we)(go.p)}function tl(t){return(0,Hr.JB)(t,go.p)}function rl(t){const n={reply:void 0,root:void 0,mentions:[],profiles:[]},e=[];for(const r of t.tags)"e"===r[0]&&r[1]&&e.push(r),"p"===r[0]&&r[1]&&n.profiles.push({pubkey:r[1],relays:r[2]?[r[2]]:[]});for(let r=0;r<e.length;r++){const i=e[r],[s,u,f,g]=i,m={id:u,relays:f?[f]:[]},k=r===e.length-1;"root"!==g?"reply"!==g?"mention"!==g?0===r?n.root=m:k?n.reply=m:n.mentions.push(m):n.mentions.push(m):n.reply=m:n.root=m}return n}function Lo(t){let n=0;for(let e=0;e<t.length;e++){const r=parseInt(t[e],16);if(0!==r){n+=Math.clz32(r)-28;break}n+=4}return n}function ol(t,n){let e=0;const r=t,i=["nonce",e.toString(),n.toString()];for(r.tags.push(i);;){const s=Math.floor((new Date).getTime()/1e3);if(s!==r.created_at&&(e=0,r.created_at=s),i[1]=(++e).toString(),r.id=Fn(r),Lo(r.id)>=n)break}return r}function al(t,n,e,r){return Vt({kind:6,tags:[...t.tags??[],["e",n.id,e],["p",n.pubkey]],content:""===t.content?"":JSON.stringify(n),created_at:t.created_at},r)}function Oo(t){if(6!==t.kind)return;let n,e;for(let r=t.tags.length-1;r>=0&&(void 0===n||void 0===e);r--){const i=t.tags[r];i.length>=2&&("e"===i[0]&&void 0===n?n=i:"p"===i[0]&&void 0===e&&(e=i))}return void 0!==n?{id:n[1],relays:[n[2],e?.[2]].filter(r=>"string"==typeof r),author:e?.[1]}:void 0}function ll(t,{skipVerification:n}={}){const e=Oo(t);if(void 0===e||""===t.content)return;let r;try{r=JSON.parse(t.content)}catch{return}return r.id===e.id&&(n||dr(r))?r:void 0}vt({},{generateSeedWords:()=>el,privateKeyFromSeedWords:()=>Ja,validateWords:()=>tl}),vt({},{parse:()=>rl}),vt({},{getPow:()=>Lo,minePow:()=>ol}),vt({},{finishRepostEvent:()=>al,getRepostedEvent:()=>ll,getRepostedEventPointer:()=>Oo}),vt({},{NOSTR_URI_REGEX:()=>vr,parse:()=>fl,test:()=>ul});var vr=new RegExp(`nostr:(${Bo.source})`);function ul(t){return"string"==typeof t&&new RegExp(`^${vr.source}$`).test(t)}function fl(t){const n=t.match(new RegExp(`^${vr.source}$`));if(!n)throw new Error(`Invalid Nostr URI: ${t}`);return{uri:n[0],value:n[1],decoded:qn(n[1])}}function dl(t,n,e){const r=n.tags.filter(i=>i.length>=2&&("e"===i[0]||"p"===i[0]));return Vt({...t,kind:7,tags:[...t.tags??[],...r,["e",n.id],["p",n.pubkey]],content:t.content??"+"},e)}function gl(t){if(7!==t.kind)return;let n,e;for(let r=t.tags.length-1;r>=0&&(void 0===n||void 0===e);r--){const i=t.tags[r];i.length>=2&&("e"===i[0]&&void 0===n?n=i:"p"===i[0]&&void 0===e&&(e=i))}return void 0!==n&&void 0!==e?{id:n[1],relays:[n[2],e[2]].filter(r=>void 0!==r),author:e[1]}:void 0}function ml(t,n){let e=[];(n.kind||-1)>=0&&e.push(`kind=${n.kind}`),n.until&&e.push(`created_at<${n.until}`),n.since&&e.push(`created_at>${n.since}`);let r=e.join("&");if(""===r)throw new Error("refusing to create a delegation without any conditions");let i=Tt(Pt.encode(`nostr:delegation:${n.pubkey}:${r}`)),s=Be(bn.sign(i,t));return{from:ei(t),to:n.pubkey,cond:r,sig:s}}function yl(t){let n=t.tags.find(f=>"delegation"===f[0]&&f.length>=4);if(!n)return null;let e=n[1],r=n[2],i=n[3],s=r.split("&");for(let f=0;f<s.length;f++){let[g,m,M]=s[f].split(/\b/);if("kind"!==g||"="!==m||t.kind!==parseInt(M)){if("created_at"===g&&"<"===m&&t.created_at<parseInt(M))continue;if("created_at"===g&&">"===m&&t.created_at>parseInt(M))continue;return null}}let u=Tt(Pt.encode(`nostr:delegation:${t.pubkey}:${r}`));return bn.verify(i,u,e)?e:null}vt({},{finishReactionEvent:()=>dl,getReactedEventPointer:()=>gl}),vt({},{createDelegation:()=>ml,getDelegator:()=>yl}),vt({},{matchAll:()=>wl,regex:()=>fi,replaceAll:()=>bl});var fi=()=>new RegExp(`\\b${vr.source}\\b`,"g");function*wl(t){const n=t.matchAll(fi());for(const e of n)try{const[r,i]=e;yield{uri:r,value:i,decoded:qn(i),start:e.index,end:e.index+r.length}}catch{}}function bl(t,n){return t.replaceAll(fi(),(e,r)=>n({uri:e,value:r,decoded:qn(r)}))}vt({},{channelCreateEvent:()=>El,channelHideMessageEvent:()=>kl,channelMessageEvent:()=>Ml,channelMetadataEvent:()=>xl,channelMuteUserEvent:()=>Sl});var hi,El=(t,n)=>{let e;if("object"==typeof t.content)e=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;e=t.content}return Vt({kind:40,tags:[...t.tags??[]],content:e,created_at:t.created_at},n)},xl=(t,n)=>{let e;if("object"==typeof t.content)e=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;e=t.content}return Vt({kind:41,tags:[["e",t.channel_create_event_id],...t.tags??[]],content:e,created_at:t.created_at},n)},Ml=(t,n)=>{const e=[["e",t.channel_create_event_id,t.relay_url,"root"]];return t.reply_to_channel_message_event_id&&e.push(["e",t.reply_to_channel_message_event_id,t.relay_url,"reply"]),Vt({kind:42,tags:[...e,...t.tags??[]],content:t.content,created_at:t.created_at},n)},kl=(t,n)=>{let e;if("object"==typeof t.content)e=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;e=t.content}return Vt({kind:43,tags:[["e",t.channel_message_event_id],...t.tags??[]],content:e,created_at:t.created_at},n)},Sl=(t,n)=>{let e;if("object"==typeof t.content)e=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;e=t.content}return Vt({kind:44,tags:[["p",t.pubkey_to_mute],...t.tags??[]],content:e,created_at:t.created_at},n)};vt({},{useFetchImplementation:()=>Cl,validateGithub:()=>Tl});try{hi=fetch}catch{}function Cl(t){hi=t}function Tl(t,n,e){return di.apply(this,arguments)}function di(){return(di=(0,y.A)(function*(t,n,e){try{return(yield(yield hi(`https://gist.github.com/${n}/${e}/raw`)).text())===`Verifying that I control the following Nostr public key: ${t}`}catch{return!1}})).apply(this,arguments)}vt({},{authenticate:()=>Rl});var Rl=function(){var t=(0,y.A)(function*({challenge:n,relay:e,sign:r}){const i={kind:22242,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e.url],["challenge",n]],content:""};return e.auth(yield r(i))});return function(e){return t.apply(this,arguments)}}();vt({},{decrypt:()=>Ul,encrypt:()=>Nl,utils:()=>cn});var pi,cn={v2:{maxPlaintextSize:65408,minCiphertextSize:100,maxCiphertextSize:102400,getConversationKey:(t,n)=>wn.getSharedSecret(t,"02"+n).subarray(1,33),getMessageKeys(t,n){const e=((t,n,e,r,i)=>function _a(t,n,e,r=32){if(Le.hash(t),Le.number(r),r>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/t.outputLen);void 0===e&&(e=bo);const s=new Uint8Array(i*t.outputLen),u=vn.create(t,n),f=u._cloneInto(),g=new Uint8Array(u.outputLen);for(let m=0;m<i;m++)Jr[0]=m+1,f.update(0===m?bo:g).update(e).update(Jr).digestInto(g),s.set(g,t.outputLen*m),u._cloneInto(f);return u.destroy(),f.destroy(),g.fill(0),Jr.fill(0),s.slice(0,r)}(t,function ba(t,n,e){return Le.hash(t),void 0===e&&(e=new Uint8Array(t.outputLen)),vn(t,je(e),je(n))}(t,n,e),r,i))(Tt,t,n,"nip44-v2",76);return{encryption:e.subarray(0,32),nonce:e.subarray(32,44),auth:e.subarray(44,76)}},calcPadding(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("expected positive integer");if(t<=32)return 32;const n=1<<Math.floor(Math.log2(t-1))+1,e=n<=256?32:n/8;return e*(Math.floor((t-1)/e)+1)},pad(t){const n=Pt.encode(t),e=n.length;if(e<1||e>=cn.v2.maxPlaintextSize)throw new Error("invalid plaintext length: must be between 1b and 64KB");const r=cn.v2.calcPadding(e),i=new Uint8Array(r-e),s=new Uint8Array(2);return new DataView(s.buffer).setUint16(0,e),Fe(s,n,i)},unpad(t){const n=new DataView(t.buffer).getUint16(0),e=t.subarray(2,2+n);if(0===n||e.length!==n||t.length!==2+cn.v2.calcPadding(n))throw new Error("invalid padding");return qt.decode(e)}}};function Nl(t,n,e={}){const r=e.version??2;if(2!==r)throw new Error("unknown encryption version "+r);const i=e.salt??Zt(32);Xr(i,32);const s=cn.v2.getMessageKeys(t,i),u=cn.v2.pad(n),f=yo(s.encryption,s.nonce,u),g=vn(Tt,s.auth,f);return Ht.encode(Fe(new Uint8Array([r]),i,f,g))}function Ul(t,n){const e=cn.v2;Xr(t,32);const r=n.length;if(r<e.minCiphertextSize||r>=e.maxCiphertextSize)throw new Error("invalid ciphertext length: "+r);if("#"===n[0])throw new Error("unknown encryption version");let i;try{i=Ht.decode(n)}catch(O){throw new Error("invalid base64: "+O.message)}const s=i.subarray(0,1)[0];if(2!==s)throw new Error("unknown encryption version "+s);const u=i.subarray(1,33),f=i.subarray(33,-32),g=i.subarray(-32),m=e.getMessageKeys(t,u);if(!function aa(t,n){if(t.length!==n.length)throw new Error("equalBytes: Different size of Uint8Arrays");let e=!0;for(let r=0;r<t.length;r++)e&&(e=t[r]===n[r]);return e}(vn(Tt,m.auth,f),g))throw new Error("invalid MAC");const k=yo(m.encryption,m.nonce,f);return e.unpad(k)}function Ll(t){const{pathname:n,searchParams:e}=new URL(t),r=n,i=e.get("relay"),s=e.get("secret");if(!r||!i||!s)throw new Error("invalid connection string");return{pubkey:r,relay:i,secret:s}}function Ol(t){return gi.apply(this,arguments)}function gi(){return(gi=(0,y.A)(function*({pubkey:t,secret:n,invoice:e}){const i=yield No(n,t,JSON.stringify({method:"pay_invoice",params:{invoice:e}}));return Vt({kind:23194,created_at:Math.round(Date.now()/1e3),content:i,tags:[["p",t]]},n)})).apply(this,arguments)}vt({},{makeNwcRequestEvent:()=>Ol,parseConnectionString:()=>Ll}),vt({},{getZapEndpoint:()=>Dl,makeZapReceipt:()=>Gl,makeZapRequest:()=>Fl,useFetchImplementation:()=>$l,validateZapRequest:()=>ql});try{pi=fetch}catch{}function $l(t){pi=t}function Dl(t){return mi.apply(this,arguments)}function mi(){return(mi=(0,y.A)(function*(t){try{let n="",{lud06:e,lud16:r}=JSON.parse(t.content);if(e){let{words:u}=_n.decode(e,1e3),f=_n.fromWords(u);n=qt.decode(f)}else{if(!r)return null;{let[u,f]=r.split("@");n=`https://${f}/.well-known/lnurlp/${u}`}}let s=yield(yield pi(n)).json();if(s.allowsNostr&&s.nostrPubkey)return s.callback}catch{}return null})).apply(this,arguments)}function Fl({profile:t,event:n,amount:e,relays:r,comment:i=""}){if(!e)throw new Error("amount not given");if(!t)throw new Error("profile not given");let s={kind:9734,created_at:Math.round(Date.now()/1e3),content:i,tags:[["p",t],["amount",e.toString()],["relays",...r]]};return n&&s.tags.push(["e",n]),s}function ql(t){let n;try{n=JSON.parse(t)}catch{return"Invalid zap request JSON."}if(!ni(n))return"Zap request is not a valid Nostr event.";if(!dr(n))return"Invalid signature on zap request.";let e=n.tags.find(([s,u])=>"p"===s&&u);if(!e)return"Zap request doesn't have a 'p' tag.";if(!e[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=n.tags.find(([s,u])=>"e"===s&&u);return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":n.tags.find(([s,u])=>"relays"===s&&u)?null:"Zap request doesn't have a 'relays' tag."}function Gl({zapRequest:t,preimage:n,bolt11:e,paidAt:r}){let s=JSON.parse(t).tags.filter(([f])=>"e"===f||"p"===f||"a"===f),u={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...s,["bolt11",e],["description",t]]};return n&&u.tags.push(["preimage",n]),u}vt({},{getToken:()=>Wl,unpackEventFromToken:()=>$o,validateEvent:()=>Do,validateToken:()=>Hl});var jo="Nostr ";function Wl(t,n,e){return yi.apply(this,arguments)}function yi(){return(yi=(0,y.A)(function*(t,n,e,r=!1){if(!t||!n)throw new Error("Missing loginUrl or httpMethod");const i=function Ca(t=255){return{kind:t,content:"",tags:[],created_at:0}}(27235);i.tags=[["u",t],["method",n]],i.created_at=Math.round((new Date).getTime()/1e3);const s=yield e(i);return(r?jo:"")+Ht.encode(Pt.encode(JSON.stringify(s)))})).apply(this,arguments)}function Hl(t,n,e){return vi.apply(this,arguments)}function vi(){return(vi=(0,y.A)(function*(t,n,e){const r=yield $o(t).catch(s=>{throw s});return yield Do(r,n,e).catch(s=>{throw s})})).apply(this,arguments)}function $o(t){return wi.apply(this,arguments)}function wi(){return(wi=(0,y.A)(function*(t){if(!t)throw new Error("Missing token");t=t.replace(jo,"");const n=qt.decode(Ht.decode(t));if(!n||0===n.length||!n.startsWith("{"))throw new Error("Invalid token");return JSON.parse(n)})).apply(this,arguments)}function Do(t,n,e){return bi.apply(this,arguments)}function bi(){return(bi=(0,y.A)(function*(t,n,e){if(!t)throw new Error("Invalid nostr event");if(!dr(t))throw new Error("Invalid nostr event, signature invalid");if(27235!==t.kind)throw new Error("Invalid nostr event, kind invalid");if(!t.created_at)throw new Error("Invalid nostr event, created_at invalid");if(Math.round((new Date).getTime()/1e3)-t.created_at>60)throw new Error("Invalid nostr event, expired");const r=t.tags.find(s=>"u"===s[0]);if(1!==r?.length&&r?.[1]!==n)throw new Error("Invalid nostr event, url tag invalid");const i=t.tags.find(s=>"method"===s[0]);if(1!==i?.length&&i?.[1].toLowerCase()!==e.toLowerCase())throw new Error("Invalid nostr event, method tag invalid");return!0})).apply(this,arguments)}function Te(){return Te=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},Te.apply(this,arguments)}const Go=t=>t.reduce((n,e)=>n+e.toString(16).padStart(2,"0"),"");class zo extends Error{constructor(n,e,r,i){let s=n.toString();e&&(s+=` ${e}`),s+=": ",s+=i.message?i.message:JSON.stringify(i),super(s),this.status=void 0,this.statusText=void 0,this.headers=void 0,this.error=void 0,this.status=n,this.statusText=e,this.headers=r,this.error=i}}const Vl=["auth","endpoint","params","request_body","method","max_retries","base_url","user_agent","headers"],Yl="https://api.getalby.com";function Wo(t,n){return Ei.apply(this,arguments)}function Ei(){return(Ei=(0,y.A)(function*(t,n,e=0){const r=yield fetch(t,n);if(429===r.status&&e>0){const i=Number(r.headers.get("x-rate-limit-reset")),s=Number(r.headers.get("x-rate-limit-remaining")),u=1e3*i-Date.now();let f=1e3;return 0===s&&(f=u),yield new Promise(g=>setTimeout(g,f)),Wo(t,n,e-1)}return r})).apply(this,arguments)}function xi(){return(xi=(0,y.A)(function*(t){let{auth:n,endpoint:e,params:r={},request_body:i,method:s,max_retries:u,base_url:f=Yl,user_agent:g,headers:m}=t,M=function _i(t,n){if(null==t)return{};var e,r,i={},s=Object.keys(t);for(r=0;r<s.length;r++)n.indexOf(e=s[r])>=0||(i[e]=t[e]);return i}(t,Vl);const k=new URL(f+e);k.search=function Fo(t){return Object.entries(t).map(([n,e])=>n&&e?`${n}=${e}`:"").filter(n=>n).join("&")}(r);const O="POST"===s&&!!i,L=n?yield n.getAuthHeader(k.href,s):void 0,P=yield Wo(k.toString(),Te({headers:Te({},O?{"Content-Type":"application/json; charset=utf-8"}:void 0,L,m,{"User-Agent":g??"@getalby/sdk","X-User-Agent":g??"@getalby/sdk"}),method:s,body:O?JSON.stringify(i):void 0},M),u);if(!P.ok){const I=yield P.json();throw new zo(P.status,P.statusText,P.headers,I)}return P})).apply(this,arguments)}function wt(t){return Mi.apply(this,arguments)}function Mi(){return Mi=(0,y.A)(function*(t){return(yield function Kl(t){return xi.apply(this,arguments)}(t)).json()}),Mi.apply(this,arguments)}class Vo{constructor(n){this.bearer_token=void 0,this.bearer_token=n}getAuthHeader(){return{Authorization:`Bearer ${this.bearer_token}`}}}class rn extends Error{constructor(n,e){super(n),this.error=void 0,this.code=void 0,this.error=n,this.code=e}}class Yo extends rn{}class ki extends rn{}class Si extends ki{}class Ai extends ki{}class Ci extends rn{}class Ti extends rn{}class wr extends rn{}class Ko extends rn{}class Zo extends rn{}const Xo={alby:{authorizationUrl:"https://nwc.getalby.com/apps/new",relayUrl:"wss://relay.getalby.com/v1",walletPubkey:"69effe7b49a6dd5cf525bd0905917a5005ffe480b58eeb8e861418cf3ae760d9"}};class zn{static parseWalletConnectUrl(n){n=n.replace("nostrwalletconnect://","http://").replace("nostr+walletconnect://","http://").replace("nostrwalletconnect:","http://").replace("nostr+walletconnect:","http://");const e=new URL(n),r=e.searchParams.get("relay");if(!r)throw new Error("No relay URL found in connection string");const i={walletPubkey:e.host,relayUrl:r},s=e.searchParams.get("secret");s&&(i.secret=s);const u=e.searchParams.get("lud16");return u&&(i.lud16=u),i}static withNewSecret(n){return(n=n||{}).secret=_o(),new zn(n)}constructor(n){var e;this.relay=void 0,this.relayUrl=void 0,this.secret=void 0,this.lud16=void 0,this.walletPubkey=void 0,this.options=void 0,n&&n.nostrWalletConnectUrl&&(n=Te({},zn.parseWalletConnectUrl(n.nostrWalletConnectUrl),n));const r=Xo[(null==(e=n)?void 0:e.providerName)||"alby"];this.options=Te({},r,n||{}),this.relayUrl=this.options.relayUrl,this.relay=To(this.relayUrl),this.options.secret&&(this.secret=this.options.secret.toLowerCase().startsWith("nsec")?ii.decode(this.options.secret).data:this.options.secret),this.lud16=this.options.lud16,this.walletPubkey=this.options.walletPubkey.toLowerCase().startsWith("npub")?ii.decode(this.options.walletPubkey).data:this.options.walletPubkey,void 0===globalThis.WebSocket&&console.error("WebSocket is undefined. Make sure to `import websocket-polyfill` for nodejs environments")}get nostrWalletConnectUrl(){return this.getNostrWalletConnectUrl()}getNostrWalletConnectUrl(n=!0){let e=`nostr+walletconnect://${this.walletPubkey}?relay=${this.relayUrl}&pubkey=${this.publicKey}`;return n&&(e=`${e}&secret=${this.secret}`),e}get connected(){return 1===this.relay.status}get publicKey(){if(!this.secret)throw new Error("Missing secret key");return ei(this.secret)}getPublicKey(){return Promise.resolve(this.publicKey)}signEvent(n){if(!this.secret)throw new Error("Missing secret key");return Promise.resolve(Vt(n,this.secret))}getEventHash(n){return Fn(n)}close(){return this.relay.close()}encrypt(n,e){var r=this;return(0,y.A)(function*(){if(!r.secret)throw new Error("Missing secret");return yield si.encrypt(r.secret,n,e)})()}decrypt(n,e){var r=this;return(0,y.A)(function*(){if(!r.secret)throw new Error("Missing secret");return yield si.decrypt(r.secret,n,e)})()}getAuthorizationUrl(n){if(!this.options.authorizationUrl)throw new Error("Missing authorizationUrl option");const e=new URL(this.options.authorizationUrl);return null!=n&&n.name&&e.searchParams.set("name",n?.name),e.searchParams.set("pubkey",this.publicKey),null!=n&&n.returnTo&&e.searchParams.set("return_to",n.returnTo),null!=n&&n.budgetRenewal&&e.searchParams.set("budget_renewal",n.budgetRenewal),null!=n&&n.expiresAt&&e.searchParams.set("expires_at",Math.floor(n.expiresAt.getTime()/1e3).toString()),null!=n&&n.maxAmount&&e.searchParams.set("max_amount",n.maxAmount.toString()),void 0!==n?.editable&&e.searchParams.set("editable",n.editable.toString()),null!=n&&n.requestMethods&&e.searchParams.set("request_methods",n.requestMethods.join(" ")),e}initNWC(n={}){n.name||(n.name=document.location.host);const e=this.getAuthorizationUrl(n),r=window.outerHeight/2+window.screenY-300,i=window.outerWidth/2+window.screenX-200;return new Promise((s,u)=>{const f=window.open(e.toString(),`${document.title} - Wallet Connect`,`height=600,width=400,top=${r},left=${i}`);if(!f)return void u(new Error("failed to execute window.open"));const g=M=>{const k=M.data;k&&"nwc:success"===k.type&&M.origin===`${e.protocol}//${e.host}`&&(s(k),clearInterval(m),window.removeEventListener("message",g),f&&f.close())},m=setInterval(()=>{f&&f.closed&&(clearInterval(m),window.removeEventListener("message",g),u(new Error("Popup closed")))},500);window.addEventListener("message",g)})}getWalletServiceSupportedMethods(){var n=this;return(0,y.A)(function*(){return console.warn("getWalletServiceSupportedMethods is deprecated. Please use getWalletServiceInfo instead."),(yield n.getWalletServiceInfo()).capabilities})()}getWalletServiceInfo(){var n=this;return(0,y.A)(function*(){var e;yield n._checkConnected();const r=yield n.relay.list([{kinds:[13194],limit:1,authors:[n.walletPubkey]}],{eoseSubTimeout:1e4});if(!r.length)throw new Error("no info event (kind 13194) returned from relay");const i=r[0].content,s=r[0].tags.find(u=>"notifications"===u[0]);return{capabilities:i.split(/[ |,]/g),notifications:(null==s||null==(e=s[1])?void 0:e.split(" "))||[]}})()}getInfo(){var n=this;return(0,y.A)(function*(){try{return yield n.executeNip47Request("get_info",{},e=>!!e.methods)}catch(e){throw console.error("Failed to request get_info",e),e}})()}getBalance(){var n=this;return(0,y.A)(function*(){try{return yield n.executeNip47Request("get_balance",{},e=>void 0!==e.balance)}catch(e){throw console.error("Failed to request get_balance",e),e}})()}payInvoice(n){var e=this;return(0,y.A)(function*(){try{return yield e.executeNip47Request("pay_invoice",n,r=>!!r.preimage)}catch(r){throw console.error("Failed to request pay_invoice",r),r}})()}payKeysend(n){var e=this;return(0,y.A)(function*(){try{return yield e.executeNip47Request("pay_keysend",n,r=>!!r.preimage)}catch(r){throw console.error("Failed to request pay_keysend",r),r}})()}signMessage(n){var e=this;return(0,y.A)(function*(){try{return yield e.executeNip47Request("sign_message",n,r=>r.message===n.message&&!!r.signature)}catch(r){throw console.error("Failed to request sign_message",r),r}})()}multiPayInvoice(n){var e=this;return(0,y.A)(function*(){try{return{invoices:yield e.executeMultiNip47Request("multi_pay_invoice",n,n.invoices.length,r=>!!r.preimage),errors:[]}}catch(r){throw console.error("Failed to request multi_pay_invoice",r),r}})()}multiPayKeysend(n){var e=this;return(0,y.A)(function*(){try{return{keysends:yield e.executeMultiNip47Request("multi_pay_keysend",n,n.keysends.length,r=>!!r.preimage),errors:[]}}catch(r){throw console.error("Failed to request multi_pay_keysend",r),r}})()}makeInvoice(n){var e=this;return(0,y.A)(function*(){try{if(!n.amount)throw new Error("No amount specified");return yield e.executeNip47Request("make_invoice",n,r=>!!r.invoice)}catch(r){throw console.error("Failed to request make_invoice",r),r}})()}lookupInvoice(n){var e=this;return(0,y.A)(function*(){try{return yield e.executeNip47Request("lookup_invoice",n,r=>!!r.invoice)}catch(r){throw console.error("Failed to request lookup_invoice",r),r}})()}listTransactions(n){var e=this;return(0,y.A)(function*(){try{return yield e.executeNip47Request("list_transactions",n,r=>!!r.transactions)}catch(r){throw console.error("Failed to request list_transactions",r),r}})()}subscribeNotifications(n,e){var r=this;return(0,y.A)(function*(){var i=r;let s,u,f,g=!0;return(0,y.A)(function*(){for(;g;){try{yield i._checkConnected(),f=i.relay.sub([{kinds:[23196],authors:[i.walletPubkey],"#p":[i.publicKey]}]),console.info("subscribed to relay"),f.on("event",function(){var m=(0,y.A)(function*(M){const k=yield i.decrypt(i.walletPubkey,M.content);let O;try{O=JSON.parse(k)}catch(L){return void console.error("Failed to parse decrypted event content",L)}O.notification?(!e||e.indexOf(O.notification_type)>-1)&&n(O):console.error("No notification in response",O)});return function(M){return m.apply(this,arguments)}}()),yield new Promise(m=>{s=()=>{m()},u=()=>{console.info("relay disconnected"),s?.()},i.relay.on("disconnect",u)}),void 0!==u&&i.relay.off("disconnect",u)}catch(m){console.error("error subscribing to notifications",m||"unknown relay error")}g&&(yield new Promise(m=>setTimeout(m,1e3)))}})(),()=>{var m;g=!1,s?.(),null==(m=f)||m.unsub()}})()}executeNip47Request(n,e,r){var i=this;return(0,y.A)(function*(){var s=i;return yield i._checkConnected(),new Promise((u,f)=>{(0,y.A)(function*(){const g={method:n,params:e},m=yield s.encrypt(s.walletPubkey,JSON.stringify(g)),M={kind:23194,created_at:Math.floor(Date.now()/1e3),tags:[["p",s.walletPubkey]],content:m,pubkey:s.publicKey},k=yield s.signEvent(M),O=s.relay.sub([{kinds:[23195],authors:[s.walletPubkey],"#e":[k.id]}]),L=setTimeout(function(){O.unsub(),f(new Ai(`reply timeout: event ${k.id}`,"INTERNAL"))},6e4);O.on("event",function(){var I=(0,y.A)(function*($){clearTimeout(L),O.unsub();const D=yield s.decrypt(s.walletPubkey,$.content);let H;try{H=JSON.parse(D)}catch{return clearTimeout(L),O.unsub(),void f(new Ti("failed to deserialize response","INTERNAL"))}var Z,V;H.result?r(H.result)?u(H.result):(clearTimeout(L),O.unsub(),f(new wr("response from NWC failed validation: "+JSON.stringify(H.result),"INTERNAL"))):(clearTimeout(L),O.unsub(),f(new Yo((null==(Z=H.error)?void 0:Z.message)||"unknown Error",(null==(V=H.error)?void 0:V.code)||"INTERNAL")))});return function($){return I.apply(this,arguments)}}());const P=setTimeout(function(){O.unsub(),f(new Si(`publish timeout: ${k.id}`,"INTERNAL"))},5e3);try{yield s.relay.publish(k),clearTimeout(P)}catch(I){clearTimeout(P),f(new Ci(`failed to publish: ${I}`,"INTERNAL"))}})()})})()}executeMultiNip47Request(n,e,r,i){var s=this;return(0,y.A)(function*(){var u=s;yield s._checkConnected();const f=[];return new Promise((g,m)=>{(0,y.A)(function*(){const M={method:n,params:e},k=yield u.encrypt(u.walletPubkey,JSON.stringify(M)),O={kind:23194,created_at:Math.floor(Date.now()/1e3),tags:[["p",u.walletPubkey]],content:k,pubkey:u.publicKey},L=yield u.signEvent(O),P=u.relay.sub([{kinds:[23195],authors:[u.walletPubkey],"#e":[L.id]}]),I=setTimeout(function(){P.unsub(),m(new Ai(`reply timeout: event ${L.id}`,"INTERNAL"))},6e4);P.on("event",function(){var D=(0,y.A)(function*(H){const Z=yield u.decrypt(u.walletPubkey,H.content);let V;try{V=JSON.parse(Z)}catch{clearTimeout(I),P.unsub(),m(new Ti("failed to deserialize response","INTERNAL"))}if(V.result){var J;if(!i(V.result))return clearTimeout(I),P.unsub(),void m(new wr("Response from NWC failed validation: "+JSON.stringify(V.result),"INTERNAL"));const Q=null==(J=H.tags.find(X=>"d"===X[0]))?void 0:J[1];if(void 0===Q)return clearTimeout(I),P.unsub(),void m(new wr("No d tag found in response event","INTERNAL"));f.push(Te({},V.result,{dTag:Q})),f.length===r&&(clearTimeout(I),P.unsub(),g(f))}else{var G,Y;clearTimeout(I),P.unsub(),m(new Ko(null==(G=V.error)?void 0:G.message,null==(Y=V.error)?void 0:Y.code))}});return function(H){return D.apply(this,arguments)}}());const $=setTimeout(function(){P.unsub(),m(new Si(`Publish timeout: ${L.id}`,"INTERNAL"))},5e3);try{yield u.relay.publish(L),clearTimeout($)}catch(D){clearTimeout($),m(new Ci(`Failed to publish: ${D}`,"INTERNAL"))}})()})})()}_checkConnected(){var n=this;return(0,y.A)(function*(){if(!n.secret)throw new Error("Missing secret key");try{yield n.relay.connect()}catch{throw console.error("failed to connect to relay",n.relayUrl),new Zo("Failed to connect to "+n.relayUrl,"OTHER")}})()}}const Ql={get_info:"getInfo",get_balance:"getBalance",make_invoice:"makeInvoice",pay_invoice:"sendPayment",pay_keysend:"payKeysend",lookup_invoice:"lookupInvoice",list_transactions:"listTransactions",multi_pay_invoice:"sendMultiPayment",multi_pay_keysend:"multiKeysend",sign_message:"signMessage"};class br{get relay(){return console.warn("relay is deprecated. Please use client.relay instead."),this.client.relay}get relayUrl(){return console.warn("relayUrl is deprecated. Please use client.relayUrl instead."),this.client.relayUrl}get walletPubkey(){return console.warn("walletPubkey is deprecated. Please use client.walletPubkey instead."),this.client.walletPubkey}get options(){return this.client.options}get secret(){return console.warn("secret is deprecated. Please use client.secret instead."),this.client.secret}static withNewSecret(n){return(n=n||{}).secret=_o(),new br(n)}constructor(n){this._enabled=!1,this.client=void 0,this.subscribers=void 0,this.client=new zn(n),this.subscribers={}}on(n,e){this.subscribers[n]=e}notify(n,e){const r=this.subscribers[n];r&&r(e)}getNostrWalletConnectUrl(n=!0){return console.warn("getNostrWalletConnectUrl is deprecated. Please use client.getNostrWalletConnectUrl instead."),this.client.getNostrWalletConnectUrl(n)}get nostrWalletConnectUrl(){return console.warn("nostrWalletConnectUrl is deprecated. Please use client.nostrWalletConnectUrl instead."),this.client.nostrWalletConnectUrl}get connected(){return console.warn("connected is deprecated. Please use client.connected instead."),this.client.connected}get publicKey(){return console.warn("publicKey is deprecated. Please use client.publicKey instead."),this.client.publicKey}getPublicKey(){return this.client.getPublicKey()}signEvent(n){return this.client.signEvent(n)}getEventHash(n){return console.warn("getEventHash is deprecated. Please use client.getEventHash instead."),this.client.getEventHash(n)}enable(){var n=this;return(0,y.A)(function*(){n._enabled=!0})()}close(){return this.client.close()}encrypt(n,e){var r=this;return(0,y.A)(function*(){return console.warn("encrypt is deprecated. Please use client.encrypt instead."),r.client.encrypt(n,e)})()}decrypt(n,e){var r=this;return(0,y.A)(function*(){return console.warn("decrypt is deprecated. Please use client.decrypt instead."),r.client.decrypt(n,e)})()}getAuthorizationUrl(n){return console.warn("getAuthorizationUrl is deprecated. Please use client.getAuthorizationUrl instead."),this.client.getAuthorizationUrl(n)}initNWC(n={}){return console.warn("initNWC is deprecated. Please use client.initNWC instead."),this.client.initNWC(n)}getInfo(){var n=this;return(0,y.A)(function*(){yield n.checkEnabled();const e=["lightning","nostr"],r="Alby JS SDK";try{const i=yield n.client.getInfo(),s={methods:i.methods.map(u=>Ql[u]),node:{alias:i.alias,pubkey:i.pubkey,color:i.color},supports:e,version:r};return n.notify("getInfo",s),s}catch(i){return console.error("Using minimal getInfo",i),{methods:["sendPayment"],node:{},supports:e,version:r}}})()}getBalance(){var n=this;return(0,y.A)(function*(){yield n.checkEnabled();const e=yield n.client.getBalance(),r={balance:Math.floor(e.balance/1e3),currency:"sats"};return n.notify("getBalance",r),r})()}sendPayment(n){var e=this;return(0,y.A)(function*(){yield e.checkEnabled();const r={preimage:(yield e.client.payInvoice({invoice:n})).preimage};return e.notify("sendPayment",r),r})()}sendPaymentAsync(n){var e=this;return(0,y.A)(function*(){return yield e.checkEnabled(),e.client.payInvoice({invoice:n}),e.notify("sendPaymentAsync",{}),{}})()}keysend(n){var e=this;return(0,y.A)(function*(){yield e.checkEnabled();const r={preimage:(yield e.client.payKeysend(Qo(n))).preimage};return e.notify("keysend",r),r})()}signMessage(n){var e=this;return(0,y.A)(function*(){yield e.checkEnabled();const r=yield e.client.signMessage({message:n}),i={message:r.message,signature:r.signature};return e.notify("keysend",i),i})()}makeInvoice(n){var e=this;return(0,y.A)(function*(){var r;yield e.checkEnabled();const i="object"==typeof n?n:void 0,s=+(null!=(r=i?.amount)?r:n);if(!s)throw new Error("No amount specified");const u={paymentRequest:(yield e.client.makeInvoice({amount:1e3*s,description:i?.defaultMemo})).invoice};return e.notify("makeInvoice",u),u})()}lookupInvoice(n){var e=this;return(0,y.A)(function*(){yield e.checkEnabled();const r=yield e.client.lookupInvoice({invoice:n.paymentRequest,payment_hash:n.paymentHash}),i={preimage:r.preimage,paymentRequest:r.invoice,paid:!!r.settled_at};return e.notify("lookupInvoice",i),i})()}listTransactions(n){var e=this;return(0,y.A)(function*(){yield e.checkEnabled();const r={transactions:(yield e.client.listTransactions(n)).transactions.map(Jl)};return e.notify("listTransactions",r),r})()}sendMultiPayment(n){var e=this;return(0,y.A)(function*(){yield e.checkEnabled();const i={payments:(yield e.client.multiPayInvoice({invoices:n.map((s,u)=>({invoice:s,id:u.toString()}))})).invoices.map(s=>{const u=n[parseInt(s.dTag)];if(!u)throw new Error("Could not find paymentRequest matching response d tag");return{paymentRequest:u,preimage:s.preimage}}),errors:[]};return e.notify("sendMultiPayment",i),i})()}multiKeysend(n){var e=this;return(0,y.A)(function*(){yield e.checkEnabled();const i={keysends:(yield e.client.multiPayKeysend({keysends:n.map((s,u)=>Te({},Qo(s),{id:u.toString()}))})).keysends.map(s=>{const u=n[parseInt(s.dTag)];if(!u)throw new Error("Could not find keysend matching response d tag");return{keysend:u,preimage:s.preimage}}),errors:[]};return e.notify("multiKeysend",i),i})()}lnurl(n){throw new Error("Method not implemented.")}request(n,e){throw new Error("Method not implemented.")}verifyMessage(n,e){throw new Error("Method not implemented.")}checkEnabled(){var n=this;return(0,y.A)(function*(){if(!n._enabled)throw new Error("please call enable() and await the promise before calling this function")})()}}function Jl(t){return Te({},t,{amount:Math.floor(t.amount/1e3),fees_paid:t.fees_paid?Math.floor(t.fees_paid/1e3):0})}function Qo(t){return{amount:1e3*+t.amount,pubkey:t.destination,tlv_records:t.customRecords?Object.entries(t.customRecords).map(n=>({type:parseInt(n[0]),value:Go((new TextEncoder).encode(n[1]))})):[]}}const ec=br;function Jo(t){const n={};return t.recipient.customKey&&t.recipient.customValue&&(n[t.recipient.customKey]=t.recipient.customValue),n[7629169]=JSON.stringify(t.boostagram),{destination:t.recipient.address,amount:t.amount,custom_records:n}}class es{constructor(n,e){this.auth=void 0,this.defaultRequestOptions=void 0,this.auth="string"==typeof n?new Vo(n):n,this.defaultRequestOptions=Te({},e,{user_agent:e?.user_agent})}accountBalance(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/balance",params:n,method:"GET"}))}accountSummary(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/user/summary",params:n,method:"GET"}))}accountInformation(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/user/me",params:n,method:"GET"}))}accountValue4Value(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/user/value4value",params:n,method:"GET"}))}incomingInvoices(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/invoices/incoming",params:n,method:"GET"}))}outgoingInvoices(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/invoices/outgoing",params:n,method:"GET"}))}invoices(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/invoices",params:n,method:"GET"}))}getInvoice(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:`/invoices/${n}`,method:"GET"}))}decodeInvoice(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:`/decode/bolt11/${n}`,method:"GET"}))}createInvoice(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/invoices",request_body:n,method:"POST"}))}keysend(n,e){let r,i;return Array.isArray(n)?(r="/payments/keysend/multi",i={keysends:n.map(s=>Te({},s,{custom_records:s.customRecords}))}):(r="/payments/keysend",i=Te({},n,{custom_records:n.customRecords})),wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:r,request_body:i,method:"POST"}))}sendPayment(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/payments/bolt11",request_body:n,method:"POST"}))}sendBoostagram(n,e){let r,i;return Array.isArray(n)?(r="/payments/keysend/multi",i={keysends:n.map(s=>Jo(s))}):(r="/payments/keysend",i=Jo(n)),wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:r,request_body:i,method:"POST"}))}sendToAlbyAccount(n,e){return console.warn("sendToAlbyAccount is deprecated. Please use sendBoostagramToAlbyAccount instead."),this.sendBoostagramToAlbyAccount(n,e)}sendBoostagramToAlbyAccount(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/payments/keysend",request_body:{destination:"030a58b8653d32b99200a2334cfe913e51dc7d155aa0116c176657a4f1722677a3",custom_records:{696969:n.account},amount:n.amount,memo:n.memo},method:"POST"}))}createWebhookEndpoint(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/webhook_endpoints",request_body:n,method:"POST"}))}deleteWebhookEndpoint(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:`/webhook_endpoints/${n}`,method:"DELETE"}))}getSwapInfo(n){return wt(Te({auth:this.auth},this.defaultRequestOptions,n,{endpoint:"/swaps/info",method:"GET"}))}createSwap(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/swaps",method:"POST",request_body:n}))}}var _r={__proto__:null,NostrWebLNProvider:br,NWC:ec,OauthWeblnProvider:class{constructor(t){this.client=void 0,this.auth=void 0,this.oauth=void 0,this.subscribers=void 0,this.isExecuting=void 0,this.auth=t.auth,this.client=new es(t.auth),this.oauth=!0,this.subscribers={},this.isExecuting=!1}on(t,n){this.subscribers[t]=n}notify(t,n){const e=this.subscribers[t];e&&e(n)}enable(){var t=this;return(0,y.A)(function*(){var n;if(!t.isExecuting){if(null!=(n=t.auth.token)&&n.access_token)return{enabled:!0};if(typeof window>"u"||void 0===window.document)throw new Error("Missing access token");try{t.isExecuting=!0,yield t.openAuthorization()}finally{t.isExecuting=!1}}})()}sendPayment(t){var n=this;return(0,y.A)(function*(){if(!n.isExecuting)try{n.isExecuting=!0;const e=yield n.client.sendPayment({invoice:t});return n.notify("sendPayment",e),{preimage:e.payment_preimage}}catch(e){let r="Unknown Error";throw e instanceof Error&&(r=e.message),new Error(r)}finally{n.isExecuting=!1}})()}keysend(t){var n=this;return(0,y.A)(function*(){if(!n.isExecuting)try{n.isExecuting=!0;const e=yield n.client.keysend(t);return n.notify("keysend",e),{preimage:e.payment_preimage}}catch(e){let r="Unknown Error";throw e instanceof Error&&(r=e.message),new Error(r)}finally{n.isExecuting=!1}})()}getInfo(){return(0,y.A)(function*(){return{alias:"Alby"}})()}makeInvoice(t){var n=this;return(0,y.A)(function*(){if(!n.isExecuting)try{n.isExecuting=!0;const e=yield n.client.createInvoice({amount:parseInt(t.amount.toString()),description:t.defaultMemo});return n.notify("makeInvoice",e),{paymentRequest:e.payment_request}}catch(e){let r="Unknown Error";throw e instanceof Error&&(r=e.message),new Error(r)}finally{n.isExecuting=!1}})()}openAuthorization(){var t=this;return(0,y.A)(function*(){var n=t;const e=window.outerHeight/2+window.screenY-350,r=window.outerWidth/2+window.screenX-300,i=yield t.auth.generateAuthURL({code_challenge_method:"S256"});return new Promise((s,u)=>{const f=window.open(i,`${document.title} - WebLN enable`,`height=700,width=600,top=${e},left=${r}`);let g=!1;window.addEventListener("message",function(){var m=(0,y.A)(function*(M){const k=M.data;if(k&&"alby:oauth:success"===k.type&&M.origin===`${document.location.protocol}//${document.location.host}`&&!g){g=!0,console.info("Processing OAuth code response");const O=k.payload.code;try{yield n.auth.requestAccessToken(O),n.client=new es(n.auth),f&&f.close(),n.notify("enable"),s({enabled:!0})}catch(L){console.error(L),u({enabled:!1})}}});return function(M){return m.apply(this,arguments)}}())})})()}}},Ii=S(5416);class tc{constructor(n,e){this._document=e;const r=this._textarea=this._document.createElement("textarea"),i=r.style;i.position="fixed",i.top=i.opacity="0",i.left="-999em",r.setAttribute("aria-hidden","true"),r.value=n,r.readOnly=!0,(this._document.fullscreenElement||this._document.body).appendChild(r)}copy(){const n=this._textarea;let e=!1;try{if(n){const r=this._document.activeElement;n.select(),n.setSelectionRange(0,n.value.length),e=this._document.execCommand("copy"),r&&r.focus()}}catch{}return e}destroy(){const n=this._textarea;n&&(n.remove(),this._textarea=void 0)}}let Ri=(()=>{class t{constructor(e){this._document=e}copy(e){const r=this.beginCopy(e),i=r.copy();return r.destroy(),i}beginCopy(e){return new tc(e,this._document)}static{this.\u0275fac=function(r){return new(r||t)(o.KVO(h.qQ))}}static{this.\u0275prov=o.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function nc(t,n){if(1&t){const e=o.RV6();o.j41(0,"button",10),o.bIt("click",function(){const i=o.eBV(e).$implicit,s=o.XpG(2);return o.Njj(s.invoiceAmount=i.value)}),o.j41(1,"mat-icon"),o.EFF(2),o.k0s(),o.j41(3,"span"),o.EFF(4),o.k0s()()}if(2&t){const e=n.$implicit;o.R7$(2),o.JRh(e.icon),o.R7$(2),o.JRh(e.label)}}function rc(t,n){if(1&t){const e=o.RV6();o.j41(0,"mat-dialog-content")(1,"div",4),o.DNE(2,nc,5,2,"button",5),o.k0s(),o.nrm(3,"mat-divider"),o.j41(4,"mat-form-field",6)(5,"mat-label"),o.EFF(6,"Zap Amount"),o.k0s(),o.j41(7,"input",7),o.mxI("ngModelChange",function(i){o.eBV(e);const s=o.XpG();return o.DH7(s.invoiceAmount,i)||(s.invoiceAmount=i),o.Njj(i)}),o.k0s()(),o.j41(8,"mat-dialog-actions",8)(9,"button",9),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.generateInvoice())}),o.EFF(10," Generate Invoice "),o.k0s()()()}if(2&t){const e=o.XpG();o.R7$(2),o.Y8G("ngForOf",e.zapButtons),o.R7$(5),o.R50("ngModel",e.invoiceAmount)}}function ic(t,n){if(1&t){const e=o.RV6();o.j41(0,"div",12)(1,"span"),o.EFF(2),o.k0s(),o.nrm(3,"mat-divider")(4,"qrcode",13),o.j41(5,"mat-dialog-actions",14)(6,"button",15),o.bIt("click",function(){o.eBV(e);const i=o.XpG(2);return o.Njj(i.copyInvoice())}),o.nrm(7,"mat-icon",16),o.k0s()()()}if(2&t){const e=o.XpG(2);o.R7$(2),o.SpI("Scan with phone to pay (",e.invoiceAmount," sats)"),o.R7$(2),o.Y8G("qrdata",e.lightningInvoice)("matTooltip","Lightning Invoice")("errorCorrectionLevel","M"),o.R7$(2),o.Y8G("matTooltip","Copy Invoice"),o.R7$(),o.Y8G("svgIcon","heroicons_outline:clipboard-document")}}function oc(t,n){if(1&t&&(o.j41(0,"mat-dialog-content"),o.DNE(1,ic,8,6,"div",11),o.k0s()),2&t){const e=o.XpG();o.R7$(),o.Y8G("ngIf",e.displayQRCode)}}let sc=(()=>{class t{constructor(e,r,i){this._dialogRef=e,this._snackBar=r,this._clipboard=i,this.invoiceAmount="",this.lightningInvoice="",this.displayQRCode=!1,this.zapButtons=[{icon:"thumb_up",label:"50",value:50},{icon:"favorite",label:"100",value:100},{icon:"emoji_emotions",label:"500",value:500},{icon:"star",label:"1k",value:1e3},{icon:"celebration",label:"5k",value:5e3},{icon:"rocket",label:"10k",value:1e4},{icon:"local_fire_department",label:"100k",value:1e5},{icon:"flash_on",label:"500k",value:5e5},{icon:"diamond",label:"1M",value:1e6}]}generateInvoice(){var e=this;return(0,y.A)(function*(){if(!e.invoiceAmount||Number(e.invoiceAmount)<=0)e.openSnackBar("Please enter a valid amount","dismiss");else try{e.nwc=new _r.NostrWebLNProvider({nostrWalletConnectUrl:yield e.loadNWCUrl()}),yield e.nwc.enable();const r=yield e.nwc.makeInvoice({amount:Number(e.invoiceAmount)});e.lightningInvoice=r.paymentRequest,e.showQRCode()}catch(r){console.error("Error generating invoice:",r),e.openSnackBar("Failed to generate invoice","dismiss")}})()}loadNWCUrl(){return(0,y.A)(function*(){try{const e=_r.NostrWebLNProvider.withNewSecret();return yield e.initNWC({name:"Angor Hub"}),e.getNostrWalletConnectUrl()}catch(e){throw console.error("Error initializing NWC:",e),new Error("Failed to initialize NWC provider")}})()}showQRCode(){this.displayQRCode=!this.displayQRCode}copyInvoice(){this.lightningInvoice?(this._clipboard.copy(this.lightningInvoice),this.openSnackBar("Invoice copied","dismiss")):this.openSnackBar("No invoice available to copy","dismiss")}openSnackBar(e,r){this._snackBar.open(e,r,{duration:1300})}closeDialog(){this._dialogRef.close()}static{this.\u0275fac=function(r){return new(r||t)(o.rXU(Pe.CP),o.rXU(Ii.UG),o.rXU(Ri))}}static{this.\u0275cmp=o.VBU({type:t,selectors:[["app-receive-dialog"]],standalone:!0,features:[o.aNF],decls:7,vars:4,consts:[[1,"absolute","right-0","top-0","pr-4","pt-4"],["mat-icon-button","",3,"matDialogClose"],[1,"text-secondary",3,"svgIcon"],[4,"ngIf"],[1,"preset-buttons"],["mat-mini-fab","","color","primary",3,"click",4,"ngFor","ngForOf"],["appearance","outline",1,"sats-input"],["matInput","","placeholder","e.g., 100","type","number",3,"ngModelChange","ngModel"],["align","end"],["mat-raised-button","","color","primary",3,"click"],["mat-mini-fab","","color","primary",3,"click"],["class","qrcode",4,"ngIf"],[1,"qrcode"],[1,"qrcode-image",3,"qrdata","matTooltip","errorCorrectionLevel"],["align","center"],["mat-icon-button","",3,"click","matTooltip"],[3,"svgIcon"]],template:function(r,i){1&r&&(o.j41(0,"div",0)(1,"button",1),o.nrm(2,"mat-icon",2),o.k0s()(),o.j41(3,"h2"),o.EFF(4,"\u26a1 Receive Zap"),o.k0s(),o.DNE(5,rc,11,2,"mat-dialog-content",3)(6,oc,2,1,"mat-dialog-content",3)),2&r&&(o.R7$(),o.Y8G("matDialogClose",void 0),o.R7$(),o.Y8G("svgIcon","heroicons_outline:x-mark"),o.R7$(3),o.Y8G("ngIf",!i.displayQRCode),o.R7$(),o.Y8G("ngIf",i.displayQRCode))},dependencies:[Ve.vg,B.Hl,B.$z,B.iY,B.$0,oe.m_,oe.An,T.YN,T.me,T.Q0,T.BC,T.vS,q.nJ,q.rl,T.X1,h.MD,h.Sq,h.bT,kn.Ve,q.RG,le.fS,le.fg,Pe.Yi,Pe.E7,we,de,N.q,F.oV,Pe.tx],styles:[".preset-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;justify-items:center;margin-bottom:20px}.preset-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px;font-weight:700;width:70px;height:60px;display:flex;flex-direction:column;align-items:center;justify-content:center;max-height:60px!important}.sats-input[_ngcontent-%COMP%]{margin-top:20px;width:100%}.lightning-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;margin:10px 0}.qrcode[_ngcontent-%COMP%]{text-align:center}.qrcode-image[_ngcontent-%COMP%]{width:100%!important}"]})}}return t})();for(var ts=S(1146),ac=S(3838),Yt=S(917),ns={bech32:"bc",pubKeyHash:0,scriptHash:5,validWitnessVersions:[0]},rs={bech32:"tb",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},is={bech32:"tbs",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},os={bech32:"bcrt",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},ss={bech32:"sb",pubKeyHash:63,scriptHash:123,validWitnessVersions:[0]},Wn=["option_data_loss_protect","initial_routing_sync","option_upfront_shutdown_script","gossip_queries","var_onion_optin","gossip_queries_ex","option_static_remotekey","payment_secret","basic_mpp","option_support_large_channel"],lc={m:new Yt.BN(1e3,10),u:new Yt.BN(1e6,10),n:new Yt.BN(1e9,10),p:new Yt.BN(1e12,10)},cc=new Yt.BN("2100000000000000000",10),as=new Yt.BN(1e11,10),Bi={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27},ls={},Er=0,Ni=Object.keys(Bi);Er<Ni.length;Er++){var uc=Ni[Er],fc=Bi[Ni[Er]].toString();ls[fc]=uc}var hc={1:function(t){return on(t,!0)},16:function(t){return on(t,!0)},13:function(t){return on(t,!0).toString("utf8")},19:function(t){return on(t,!0)},23:function(t){return on(t,!0)},27:function(t){return on(t,!0)},6:xr,24:xr,3:function pc(t){for(var e,r,i,s,u,n=[],f=on(t,!0);f.length>0;)e=f.slice(0,33).toString("hex"),r=f.slice(33,41).toString("hex"),i=parseInt(f.slice(41,45).toString("hex"),16),s=parseInt(f.slice(45,49).toString("hex"),16),u=parseInt(f.slice(49,51).toString("hex"),16),f=f.slice(51),n.push({pubkey:e,short_channel_id:r,fee_base_msat:i,fee_proportional_millionths:s,cltv_expiry_delta:u});return n},5:function mc(t){for(var n=t.slice().reverse().map(function(i){return[!!(1&i),!!(2&i),!!(4&i),!!(8&i),!!(16&i)]}).reduce(function(i,s){return i.concat(s)},[]);n.length<2*Wn.length;)n.push(!1);var e={extra_bits:{}};if(Wn.forEach(function(i,s){var u;n[2*s]?u="required":n[2*s+1]&&(u="supported"),e[i]=u}),n.length>2*Wn.length){var r=n.slice(2*Wn.length);e.extra_bits={start_bit:2*Wn.length,bits:r,required:r.reduce(function(i,s,u){return u%2!=0?i||!1:i||s},!1)}}return e}};function dc(t){return function(n){return{tagCode:parseInt(t),words:ts.encode("unknown",n,Number.MAX_SAFE_INTEGER)}}}function xr(t){return t.reverse().reduce(function(n,e,r){return n+e*Math.pow(32,r)},0)}function on(t,n){var e=ac.hp.from(function gc(t,n,e){for(var r=0,i=0,s=(1<<e)-1,u=[],f=0;f<t.length;++f)for(r=r<<n|t[f],i+=n;i>=e;)u.push(r>>(i-=e)&s);return i>0&&u.push(r<<e-i&s),u}(t,5,8));return n&&5*t.length%8!=0&&(e=e.slice(0,-1)),e}var Ui=S(7673),Pi=S(9437),wc=S(1626);let cs=(()=>{class t{constructor(e){this.http=e}getLightning(e){return this.http.get(e).pipe((0,Pi.W)(r=>(console.error("Failed to fetch Lightning response:",r),(0,Ui.of)({status:"Failed"}))))}getLightningInvoice(e,r){return this.http.get(`${e}?amount=${r}`).pipe((0,Pi.W)(s=>(console.error("Failed to fetch Lightning invoice:",s),(0,Ui.of)({pr:"",status:"Failed"}))))}getLightningAddress(e){try{const[r,i]=e.split("@");return`https://${i}/.well-known/lnurlp/${r}`}catch{return console.error("Invalid Lightning address format:",e),""}}sendZapRequest(e,r,i,s){const u=encodeURIComponent(JSON.stringify(r));return this.http.get(`${e}?amount=${i}&nostr=${u}&lnurl=${s}`).pipe((0,Pi.W)(g=>(console.error("Failed to send zap request:",g),(0,Ui.of)({pr:"",status:"Failed"}))))}login(){return(0,y.A)(function*(){try{return window.webln&&!window.webln.isEnabled()&&(yield window.webln.enable()),!0}catch(e){return console.error("WebLN login failed:",e),!1}})()}hasWebln(){return!!window.webln}sendPayment(e){var r=this;return(0,y.A)(function*(){try{return r.hasWebln()?yield window.webln.sendPayment(e):(console.error("WebLN is not available"),null)}catch(i){throw console.error("Payment failed:",i),i}})()}payInvoice(e){var r=this;return(0,y.A)(function*(){if((yield r.login())&&r.hasWebln())try{return!!(yield r.sendPayment(e))}catch(s){return console.error("Failed to pay invoice:",s),!1}return console.error("WebLN not available or login failed"),!1})()}static{this.\u0275fac=function(r){return new(r||t)(o.KVO(wc.Qq))}}static{this.\u0275prov=o.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function bc(t,n){if(1&t){const e=o.RV6();o.j41(0,"button",10),o.bIt("click",function(){const i=o.eBV(e).$implicit,s=o.XpG(2);return o.Njj(s.sats=i.value)}),o.j41(1,"mat-icon"),o.EFF(2),o.k0s(),o.j41(3,"span"),o.EFF(4),o.k0s()()}if(2&t){const e=n.$implicit;o.R7$(2),o.JRh(e.icon),o.R7$(2),o.JRh(e.label)}}function _c(t,n){if(1&t){const e=o.RV6();o.j41(0,"mat-dialog-content")(1,"div",4),o.DNE(2,bc,5,2,"button",5),o.k0s(),o.nrm(3,"mat-divider"),o.j41(4,"mat-form-field",6)(5,"mat-label"),o.EFF(6,"Zap Amount"),o.k0s(),o.j41(7,"input",7),o.mxI("ngModelChange",function(i){o.eBV(e);const s=o.XpG();return o.DH7(s.sats,i)||(s.sats=i),o.Njj(i)}),o.k0s()(),o.j41(8,"mat-dialog-actions",8)(9,"button",9),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.sendZap())}),o.EFF(10," Create invoice "),o.k0s()()()}if(2&t){const e=o.XpG();o.R7$(2),o.Y8G("ngForOf",e.zapButtons),o.R7$(5),o.R50("ngModel",e.sats)}}function Ec(t,n){if(1&t&&(o.j41(0,"div",16)(1,"span"),o.EFF(2),o.k0s(),o.nrm(3,"mat-divider")(4,"qrcode",17),o.k0s()),2&t){const e=o.XpG(2);o.R7$(2),o.SpI("Scan with phone to pay (",e.invoiceAmount," sats)"),o.R7$(2),o.Y8G("qrdata",e.lightningInvoice)("matTooltip","Lightning Invoice")("errorCorrectionLevel","M")}}function xc(t,n){if(1&t){const e=o.RV6();o.j41(0,"mat-dialog-content"),o.DNE(1,Ec,5,4,"div",11),o.j41(2,"mat-dialog-actions",12)(3,"button",13),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.copyInvoice())}),o.nrm(4,"mat-icon",14),o.k0s(),o.j41(5,"button",13),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.payInvoice())}),o.nrm(6,"mat-icon",15),o.k0s()()()}if(2&t){const e=o.XpG();o.R7$(),o.Y8G("ngIf",e.displayQRCode),o.R7$(2),o.Y8G("matTooltip","Copy Invoice"),o.R7$(),o.Y8G("svgIcon","heroicons_outline:clipboard-document"),o.R7$(),o.Y8G("matTooltip","Pay Invoice"),o.R7$(),o.Y8G("svgIcon","feather:zap")}}let Mc=(()=>{class t{constructor(e,r,i,s,u){this._dialogRef=e,this._metadata=r,this._lightning=i,this._snackBar=s,this._clipboard=u,this.lightningInvoice="",this.showInvoiceSection=!1,this.displayQRCode=!1,this.invoiceAmount="?",this.zapButtons=[{icon:"thumb_up",label:"50",value:50},{icon:"favorite",label:"100",value:100},{icon:"emoji_emotions",label:"500",value:500},{icon:"star",label:"1k",value:1e3},{icon:"celebration",label:"5k",value:5e3},{icon:"rocket",label:"10k",value:1e4},{icon:"local_fire_department",label:"100k",value:1e5},{icon:"flash_on",label:"500k",value:5e5},{icon:"diamond",label:"1M",value:1e6}],this.getLightningInfo()}getLightningInfo(){let e="";if(this._metadata?.lud06){const{words:r}=ne.I.decode(this._metadata.lud06,5e3),i=new Uint8Array(ne.I.fromWords(r));e=(new TextDecoder).decode(Uint8Array.from(i))}else if(this._metadata?.lud16?.toLowerCase().startsWith("lnurl")){const{words:r}=ne.I.decode(this._metadata.lud16,5e3),i=new Uint8Array(ne.I.fromWords(r));e=(new TextDecoder).decode(Uint8Array.from(i))}else this._metadata?.lud16&&(e=this._lightning.getLightningAddress(this._metadata.lud16));""!==e?this._lightning.getLightning(e).subscribe(r=>{this.lightningResponse=r,"Failed"===this.lightningResponse.status?this.openSnackBar("Failed to lookup lightning address","dismiss"):this.lightningResponse.callback?this.showInvoiceSection=!0:this.openSnackBar("Couldn't find user's lightning address","dismiss")}):this.openSnackBar("No lightning address found","dismiss")}getLightningInvoice(e){var r=this;this.lightningResponse&&this.lightningResponse.callback&&this._lightning.getLightningInvoice(this.lightningResponse.callback,e).subscribe(function(){var i=(0,y.A)(function*(s){r.lightningInvoice=s.pr,r.setInvoiceAmount(r.lightningInvoice),r.showInvoiceSection=!0,r.showQRCode()});return function(s){return i.apply(this,arguments)}}())}setInvoiceAmount(e){if(e){const i=function vc(t,n){if("string"!=typeof t)throw new Error("Lightning Payment Request must be string");if("ln"!==t.slice(0,2).toLowerCase())throw new Error("Not a proper lightning payment request");var e=[],r=ts.decode(t,Number.MAX_SAFE_INTEGER);t=t.toLowerCase();var i=r.prefix,s=r.words,u=t.slice(i.length+1),f=s.slice(-104);s=s.slice(0,-104);var g=i.match(/^ln(\S+?)(\d*)([a-zA-Z]?)$/);if(g&&!g[2]&&(g=i.match(/^ln(\S+)$/)),!g)throw new Error("Not a proper lightning payment request");e.push({name:"lightning_network",letters:"ln"});var M,m=g[1];if(n){if(void 0===n.bech32||void 0===n.pubKeyHash||void 0===n.scriptHash||!Array.isArray(n.validWitnessVersions))throw new Error("Invalid network");M=n}else switch(m){case ns.bech32:M=ns;break;case rs.bech32:M=rs;break;case is.bech32:M=is;break;case os.bech32:M=os;break;case ss.bech32:M=ss}if(!M||M.bech32!==m)throw new Error("Unknown coin bech32 prefix");e.push({name:"coin_network",letters:m,value:M});var O,k=g[2];k?(O=function yc(t,n){var e,r;if(t.slice(-1).match(/^[munp]$/))e=t.slice(-1),r=t.slice(0,-1);else{if(t.slice(-1).match(/^[^munp0-9]$/))throw new Error("Not a valid multiplier for the amount");r=t}if(!r.match(/^\d+$/))throw new Error("Not a valid human readable amount");var i=new Yt.BN(r,10),s=e?i.mul(as).div(lc[e]):i.mul(as);if("p"===e&&!i.mod(new Yt.BN(10,10)).eq(new Yt.BN(0,10))||s.gt(cc))throw new Error("Amount is outside of valid range");return n?s.toString():s}(k+g[3],!0),e.push({name:"amount",letters:g[2]+g[3],value:O})):O=null,e.push({name:"separator",letters:"1"});var I,$,D,H,P=xr(s.slice(0,7));for(s=s.slice(7),e.push({name:"timestamp",letters:u.slice(0,7),value:P}),u=u.slice(7);s.length>0;){var Z=s[0].toString();I=ls[Z]||"unknown_tag",$=hc[Z]||dc(Z),D=xr((s=s.slice(1)).slice(0,2)),H=(s=s.slice(2)).slice(0,D),s=s.slice(D),e.push({name:I,tag:u[0],letters:u.slice(0,3+D),value:$(H)}),u=u.slice(3+D)}e.push({name:"signature",letters:u.slice(0,104),value:on(f,!0)}),u=u.slice(104),e.push({name:"checksum",letters:u});var V={paymentRequest:t,sections:e,get expiry(){var Q=e.find(function(X){return"expiry"===X.name});if(Q)return Y("timestamp")+Q.value},get route_hints(){return e.filter(function(Q){return"route_hint"===Q.name}).map(function(Q){return Q.value})}},J=function(Q){if("route_hint"===Q)return"continue";Object.defineProperty(V,Q,{get:function(){return Y(Q)}})};for(var G in Bi)J(G);return V;function Y(Q){var X=e.find(function(pe){return pe.name===Q});return X?X.value:void 0}}(e).sections.find(s=>"amount"===s.name);i&&(this.invoiceAmount=String(Number(i.value)/1e3))}}showQRCode(){this.displayQRCode=!this.displayQRCode}sendZap(){this.getLightningInvoice(String(1e3*Number(this.sats)))}payInvoice(){var e=this;return(0,y.A)(function*(){if(!e.lightningInvoice)return void console.error("Lightning invoice is not set");const r=new _r.NostrWebLNProvider({nostrWalletConnectUrl:yield e.loadNWCUrl()});r.enable().then(()=>r.sendPayment(e.lightningInvoice)).then(i=>{i&&i.preimage?(console.log(`Payment successful, preimage: ${i.preimage}`),e.openSnackBar("Zapped!","dismiss"),e._dialogRef.close()):e.listenForPaymentStatus(r)}).catch(i=>{console.error("Payment failed:",i),e.openSnackBar("Failed to pay invoice","dismiss"),e.listenForPaymentStatus(r)})})()}loadNWCUrl(){const e=_r.NostrWebLNProvider.withNewSecret();return e.initNWC({name:"Angor Hub"}).then(()=>e.getNostrWalletConnectUrl()).catch(r=>{throw console.error("Error initializing NWC:",r),r})}listenForPaymentStatus(e){const r=()=>{e.sendPayment(this.lightningInvoice).then(i=>{i&&i.preimage?(console.log("Payment confirmed, preimage:",i.preimage),this.openSnackBar("Payment confirmed!","dismiss"),this._dialogRef.close()):setTimeout(r,5e3)}).catch(i=>{console.error("Error checking payment status:",i),setTimeout(r,5e3)})};r()}copyInvoice(){this.lightningInvoice?(this._clipboard.copy(this.lightningInvoice),this.openSnackBar("Invoice copied","dismiss")):this.openSnackBar("No invoice available to copy","dismiss")}openSnackBar(e,r){this._snackBar.open(e,r,{duration:1300})}closeDialog(){this._dialogRef.close()}static{this.\u0275fac=function(r){return new(r||t)(o.rXU(Pe.CP),o.rXU(Pe.Vh),o.rXU(cs),o.rXU(Ii.UG),o.rXU(Ri))}}static{this.\u0275cmp=o.VBU({type:t,selectors:[["app-send-dialog"]],standalone:!0,features:[o.aNF],decls:7,vars:4,consts:[[1,"absolute","right-0","top-0","pr-4","pt-4"],["mat-icon-button","",3,"matDialogClose"],[1,"text-secondary",3,"svgIcon"],[4,"ngIf"],[1,"preset-buttons"],["mat-mini-fab","","color","primary",3,"click",4,"ngFor","ngForOf"],["appearance","outline",1,"sats-input"],["matInput","","placeholder","e.g., 100","type","number",3,"ngModelChange","ngModel"],["align","end"],["mat-raised-button","","color","primary",3,"click"],["mat-mini-fab","","color","primary",3,"click"],["class","qrcode",4,"ngIf"],["align","center"],["mat-icon-button","",3,"click","matTooltip"],[3,"svgIcon"],["color","#f79318",3,"svgIcon"],[1,"qrcode"],[1,"qrcode-image",3,"qrdata","matTooltip","errorCorrectionLevel"]],template:function(r,i){1&r&&(o.j41(0,"div",0)(1,"button",1),o.nrm(2,"mat-icon",2),o.k0s()(),o.j41(3,"h1"),o.EFF(4,"\u26a1 Send Zap"),o.k0s(),o.DNE(5,_c,11,2,"mat-dialog-content",3)(6,xc,7,5,"mat-dialog-content",3)),2&r&&(o.R7$(),o.Y8G("matDialogClose",void 0),o.R7$(),o.Y8G("svgIcon","heroicons_outline:x-mark"),o.R7$(3),o.Y8G("ngIf",!i.showInvoiceSection||!i.lightningInvoice),o.R7$(),o.Y8G("ngIf",i.showInvoiceSection&&i.lightningInvoice))},dependencies:[Ve.vg,B.Hl,B.$z,B.iY,B.$0,oe.m_,oe.An,T.YN,T.me,T.Q0,T.BC,T.vS,q.nJ,q.rl,T.X1,h.MD,h.Sq,h.bT,kn.Ve,q.RG,le.fS,le.fg,Pe.Yi,Pe.E7,we,de,N.q,F.oV,Pe.tx],styles:[".preset-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;justify-items:center;margin-bottom:20px}.preset-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px;font-weight:700;width:70px;height:60px;display:flex;flex-direction:column;align-items:center;justify-content:center;max-height:60px!important}.sats-input[_ngcontent-%COMP%]{margin-top:20px;width:100%}.lightning-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;margin:10px 0}.qrcode[_ngcontent-%COMP%]{text-align:center}.qrcode-image[_ngcontent-%COMP%]{width:100%!important}"]})}}return t})();var Li=S(4930),kc=S(7291),us=S(6231),fs=S(7343);let Sc=(()=>{class t{constructor(e,r,i){this.relayService=e,this.signerService=r,this.queueService=i,this.followersSubject=new Ge.B,this.followingSubject=new Ge.B}getFollowersObservable(){return this.followersSubject.asObservable()}getFollowingObservable(){return this.followingSubject.asObservable()}getFollowers(e){var r=this;return(0,y.A)(function*(){const i=[{kinds:[3],"#p":[e]}],s=[];return new Promise((u,f)=>{r.queueService.addRequestToQueue(i).subscribe({next:m=>{s.push(m),r.followersSubject.next(m)},error:m=>{console.error("Error fetching followers:",m),f(m)},complete:()=>{u(s)}})})})()}getFollowing(e){var r=this;return(0,y.A)(function*(){const i=[{kinds:[3],authors:[e]}],s=[];return new Promise((u,f)=>{r.queueService.addRequestToQueue(i).subscribe({next:m=>{m.tags.filter(k=>"p"===k[0]).forEach(k=>{s.push(k[1]),r.followingSubject.next(m)})},error:m=>{console.error("Error fetching following:",m),f(m)},complete:()=>{u(s)}})})})()}follow(e){var r=this;return(0,y.A)(function*(){const i=r.getFollowingList();if(i.includes(e))return void console.log(`Already following ${e}`);const s=[...i,e];r.setFollowingList(s);const u=r.signerService.getUnsignedEvent(3,s.map(f=>["p",f]),"");yield r.publishSignedEvent(u),console.log(`Now following ${e}`)})()}unfollow(e){var r=this;return(0,y.A)(function*(){const i=r.getFollowingList();if(!i.includes(e))return void console.log(`Not following ${e}`);const s=i.filter(f=>f!==e);r.setFollowingList(s);const u=r.signerService.getUnsignedEvent(3,s.map(f=>["p",f]),"");yield r.publishSignedEvent(u),console.log(`Unfollowed ${e}`)})()}publishSignedEvent(e){var r=this;return(0,y.A)(function*(){let s;if(yield r.signerService.isUsingExtension())s=yield r.signerService.signEventWithExtension(e);else{const u=yield r.signerService.getDecryptedSecretKey();if(!u)throw new Error("Secret key is missing. Unable to sign event.");s=r.signerService.getSignedEvent(e,u)}r.relayService.publishEventToWriteRelays(s)})()}getFollowingListAsTags(){const e=this.getFollowingList(),r=[],i=this.relayService.getConnectedRelays();return e.forEach(s=>{i.forEach(u=>{r.push(["p",s,u,localStorage.getItem(`${s}`)||""])})}),r}setFollowingListFromTags(e){const r=[];e.forEach(i=>{r.push(i[1])}),this.setFollowingList(r)}setFollowingList(e){const i=Array.from(new Set(e)).filter(s=>s).join(",");localStorage.setItem("following",i)}getFollowingList(){const e=localStorage.getItem("following");return null===e||""===e?[]:e.split(",").filter(i=>/[a-f0-9]{64}/.test(i))}static{this.\u0275fac=function(r){return new(r||t)(o.KVO(us.b),o.KVO(Li.A),o.KVO(fs.F))}}static{this.\u0275prov=o.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Ac=S(881),Cc=S(9979),Mr=S(5766);class Tc{constructor(n,e,r,i,s,u,f=[]){this.username="",this.picture="/images/avatars/avatar-placeholder.png",this.replyCount=0,this.likeCount=0,this.zapCount=0,this.repostCount=0,this.likedByMe=!1,this.replies=[],this.likers=[],this.reposters=[],this.zappers=[],this.relatedEventIds=[],this.rootEventId="",this.replyToEventId="",this.mentions=[],this.hashtags=[],this.repostedByMe=!1,this.tags=[],this.isAReply=!1,this.kind=e,this.pubkey=r,this.content=i,this.noteId=s,this.createdAt=u,this.date=new Date(1e3*this.createdAt),this.fromNow=this.calculateTimeFromNow(this.date),this.tags=f,this.id=n}calculateTimeFromNow(n){const r=Math.floor(((new Date).getTime()-n.getTime())/1e3);return r<60?`${r} seconds ago`:r<3600?`${Math.floor(r/60)} minutes ago`:r<86400?`${Math.floor(r/3600)} hours ago`:r<2592e3?`${Math.floor(r/86400)} days ago`:r<31536e3?`${Math.floor(r/2592e3)} months ago`:`${Math.floor(r/31536e3)} years ago`}}var kr=S(719),Oi=S(4412),Ic=S(3386),Rc=S(2827);let Bc=(()=>{class t{constructor(e,r,i,s){this.relayService=e,this.signerService=r,this.metadataService=i,this.queueService=s,this.eventsSubject=new Oi.t([]),this.isLoading=new Oi.t(!1),this.lastLoadedEventTime=null,this.pageSize=10,this.noMoreEvents=new Oi.t(!1),this.seenEventIds=new Set,this.likesMap=new Map,this.repliesMap=new Map,this.zapsMap=new Map,this.repostsMap=new Map,this.hasLikedMap=new Map,this.hasRepostedMap=new Map,this.jobQueue=[],this.isProcessingQueue=!1,this.myLikedNoteIds=[]}subscribeToEvents(e){var r=this;return(0,y.A)(function*(){yield r.relayService.ensureConnectedRelays();const i=r.relayService.getConnectedRelays().slice(0,3);if(!i||0===i.length)return void console.error("No connected relays available.");const s=[{kinds:[1],authors:e,limit:r.pageSize},{"#p":e,limit:1}];r.relayService.getPool().subscribeMany(i,s,{onevent:f=>{r.isReply(f)||r.handleNewOrUpdatedEvent(f);const g=r.getParentEventId(f);switch(g&&r.enqueueJob(g),f.kind){case 7:case 9735:case 6:r.enqueueJob(g)}},oneose:()=>{}})})()}getParentEventId(e){const r=e.tags.find(i=>"e"===i[0]);return r?r[1]:null}handleNewOrUpdatedEvent(e){var r=this;return(0,y.A)(function*(){switch(e.kind){case 1:if(!r.seenEventIds.has(e.id)){r.seenEventIds.add(e.id);const i=yield r.createNewEvent(e);r.eventsSubject.next([i]),r.updateEventInSubject(e.id)}break;case 7:r.handleLikeEvent(e);break;case 9735:r.handleZapEvent(e);break;case 6:r.handleRepostEvent(e);break;case 4:r.handleReplyEvent(e)}})()}handleLikeEvent(e){const r=e.tags.find(i=>"e"===i[0])?.[1];if(r){const s=this.eventsSubject.getValue().find(u=>u.id===r);s&&(s.likeCount+=1,s.likers=[...s.likers||[],e.pubkey],this.eventsSubject.next([s]))}}handleZapEvent(e){const r=e.tags.find(i=>"e"===i[0])?.[1];if(r){const s=this.eventsSubject.getValue().find(u=>u.id===r);s&&(s.zapCount+=1,s.zappers=[...s.zappers||[],e.pubkey],this.eventsSubject.next([s]))}}handleRepostEvent(e){const r=e.tags.find(i=>"e"===i[0])?.[1];if(r){const s=this.eventsSubject.getValue().find(u=>u.id===r);s&&(s.repostCount+=1,s.reposters=[...s.reposters||[],e.pubkey],this.eventsSubject.next([s]))}}handleReplyEvent(e){var r=this;return(0,y.A)(function*(){const i=e.tags.find(s=>"e"===s[0])?.[1];if(i){const s=yield r.createNewEvent(e),f=r.eventsSubject.getValue().find(g=>g.id===i);f&&(f.replyCount+=1,f.replies=[...f.replies||[],s],r.eventsSubject.next([f]))}})()}isReply(e){return e.tags.filter(i=>"e"===i[0]||"p"===i[0]).length>0}getMyLikes(){var e=this;return(0,y.A)(function*(){const r={kinds:[7],authors:[e.signerService.getPublicKey()]};try{return(yield e.fetchFilteredEvents(r)).forEach(s=>{const u=s.tags.find(f=>"e"===f[0]);u&&e.myLikedNoteIds.push(u[1])}),e.myLikedNoteIds}catch(i){return console.error("Failed to get user likes:",i),[]}})()}loadMoreEvents(e){var r=this;return(0,y.A)(function*(){if(r.isLoading.value||r.noMoreEvents.value)return;r.isLoading.next(!0);const i={authors:e,kinds:[1],until:r.lastLoadedEventTime||Math.floor(Date.now()/1e3),limit:r.pageSize};try{const s=yield r.fetchFilteredEvents(i);if(s.length<r.pageSize&&r.noMoreEvents.next(!0),s.length>0){r.lastLoadedEventTime=s[s.length-1].created_at;const u=s.filter(g=>!r.seenEventIds.has(g.id)&&!r.isReply(g));u.forEach(g=>r.seenEventIds.add(g.id));const f=yield Promise.all(u.map(g=>r.createNewEvent(g)));r.eventsSubject.next([...r.eventsSubject.getValue(),...f].sort((g,m)=>m.createdAt-g.createdAt))}else r.noMoreEvents.next(!0)}catch(s){console.error("Error loading more events:",s)}finally{r.isLoading.next(!1)}})()}fetchFilteredEvents(e){var r=this;return(0,y.A)(function*(){return new Promise((i,s)=>{const u=new Map,f=[];r.queueService.addRequestToQueue([e]).subscribe({next:g=>{u.has(g.id)||(u.set(g.id,g),f.push(g))},error:g=>{console.error("Error fetching events:",g),s(g)},complete:()=>{console.log("All events fetched and completed"),i(f)}})})})()}createNewEvent(e){var r=this;return(0,y.A)(function*(){const i=new Tc(e.id,e.kind,e.pubkey,e.content,e.id,e.created_at,e.tags);r.enqueueJob(e.id),yield r.processJobQueue(),i.likedByMe=r.myLikedNoteIds.includes(e.id);const s=yield r.metadataService.fetchMetadataWithCache(e.pubkey);return s&&(i.username=s.name||i.npub,i.picture=s.picture||"/images/avatars/avatar-placeholder.png"),i})()}enqueueJob(e){this.jobQueue.some(r=>r.eventId===e)||(this.jobQueue.push({eventId:e}),this.isProcessingQueue||this.processJobQueue())}processJobQueue(){var e=this;return(0,y.A)(function*(){if(e.isProcessingQueue)return;e.isProcessingQueue=!0;const r=[];for(;e.jobQueue.length>0||r.length>0;){for(;e.jobQueue.length>0&&r.length<10;){const i=e.jobQueue.shift();if(!i)break;yield e.delay(1e3);const s=e.processJobWithQueueService(i);r.push(s),s.then(()=>{r.splice(r.indexOf(s),1)}).catch(u=>{console.error("Error processing job:",u),r.splice(r.indexOf(s),1)})}yield Promise.race(r)}e.isProcessingQueue=!1})()}processJobWithQueueService(e){var r=this;return(0,y.A)(function*(){try{const i=yield r.fetchMultiFilterEvents(e.eventId);r.repliesMap.set(e.eventId,i.replies),r.likesMap.set(e.eventId,i.likers),r.zapsMap.set(e.eventId,i.zappers),r.repostsMap.set(e.eventId,i.reposters),r.updateEventInSubject(e.eventId)}catch(i){throw console.error("Error processing job with QueueService:",i),i}})()}delay(e){return new Promise(r=>setTimeout(r,e))}updateEventInSubject(e){const i=this.eventsSubject.getValue().map(s=>(s.id===e&&(s.replyCount=this.getRepliesCount(e),s.replies=this.repliesMap.get(e)||[],s.likeCount=this.getLikesCount(e),s.likers=this.likesMap.get(e)||[],s.zapCount=this.getZapsCount(e),s.zappers=this.zapsMap.get(e)||[],s.repostCount=this.getRepostsCount(e),s.reposters=this.repostsMap.get(e)||[]),s));this.eventsSubject.next(i)}fetchMultiFilterEvents(e){var r=this;return(0,y.A)(function*(){const i=[{"#e":[e],kinds:[1]},{"#e":[e],kinds:[7]},{"#e":[e],kinds:[9735]},{"#e":[e],kinds:[6]}],s=new Map,u=[],f=[],g=[],m=[],M=r.queueService.addRequestToQueue(i);return new Promise((k,O)=>{var L;M.subscribe({next:(L=(0,y.A)(function*(P){if(s.has(P.id)||s.set(P.id,P),1===P.kind){const I=yield r.createNewEvent(P);u.push(I)}else 7===P.kind?f.push(P.pubkey):9735===P.kind?g.push(P.pubkey):6===P.kind&&m.push(P.pubkey)}),function(I){return L.apply(this,arguments)}),error:L=>{console.error("Error fetching events:",L),O(L)},complete:()=>{k({replies:u,likers:f,zappers:g,reposters:m})}})})})()}getRepliesCount(e){return(this.repliesMap.get(e)||[]).length}getLikesCount(e){return(this.likesMap.get(e)||[]).length}getZapsCount(e){return(this.zapsMap.get(e)||[]).length}getRepostsCount(e){return(this.repostsMap.get(e)||[]).length}hasUserLiked(e){return this.hasLikedMap.get(e)||!1}hasUserReposted(e){return this.hasRepostedMap.get(e)||!1}getEventStream(){return this.eventsSubject.asObservable().pipe((0,Ic.c)(1e3))}hasMoreEvents(){return this.noMoreEvents.asObservable()}sendTextEvent(e){var r=this;return(0,y.A)(function*(){if(e)try{const s=r.signerService.getUnsignedEvent(1,[],e);let u;if(r.signerService.isUsingSecretKey()){const f=yield r.signerService.getDecryptedSecretKey(),g=(0,Mr.aT)(f);u=(0,kr.pC)(s,g)}else u=yield r.signerService.signEventWithExtension(s);yield r.relayService.publishEventToWriteRelays(u)}catch(i){console.error("Failed to send text event:",i)}})()}sendLikeEvent(e){var r=this;return(0,y.A)(function*(){if(e)try{const u=r.signerService.getUnsignedEvent(7,[["e",e.id],["p",e.pubkey]],"+");let f;if(r.signerService.isUsingSecretKey()){const g=yield r.signerService.getDecryptedSecretKey(),m=(0,Mr.aT)(g);f=(0,kr.pC)(u,m)}else f=yield r.signerService.signEventWithExtension(u);yield r.relayService.publishEventToWriteRelays(f),r.likesMap.set(e.id,[...r.likesMap.get(e.id)||[],r.signerService.getPublicKey()]),r.hasLikedMap.set(e.id,!0)}catch(i){console.error("Failed to send like event:",i)}})()}sendZapEvent(e,r){var i=this;return(0,y.A)(function*(){if(e&&!(r<=0))try{const s=[["e",e.id],["p",e.pubkey],["amount",r.toString()]],f=i.signerService.getUnsignedEvent(9735,s,`Zapped with ${r} sats`);let g;if(i.signerService.isUsingSecretKey()){const m=yield i.signerService.getDecryptedSecretKey(),M=(0,Mr.aT)(m);g=(0,kr.pC)(f,M)}else g=yield i.signerService.signEventWithExtension(f);yield i.relayService.publishEventToWriteRelays(g)}catch(s){console.error("Failed to send zap event:",s)}})()}sendReplyEvent(e,r){var i=this;return(0,y.A)(function*(){if(e)try{const u=i.signerService.getUnsignedEvent(1,[["e",e.id],["p",e.pubkey]],r);let f;if(i.signerService.isUsingSecretKey()){const g=yield i.signerService.getDecryptedSecretKey(),m=(0,Mr.aT)(g);f=(0,kr.pC)(u,m)}else f=yield i.signerService.signEventWithExtension(u);yield i.relayService.publishEventToWriteRelays(f)}catch(s){console.error("Failed to send reply event:",s)}})()}clearEvents(){this.eventsSubject.next([]),this.seenEventIds.clear(),this.lastLoadedEventTime=null,this.noMoreEvents.next(!1)}static{this.\u0275fac=function(r){return new(r||t)(o.KVO(us.b),o.KVO(Li.A),o.KVO(Rc.T),o.KVO(fs.F))}}static{this.\u0275prov=o.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Nc=S(5645);const Uc=["eventInput"],Pc=["commentInput"],Lc=()=>["./"],Oc=t=>({"heart-beat":t}),jc=t=>({"rotate-180":t});function $c(t,n){if(1&t&&(o.qex(0),o.nrm(1,"img",36),o.bVm()),2&t){const e=o.XpG();o.R7$(),o.FS9("alt",(null==e.profileUser?null:e.profileUser.display_name)||(null==e.profileUser?null:e.profileUser.name)||""),o.Y8G("src",e.getSafeUrl(null==e.profileUser?null:e.profileUser.picture),o.B4B)}}function Dc(t,n){if(1&t&&o.nrm(0,"img",37),2&t){const e=o.XpG();o.FS9("alt",(null==e.profileUser?null:e.profileUser.display_name)||(null==e.profileUser?null:e.profileUser.name)||"")}}function Fc(t,n){if(1&t&&(o.j41(0,"div",38)(1,"div",39)(2,"span",40),o.EFF(3),o.k0s(),o.j41(4,"span",41),o.EFF(5,"FOLLOWERS"),o.k0s()(),o.j41(6,"div",39)(7,"span",42),o.EFF(8),o.k0s(),o.j41(9,"span",43),o.EFF(10,"FOLLOWING"),o.k0s()()()),2&t){const e=n.ngIf;o.R7$(2),o.Y8G("matTooltip","Total contact: "+e.totalContacts),o.R7$(),o.JRh(e.followersCount),o.R7$(5),o.JRh(e.followingCount),o.R7$(),o.Y8G("matTooltip","Total contact: "+e.totalContacts)}}function qc(t,n){if(1&t){const e=o.RV6();o.j41(0,"div")(1,"button",44),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.toggleFollow())}),o.nrm(2,"mat-icon",45),o.k0s()()}if(2&t){const e=o.XpG();o.R7$(),o.Y8G("matTooltip",e.isFollowing?"Unfollow":"Follow"),o.R7$(),o.Y8G("svgIcon",e.isFollowing?"heroicons_outline:user-minus":"heroicons_outline:user-plus")}}function Gc(t,n){if(1&t){const e=o.RV6();o.j41(0,"button",24),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.zap())}),o.j41(1,"span",25),o.nrm(2,"mat-icon",26),o.j41(3,"span"),o.EFF(4,"Send Zap"),o.k0s()()()}2&t&&(o.R7$(2),o.Y8G("svgIcon","feather:zap"))}function zc(t,n){if(1&t){const e=o.RV6();o.j41(0,"button",24),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.openReceiveZapDialog())}),o.j41(1,"span",25),o.nrm(2,"mat-icon",26),o.j41(3,"span"),o.EFF(4,"Receive Zap"),o.k0s()()()}2&t&&(o.R7$(2),o.Y8G("svgIcon","heroicons_outline:qr-code"))}function Wc(t,n){1&t&&(o.j41(0,"button",46)(1,"span",25),o.nrm(2,"mat-icon",26),o.j41(3,"span"),o.EFF(4,"Edit your profile"),o.k0s()()()),2&t&&(o.Y8G("routerLink","/settings/profile"),o.R7$(2),o.Y8G("svgIcon","heroicons_outline:pencil-square"))}function Hc(t,n){1&t&&(o.j41(0,"button",47)(1,"span",25),o.nrm(2,"mat-icon",26),o.j41(3,"span"),o.EFF(4,"Report"),o.k0s()()()),2&t&&(o.R7$(2),o.Y8G("svgIcon","heroicons_solid:exclamation-triangle"))}function Vc(t,n){1&t&&(o.j41(0,"button",47)(1,"span",25),o.nrm(2,"mat-icon",26),o.j41(3,"span"),o.EFF(4,"Turn on notifications"),o.k0s()()()),2&t&&(o.R7$(2),o.Y8G("svgIcon","heroicons_solid:bell"))}function Yc(t,n){if(1&t&&(o.j41(0,"angor-card",48)(1,"div",49),o.EFF(2,"About"),o.k0s(),o.j41(3,"div",50),o.EFF(4),o.k0s(),o.j41(5,"a",51),o.EFF(6," See complete about "),o.k0s()()),2&t){const e=o.XpG();o.R7$(4),o.SpI(" ",(null==e.profileUser?null:e.profileUser.about)||""," "),o.R7$(),o.Y8G("color","primary")("routerLink",o.lJ4(3,Lc))}}function Kc(t,n){if(1&t){const e=o.RV6();o.j41(0,"div",70)(1,"emoji-mart",71),o.bIt("emojiClick",function(i){o.eBV(e);const s=o.XpG(2);return o.Njj(s.addEmoji(i))}),o.k0s()()}if(2&t){const e=o.XpG(2);o.R7$(),o.Y8G("darkMode",e.darkMode)}}function Zc(t,n){if(1&t){const e=o.RV6();o.j41(0,"angor-card",52)(1,"div",53)(2,"div",54),o.EFF(3,"Create Post"),o.k0s(),o.j41(4,"mat-slide-toggle",55),o.bIt("change",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.togglePreview())}),o.EFF(5," Preview "),o.k0s()(),o.j41(6,"div",56)(7,"div",57),o.nrm(8,"img",58),o.j41(9,"div",59),o.EFF(10),o.k0s()(),o.j41(11,"mat-form-field",60),o.nrm(12,"textarea",61,2),o.k0s()(),o.j41(14,"div",62)(15,"div",25)(16,"button",63),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.toggleEmojiPicker())}),o.nrm(17,"mat-icon",22),o.j41(18,"span",64),o.EFF(19,"Feeling"),o.k0s()(),o.DNE(20,Kc,2,1,"div",65),o.j41(21,"button",66),o.nrm(22,"mat-icon",22),o.j41(23,"span",64),o.EFF(24,"Media"),o.k0s()(),o.j41(25,"button",66),o.nrm(26,"mat-icon",22),o.j41(27,"span",64),o.EFF(28,"Tag"),o.k0s()(),o.j41(29,"button",67),o.nrm(30,"mat-icon",22),o.k0s(),o.j41(31,"mat-menu",null,3)(33,"button",68)(34,"span",25),o.nrm(35,"mat-icon",26),o.j41(36,"span"),o.EFF(37,"Tag"),o.k0s()()(),o.j41(38,"button",68)(39,"span",25),o.nrm(40,"mat-icon",26),o.j41(41,"span"),o.EFF(42,"Feeling"),o.k0s()()(),o.j41(43,"button",47)(44,"span",25),o.nrm(45,"mat-icon",26),o.j41(46,"span"),o.EFF(47,"Live"),o.k0s()()(),o.j41(48,"button",47)(49,"span",25),o.nrm(50,"mat-icon",26),o.j41(51,"span"),o.EFF(52,"Gif"),o.k0s()()(),o.j41(53,"button",47)(54,"span",25),o.nrm(55,"mat-icon",26),o.j41(56,"span"),o.EFF(57,"Check in"),o.k0s()()()()(),o.j41(58,"button",69),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.sendEvent())}),o.nrm(59,"mat-icon",22),o.j41(60,"span",64),o.EFF(61,"Send"),o.k0s()()()()}if(2&t){const e=o.sdS(32),r=o.XpG();o.R7$(4),o.Y8G("color","primary"),o.R7$(4),o.FS9("alt",(null==r.currentUser?null:r.currentUser.display_name)||(null==r.currentUser?null:r.currentUser.name)||"Avatar"),o.Y8G("src",(null==r.currentUser?null:r.currentUser.picture)||"images/avatars/avatar-placeholder.png",o.B4B),o.R7$(2),o.SpI(" ",(null==r.currentUser?null:r.currentUser.name)||"Unknown User"," "),o.R7$(),o.Y8G("subscriptSizing","dynamic"),o.R7$(),o.Y8G("placeholder","What's on your mind?")("rows",3),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:face-smile"),o.R7$(3),o.Y8G("ngIf",r.showEmojiPicker),o.R7$(2),o.Y8G("svgIcon","heroicons_solid:photo"),o.R7$(4),o.Y8G("svgIcon","heroicons_solid:user-circle"),o.R7$(3),o.Y8G("matMenuTriggerFor",e),o.R7$(),o.Y8G("svgIcon","heroicons_solid:ellipsis-horizontal"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:user-circle"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:face-smile"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:play"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:sparkles"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:map-pin"),o.R7$(4),o.Y8G("svgIcon","heroicons_solid:paper-airplane")}}function Xc(t,n){if(1&t){const e=o.RV6();o.j41(0,"div",70)(1,"emoji-mart",71),o.bIt("emojiClick",function(i){o.eBV(e);const s=o.XpG(2);return o.Njj(s.addEmojiTocomment(i))}),o.k0s()()}if(2&t){const e=o.XpG(2);o.R7$(),o.Y8G("darkMode",e.darkMode)}}function Qc(t,n){if(1&t){const e=o.RV6();o.j41(0,"angor-card",72,4)(2,"div",73),o.nrm(3,"img",74),o.j41(4,"div",75)(5,"span",76),o.EFF(6),o.k0s(),o.j41(7,"span",77),o.EFF(8,"1 minutes ago"),o.k0s()(),o.j41(9,"button",78),o.nrm(10,"mat-icon",22),o.k0s(),o.j41(11,"mat-menu",null,5)(13,"button",47)(14,"span",25),o.nrm(15,"mat-icon",26),o.j41(16,"span"),o.EFF(17,"Save post"),o.k0s()()(),o.j41(18,"button",47)(19,"span",25),o.nrm(20,"mat-icon",26),o.j41(21,"span"),o.EFF(22,"Hide post"),o.k0s()()(),o.j41(23,"button",47)(24,"span",25),o.nrm(25,"mat-icon",26),o.j41(26,"span"),o.EFF(27,"Snooze for 30 days"),o.k0s()()(),o.j41(28,"button",47)(29,"span",25),o.nrm(30,"mat-icon",26),o.j41(31,"span"),o.EFF(32,"Hide all"),o.k0s()()(),o.nrm(33,"mat-divider",27),o.j41(34,"button",47)(35,"span",25),o.nrm(36,"mat-icon",26),o.j41(37,"span"),o.EFF(38,"Report post"),o.k0s()()(),o.j41(39,"button",47)(40,"span",25),o.nrm(41,"mat-icon",26),o.j41(42,"span"),o.EFF(43,"Turn on notifications for this post"),o.k0s()()()()(),o.j41(44,"div",79),o.EFF(45),o.k0s(),o.nrm(46,"div",80),o.j41(47,"div",81)(48,"button",63),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.toggleLike())}),o.nrm(49,"mat-icon",82),o.j41(50,"span",64),o.EFF(51),o.k0s()(),o.j41(52,"button",63),o.bIt("click",function(){o.eBV(e);const i=o.sdS(1);return o.Njj(i.expanded=!i.expanded)}),o.nrm(53,"mat-icon",22),o.j41(54,"span",64),o.EFF(55,"Comment"),o.k0s()(),o.j41(56,"button",83),o.nrm(57,"mat-icon",22),o.j41(58,"span",64),o.EFF(59,"Share"),o.k0s()()(),o.nrm(60,"hr",84),o.j41(61,"div",85)(62,"div",25),o.nrm(63,"img",86)(64,"img",87)(65,"img",87)(66,"img",87),o.j41(67,"div",88),o.EFF(68," You and 4 more liked this "),o.k0s()(),o.nrm(69,"div",89),o.j41(70,"div",90)(71,"button",91),o.EFF(72," 0 shares "),o.k0s(),o.j41(73,"button",92),o.bIt("click",function(){o.eBV(e);const i=o.sdS(1);return o.Njj(i.expanded=!i.expanded)}),o.j41(74,"span",93),o.EFF(75,"0 Comments"),o.k0s(),o.nrm(76,"mat-icon",94),o.k0s()()(),o.qex(77,95),o.nrm(78,"hr",96),o.j41(79,"div",97)(80,"div",98),o.nrm(81,"img",99),o.j41(82,"mat-form-field",60),o.nrm(83,"textarea",61,6),o.k0s()(),o.j41(85,"div",100)(86,"div",25)(87,"button",101),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.toggleCommentEmojiPicker())}),o.nrm(88,"mat-icon",22),o.k0s(),o.DNE(89,Xc,2,1,"div",65),o.j41(90,"button",102),o.nrm(91,"mat-icon",22),o.k0s(),o.j41(92,"button",102),o.nrm(93,"mat-icon",22),o.k0s()(),o.j41(94,"button",103),o.nrm(95,"mat-icon",22),o.j41(96,"span",64),o.EFF(97,"Send"),o.k0s()()()(),o.bVm(),o.k0s()}if(2&t){const e=o.sdS(1),r=o.sdS(12),i=o.XpG();o.R7$(3),o.FS9("alt",(null==i.currentUser?null:i.currentUser.display_name)||(null==i.currentUser?null:i.currentUser.name)||"Avatar"),o.Y8G("src",(null==i.currentUser?null:i.currentUser.picture)||"images/avatars/avatar-placeholder.png",o.B4B),o.R7$(3),o.JRh((null==i.currentUser?null:i.currentUser.display_name)||(null==i.currentUser?null:i.currentUser.name)),o.R7$(3),o.Y8G("matMenuTriggerFor",r),o.R7$(),o.Y8G("svgIcon","heroicons_solid:ellipsis-vertical"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:arrow-up-tray"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:eye-slash"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:clock"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:minus-circle"),o.R7$(6),o.Y8G("svgIcon","heroicons_solid:exclamation-triangle"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:bell"),o.R7$(4),o.SpI(" ",i.eventInput.nativeElement.value," "),o.R7$(4),o.Y8G("ngClass",o.eq3(29,Oc,i.isLiked))("svgIcon",i.isLiked?"heroicons_solid:heart":"heroicons_outline:heart"),o.R7$(2),o.JRh(i.isLiked?"Unlike":"Like"),o.R7$(2),o.Y8G("svgIcon","heroicons_solid:chat-bubble-left-ellipsis"),o.R7$(4),o.Y8G("svgIcon","heroicons_solid:share"),o.R7$(19),o.Y8G("ngClass",o.eq3(31,jc,e.expanded))("svgIcon","heroicons_mini:chevron-down"),o.R7$(5),o.FS9("alt",(null==i.currentUser?null:i.currentUser.display_name)||(null==i.currentUser?null:i.currentUser.name)||"Avatar"),o.Y8G("src",(null==i.currentUser?null:i.currentUser.picture)||"images/avatars/avatar-placeholder.png",o.B4B),o.R7$(),o.Y8G("subscriptSizing","dynamic"),o.R7$(),o.Y8G("placeholder","Write a comment...")("rows",3),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:face-smile"),o.R7$(),o.Y8G("ngIf",i.showCommentEmojiPicker),o.R7$(2),o.Y8G("svgIcon","heroicons_solid:photo"),o.R7$(2),o.Y8G("svgIcon","heroicons_solid:sparkles"),o.R7$(2),o.Y8G("svgIcon","heroicons_solid:paper-airplane")}}const Jc=[{path:"",component:(()=>{class t{constructor(e,r,i,s,u,f,g,m,M,k,O,L,P,I){this._changeDetectorRef=e,this._signerService=r,this._storageService=i,this._sanitizer=s,this._route=u,this._socialService=f,this._snackBar=g,this._lightning=m,this._dialog=M,this._angorConfigService=k,this._angorConfirmationService=O,this._eventService=L,this._subscriptionService=P,this._clipboard=I,this.darkMode=!1,this.isLoading=!0,this.errorMessage=null,this._unsubscribeAll=new Ge.B,this.allPublicKeys=[],this.isCurrentUserProfile=!1,this.isFollowing=!1,this.showEmojiPicker=!1,this.showCommentEmojiPicker=!1,this.lightningResponse=null,this.lightningInvoice=null,this.paymentInvoice="",this.invoiceAmount="?",this.isLiked=!1,this.isPreview=!1,this.posts=[],this.likes=[],this.myLikes=[],this.myLikedNoteIds=[],this.isLoadingPosts=!0,this.noEventsMessage="",this.totalContacts=0,this.followersCount=0,this.followingCount=0}ngOnInit(){var e=this;return(0,y.A)(function*(){e._angorConfigService.config$.subscribe(r=>{"auto"===r.scheme?e.detectSystemTheme():e.darkMode="dark"===r.scheme}),e._route.paramMap.subscribe(r=>{const i=r.get("pubkey");if(i)e.routePubKey=i;else{e.isCurrentUserProfile=!0;const s=e._signerService.getPublicKey();e.routePubKey=s}e.loadProfileUser(e.routePubKey),e.stats$=e._storageService.getContactStats$(e.routePubKey)})})()}ngOnDestroy(){this.subscriptionId&&this._subscriptionService.removeSubscriptionById(this.subscriptionId),this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}loadCurrentUser(){var e=this;return(0,y.A)(function*(){e.currentUser=null,e._storageService.profile$.subscribe(r=>{r&&r.pubKey&&r.metadata&&r.pubKey===e.routePubKey&&(e.currentUser=r.metadata,e._changeDetectorRef.detectChanges())}),e._storageService.getProfile(e.routePubKey).then(r=>{e._changeDetectorRef.detectChanges(),e.currentUser=r})})()}loadProfileUser(e){var r=this;return(0,y.A)(function*(){if(r.isLoading=!0,r.errorMessage=null,r.profileUser=null,r._changeDetectorRef.detectChanges(),!e)return r.errorMessage="No public key found. Please log in again.",r.isLoading=!1,void r._changeDetectorRef.detectChanges();try{const i=yield r._storageService.getProfile(e);i&&(r.profileUser=i,r._changeDetectorRef.detectChanges()),r.subscribeToUserProfile(e)}catch(i){console.error("Error loading user profile:",i)}})()}subscribeToUserProfile(e){var r=this;this.subscriptionId=this._subscriptionService.addSubscriptions([{authors:[e],kinds:[0],limit:1}],function(){var s=(0,y.A)(function*(u){try{const f=JSON.parse(u.content);r.profileUser=f,yield r._storageService.saveProfile(e,f),r._changeDetectorRef.detectChanges()}catch(f){console.error("Error processing metadata event:",f)}});return function(u){return s.apply(this,arguments)}}())}getSafeUrl(e){return this._sanitizer.bypassSecurityTrustUrl(e)}toggleFollow(){var e=this;return(0,y.A)(function*(){try{const r=e._signerService.getPublicKey(),i=e.routePubKey||e.currentUserPubKey;if(!i||!r)return void console.error("Public key missing. Unable to toggle follow.");e.isFollowing?(yield e._socialService.unfollow(i),console.log(`Unfollowed ${i}`)):(yield e._socialService.follow(i),console.log(`Followed ${i}`)),e.isFollowing=!e.isFollowing,e._changeDetectorRef.detectChanges()}catch(r){console.error("Failed to toggle follow:",r)}})()}openSnackBar(e,r){this._snackBar.open(e,r,{duration:1300})}getLightningInfo(){let e="";if(this.profileUser?.lud06){const{words:r}=ne.I.decode(this.profileUser.lud06,5e3),i=new Uint8Array(ne.I.fromWords(r));e=(new TextDecoder).decode(Uint8Array.from(i))}else if(this.profileUser?.lud16?.toLowerCase().startsWith("lnurl")){const{words:r}=ne.I.decode(this.profileUser.lud16,5e3),i=new Uint8Array(ne.I.fromWords(r));e=(new TextDecoder).decode(Uint8Array.from(i))}else this.profileUser?.lud16&&(e=this._lightning.getLightningAddress(this.profileUser.lud16));""!==e?this._lightning.getLightning(e).subscribe(r=>{this.lightningResponse=r,"Failed"===this.lightningResponse.status?this.openSnackBar("Failed to lookup lightning address","dismiss"):this.lightningResponse.callback?this.openZapDialog():this.openSnackBar("couldn't find user's lightning address","dismiss")}):this.openSnackBar("No lightning address found","dismiss")}zap(){var e=this;return(0,y.A)(function*(){e.profileUser&&(e.profileUser.lud06||e.profileUser.lud16)?e.getLightningInfo():e.openSnackBar("user can't receive zaps","dismiss")})()}openZapDialog(){this._dialog.open(Mc,{width:"405px",maxHeight:"90vh",data:this.profileUser})}openReceiveZapDialog(){this._dialog.open(sc,{width:"405px",maxHeight:"90vh",data:this.profileUser})}toggleLike(){this.isLiked=!this.isLiked,this.isLiked&&setTimeout(()=>{this.isLiked=!1,this.isLiked=!0},300)}addEmoji(e){this.eventInput.nativeElement.value+=e.emoji.native,this.showEmojiPicker=!1}toggleEmojiPicker(){this.showCommentEmojiPicker=!1,this.showEmojiPicker=!this.showEmojiPicker}addEmojiTocomment(e){this.commentInput.nativeElement.value+=e.emoji.native,this.showCommentEmojiPicker=!1}detectSystemTheme(){const e=window.matchMedia("(prefers-color-scheme: dark)");this.darkMode=e.matches,e.addEventListener("change",r=>{this.darkMode=r.matches})}togglePreview(){this.isPreview=!this.isPreview}sendEvent(){""!=this.eventInput.nativeElement.value&&this._eventService.sendTextEvent(this.eventInput.nativeElement.value).then(()=>{this._changeDetectorRef.markForCheck()}).catch(e=>{console.error("Failed to send Event:",e)})}copyHex(){this._clipboard.copy(this.routePubKey),this.openSnackBar("hex public key copied","dismiss")}copyNpub(){var e=this._signerService.getNpubFromPubkey(this.routePubKey);this._clipboard.copy(e),this.openSnackBar("npub public key copied","dismiss")}static{this.\u0275fac=function(r){return new(r||t)(o.rXU(o.gRc),o.rXU(Li.A),o.rXU(kc.n),o.rXU(ke.up),o.rXU(he.nX),o.rXU(Sc),o.rXU(Ii.UG),o.rXU(cs),o.rXU(Pe.bZ),o.rXU(Ac.P),o.rXU(Cc.m),o.rXU(Bc),o.rXU(Nc.n),o.rXU(Ri))}}static{this.\u0275cmp=o.VBU({type:t,selectors:[["profile"]],viewQuery:function(r,i){if(1&r&&(o.GBs(Uc,5),o.GBs(Pc,5)),2&r){let s;o.mGM(s=o.lsd())&&(i.eventInput=s.first),o.mGM(s=o.lsd())&&(i.commentInput=s.first)}},standalone:!0,features:[o.aNF],decls:48,vars:22,consts:[["defaultAvatar",""],["profileMenu","matMenu"],["eventInput",""],["postCardMenu01","matMenu"],["expandableComments","angorCard"],["postCardMenu02","matMenu"],["commentInput",""],[1,"flex","min-w-0","flex-auto","flex-col"],[1,"bg-card","flex","flex-col","shadow"],["onerror","this.onerror=null; this.src='/images/pages/profile/cover.jpg';",1,"h-40","object-cover","lg:h-80",3,"src","alt"],[1,"bg-card","mx-auto","flex","w-full","max-w-5xl","flex-0","flex-col","items-center","px-8","lg:h-18","lg:flex-row"],[1,"-mt-26","flex-shrink-0","rounded-full","lg:-mt-22"],[4,"ngIf","ngIfElse"],[1,"mt-4","flex","flex-grow","flex-col","items-center","lg:ml-8","lg:mt-0","lg:items-start"],[1,"max-w-full","truncate","text-lg","font-bold","leading-tight","lg:max-w-[25rem]",2,"white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"text-secondary","max-w-full","truncate","leading-tight","lg:max-w-[25rem]",2,"white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"mx-8","hidden","h-8","flex-shrink-0","border-l-2","lg:flex"],[1,"flex","flex-shrink-0","items-center","space-x-6","lg:mt-0"],["class","mt-6 flex flex-shrink-0 items-center space-x-6 lg:mt-0",4,"ngIf"],[1,"mb-4","mt-8","flex","flex-shrink-0","items-center","space-x-6","lg:m-0","lg:ml-auto"],[4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"icon-size-5",3,"svgIcon"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],[1,"flex","items-center"],[1,"mr-3","icon-size-5",3,"svgIcon"],[1,"my-2"],["mat-menu-item","",3,"routerLink",4,"ngIf"],["mat-menu-item","",4,"ngIf"],[1,"mx-auto","flex","w-full","max-w-5xl","flex-auto","justify-center","p-6","sm:p-8"],[1,"mr-8","hidden","flex-col","items-start","lg:flex"],["class","flex w-full max-w-80 flex-col p-8",4,"ngIf"],[1,"flex","w-full","flex-col","items-start"],["class","mb-8 flex w-full flex-col p-6 pb-6 sm:p-8",4,"ngIf"],["class","mb-8 flex w-full flex-col bg-primary-50 dark:bg-primary-800",4,"ngIf"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"ring-bg-card","h-32","min-h-32","w-32","min-w-32","max-w-fit","rounded-full","object-cover","ring-4",3,"src","alt"],["src","/images/avatars/avatar-placeholder.png","onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"ring-bg-card","h-32","min-h-32","w-32","min-w-32","rounded-full","object-cover","ring-4",3,"alt"],[1,"mt-6","flex","flex-shrink-0","items-center","space-x-6","lg:mt-0"],[1,"flex","flex-col","items-center"],[1,"font-bold",3,"matTooltip"],[1,"text-secondary","text-sm","font-medium"],[1,"font-bold"],[1,"text-secondary","text-sm","font-medium",3,"matTooltip"],["mat-icon-button","",3,"click","matTooltip"],[3,"svgIcon"],["mat-menu-item","",3,"routerLink"],["mat-menu-item",""],[1,"flex","w-full","max-w-80","flex-col","p-8"],[1,"text-2xl","font-semibold","leading-tight"],[1,"mt-4"],["mat-flat-button","",1,"mt-8","px-6",3,"color","routerLink"],[1,"mb-8","flex","w-full","flex-col","p-6","pb-6","sm:p-8"],[1,"flex","justify-between"],[1,"text-xl","font-semibold"],[1,"-mr-4","ml-auto",3,"change","color"],[1,"mt-8","flex","flex-col","items-start","sm:flex-row"],[1,"mb-6","flex","items-center","sm:mb-0"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"mr-4","h-12","w-12","min-w-12","rounded-full","object-cover",3,"src","alt"],[1,"sm:hidden"],[1,"w-full",3,"subscriptSizing"],["matInput","","cdkTextareaAutosize","",3,"placeholder","rows"],[1,"-mx-3","mt-6","flex","items-center","justify-between","sm:mt-8"],["mat-button","",1,"mr-1","px-3",3,"click"],[1,"ml-2"],["class","emoji-picker-container-global",4,"ngIf"],["mat-button","",1,"mr-1","hidden","px-3","sm:inline-flex"],["mat-button","",1,"px-3",3,"matMenuTriggerFor"],["mat-menu-item","",1,"sm:hidden"],["mat-button","",1,"mr-1","flex","px-3",3,"click"],[1,"emoji-picker-container-global"],[3,"emojiClick","darkMode"],[1,"mb-8","flex","w-full","flex-col","bg-primary-50","dark:bg-primary-800"],[1,"mx-6","mb-4","mt-6","flex","items-center","sm:mx-8"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"mr-4","h-10","w-10","rounded-full",3,"src","alt"],[1,"flex","flex-col"],[1,"font-semibold","leading-none"],[1,"text-secondary","mt-1","text-sm","leading-none"],["mat-icon-button","",1,"-mr-4","ml-auto",3,"matMenuTriggerFor"],[1,"mx-6","mb-6","mt-2","sm:mx-8"],[1,"relative","mb-4"],[1,"mx-3","flex","items-center","sm:mx-5"],[1,"text-red-500","icon-size-5",3,"ngClass","svgIcon"],["mat-button","",1,"mr-1","px-3"],[1,"mx-6","mb-6","mt-4","border-b","sm:mx-8"],[1,"mx-6","mb-4","flex","flex-col","sm:mx-8","sm:mb-6","sm:flex-row","sm:items-center"],["src","images/avatars/avatar-placeholder.png","alt","Card cover image",1,"text-card","m-0.5","h-6","w-6","rounded-full","ring-2","ring-white"],["src","images/avatars/avatar-placeholder.png","alt","Card cover image",1,"text-card","m-0.5","-ml-3","h-6","w-6","rounded-full","ring-2","ring-white"],[1,"ml-3","text-md","tracking-tight"],[1,"hidden","flex-auto","sm:flex"],[1,"mt-4","flex","items-center","sm:mt-0"],["mat-button","",1,"-ml-2","mr-1","px-3","sm:ml-0"],["mat-button","",1,"px-3","sm:-mr-4",3,"click"],[1,"mr-1"],[1,"rotate-0","transition-transform","duration-150","ease-in-out","icon-size-5",3,"ngClass","svgIcon"],["angorCardExpansion",""],[1,"m-0","border-b"],[1,"mx-4","mb-3","mt-6","flex","flex-col","sm:mx-8"],[1,"flex","items-start"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"mr-5","h-12","w-12","rounded-full","object-cover",3,"src","alt"],[1,"mt-3","flex","items-center","justify-between"],["mat-icon-button","",3,"click"],["mat-icon-button",""],["mat-button","",1,"mr-1","flex","px-3"]],template:function(r,i){if(1&r){const s=o.RV6();o.j41(0,"div",7)(1,"div",8)(2,"div"),o.nrm(3,"img",9),o.k0s(),o.j41(4,"div",10)(5,"div",11),o.DNE(6,$c,2,2,"ng-container",12)(7,Dc,1,1,"ng-template",null,0,o.C5r),o.k0s(),o.j41(9,"div",13)(10,"div",14),o.EFF(11),o.k0s(),o.j41(12,"div",15),o.EFF(13),o.k0s()(),o.nrm(14,"div",16),o.j41(15,"div",17),o.DNE(16,Fc,11,4,"div",18),o.nI1(17,"async"),o.nrm(18,"div",16),o.j41(19,"div",19),o.DNE(20,qc,3,2,"div",20),o.j41(21,"div")(22,"button",21),o.nrm(23,"mat-icon",22),o.k0s(),o.j41(24,"mat-menu",null,1),o.DNE(26,Gc,5,1,"button",23),o.j41(27,"button",24),o.bIt("click",function(){return o.eBV(s),o.Njj(i.copyHex())}),o.j41(28,"span",25),o.nrm(29,"mat-icon",26),o.j41(30,"span"),o.EFF(31,"Copy Public key (hex)"),o.k0s()()(),o.j41(32,"button",24),o.bIt("click",function(){return o.eBV(s),o.Njj(i.copyNpub())}),o.j41(33,"span",25),o.nrm(34,"mat-icon",26),o.j41(35,"span"),o.EFF(36,"Copy Public key (npub)"),o.k0s()()(),o.DNE(37,zc,5,1,"button",23),o.nrm(38,"mat-divider",27),o.DNE(39,Wc,5,2,"button",28)(40,Hc,5,1,"button",29)(41,Vc,5,1,"button",29),o.k0s()()()()()(),o.j41(42,"div",30)(43,"div",31),o.DNE(44,Yc,7,4,"angor-card",32),o.k0s(),o.j41(45,"div",33),o.DNE(46,Zc,62,19,"angor-card",34)(47,Qc,98,33,"angor-card",35),o.k0s()()()}if(2&r){const s=o.sdS(8),u=o.sdS(25);o.R7$(3),o.FS9("alt",(null==i.profileUser?null:i.profileUser.display_name)||(null==i.profileUser?null:i.profileUser.name)||"Banner"),o.Y8G("src",(null==i.profileUser?null:i.profileUser.banner)||"/images/pages/profile/cover.jpg",o.B4B),o.R7$(3),o.Y8G("ngIf",null==i.profileUser?null:i.profileUser.picture)("ngIfElse",s),o.R7$(5),o.SpI(" ",(null==i.profileUser?null:i.profileUser.display_name)||(null==i.profileUser?null:i.profileUser.name)||"Unknown User"," "),o.R7$(2),o.SpI(" ",(null==i.profileUser?null:i.profileUser.username)||(null==i.profileUser?null:i.profileUser.name)," "),o.R7$(3),o.Y8G("ngIf",o.bMT(17,20,i.stats$)),o.R7$(4),o.Y8G("ngIf",!i.isCurrentUserProfile),o.R7$(2),o.Y8G("matMenuTriggerFor",u),o.R7$(),o.Y8G("svgIcon","heroicons_solid:ellipsis-vertical"),o.R7$(3),o.Y8G("ngIf",!i.isCurrentUserProfile),o.R7$(3),o.Y8G("svgIcon","heroicons_outline:clipboard-document"),o.R7$(5),o.Y8G("svgIcon","heroicons_outline:clipboard-document"),o.R7$(3),o.Y8G("ngIf",i.isCurrentUserProfile),o.R7$(2),o.Y8G("ngIf",i.isCurrentUserProfile),o.R7$(),o.Y8G("ngIf",!i.isCurrentUserProfile),o.R7$(),o.Y8G("ngIf",!i.isCurrentUserProfile),o.R7$(3),o.Y8G("ngIf",(null==i.profileUser?null:i.profileUser.about)&&""!==i.profileUser.about.trim()),o.R7$(2),o.Y8G("ngIf",i.isCurrentUserProfile),o.R7$(),o.Y8G("ngIf",i.isPreview)}},dependencies:[he.Wk,v.n,oe.m_,oe.An,B.Hl,B.It,B.$z,B.iY,ee.Cn,ee.kk,ee.fb,ee.Cp,q.RG,q.rl,le.fS,le.fg,A.xb,A.EE,N.w,N.q,F.uc,F.oV,h.YU,h.MD,h.bT,h.Jj,T.YN,we,W.Ic,j.sG,te.D6,Yn],styles:[".emoji-picker-container-global{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:9999;width:350px;max-width:100%}.heart-beat{animation:heartBeatAnimation .3s ease-in-out}@keyframes heartBeatAnimation{0%{transform:scale(1)}30%{transform:scale(2)}60%{transform:scale(1)}to{transform:scale(1)}}.loading-spinner{display:flex;justify-content:center;align-items:center;margin:20px 0}.loading-spinner .spinner{border:4px solid rgba(0,0,0,.1);border-left-color:#009fb5;border-radius:50%;width:30px;height:30px;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}\n"],encapsulation:2,changeDetection:0})}}return t})()}]},2577:(Ee,U,S)=>{const y=S(531),v=S(8715),A=S(465),h=S(5510);function T(B,N,q,oe,le){const ee=[].slice.call(arguments,1),te=ee.length,j="function"==typeof ee[te-1];if(!j&&!y())throw new Error("Callback required as last argument");if(!j){if(te<1)throw new Error("Too few arguments provided");return 1===te?(q=N,N=oe=void 0):2===te&&!N.getContext&&(oe=q,q=N,N=void 0),new Promise(function(F,he){try{const W=v.create(q,oe);F(B(W,N,oe))}catch(W){he(W)}})}if(te<2)throw new Error("Too few arguments provided");2===te?(le=q,q=N,N=oe=void 0):3===te&&(N.getContext&&typeof le>"u"?(le=oe,oe=void 0):(le=oe,oe=q,q=N,N=void 0));try{const F=v.create(q,oe);le(null,B(F,N,oe))}catch(F){le(F)}}U.mo=T.bind(null,A.render),U.dY=T.bind(null,A.renderToDataURL),U.toString=T.bind(null,function(B,N,q){return h.render(B,q)})},531:Ee=>{Ee.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},919:(Ee,U,S)=>{const x=S(2656).getSymbolSize;U.getRowColCoords=function(v){if(1===v)return[];const A=Math.floor(v/7)+2,h=x(v),T=145===h?26:2*Math.ceil((h-13)/(2*A-2)),B=[h-7];for(let N=1;N<A-1;N++)B[N]=B[N-1]-T;return B.push(6),B.reverse()},U.getPositions=function(v){const A=[],h=U.getRowColCoords(v),T=h.length;for(let B=0;B<T;B++)for(let N=0;N<T;N++)0===B&&0===N||0===B&&N===T-1||B===T-1&&0===N||A.push([h[B],h[N]]);return A}},387:(Ee,U,S)=>{const x=S(838),y=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function v(A){this.mode=x.ALPHANUMERIC,this.data=A}v.getBitsLength=function(h){return 11*Math.floor(h/2)+h%2*6},v.prototype.getLength=function(){return this.data.length},v.prototype.getBitsLength=function(){return v.getBitsLength(this.data.length)},v.prototype.write=function(h){let T;for(T=0;T+2<=this.data.length;T+=2){let B=45*y.indexOf(this.data[T]);B+=y.indexOf(this.data[T+1]),h.put(B,11)}this.data.length%2&&h.put(y.indexOf(this.data[T]),6)},Ee.exports=v},4481:Ee=>{function U(){this.buffer=[],this.length=0}U.prototype={get:function(S){const x=Math.floor(S/8);return 1==(this.buffer[x]>>>7-S%8&1)},put:function(S,x){for(let y=0;y<x;y++)this.putBit(1==(S>>>x-y-1&1))},getLengthInBits:function(){return this.length},putBit:function(S){const x=Math.floor(this.length/8);this.buffer.length<=x&&this.buffer.push(0),S&&(this.buffer[x]|=128>>>this.length%8),this.length++}},Ee.exports=U},8038:Ee=>{function U(S){if(!S||S<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=S,this.data=new Uint8Array(S*S),this.reservedBit=new Uint8Array(S*S)}U.prototype.set=function(S,x,y,v){const A=S*this.size+x;this.data[A]=y,v&&(this.reservedBit[A]=!0)},U.prototype.get=function(S,x){return this.data[S*this.size+x]},U.prototype.xor=function(S,x,y){this.data[S*this.size+x]^=y},U.prototype.isReserved=function(S,x){return this.reservedBit[S*this.size+x]},Ee.exports=U},1736:(Ee,U,S)=>{const x=S(3174),y=S(838);function v(A){this.mode=y.BYTE,"string"==typeof A&&(A=x(A)),this.data=new Uint8Array(A)}v.getBitsLength=function(h){return 8*h},v.prototype.getLength=function(){return this.data.length},v.prototype.getBitsLength=function(){return v.getBitsLength(this.data.length)},v.prototype.write=function(A){for(let h=0,T=this.data.length;h<T;h++)A.put(this.data[h],8)},Ee.exports=v},2296:(Ee,U,S)=>{const x=S(139),y=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],v=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];U.getBlocksCount=function(h,T){switch(T){case x.L:return y[4*(h-1)+0];case x.M:return y[4*(h-1)+1];case x.Q:return y[4*(h-1)+2];case x.H:return y[4*(h-1)+3];default:return}},U.getTotalCodewordsCount=function(h,T){switch(T){case x.L:return v[4*(h-1)+0];case x.M:return v[4*(h-1)+1];case x.Q:return v[4*(h-1)+2];case x.H:return v[4*(h-1)+3];default:return}}},139:(Ee,U)=>{U.L={bit:1},U.M={bit:0},U.Q={bit:3},U.H={bit:2},U.isValid=function(y){return y&&typeof y.bit<"u"&&y.bit>=0&&y.bit<4},U.from=function(y,v){if(U.isValid(y))return y;try{return function S(x){if("string"!=typeof x)throw new Error("Param is not a string");switch(x.toLowerCase()){case"l":case"low":return U.L;case"m":case"medium":return U.M;case"q":case"quartile":return U.Q;case"h":case"high":return U.H;default:throw new Error("Unknown EC Level: "+x)}}(y)}catch{return v}}},9202:(Ee,U,S)=>{const x=S(2656).getSymbolSize;U.getPositions=function(A){const h=x(A);return[[0,0],[h-7,0],[0,h-7]]}},9211:(Ee,U,S)=>{const x=S(2656),A=x.getBCHDigit(1335);U.getEncodedBits=function(T,B){const N=T.bit<<3|B;let q=N<<10;for(;x.getBCHDigit(q)-A>=0;)q^=1335<<x.getBCHDigit(q)-A;return 21522^(N<<10|q)}},6965:(Ee,U)=>{const S=new Uint8Array(512),x=new Uint8Array(256);(function(){let v=1;for(let A=0;A<255;A++)S[A]=v,x[v]=A,v<<=1,256&v&&(v^=285);for(let A=255;A<512;A++)S[A]=S[A-255]})(),U.log=function(v){if(v<1)throw new Error("log("+v+")");return x[v]},U.exp=function(v){return S[v]},U.mul=function(v,A){return 0===v||0===A?0:S[x[v]+x[A]]}},1971:(Ee,U,S)=>{const x=S(838),y=S(2656);function v(A){this.mode=x.KANJI,this.data=A}v.getBitsLength=function(h){return 13*h},v.prototype.getLength=function(){return this.data.length},v.prototype.getBitsLength=function(){return v.getBitsLength(this.data.length)},v.prototype.write=function(A){let h;for(h=0;h<this.data.length;h++){let T=y.toSJIS(this.data[h]);if(T>=33088&&T<=40956)T-=33088;else{if(!(T>=57408&&T<=60351))throw new Error("Invalid SJIS character: "+this.data[h]+"\nMake sure your charset is UTF-8");T-=49472}T=192*(T>>>8&255)+(255&T),A.put(T,13)}},Ee.exports=v},9366:(Ee,U)=>{U.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function x(y,v,A){switch(y){case U.Patterns.PATTERN000:return(v+A)%2==0;case U.Patterns.PATTERN001:return v%2==0;case U.Patterns.PATTERN010:return A%3==0;case U.Patterns.PATTERN011:return(v+A)%3==0;case U.Patterns.PATTERN100:return(Math.floor(v/2)+Math.floor(A/3))%2==0;case U.Patterns.PATTERN101:return v*A%2+v*A%3==0;case U.Patterns.PATTERN110:return(v*A%2+v*A%3)%2==0;case U.Patterns.PATTERN111:return(v*A%3+(v+A)%2)%2==0;default:throw new Error("bad maskPattern:"+y)}}U.isValid=function(v){return null!=v&&""!==v&&!isNaN(v)&&v>=0&&v<=7},U.from=function(v){return U.isValid(v)?parseInt(v,10):void 0},U.getPenaltyN1=function(v){const A=v.size;let h=0,T=0,B=0,N=null,q=null;for(let oe=0;oe<A;oe++){T=B=0,N=q=null;for(let le=0;le<A;le++){let ee=v.get(oe,le);ee===N?T++:(T>=5&&(h+=T-5+3),N=ee,T=1),ee=v.get(le,oe),ee===q?B++:(B>=5&&(h+=B-5+3),q=ee,B=1)}T>=5&&(h+=T-5+3),B>=5&&(h+=B-5+3)}return h},U.getPenaltyN2=function(v){const A=v.size;let h=0;for(let T=0;T<A-1;T++)for(let B=0;B<A-1;B++){const N=v.get(T,B)+v.get(T,B+1)+v.get(T+1,B)+v.get(T+1,B+1);(4===N||0===N)&&h++}return 3*h},U.getPenaltyN3=function(v){const A=v.size;let h=0,T=0,B=0;for(let N=0;N<A;N++){T=B=0;for(let q=0;q<A;q++)T=T<<1&2047|v.get(N,q),q>=10&&(1488===T||93===T)&&h++,B=B<<1&2047|v.get(q,N),q>=10&&(1488===B||93===B)&&h++}return 40*h},U.getPenaltyN4=function(v){let A=0;const h=v.data.length;for(let B=0;B<h;B++)A+=v.data[B];return 10*Math.abs(Math.ceil(100*A/h/5)-10)},U.applyMask=function(v,A){const h=A.size;for(let T=0;T<h;T++)for(let B=0;B<h;B++)A.isReserved(B,T)||A.xor(B,T,x(v,B,T))},U.getBestMask=function(v,A){const h=Object.keys(U.Patterns).length;let T=0,B=1/0;for(let N=0;N<h;N++){A(N),U.applyMask(N,v);const q=U.getPenaltyN1(v)+U.getPenaltyN2(v)+U.getPenaltyN3(v)+U.getPenaltyN4(v);U.applyMask(N,v),q<B&&(B=q,T=N)}return T}},838:(Ee,U,S)=>{const x=S(1604),y=S(6082);U.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},U.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},U.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},U.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},U.MIXED={bit:-1},U.getCharCountIndicator=function(h,T){if(!h.ccBits)throw new Error("Invalid mode: "+h);if(!x.isValid(T))throw new Error("Invalid version: "+T);return T>=1&&T<10?h.ccBits[0]:T<27?h.ccBits[1]:h.ccBits[2]},U.getBestModeForData=function(h){return y.testNumeric(h)?U.NUMERIC:y.testAlphanumeric(h)?U.ALPHANUMERIC:y.testKanji(h)?U.KANJI:U.BYTE},U.toString=function(h){if(h&&h.id)return h.id;throw new Error("Invalid mode")},U.isValid=function(h){return h&&h.bit&&h.ccBits},U.from=function(h,T){if(U.isValid(h))return h;try{return function v(A){if("string"!=typeof A)throw new Error("Param is not a string");switch(A.toLowerCase()){case"numeric":return U.NUMERIC;case"alphanumeric":return U.ALPHANUMERIC;case"kanji":return U.KANJI;case"byte":return U.BYTE;default:throw new Error("Unknown mode: "+A)}}(h)}catch{return T}}},7035:(Ee,U,S)=>{const x=S(838);function y(v){this.mode=x.NUMERIC,this.data=v.toString()}y.getBitsLength=function(A){return 10*Math.floor(A/3)+(A%3?A%3*3+1:0)},y.prototype.getLength=function(){return this.data.length},y.prototype.getBitsLength=function(){return y.getBitsLength(this.data.length)},y.prototype.write=function(A){let h,T,B;for(h=0;h+3<=this.data.length;h+=3)T=this.data.substr(h,3),B=parseInt(T,10),A.put(B,10);const N=this.data.length-h;N>0&&(T=this.data.substr(h),B=parseInt(T,10),A.put(B,3*N+1))},Ee.exports=y},7767:(Ee,U,S)=>{const x=S(6965);U.mul=function(v,A){const h=new Uint8Array(v.length+A.length-1);for(let T=0;T<v.length;T++)for(let B=0;B<A.length;B++)h[T+B]^=x.mul(v[T],A[B]);return h},U.mod=function(v,A){let h=new Uint8Array(v);for(;h.length-A.length>=0;){const T=h[0];for(let N=0;N<A.length;N++)h[N]^=x.mul(A[N],T);let B=0;for(;B<h.length&&0===h[B];)B++;h=h.slice(B)}return h},U.generateECPolynomial=function(v){let A=new Uint8Array([1]);for(let h=0;h<v;h++)A=U.mul(A,new Uint8Array([1,x.exp(h)]));return A}},8715:(Ee,U,S)=>{const x=S(2656),y=S(139),v=S(4481),A=S(8038),h=S(919),T=S(9202),B=S(9366),N=S(2296),q=S(6758),oe=S(8925),le=S(9211),ee=S(838),te=S(7939);function ne(de,we,se){const ce=de.size,_=le.getEncodedBits(we,se);let a,c;for(a=0;a<15;a++)c=1==(_>>a&1),de.set(a<6?a:a<8?a+1:ce-15+a,8,c,!0),de.set(8,a<8?ce-a-1:a<9?15-a-1+1:15-a-1,c,!0);de.set(ce-8,8,1,!0)}function $e(de,we,se,ce){let _;if(Array.isArray(de))_=te.fromArray(de);else{if("string"!=typeof de)throw new Error("Invalid data");{let E=we;if(!E){const C=te.rawSplit(de);E=oe.getBestVersionForData(C,se)}_=te.fromString(de,E||40)}}const a=oe.getBestVersionForData(_,se);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(we){if(we<a)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+a+".\n")}else we=a;const c=function ae(de,we,se){const ce=new v;se.forEach(function(p){ce.put(p.mode.bit,4),ce.put(p.getLength(),ee.getCharCountIndicator(p.mode,de)),p.write(ce)});const c=8*(x.getSymbolTotalCodewords(de)-N.getTotalCodewordsCount(de,we));for(ce.getLengthInBits()+4<=c&&ce.put(0,4);ce.getLengthInBits()%8!=0;)ce.putBit(0);const d=(c-ce.getLengthInBits())/8;for(let p=0;p<d;p++)ce.put(p%2?17:236,8);return function ke(de,we,se){const ce=x.getSymbolTotalCodewords(we),a=ce-N.getTotalCodewordsCount(we,se),c=N.getBlocksCount(we,se),p=c-ce%c,E=Math.floor(ce/c),C=Math.floor(a/c),R=C+1,w=E-C,l=new q(w);let b=0;const ue=new Array(c),me=new Array(c);let ye=0;const xe=new Uint8Array(de.buffer);for(let Ne=0;Ne<c;Ne++){const Kt=Ne<p?C:R;ue[Ne]=xe.slice(b,b+Kt),me[Ne]=l.encode(ue[Ne]),b+=Kt,ye=Math.max(ye,Kt)}const Ce=new Uint8Array(ce);let at,Se,Ue=0;for(at=0;at<ye;at++)for(Se=0;Se<c;Se++)at<ue[Se].length&&(Ce[Ue++]=ue[Se][at]);for(at=0;at<w;at++)for(Se=0;Se<c;Se++)Ce[Ue++]=me[Se][at];return Ce}(ce,de,we)}(we,se,_),d=x.getSymbolSize(we),p=new A(d);return function j(de,we){const se=de.size,ce=T.getPositions(we);for(let _=0;_<ce.length;_++){const a=ce[_][0],c=ce[_][1];for(let d=-1;d<=7;d++)if(!(a+d<=-1||se<=a+d))for(let p=-1;p<=7;p++)c+p<=-1||se<=c+p||de.set(a+d,c+p,d>=0&&d<=6&&(0===p||6===p)||p>=0&&p<=6&&(0===d||6===d)||d>=2&&d<=4&&p>=2&&p<=4,!0)}}(p,we),function F(de){const we=de.size;for(let se=8;se<we-8;se++){const ce=se%2==0;de.set(se,6,ce,!0),de.set(6,se,ce,!0)}}(p),function he(de,we){const se=h.getPositions(we);for(let ce=0;ce<se.length;ce++){const _=se[ce][0],a=se[ce][1];for(let c=-2;c<=2;c++)for(let d=-2;d<=2;d++)de.set(_+c,a+d,-2===c||2===c||-2===d||2===d||0===c&&0===d,!0)}}(p,we),ne(p,se,0),we>=7&&function W(de,we){const se=de.size,ce=oe.getEncodedBits(we);let _,a,c;for(let d=0;d<18;d++)_=Math.floor(d/3),a=d%3+se-8-3,c=1==(ce>>d&1),de.set(_,a,c,!0),de.set(a,_,c,!0)}(p,we),function o(de,we){const se=de.size;let ce=-1,_=se-1,a=7,c=0;for(let d=se-1;d>0;d-=2)for(6===d&&d--;;){for(let p=0;p<2;p++)if(!de.isReserved(_,d-p)){let E=!1;c<we.length&&(E=1==(we[c]>>>a&1)),de.set(_,d-p,E),a--,-1===a&&(c++,a=7)}if(_+=ce,_<0||se<=_){_-=ce,ce=-ce;break}}}(p,c),isNaN(ce)&&(ce=B.getBestMask(p,ne.bind(null,p,se))),B.applyMask(ce,p),ne(p,se,ce),{modules:p,version:we,errorCorrectionLevel:se,maskPattern:ce,segments:_}}U.create=function(we,se){if(typeof we>"u"||""===we)throw new Error("No input text");let _,a,ce=y.M;return typeof se<"u"&&(ce=y.from(se.errorCorrectionLevel,y.M),_=oe.from(se.version),a=B.from(se.maskPattern),se.toSJISFunc&&x.setToSJISFunction(se.toSJISFunc)),$e(we,_,ce,a)}},6758:(Ee,U,S)=>{const x=S(7767);function y(v){this.genPoly=void 0,this.degree=v,this.degree&&this.initialize(this.degree)}y.prototype.initialize=function(A){this.degree=A,this.genPoly=x.generateECPolynomial(this.degree)},y.prototype.encode=function(A){if(!this.genPoly)throw new Error("Encoder not initialized");const h=new Uint8Array(A.length+this.degree);h.set(A);const T=x.mod(h,this.genPoly),B=this.degree-T.length;if(B>0){const N=new Uint8Array(this.degree);return N.set(T,B),N}return T},Ee.exports=y},6082:(Ee,U)=>{const S="[0-9]+";let y="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";y=y.replace(/u/g,"\\u");const v="(?:(?![A-Z0-9 $%*+\\-./:]|"+y+")(?:.|[\r\n]))+";U.KANJI=new RegExp(y,"g"),U.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),U.BYTE=new RegExp(v,"g"),U.NUMERIC=new RegExp(S,"g"),U.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const A=new RegExp("^"+y+"$"),h=new RegExp("^"+S+"$"),T=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");U.testKanji=function(N){return A.test(N)},U.testNumeric=function(N){return h.test(N)},U.testAlphanumeric=function(N){return T.test(N)}},7939:(Ee,U,S)=>{const x=S(838),y=S(7035),v=S(387),A=S(1736),h=S(1971),T=S(6082),B=S(2656),N=S(243);function q(W){return unescape(encodeURIComponent(W)).length}function oe(W,ne,o){const ae=[];let ke;for(;null!==(ke=W.exec(o));)ae.push({data:ke[0],index:ke.index,mode:ne,length:ke[0].length});return ae}function le(W){const ne=oe(T.NUMERIC,x.NUMERIC,W),o=oe(T.ALPHANUMERIC,x.ALPHANUMERIC,W);let ae,ke;return B.isKanjiModeEnabled()?(ae=oe(T.BYTE,x.BYTE,W),ke=oe(T.KANJI,x.KANJI,W)):(ae=oe(T.BYTE_KANJI,x.BYTE,W),ke=[]),ne.concat(o,ae,ke).sort(function(de,we){return de.index-we.index}).map(function(de){return{data:de.data,mode:de.mode,length:de.length}})}function ee(W,ne){switch(ne){case x.NUMERIC:return y.getBitsLength(W);case x.ALPHANUMERIC:return v.getBitsLength(W);case x.KANJI:return h.getBitsLength(W);case x.BYTE:return A.getBitsLength(W)}}function he(W,ne){let o;const ae=x.getBestModeForData(W);if(o=x.from(ne,ae),o!==x.BYTE&&o.bit<ae.bit)throw new Error('"'+W+'" cannot be encoded with mode '+x.toString(o)+".\n Suggested mode is: "+x.toString(ae));switch(o===x.KANJI&&!B.isKanjiModeEnabled()&&(o=x.BYTE),o){case x.NUMERIC:return new y(W);case x.ALPHANUMERIC:return new v(W);case x.KANJI:return new h(W);case x.BYTE:return new A(W)}}U.fromArray=function(ne){return ne.reduce(function(o,ae){return"string"==typeof ae?o.push(he(ae,null)):ae.data&&o.push(he(ae.data,ae.mode)),o},[])},U.fromString=function(ne,o){const ke=function j(W){const ne=[];for(let o=0;o<W.length;o++){const ae=W[o];switch(ae.mode){case x.NUMERIC:ne.push([ae,{data:ae.data,mode:x.ALPHANUMERIC,length:ae.length},{data:ae.data,mode:x.BYTE,length:ae.length}]);break;case x.ALPHANUMERIC:ne.push([ae,{data:ae.data,mode:x.BYTE,length:ae.length}]);break;case x.KANJI:ne.push([ae,{data:ae.data,mode:x.BYTE,length:q(ae.data)}]);break;case x.BYTE:ne.push([{data:ae.data,mode:x.BYTE,length:q(ae.data)}])}}return ne}(le(ne,B.isKanjiModeEnabled())),$e=function F(W,ne){const o={},ae={start:{}};let ke=["start"];for(let $e=0;$e<W.length;$e++){const de=W[$e],we=[];for(let se=0;se<de.length;se++){const ce=de[se],_=""+$e+se;we.push(_),o[_]={node:ce,lastCount:0},ae[_]={};for(let a=0;a<ke.length;a++){const c=ke[a];o[c]&&o[c].node.mode===ce.mode?(ae[c][_]=ee(o[c].lastCount+ce.length,ce.mode)-ee(o[c].lastCount,ce.mode),o[c].lastCount+=ce.length):(o[c]&&(o[c].lastCount=ce.length),ae[c][_]=ee(ce.length,ce.mode)+4+x.getCharCountIndicator(ce.mode,ne))}}ke=we}for(let $e=0;$e<ke.length;$e++)ae[ke[$e]].end=0;return{map:ae,table:o}}(ke,o),de=N.find_path($e.map,"start","end"),we=[];for(let se=1;se<de.length-1;se++)we.push($e.table[de[se]].node);return U.fromArray(function te(W){return W.reduce(function(ne,o){const ae=ne.length-1>=0?ne[ne.length-1]:null;return ae&&ae.mode===o.mode?(ne[ne.length-1].data+=o.data,ne):(ne.push(o),ne)},[])}(we))},U.rawSplit=function(ne){return U.fromArray(le(ne,B.isKanjiModeEnabled()))}},2656:(Ee,U)=>{let S;const x=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];U.getSymbolSize=function(v){if(!v)throw new Error('"version" cannot be null or undefined');if(v<1||v>40)throw new Error('"version" should be in range from 1 to 40');return 4*v+17},U.getSymbolTotalCodewords=function(v){return x[v]},U.getBCHDigit=function(y){let v=0;for(;0!==y;)v++,y>>>=1;return v},U.setToSJISFunction=function(v){if("function"!=typeof v)throw new Error('"toSJISFunc" is not a valid function.');S=v},U.isKanjiModeEnabled=function(){return typeof S<"u"},U.toSJIS=function(v){return S(v)}},1604:(Ee,U)=>{U.isValid=function(x){return!isNaN(x)&&x>=1&&x<=40}},8925:(Ee,U,S)=>{const x=S(2656),y=S(2296),v=S(139),A=S(838),h=S(1604),B=x.getBCHDigit(7973);function q(ee,te){return A.getCharCountIndicator(ee,te)+4}function oe(ee,te){let j=0;return ee.forEach(function(F){const he=q(F.mode,te);j+=he+F.getBitsLength()}),j}U.from=function(te,j){return h.isValid(te)?parseInt(te,10):j},U.getCapacity=function(te,j,F){if(!h.isValid(te))throw new Error("Invalid QR Code version");typeof F>"u"&&(F=A.BYTE);const ne=8*(x.getSymbolTotalCodewords(te)-y.getTotalCodewordsCount(te,j));if(F===A.MIXED)return ne;const o=ne-q(F,te);switch(F){case A.NUMERIC:return Math.floor(o/10*3);case A.ALPHANUMERIC:return Math.floor(o/11*2);case A.KANJI:return Math.floor(o/13);default:return Math.floor(o/8)}},U.getBestVersionForData=function(te,j){let F;const he=v.from(j,v.M);if(Array.isArray(te)){if(te.length>1)return function le(ee,te){for(let j=1;j<=40;j++)if(oe(ee,j)<=U.getCapacity(j,te,A.MIXED))return j}(te,he);if(0===te.length)return 1;F=te[0]}else F=te;return function N(ee,te,j){for(let F=1;F<=40;F++)if(te<=U.getCapacity(F,j,ee))return F}(F.mode,F.getLength(),he)},U.getEncodedBits=function(te){if(!h.isValid(te)||te<7)throw new Error("Invalid QR Code version");let j=te<<12;for(;x.getBCHDigit(j)-B>=0;)j^=7973<<x.getBCHDigit(j)-B;return te<<12|j}},465:(Ee,U,S)=>{const x=S(8428);U.render=function(h,T,B){let N=B,q=T;typeof N>"u"&&(!T||!T.getContext)&&(N=T,T=void 0),T||(q=function v(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}()),N=x.getOptions(N);const oe=x.getImageWidth(h.modules.size,N),le=q.getContext("2d"),ee=le.createImageData(oe,oe);return x.qrToImageData(ee.data,h,N),function y(A,h,T){A.clearRect(0,0,h.width,h.height),h.style||(h.style={}),h.height=T,h.width=T,h.style.height=T+"px",h.style.width=T+"px"}(le,q,oe),le.putImageData(ee,0,0),q},U.renderToDataURL=function(h,T,B){let N=B;return typeof N>"u"&&(!T||!T.getContext)&&(N=T,T=void 0),N||(N={}),U.render(h,T,N).toDataURL(N.type||"image/png",(N.rendererOpts||{}).quality)}},5510:(Ee,U,S)=>{const x=S(8428);function y(h,T){const B=h.a/255,N=T+'="'+h.hex+'"';return B<1?N+" "+T+'-opacity="'+B.toFixed(2).slice(1)+'"':N}function v(h,T,B){let N=h+T;return typeof B<"u"&&(N+=" "+B),N}U.render=function(T,B,N){const q=x.getOptions(B),oe=T.modules.size,le=T.modules.data,ee=oe+2*q.margin,te=q.color.light.a?"<path "+y(q.color.light,"fill")+' d="M0 0h'+ee+"v"+ee+'H0z"/>':"",j="<path "+y(q.color.dark,"stroke")+' d="'+function A(h,T,B){let N="",q=0,oe=!1,le=0;for(let ee=0;ee<h.length;ee++){const te=Math.floor(ee%T),j=Math.floor(ee/T);!te&&!oe&&(oe=!0),h[ee]?(le++,ee>0&&te>0&&h[ee-1]||(N+=oe?v("M",te+B,.5+j+B):v("m",q,0),q=0,oe=!1),te+1<T&&h[ee+1]||(N+=v("h",le),le=0)):q++}return N}(le,oe,q.margin)+'"/>',W='<svg xmlns="http://www.w3.org/2000/svg" '+(q.width?'width="'+q.width+'" height="'+q.width+'" ':"")+'viewBox="0 0 '+ee+" "+ee+'" shape-rendering="crispEdges">'+te+j+"</svg>\n";return"function"==typeof N&&N(null,W),W}},8428:(Ee,U)=>{function S(x){if("number"==typeof x&&(x=x.toString()),"string"!=typeof x)throw new Error("Color should be defined as hex string");let y=x.slice().replace("#","").split("");if(y.length<3||5===y.length||y.length>8)throw new Error("Invalid hex color: "+x);(3===y.length||4===y.length)&&(y=Array.prototype.concat.apply([],y.map(function(A){return[A,A]}))),6===y.length&&y.push("F","F");const v=parseInt(y.join(""),16);return{r:v>>24&255,g:v>>16&255,b:v>>8&255,a:255&v,hex:"#"+y.slice(0,6).join("")}}U.getOptions=function(y){y||(y={}),y.color||(y.color={});const A=y.width&&y.width>=21?y.width:void 0;return{width:A,scale:A?4:y.scale||4,margin:typeof y.margin>"u"||null===y.margin||y.margin<0?4:y.margin,color:{dark:S(y.color.dark||"#000000ff"),light:S(y.color.light||"#ffffffff")},type:y.type,rendererOpts:y.rendererOpts||{}}},U.getScale=function(y,v){return v.width&&v.width>=y+2*v.margin?v.width/(y+2*v.margin):v.scale},U.getImageWidth=function(y,v){const A=U.getScale(y,v);return Math.floor((y+2*v.margin)*A)},U.qrToImageData=function(y,v,A){const h=v.modules.size,T=v.modules.data,B=U.getScale(h,A),N=Math.floor((h+2*A.margin)*B),q=A.margin*B,oe=[A.color.light,A.color.dark];for(let le=0;le<N;le++)for(let ee=0;ee<N;ee++){let te=4*(le*N+ee),j=A.color.light;le>=q&&ee>=q&&le<N-q&&ee<N-q&&(j=oe[T[Math.floor((le-q)/B)*h+Math.floor((ee-q)/B)]?1:0]),y[te++]=j.r,y[te++]=j.g,y[te++]=j.b,y[te]=j.a}}},917:function(Ee,U,S){!function(x,y){"use strict";function v(_,a){if(!_)throw new Error(a||"Assertion failed")}function A(_,a){_.super_=a;var c=function(){};c.prototype=a.prototype,_.prototype=new c,_.prototype.constructor=_}function h(_,a,c){if(h.isBN(_))return _;this.negative=0,this.words=null,this.length=0,this.red=null,null!==_&&(("le"===a||"be"===a)&&(c=a,a=10),this._init(_||0,a||10,c||"be"))}var T;"object"==typeof x?x.exports=h:y.BN=h,h.BN=h,h.wordSize=26;try{T=typeof window<"u"&&typeof window.Buffer<"u"?window.Buffer:S(7790).Buffer}catch{}function B(_,a){var c=_.charCodeAt(a);return c>=65&&c<=70?c-55:c>=97&&c<=102?c-87:c-48&15}function N(_,a,c){var d=B(_,c);return c-1>=a&&(d|=B(_,c-1)<<4),d}function q(_,a,c,d){for(var p=0,E=Math.min(_.length,c),C=a;C<E;C++){var R=_.charCodeAt(C)-48;p*=d,p+=R>=49?R-49+10:R>=17?R-17+10:R}return p}h.isBN=function(a){return a instanceof h||null!==a&&"object"==typeof a&&a.constructor.wordSize===h.wordSize&&Array.isArray(a.words)},h.max=function(a,c){return a.cmp(c)>0?a:c},h.min=function(a,c){return a.cmp(c)<0?a:c},h.prototype._init=function(a,c,d){if("number"==typeof a)return this._initNumber(a,c,d);if("object"==typeof a)return this._initArray(a,c,d);"hex"===c&&(c=16),v(c===(0|c)&&c>=2&&c<=36);var p=0;"-"===(a=a.toString().replace(/\s+/g,""))[0]&&(p++,this.negative=1),p<a.length&&(16===c?this._parseHex(a,p,d):(this._parseBase(a,c,p),"le"===d&&this._initArray(this.toArray(),c,d)))},h.prototype._initNumber=function(a,c,d){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[67108863&a],this.length=1):a<4503599627370496?(this.words=[67108863&a,a/67108864&67108863],this.length=2):(v(a<9007199254740992),this.words=[67108863&a,a/67108864&67108863,1],this.length=3),"le"===d&&this._initArray(this.toArray(),c,d)},h.prototype._initArray=function(a,c,d){if(v("number"==typeof a.length),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var E,C,R=0;if("be"===d)for(p=a.length-1,E=0;p>=0;p-=3)this.words[E]|=(C=a[p]|a[p-1]<<8|a[p-2]<<16)<<R&67108863,this.words[E+1]=C>>>26-R&67108863,(R+=24)>=26&&(R-=26,E++);else if("le"===d)for(p=0,E=0;p<a.length;p+=3)this.words[E]|=(C=a[p]|a[p+1]<<8|a[p+2]<<16)<<R&67108863,this.words[E+1]=C>>>26-R&67108863,(R+=24)>=26&&(R-=26,E++);return this.strip()},h.prototype._parseHex=function(a,c,d){this.length=Math.ceil((a.length-c)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var R,E=0,C=0;if("be"===d)for(p=a.length-1;p>=c;p-=2)R=N(a,c,p)<<E,this.words[C]|=67108863&R,E>=18?(E-=18,this.words[C+=1]|=R>>>26):E+=8;else for(p=(a.length-c)%2==0?c+1:c;p<a.length;p+=2)R=N(a,c,p)<<E,this.words[C]|=67108863&R,E>=18?(E-=18,this.words[C+=1]|=R>>>26):E+=8;this.strip()},h.prototype._parseBase=function(a,c,d){this.words=[0],this.length=1;for(var p=0,E=1;E<=67108863;E*=c)p++;p--,E=E/c|0;for(var C=a.length-d,R=C%p,w=Math.min(C,C-R)+d,l=0,b=d;b<w;b+=p)l=q(a,b,b+p,c),this.imuln(E),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(0!==R){var ue=1;for(l=q(a,b,a.length,c),b=0;b<R;b++)ue*=c;this.imuln(ue),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}this.strip()},h.prototype.copy=function(a){a.words=new Array(this.length);for(var c=0;c<this.length;c++)a.words[c]=this.words[c];a.length=this.length,a.negative=this.negative,a.red=this.red},h.prototype.clone=function(){var a=new h(null);return this.copy(a),a},h.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},h.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},h.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},h.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var oe=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],le=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],ee=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function j(_,a,c){c.negative=a.negative^_.negative;var d=_.length+a.length|0;c.length=d,d=d-1|0;var p=0|_.words[0],E=0|a.words[0],C=p*E,w=C/67108864|0;c.words[0]=67108863&C;for(var l=1;l<d;l++){for(var b=w>>>26,ue=67108863&w,me=Math.min(l,a.length-1),ye=Math.max(0,l-_.length+1);ye<=me;ye++)b+=(C=(p=0|_.words[l-ye|0])*(E=0|a.words[ye])+ue)/67108864|0,ue=67108863&C;c.words[l]=0|ue,w=0|b}return 0!==w?c.words[l]=0|w:c.length--,c.strip()}h.prototype.toString=function(a,c){var d;if(c=0|c||1,16===(a=a||10)||"hex"===a){d="";for(var p=0,E=0,C=0;C<this.length;C++){var R=this.words[C],w=(16777215&(R<<p|E)).toString(16);d=0!=(E=R>>>24-p&16777215)||C!==this.length-1?oe[6-w.length]+w+d:w+d,(p+=2)>=26&&(p-=26,C--)}for(0!==E&&(d=E.toString(16)+d);d.length%c!=0;)d="0"+d;return 0!==this.negative&&(d="-"+d),d}if(a===(0|a)&&a>=2&&a<=36){var l=le[a],b=ee[a];d="";var ue=this.clone();for(ue.negative=0;!ue.isZero();){var me=ue.modn(b).toString(a);d=(ue=ue.idivn(b)).isZero()?me+d:oe[l-me.length]+me+d}for(this.isZero()&&(d="0"+d);d.length%c!=0;)d="0"+d;return 0!==this.negative&&(d="-"+d),d}v(!1,"Base should be between 2 and 36")},h.prototype.toNumber=function(){var a=this.words[0];return 2===this.length?a+=67108864*this.words[1]:3===this.length&&1===this.words[2]?a+=4503599627370496+67108864*this.words[1]:this.length>2&&v(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-a:a},h.prototype.toJSON=function(){return this.toString(16)},h.prototype.toBuffer=function(a,c){return v(typeof T<"u"),this.toArrayLike(T,a,c)},h.prototype.toArray=function(a,c){return this.toArrayLike(Array,a,c)},h.prototype.toArrayLike=function(a,c,d){var p=this.byteLength(),E=d||Math.max(1,p);v(p<=E,"byte array longer than desired length"),v(E>0,"Requested array length <= 0"),this.strip();var w,l,C="le"===c,R=new a(E),b=this.clone();if(C){for(l=0;!b.isZero();l++)w=b.andln(255),b.iushrn(8),R[l]=w;for(;l<E;l++)R[l]=0}else{for(l=0;l<E-p;l++)R[l]=0;for(l=0;!b.isZero();l++)w=b.andln(255),b.iushrn(8),R[E-l-1]=w}return R},h.prototype._countBits=Math.clz32?function(a){return 32-Math.clz32(a)}:function(a){var c=a,d=0;return c>=4096&&(d+=13,c>>>=13),c>=64&&(d+=7,c>>>=7),c>=8&&(d+=4,c>>>=4),c>=2&&(d+=2,c>>>=2),d+c},h.prototype._zeroBits=function(a){if(0===a)return 26;var c=a,d=0;return 8191&c||(d+=13,c>>>=13),127&c||(d+=7,c>>>=7),15&c||(d+=4,c>>>=4),3&c||(d+=2,c>>>=2),1&c||d++,d},h.prototype.bitLength=function(){var c=this._countBits(this.words[this.length-1]);return 26*(this.length-1)+c},h.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,c=0;c<this.length;c++){var d=this._zeroBits(this.words[c]);if(a+=d,26!==d)break}return a},h.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},h.prototype.toTwos=function(a){return 0!==this.negative?this.abs().inotn(a).iaddn(1):this.clone()},h.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},h.prototype.isNeg=function(){return 0!==this.negative},h.prototype.neg=function(){return this.clone().ineg()},h.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},h.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var c=0;c<a.length;c++)this.words[c]=this.words[c]|a.words[c];return this.strip()},h.prototype.ior=function(a){return v(!(this.negative|a.negative)),this.iuor(a)},h.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},h.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},h.prototype.iuand=function(a){var c;c=this.length>a.length?a:this;for(var d=0;d<c.length;d++)this.words[d]=this.words[d]&a.words[d];return this.length=c.length,this.strip()},h.prototype.iand=function(a){return v(!(this.negative|a.negative)),this.iuand(a)},h.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},h.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},h.prototype.iuxor=function(a){var c,d;this.length>a.length?(c=this,d=a):(c=a,d=this);for(var p=0;p<d.length;p++)this.words[p]=c.words[p]^d.words[p];if(this!==c)for(;p<c.length;p++)this.words[p]=c.words[p];return this.length=c.length,this.strip()},h.prototype.ixor=function(a){return v(!(this.negative|a.negative)),this.iuxor(a)},h.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},h.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},h.prototype.inotn=function(a){v("number"==typeof a&&a>=0);var c=0|Math.ceil(a/26),d=a%26;this._expand(c),d>0&&c--;for(var p=0;p<c;p++)this.words[p]=67108863&~this.words[p];return d>0&&(this.words[p]=~this.words[p]&67108863>>26-d),this.strip()},h.prototype.notn=function(a){return this.clone().inotn(a)},h.prototype.setn=function(a,c){v("number"==typeof a&&a>=0);var d=a/26|0,p=a%26;return this._expand(d+1),this.words[d]=c?this.words[d]|1<<p:this.words[d]&~(1<<p),this.strip()},h.prototype.iadd=function(a){var c,d,p;if(0!==this.negative&&0===a.negative)return this.negative=0,c=this.isub(a),this.negative^=1,this._normSign();if(0===this.negative&&0!==a.negative)return a.negative=0,c=this.isub(a),a.negative=1,c._normSign();this.length>a.length?(d=this,p=a):(d=a,p=this);for(var E=0,C=0;C<p.length;C++)this.words[C]=67108863&(c=(0|d.words[C])+(0|p.words[C])+E),E=c>>>26;for(;0!==E&&C<d.length;C++)this.words[C]=67108863&(c=(0|d.words[C])+E),E=c>>>26;if(this.length=d.length,0!==E)this.words[this.length]=E,this.length++;else if(d!==this)for(;C<d.length;C++)this.words[C]=d.words[C];return this},h.prototype.add=function(a){var c;return 0!==a.negative&&0===this.negative?(a.negative=0,c=this.sub(a),a.negative^=1,c):0===a.negative&&0!==this.negative?(this.negative=0,c=a.sub(this),this.negative=1,c):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},h.prototype.isub=function(a){if(0!==a.negative){a.negative=0;var c=this.iadd(a);return a.negative=1,c._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var p,E,d=this.cmp(a);if(0===d)return this.negative=0,this.length=1,this.words[0]=0,this;d>0?(p=this,E=a):(p=a,E=this);for(var C=0,R=0;R<E.length;R++)C=(c=(0|p.words[R])-(0|E.words[R])+C)>>26,this.words[R]=67108863&c;for(;0!==C&&R<p.length;R++)C=(c=(0|p.words[R])+C)>>26,this.words[R]=67108863&c;if(0===C&&R<p.length&&p!==this)for(;R<p.length;R++)this.words[R]=p.words[R];return this.length=Math.max(this.length,R),p!==this&&(this.negative=1),this.strip()},h.prototype.sub=function(a){return this.clone().isub(a)};var F=function(a,c,d){var w,l,b,p=a.words,E=c.words,C=d.words,R=0,ue=0|p[0],me=8191&ue,ye=ue>>>13,xe=0|p[1],Ce=8191&xe,Ue=xe>>>13,at=0|p[2],Se=8191&at,Ne=at>>>13,Kt=0|p[3],Ke=8191&Kt,Ze=Kt>>>13,Ar=0|p[4],lt=8191&Ar,ct=Ar>>>13,Cr=0|p[5],Xe=8191&Cr,ut=Cr>>>13,Hn=0|p[6],Qe=8191&Hn,He=Hn>>>13,Vn=0|p[7],ft=8191&Vn,ht=Vn>>>13,Yn=0|p[8],Ge=8191&Yn,Pe=Yn>>>13,kn=0|p[9],Ve=8191&kn,Je=kn>>>13,Kn=0|E[0],et=8191&Kn,tt=Kn>>>13,un=0|E[1],nt=8191&un,Ye=un>>>13,Zn=0|E[2],rt=8191&Zn,it=Zn>>>13,Tr=0|E[3],Le=8191&Tr,ze=Tr>>>13,fn=0|E[4],dt=8191&fn,gt=fn>>>13,hn=0|E[5],Oe=8191&hn,pt=hn>>>13,Xn=0|E[6],Be=8191&Xn,De=Xn>>>13,Qn=0|E[7],mt=8191&Qn,We=Qn>>>13,Jn=0|E[8],je=8191&Jn,Fe=Jn>>>13,Sn=0|E[9],ot=8191&Sn,yt=Sn>>>13;d.negative=a.negative^c.negative,d.length=19;var dn=(R+(w=Math.imul(me,et))|0)+((8191&(l=(l=Math.imul(me,tt))+Math.imul(ye,et)|0))<<13)|0;R=((b=Math.imul(ye,tt))+(l>>>13)|0)+(dn>>>26)|0,dn&=67108863,w=Math.imul(Ce,et),l=(l=Math.imul(Ce,tt))+Math.imul(Ue,et)|0,b=Math.imul(Ue,tt);var er=(R+(w=w+Math.imul(me,nt)|0)|0)+((8191&(l=(l=l+Math.imul(me,Ye)|0)+Math.imul(ye,nt)|0))<<13)|0;R=((b=b+Math.imul(ye,Ye)|0)+(l>>>13)|0)+(er>>>26)|0,er&=67108863,w=Math.imul(Se,et),l=(l=Math.imul(Se,tt))+Math.imul(Ne,et)|0,b=Math.imul(Ne,tt),w=w+Math.imul(Ce,nt)|0,l=(l=l+Math.imul(Ce,Ye)|0)+Math.imul(Ue,nt)|0,b=b+Math.imul(Ue,Ye)|0;var tr=(R+(w=w+Math.imul(me,rt)|0)|0)+((8191&(l=(l=l+Math.imul(me,it)|0)+Math.imul(ye,rt)|0))<<13)|0;R=((b=b+Math.imul(ye,it)|0)+(l>>>13)|0)+(tr>>>26)|0,tr&=67108863,w=Math.imul(Ke,et),l=(l=Math.imul(Ke,tt))+Math.imul(Ze,et)|0,b=Math.imul(Ze,tt),w=w+Math.imul(Se,nt)|0,l=(l=l+Math.imul(Se,Ye)|0)+Math.imul(Ne,nt)|0,b=b+Math.imul(Ne,Ye)|0,w=w+Math.imul(Ce,rt)|0,l=(l=l+Math.imul(Ce,it)|0)+Math.imul(Ue,rt)|0,b=b+Math.imul(Ue,it)|0;var Zt=(R+(w=w+Math.imul(me,Le)|0)|0)+((8191&(l=(l=l+Math.imul(me,ze)|0)+Math.imul(ye,Le)|0))<<13)|0;R=((b=b+Math.imul(ye,ze)|0)+(l>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,w=Math.imul(lt,et),l=(l=Math.imul(lt,tt))+Math.imul(ct,et)|0,b=Math.imul(ct,tt),w=w+Math.imul(Ke,nt)|0,l=(l=l+Math.imul(Ke,Ye)|0)+Math.imul(Ze,nt)|0,b=b+Math.imul(Ze,Ye)|0,w=w+Math.imul(Se,rt)|0,l=(l=l+Math.imul(Se,it)|0)+Math.imul(Ne,rt)|0,b=b+Math.imul(Ne,it)|0,w=w+Math.imul(Ce,Le)|0,l=(l=l+Math.imul(Ce,ze)|0)+Math.imul(Ue,Le)|0,b=b+Math.imul(Ue,ze)|0;var An=(R+(w=w+Math.imul(me,dt)|0)|0)+((8191&(l=(l=l+Math.imul(me,gt)|0)+Math.imul(ye,dt)|0))<<13)|0;R=((b=b+Math.imul(ye,gt)|0)+(l>>>13)|0)+(An>>>26)|0,An&=67108863,w=Math.imul(Xe,et),l=(l=Math.imul(Xe,tt))+Math.imul(ut,et)|0,b=Math.imul(ut,tt),w=w+Math.imul(lt,nt)|0,l=(l=l+Math.imul(lt,Ye)|0)+Math.imul(ct,nt)|0,b=b+Math.imul(ct,Ye)|0,w=w+Math.imul(Ke,rt)|0,l=(l=l+Math.imul(Ke,it)|0)+Math.imul(Ze,rt)|0,b=b+Math.imul(Ze,it)|0,w=w+Math.imul(Se,Le)|0,l=(l=l+Math.imul(Se,ze)|0)+Math.imul(Ne,Le)|0,b=b+Math.imul(Ne,ze)|0,w=w+Math.imul(Ce,dt)|0,l=(l=l+Math.imul(Ce,gt)|0)+Math.imul(Ue,dt)|0,b=b+Math.imul(Ue,gt)|0;var Cn=(R+(w=w+Math.imul(me,Oe)|0)|0)+((8191&(l=(l=l+Math.imul(me,pt)|0)+Math.imul(ye,Oe)|0))<<13)|0;R=((b=b+Math.imul(ye,pt)|0)+(l>>>13)|0)+(Cn>>>26)|0,Cn&=67108863,w=Math.imul(Qe,et),l=(l=Math.imul(Qe,tt))+Math.imul(He,et)|0,b=Math.imul(He,tt),w=w+Math.imul(Xe,nt)|0,l=(l=l+Math.imul(Xe,Ye)|0)+Math.imul(ut,nt)|0,b=b+Math.imul(ut,Ye)|0,w=w+Math.imul(lt,rt)|0,l=(l=l+Math.imul(lt,it)|0)+Math.imul(ct,rt)|0,b=b+Math.imul(ct,it)|0,w=w+Math.imul(Ke,Le)|0,l=(l=l+Math.imul(Ke,ze)|0)+Math.imul(Ze,Le)|0,b=b+Math.imul(Ze,ze)|0,w=w+Math.imul(Se,dt)|0,l=(l=l+Math.imul(Se,gt)|0)+Math.imul(Ne,dt)|0,b=b+Math.imul(Ne,gt)|0,w=w+Math.imul(Ce,Oe)|0,l=(l=l+Math.imul(Ce,pt)|0)+Math.imul(Ue,Oe)|0,b=b+Math.imul(Ue,pt)|0;var Tn=(R+(w=w+Math.imul(me,Be)|0)|0)+((8191&(l=(l=l+Math.imul(me,De)|0)+Math.imul(ye,Be)|0))<<13)|0;R=((b=b+Math.imul(ye,De)|0)+(l>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,w=Math.imul(ft,et),l=(l=Math.imul(ft,tt))+Math.imul(ht,et)|0,b=Math.imul(ht,tt),w=w+Math.imul(Qe,nt)|0,l=(l=l+Math.imul(Qe,Ye)|0)+Math.imul(He,nt)|0,b=b+Math.imul(He,Ye)|0,w=w+Math.imul(Xe,rt)|0,l=(l=l+Math.imul(Xe,it)|0)+Math.imul(ut,rt)|0,b=b+Math.imul(ut,it)|0,w=w+Math.imul(lt,Le)|0,l=(l=l+Math.imul(lt,ze)|0)+Math.imul(ct,Le)|0,b=b+Math.imul(ct,ze)|0,w=w+Math.imul(Ke,dt)|0,l=(l=l+Math.imul(Ke,gt)|0)+Math.imul(Ze,dt)|0,b=b+Math.imul(Ze,gt)|0,w=w+Math.imul(Se,Oe)|0,l=(l=l+Math.imul(Se,pt)|0)+Math.imul(Ne,Oe)|0,b=b+Math.imul(Ne,pt)|0,w=w+Math.imul(Ce,Be)|0,l=(l=l+Math.imul(Ce,De)|0)+Math.imul(Ue,Be)|0,b=b+Math.imul(Ue,De)|0;var In=(R+(w=w+Math.imul(me,mt)|0)|0)+((8191&(l=(l=l+Math.imul(me,We)|0)+Math.imul(ye,mt)|0))<<13)|0;R=((b=b+Math.imul(ye,We)|0)+(l>>>13)|0)+(In>>>26)|0,In&=67108863,w=Math.imul(Ge,et),l=(l=Math.imul(Ge,tt))+Math.imul(Pe,et)|0,b=Math.imul(Pe,tt),w=w+Math.imul(ft,nt)|0,l=(l=l+Math.imul(ft,Ye)|0)+Math.imul(ht,nt)|0,b=b+Math.imul(ht,Ye)|0,w=w+Math.imul(Qe,rt)|0,l=(l=l+Math.imul(Qe,it)|0)+Math.imul(He,rt)|0,b=b+Math.imul(He,it)|0,w=w+Math.imul(Xe,Le)|0,l=(l=l+Math.imul(Xe,ze)|0)+Math.imul(ut,Le)|0,b=b+Math.imul(ut,ze)|0,w=w+Math.imul(lt,dt)|0,l=(l=l+Math.imul(lt,gt)|0)+Math.imul(ct,dt)|0,b=b+Math.imul(ct,gt)|0,w=w+Math.imul(Ke,Oe)|0,l=(l=l+Math.imul(Ke,pt)|0)+Math.imul(Ze,Oe)|0,b=b+Math.imul(Ze,pt)|0,w=w+Math.imul(Se,Be)|0,l=(l=l+Math.imul(Se,De)|0)+Math.imul(Ne,Be)|0,b=b+Math.imul(Ne,De)|0,w=w+Math.imul(Ce,mt)|0,l=(l=l+Math.imul(Ce,We)|0)+Math.imul(Ue,mt)|0,b=b+Math.imul(Ue,We)|0;var Rn=(R+(w=w+Math.imul(me,je)|0)|0)+((8191&(l=(l=l+Math.imul(me,Fe)|0)+Math.imul(ye,je)|0))<<13)|0;R=((b=b+Math.imul(ye,Fe)|0)+(l>>>13)|0)+(Rn>>>26)|0,Rn&=67108863,w=Math.imul(Ve,et),l=(l=Math.imul(Ve,tt))+Math.imul(Je,et)|0,b=Math.imul(Je,tt),w=w+Math.imul(Ge,nt)|0,l=(l=l+Math.imul(Ge,Ye)|0)+Math.imul(Pe,nt)|0,b=b+Math.imul(Pe,Ye)|0,w=w+Math.imul(ft,rt)|0,l=(l=l+Math.imul(ft,it)|0)+Math.imul(ht,rt)|0,b=b+Math.imul(ht,it)|0,w=w+Math.imul(Qe,Le)|0,l=(l=l+Math.imul(Qe,ze)|0)+Math.imul(He,Le)|0,b=b+Math.imul(He,ze)|0,w=w+Math.imul(Xe,dt)|0,l=(l=l+Math.imul(Xe,gt)|0)+Math.imul(ut,dt)|0,b=b+Math.imul(ut,gt)|0,w=w+Math.imul(lt,Oe)|0,l=(l=l+Math.imul(lt,pt)|0)+Math.imul(ct,Oe)|0,b=b+Math.imul(ct,pt)|0,w=w+Math.imul(Ke,Be)|0,l=(l=l+Math.imul(Ke,De)|0)+Math.imul(Ze,Be)|0,b=b+Math.imul(Ze,De)|0,w=w+Math.imul(Se,mt)|0,l=(l=l+Math.imul(Se,We)|0)+Math.imul(Ne,mt)|0,b=b+Math.imul(Ne,We)|0,w=w+Math.imul(Ce,je)|0,l=(l=l+Math.imul(Ce,Fe)|0)+Math.imul(Ue,je)|0,b=b+Math.imul(Ue,Fe)|0;var Bt=(R+(w=w+Math.imul(me,ot)|0)|0)+((8191&(l=(l=l+Math.imul(me,yt)|0)+Math.imul(ye,ot)|0))<<13)|0;R=((b=b+Math.imul(ye,yt)|0)+(l>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,w=Math.imul(Ve,nt),l=(l=Math.imul(Ve,Ye))+Math.imul(Je,nt)|0,b=Math.imul(Je,Ye),w=w+Math.imul(Ge,rt)|0,l=(l=l+Math.imul(Ge,it)|0)+Math.imul(Pe,rt)|0,b=b+Math.imul(Pe,it)|0,w=w+Math.imul(ft,Le)|0,l=(l=l+Math.imul(ft,ze)|0)+Math.imul(ht,Le)|0,b=b+Math.imul(ht,ze)|0,w=w+Math.imul(Qe,dt)|0,l=(l=l+Math.imul(Qe,gt)|0)+Math.imul(He,dt)|0,b=b+Math.imul(He,gt)|0,w=w+Math.imul(Xe,Oe)|0,l=(l=l+Math.imul(Xe,pt)|0)+Math.imul(ut,Oe)|0,b=b+Math.imul(ut,pt)|0,w=w+Math.imul(lt,Be)|0,l=(l=l+Math.imul(lt,De)|0)+Math.imul(ct,Be)|0,b=b+Math.imul(ct,De)|0,w=w+Math.imul(Ke,mt)|0,l=(l=l+Math.imul(Ke,We)|0)+Math.imul(Ze,mt)|0,b=b+Math.imul(Ze,We)|0,w=w+Math.imul(Se,je)|0,l=(l=l+Math.imul(Se,Fe)|0)+Math.imul(Ne,je)|0,b=b+Math.imul(Ne,Fe)|0;var Nt=(R+(w=w+Math.imul(Ce,ot)|0)|0)+((8191&(l=(l=l+Math.imul(Ce,yt)|0)+Math.imul(Ue,ot)|0))<<13)|0;R=((b=b+Math.imul(Ue,yt)|0)+(l>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,w=Math.imul(Ve,rt),l=(l=Math.imul(Ve,it))+Math.imul(Je,rt)|0,b=Math.imul(Je,it),w=w+Math.imul(Ge,Le)|0,l=(l=l+Math.imul(Ge,ze)|0)+Math.imul(Pe,Le)|0,b=b+Math.imul(Pe,ze)|0,w=w+Math.imul(ft,dt)|0,l=(l=l+Math.imul(ft,gt)|0)+Math.imul(ht,dt)|0,b=b+Math.imul(ht,gt)|0,w=w+Math.imul(Qe,Oe)|0,l=(l=l+Math.imul(Qe,pt)|0)+Math.imul(He,Oe)|0,b=b+Math.imul(He,pt)|0,w=w+Math.imul(Xe,Be)|0,l=(l=l+Math.imul(Xe,De)|0)+Math.imul(ut,Be)|0,b=b+Math.imul(ut,De)|0,w=w+Math.imul(lt,mt)|0,l=(l=l+Math.imul(lt,We)|0)+Math.imul(ct,mt)|0,b=b+Math.imul(ct,We)|0,w=w+Math.imul(Ke,je)|0,l=(l=l+Math.imul(Ke,Fe)|0)+Math.imul(Ze,je)|0,b=b+Math.imul(Ze,Fe)|0;var gn=(R+(w=w+Math.imul(Se,ot)|0)|0)+((8191&(l=(l=l+Math.imul(Se,yt)|0)+Math.imul(Ne,ot)|0))<<13)|0;R=((b=b+Math.imul(Ne,yt)|0)+(l>>>13)|0)+(gn>>>26)|0,gn&=67108863,w=Math.imul(Ve,Le),l=(l=Math.imul(Ve,ze))+Math.imul(Je,Le)|0,b=Math.imul(Je,ze),w=w+Math.imul(Ge,dt)|0,l=(l=l+Math.imul(Ge,gt)|0)+Math.imul(Pe,dt)|0,b=b+Math.imul(Pe,gt)|0,w=w+Math.imul(ft,Oe)|0,l=(l=l+Math.imul(ft,pt)|0)+Math.imul(ht,Oe)|0,b=b+Math.imul(ht,pt)|0,w=w+Math.imul(Qe,Be)|0,l=(l=l+Math.imul(Qe,De)|0)+Math.imul(He,Be)|0,b=b+Math.imul(He,De)|0,w=w+Math.imul(Xe,mt)|0,l=(l=l+Math.imul(Xe,We)|0)+Math.imul(ut,mt)|0,b=b+Math.imul(ut,We)|0,w=w+Math.imul(lt,je)|0,l=(l=l+Math.imul(lt,Fe)|0)+Math.imul(ct,je)|0,b=b+Math.imul(ct,Fe)|0;var Bn=(R+(w=w+Math.imul(Ke,ot)|0)|0)+((8191&(l=(l=l+Math.imul(Ke,yt)|0)+Math.imul(Ze,ot)|0))<<13)|0;R=((b=b+Math.imul(Ze,yt)|0)+(l>>>13)|0)+(Bn>>>26)|0,Bn&=67108863,w=Math.imul(Ve,dt),l=(l=Math.imul(Ve,gt))+Math.imul(Je,dt)|0,b=Math.imul(Je,gt),w=w+Math.imul(Ge,Oe)|0,l=(l=l+Math.imul(Ge,pt)|0)+Math.imul(Pe,Oe)|0,b=b+Math.imul(Pe,pt)|0,w=w+Math.imul(ft,Be)|0,l=(l=l+Math.imul(ft,De)|0)+Math.imul(ht,Be)|0,b=b+Math.imul(ht,De)|0,w=w+Math.imul(Qe,mt)|0,l=(l=l+Math.imul(Qe,We)|0)+Math.imul(He,mt)|0,b=b+Math.imul(He,We)|0,w=w+Math.imul(Xe,je)|0,l=(l=l+Math.imul(Xe,Fe)|0)+Math.imul(ut,je)|0,b=b+Math.imul(ut,Fe)|0;var Tt=(R+(w=w+Math.imul(lt,ot)|0)|0)+((8191&(l=(l=l+Math.imul(lt,yt)|0)+Math.imul(ct,ot)|0))<<13)|0;R=((b=b+Math.imul(ct,yt)|0)+(l>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,w=Math.imul(Ve,Oe),l=(l=Math.imul(Ve,pt))+Math.imul(Je,Oe)|0,b=Math.imul(Je,pt),w=w+Math.imul(Ge,Be)|0,l=(l=l+Math.imul(Ge,De)|0)+Math.imul(Pe,Be)|0,b=b+Math.imul(Pe,De)|0,w=w+Math.imul(ft,mt)|0,l=(l=l+Math.imul(ft,We)|0)+Math.imul(ht,mt)|0,b=b+Math.imul(ht,We)|0,w=w+Math.imul(Qe,je)|0,l=(l=l+Math.imul(Qe,Fe)|0)+Math.imul(He,je)|0,b=b+Math.imul(He,Fe)|0;var nr=(R+(w=w+Math.imul(Xe,ot)|0)|0)+((8191&(l=(l=l+Math.imul(Xe,yt)|0)+Math.imul(ut,ot)|0))<<13)|0;R=((b=b+Math.imul(ut,yt)|0)+(l>>>13)|0)+(nr>>>26)|0,nr&=67108863,w=Math.imul(Ve,Be),l=(l=Math.imul(Ve,De))+Math.imul(Je,Be)|0,b=Math.imul(Je,De),w=w+Math.imul(Ge,mt)|0,l=(l=l+Math.imul(Ge,We)|0)+Math.imul(Pe,mt)|0,b=b+Math.imul(Pe,We)|0,w=w+Math.imul(ft,je)|0,l=(l=l+Math.imul(ft,Fe)|0)+Math.imul(ht,je)|0,b=b+Math.imul(ht,Fe)|0;var pn=(R+(w=w+Math.imul(Qe,ot)|0)|0)+((8191&(l=(l=l+Math.imul(Qe,yt)|0)+Math.imul(He,ot)|0))<<13)|0;R=((b=b+Math.imul(He,yt)|0)+(l>>>13)|0)+(pn>>>26)|0,pn&=67108863,w=Math.imul(Ve,mt),l=(l=Math.imul(Ve,We))+Math.imul(Je,mt)|0,b=Math.imul(Je,We),w=w+Math.imul(Ge,je)|0,l=(l=l+Math.imul(Ge,Fe)|0)+Math.imul(Pe,je)|0,b=b+Math.imul(Pe,Fe)|0;var Xt=(R+(w=w+Math.imul(ft,ot)|0)|0)+((8191&(l=(l=l+Math.imul(ft,yt)|0)+Math.imul(ht,ot)|0))<<13)|0;R=((b=b+Math.imul(ht,yt)|0)+(l>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,w=Math.imul(Ve,je),l=(l=Math.imul(Ve,Fe))+Math.imul(Je,je)|0,b=Math.imul(Je,Fe);var Nn=(R+(w=w+Math.imul(Ge,ot)|0)|0)+((8191&(l=(l=l+Math.imul(Ge,yt)|0)+Math.imul(Pe,ot)|0))<<13)|0;R=((b=b+Math.imul(Pe,yt)|0)+(l>>>13)|0)+(Nn>>>26)|0,Nn&=67108863;var Qt=(R+(w=Math.imul(Ve,ot))|0)+((8191&(l=(l=Math.imul(Ve,yt))+Math.imul(Je,ot)|0))<<13)|0;return R=((b=Math.imul(Je,yt))+(l>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,C[0]=dn,C[1]=er,C[2]=tr,C[3]=Zt,C[4]=An,C[5]=Cn,C[6]=Tn,C[7]=In,C[8]=Rn,C[9]=Bt,C[10]=Nt,C[11]=gn,C[12]=Bn,C[13]=Tt,C[14]=nr,C[15]=pn,C[16]=Xt,C[17]=Nn,C[18]=Qt,0!==R&&(C[19]=R,d.length++),d};function W(_,a,c){return(new ne).mulp(_,a,c)}function ne(_,a){this.x=_,this.y=a}Math.imul||(F=j),h.prototype.mulTo=function(a,c){var d,p=this.length+a.length;return d=10===this.length&&10===a.length?F(this,a,c):p<63?j(this,a,c):p<1024?function he(_,a,c){c.negative=a.negative^_.negative,c.length=_.length+a.length;for(var d=0,p=0,E=0;E<c.length-1;E++){var C=p;p=0;for(var R=67108863&d,w=Math.min(E,a.length-1),l=Math.max(0,E-_.length+1);l<=w;l++){var ye=(0|_.words[E-l])*(0|a.words[l]),xe=67108863&ye;R=67108863&(xe=xe+R|0),p+=(C=(C=C+(ye/67108864|0)|0)+(xe>>>26)|0)>>>26,C&=67108863}c.words[E]=R,d=C,C=p}return 0!==d?c.words[E]=d:c.length--,c.strip()}(this,a,c):W(this,a,c),d},ne.prototype.makeRBT=function(a){for(var c=new Array(a),d=h.prototype._countBits(a)-1,p=0;p<a;p++)c[p]=this.revBin(p,d,a);return c},ne.prototype.revBin=function(a,c,d){if(0===a||a===d-1)return a;for(var p=0,E=0;E<c;E++)p|=(1&a)<<c-E-1,a>>=1;return p},ne.prototype.permute=function(a,c,d,p,E,C){for(var R=0;R<C;R++)p[R]=c[a[R]],E[R]=d[a[R]]},ne.prototype.transform=function(a,c,d,p,E,C){this.permute(C,a,c,d,p,E);for(var R=1;R<E;R<<=1)for(var w=R<<1,l=Math.cos(2*Math.PI/w),b=Math.sin(2*Math.PI/w),ue=0;ue<E;ue+=w)for(var me=l,ye=b,xe=0;xe<R;xe++){var Ce=d[ue+xe],Ue=p[ue+xe],at=d[ue+xe+R],Se=p[ue+xe+R],Ne=me*at-ye*Se;Se=me*Se+ye*at,d[ue+xe]=Ce+(at=Ne),p[ue+xe]=Ue+Se,d[ue+xe+R]=Ce-at,p[ue+xe+R]=Ue-Se,xe!==w&&(Ne=l*me-b*ye,ye=l*ye+b*me,me=Ne)}},ne.prototype.guessLen13b=function(a,c){var d=1|Math.max(c,a),p=1&d,E=0;for(d=d/2|0;d;d>>>=1)E++;return 1<<E+1+p},ne.prototype.conjugate=function(a,c,d){if(!(d<=1))for(var p=0;p<d/2;p++){var E=a[p];a[p]=a[d-p-1],a[d-p-1]=E,E=c[p],c[p]=-c[d-p-1],c[d-p-1]=-E}},ne.prototype.normalize13b=function(a,c){for(var d=0,p=0;p<c/2;p++){var E=8192*Math.round(a[2*p+1]/c)+Math.round(a[2*p]/c)+d;a[p]=67108863&E,d=E<67108864?0:E/67108864|0}return a},ne.prototype.convert13b=function(a,c,d,p){for(var E=0,C=0;C<c;C++)d[2*C]=8191&(E+=0|a[C]),d[2*C+1]=8191&(E>>>=13),E>>>=13;for(C=2*c;C<p;++C)d[C]=0;v(0===E),v(!(-8192&E))},ne.prototype.stub=function(a){for(var c=new Array(a),d=0;d<a;d++)c[d]=0;return c},ne.prototype.mulp=function(a,c,d){var p=2*this.guessLen13b(a.length,c.length),E=this.makeRBT(p),C=this.stub(p),R=new Array(p),w=new Array(p),l=new Array(p),b=new Array(p),ue=new Array(p),me=new Array(p),ye=d.words;ye.length=p,this.convert13b(a.words,a.length,R,p),this.convert13b(c.words,c.length,b,p),this.transform(R,C,w,l,p,E),this.transform(b,C,ue,me,p,E);for(var xe=0;xe<p;xe++){var Ce=w[xe]*ue[xe]-l[xe]*me[xe];l[xe]=w[xe]*me[xe]+l[xe]*ue[xe],w[xe]=Ce}return this.conjugate(w,l,p),this.transform(w,l,ye,C,p,E),this.conjugate(ye,C,p),this.normalize13b(ye,p),d.negative=a.negative^c.negative,d.length=a.length+c.length,d.strip()},h.prototype.mul=function(a){var c=new h(null);return c.words=new Array(this.length+a.length),this.mulTo(a,c)},h.prototype.mulf=function(a){var c=new h(null);return c.words=new Array(this.length+a.length),W(this,a,c)},h.prototype.imul=function(a){return this.clone().mulTo(a,this)},h.prototype.imuln=function(a){v("number"==typeof a),v(a<67108864);for(var c=0,d=0;d<this.length;d++){var p=(0|this.words[d])*a,E=(67108863&p)+(67108863&c);c>>=26,c+=p/67108864|0,c+=E>>>26,this.words[d]=67108863&E}return 0!==c&&(this.words[d]=c,this.length++),this},h.prototype.muln=function(a){return this.clone().imuln(a)},h.prototype.sqr=function(){return this.mul(this)},h.prototype.isqr=function(){return this.imul(this.clone())},h.prototype.pow=function(a){var c=function te(_){for(var a=new Array(_.bitLength()),c=0;c<a.length;c++){var p=c%26;a[c]=(_.words[c/26|0]&1<<p)>>>p}return a}(a);if(0===c.length)return new h(1);for(var d=this,p=0;p<c.length&&0===c[p];p++,d=d.sqr());if(++p<c.length)for(var E=d.sqr();p<c.length;p++,E=E.sqr())0!==c[p]&&(d=d.mul(E));return d},h.prototype.iushln=function(a){v("number"==typeof a&&a>=0);var E,c=a%26,d=(a-c)/26,p=67108863>>>26-c<<26-c;if(0!==c){var C=0;for(E=0;E<this.length;E++){var R=this.words[E]&p;this.words[E]=(0|this.words[E])-R<<c|C,C=R>>>26-c}C&&(this.words[E]=C,this.length++)}if(0!==d){for(E=this.length-1;E>=0;E--)this.words[E+d]=this.words[E];for(E=0;E<d;E++)this.words[E]=0;this.length+=d}return this.strip()},h.prototype.ishln=function(a){return v(0===this.negative),this.iushln(a)},h.prototype.iushrn=function(a,c,d){var p;v("number"==typeof a&&a>=0),p=c?(c-c%26)/26:0;var E=a%26,C=Math.min((a-E)/26,this.length),R=67108863^67108863>>>E<<E,w=d;if(p-=C,p=Math.max(0,p),w){for(var l=0;l<C;l++)w.words[l]=this.words[l];w.length=C}if(0!==C)if(this.length>C)for(this.length-=C,l=0;l<this.length;l++)this.words[l]=this.words[l+C];else this.words[0]=0,this.length=1;var b=0;for(l=this.length-1;l>=0&&(0!==b||l>=p);l--){var ue=0|this.words[l];this.words[l]=b<<26-E|ue>>>E,b=ue&R}return w&&0!==b&&(w.words[w.length++]=b),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},h.prototype.ishrn=function(a,c,d){return v(0===this.negative),this.iushrn(a,c,d)},h.prototype.shln=function(a){return this.clone().ishln(a)},h.prototype.ushln=function(a){return this.clone().iushln(a)},h.prototype.shrn=function(a){return this.clone().ishrn(a)},h.prototype.ushrn=function(a){return this.clone().iushrn(a)},h.prototype.testn=function(a){v("number"==typeof a&&a>=0);var c=a%26,d=(a-c)/26;return!(this.length<=d||!(this.words[d]&1<<c))},h.prototype.imaskn=function(a){v("number"==typeof a&&a>=0);var c=a%26,d=(a-c)/26;return v(0===this.negative,"imaskn works only with positive numbers"),this.length<=d?this:(0!==c&&d++,this.length=Math.min(d,this.length),0!==c&&(this.words[this.length-1]&=67108863^67108863>>>c<<c),this.strip())},h.prototype.maskn=function(a){return this.clone().imaskn(a)},h.prototype.iaddn=function(a){return v("number"==typeof a),v(a<67108864),a<0?this.isubn(-a):0!==this.negative?1===this.length&&(0|this.words[0])<a?(this.words[0]=a-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},h.prototype._iaddn=function(a){this.words[0]+=a;for(var c=0;c<this.length&&this.words[c]>=67108864;c++)this.words[c]-=67108864,c===this.length-1?this.words[c+1]=1:this.words[c+1]++;return this.length=Math.max(this.length,c+1),this},h.prototype.isubn=function(a){if(v("number"==typeof a),v(a<67108864),a<0)return this.iaddn(-a);if(0!==this.negative)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var c=0;c<this.length&&this.words[c]<0;c++)this.words[c]+=67108864,this.words[c+1]-=1;return this.strip()},h.prototype.addn=function(a){return this.clone().iaddn(a)},h.prototype.subn=function(a){return this.clone().isubn(a)},h.prototype.iabs=function(){return this.negative=0,this},h.prototype.abs=function(){return this.clone().iabs()},h.prototype._ishlnsubmul=function(a,c,d){var E;this._expand(a.length+d);var C,R=0;for(E=0;E<a.length;E++){C=(0|this.words[E+d])+R;var w=(0|a.words[E])*c;R=((C-=67108863&w)>>26)-(w/67108864|0),this.words[E+d]=67108863&C}for(;E<this.length-d;E++)R=(C=(0|this.words[E+d])+R)>>26,this.words[E+d]=67108863&C;if(0===R)return this.strip();for(v(-1===R),R=0,E=0;E<this.length;E++)R=(C=-(0|this.words[E])+R)>>26,this.words[E]=67108863&C;return this.negative=1,this.strip()},h.prototype._wordDiv=function(a,c){var d,p=this.clone(),E=a,C=0|E.words[E.length-1];0!=(d=26-this._countBits(C))&&(E=E.ushln(d),p.iushln(d),C=0|E.words[E.length-1]);var l,w=p.length-E.length;if("mod"!==c){(l=new h(null)).length=w+1,l.words=new Array(l.length);for(var b=0;b<l.length;b++)l.words[b]=0}var ue=p.clone()._ishlnsubmul(E,1,w);0===ue.negative&&(p=ue,l&&(l.words[w]=1));for(var me=w-1;me>=0;me--){var ye=67108864*(0|p.words[E.length+me])+(0|p.words[E.length+me-1]);for(ye=Math.min(ye/C|0,67108863),p._ishlnsubmul(E,ye,me);0!==p.negative;)ye--,p.negative=0,p._ishlnsubmul(E,1,me),p.isZero()||(p.negative^=1);l&&(l.words[me]=ye)}return l&&l.strip(),p.strip(),"div"!==c&&0!==d&&p.iushrn(d),{div:l||null,mod:p}},h.prototype.divmod=function(a,c,d){return v(!a.isZero()),this.isZero()?{div:new h(0),mod:new h(0)}:0!==this.negative&&0===a.negative?(C=this.neg().divmod(a,c),"mod"!==c&&(p=C.div.neg()),"div"!==c&&(E=C.mod.neg(),d&&0!==E.negative&&E.iadd(a)),{div:p,mod:E}):0===this.negative&&0!==a.negative?(C=this.divmod(a.neg(),c),"mod"!==c&&(p=C.div.neg()),{div:p,mod:C.mod}):this.negative&a.negative?(C=this.neg().divmod(a.neg(),c),"div"!==c&&(E=C.mod.neg(),d&&0!==E.negative&&E.isub(a)),{div:C.div,mod:E}):a.length>this.length||this.cmp(a)<0?{div:new h(0),mod:this}:1===a.length?"div"===c?{div:this.divn(a.words[0]),mod:null}:"mod"===c?{div:null,mod:new h(this.modn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new h(this.modn(a.words[0]))}:this._wordDiv(a,c);var p,E,C},h.prototype.div=function(a){return this.divmod(a,"div",!1).div},h.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},h.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},h.prototype.divRound=function(a){var c=this.divmod(a);if(c.mod.isZero())return c.div;var d=0!==c.div.negative?c.mod.isub(a):c.mod,p=a.ushrn(1),E=a.andln(1),C=d.cmp(p);return C<0||1===E&&0===C?c.div:0!==c.div.negative?c.div.isubn(1):c.div.iaddn(1)},h.prototype.modn=function(a){v(a<=67108863);for(var c=(1<<26)%a,d=0,p=this.length-1;p>=0;p--)d=(c*d+(0|this.words[p]))%a;return d},h.prototype.idivn=function(a){v(a<=67108863);for(var c=0,d=this.length-1;d>=0;d--){var p=(0|this.words[d])+67108864*c;this.words[d]=p/a|0,c=p%a}return this.strip()},h.prototype.divn=function(a){return this.clone().idivn(a)},h.prototype.egcd=function(a){v(0===a.negative),v(!a.isZero());var c=this,d=a.clone();c=0!==c.negative?c.umod(a):c.clone();for(var p=new h(1),E=new h(0),C=new h(0),R=new h(1),w=0;c.isEven()&&d.isEven();)c.iushrn(1),d.iushrn(1),++w;for(var l=d.clone(),b=c.clone();!c.isZero();){for(var ue=0,me=1;!(c.words[0]&me)&&ue<26;++ue,me<<=1);if(ue>0)for(c.iushrn(ue);ue-- >0;)(p.isOdd()||E.isOdd())&&(p.iadd(l),E.isub(b)),p.iushrn(1),E.iushrn(1);for(var ye=0,xe=1;!(d.words[0]&xe)&&ye<26;++ye,xe<<=1);if(ye>0)for(d.iushrn(ye);ye-- >0;)(C.isOdd()||R.isOdd())&&(C.iadd(l),R.isub(b)),C.iushrn(1),R.iushrn(1);c.cmp(d)>=0?(c.isub(d),p.isub(C),E.isub(R)):(d.isub(c),C.isub(p),R.isub(E))}return{a:C,b:R,gcd:d.iushln(w)}},h.prototype._invmp=function(a){v(0===a.negative),v(!a.isZero());var ue,c=this,d=a.clone();c=0!==c.negative?c.umod(a):c.clone();for(var p=new h(1),E=new h(0),C=d.clone();c.cmpn(1)>0&&d.cmpn(1)>0;){for(var R=0,w=1;!(c.words[0]&w)&&R<26;++R,w<<=1);if(R>0)for(c.iushrn(R);R-- >0;)p.isOdd()&&p.iadd(C),p.iushrn(1);for(var l=0,b=1;!(d.words[0]&b)&&l<26;++l,b<<=1);if(l>0)for(d.iushrn(l);l-- >0;)E.isOdd()&&E.iadd(C),E.iushrn(1);c.cmp(d)>=0?(c.isub(d),p.isub(E)):(d.isub(c),E.isub(p))}return(ue=0===c.cmpn(1)?p:E).cmpn(0)<0&&ue.iadd(a),ue},h.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var c=this.clone(),d=a.clone();c.negative=0,d.negative=0;for(var p=0;c.isEven()&&d.isEven();p++)c.iushrn(1),d.iushrn(1);for(;;){for(;c.isEven();)c.iushrn(1);for(;d.isEven();)d.iushrn(1);var E=c.cmp(d);if(E<0){var C=c;c=d,d=C}else if(0===E||0===d.cmpn(1))break;c.isub(d)}return d.iushln(p)},h.prototype.invm=function(a){return this.egcd(a).a.umod(a)},h.prototype.isEven=function(){return!(1&this.words[0])},h.prototype.isOdd=function(){return!(1&~this.words[0])},h.prototype.andln=function(a){return this.words[0]&a},h.prototype.bincn=function(a){v("number"==typeof a);var c=a%26,d=(a-c)/26,p=1<<c;if(this.length<=d)return this._expand(d+1),this.words[d]|=p,this;for(var E=p,C=d;0!==E&&C<this.length;C++){var R=0|this.words[C];E=(R+=E)>>>26,this.words[C]=R&=67108863}return 0!==E&&(this.words[C]=E,this.length++),this},h.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},h.prototype.cmpn=function(a){var d,c=a<0;if(0!==this.negative&&!c)return-1;if(0===this.negative&&c)return 1;if(this.strip(),this.length>1)d=1;else{c&&(a=-a),v(a<=67108863,"Number is too big");var p=0|this.words[0];d=p===a?0:p<a?-1:1}return 0!==this.negative?0|-d:d},h.prototype.cmp=function(a){if(0!==this.negative&&0===a.negative)return-1;if(0===this.negative&&0!==a.negative)return 1;var c=this.ucmp(a);return 0!==this.negative?0|-c:c},h.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var c=0,d=this.length-1;d>=0;d--){var p=0|this.words[d],E=0|a.words[d];if(p!==E){p<E?c=-1:p>E&&(c=1);break}}return c},h.prototype.gtn=function(a){return 1===this.cmpn(a)},h.prototype.gt=function(a){return 1===this.cmp(a)},h.prototype.gten=function(a){return this.cmpn(a)>=0},h.prototype.gte=function(a){return this.cmp(a)>=0},h.prototype.ltn=function(a){return-1===this.cmpn(a)},h.prototype.lt=function(a){return-1===this.cmp(a)},h.prototype.lten=function(a){return this.cmpn(a)<=0},h.prototype.lte=function(a){return this.cmp(a)<=0},h.prototype.eqn=function(a){return 0===this.cmpn(a)},h.prototype.eq=function(a){return 0===this.cmp(a)},h.red=function(a){return new se(a)},h.prototype.toRed=function(a){return v(!this.red,"Already a number in reduction context"),v(0===this.negative,"red works only with positives"),a.convertTo(this)._forceRed(a)},h.prototype.fromRed=function(){return v(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},h.prototype._forceRed=function(a){return this.red=a,this},h.prototype.forceRed=function(a){return v(!this.red,"Already a number in reduction context"),this._forceRed(a)},h.prototype.redAdd=function(a){return v(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},h.prototype.redIAdd=function(a){return v(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},h.prototype.redSub=function(a){return v(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},h.prototype.redISub=function(a){return v(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},h.prototype.redShl=function(a){return v(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},h.prototype.redMul=function(a){return v(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},h.prototype.redIMul=function(a){return v(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},h.prototype.redSqr=function(){return v(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},h.prototype.redISqr=function(){return v(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},h.prototype.redSqrt=function(){return v(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},h.prototype.redInvm=function(){return v(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},h.prototype.redNeg=function(){return v(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},h.prototype.redPow=function(a){return v(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var o={k256:null,p224:null,p192:null,p25519:null};function ae(_,a){this.name=_,this.p=new h(a,16),this.n=this.p.bitLength(),this.k=new h(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function ke(){ae.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function $e(){ae.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function de(){ae.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function we(){ae.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function se(_){if("string"==typeof _){var a=h._prime(_);this.m=a.p,this.prime=a}else v(_.gtn(1),"modulus must be greater than 1"),this.m=_,this.prime=null}function ce(_){se.call(this,_),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new h(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}ae.prototype._tmp=function(){var a=new h(null);return a.words=new Array(Math.ceil(this.n/13)),a},ae.prototype.ireduce=function(a){var d,c=a;do{this.split(c,this.tmp),d=(c=(c=this.imulK(c)).iadd(this.tmp)).bitLength()}while(d>this.n);var p=d<this.n?-1:c.ucmp(this.p);return 0===p?(c.words[0]=0,c.length=1):p>0?c.isub(this.p):void 0!==c.strip?c.strip():c._strip(),c},ae.prototype.split=function(a,c){a.iushrn(this.n,0,c)},ae.prototype.imulK=function(a){return a.imul(this.k)},A(ke,ae),ke.prototype.split=function(a,c){for(var d=4194303,p=Math.min(a.length,9),E=0;E<p;E++)c.words[E]=a.words[E];if(c.length=p,a.length<=9)return a.words[0]=0,void(a.length=1);var C=a.words[9];for(c.words[c.length++]=C&d,E=10;E<a.length;E++){var R=0|a.words[E];a.words[E-10]=(R&d)<<4|C>>>22,C=R}a.words[E-10]=C>>>=22,a.length-=0===C&&a.length>10?10:9},ke.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var c=0,d=0;d<a.length;d++){var p=0|a.words[d];a.words[d]=67108863&(c+=977*p),c=64*p+(c/67108864|0)}return 0===a.words[a.length-1]&&(a.length--,0===a.words[a.length-1]&&a.length--),a},A($e,ae),A(de,ae),A(we,ae),we.prototype.imulK=function(a){for(var c=0,d=0;d<a.length;d++){var p=19*(0|a.words[d])+c,E=67108863&p;p>>>=26,a.words[d]=E,c=p}return 0!==c&&(a.words[a.length++]=c),a},h._prime=function(a){if(o[a])return o[a];var c;if("k256"===a)c=new ke;else if("p224"===a)c=new $e;else if("p192"===a)c=new de;else{if("p25519"!==a)throw new Error("Unknown prime "+a);c=new we}return o[a]=c,c},se.prototype._verify1=function(a){v(0===a.negative,"red works only with positives"),v(a.red,"red works only with red numbers")},se.prototype._verify2=function(a,c){v(!(a.negative|c.negative),"red works only with positives"),v(a.red&&a.red===c.red,"red works only with red numbers")},se.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):a.umod(this.m)._forceRed(this)},se.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},se.prototype.add=function(a,c){this._verify2(a,c);var d=a.add(c);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},se.prototype.iadd=function(a,c){this._verify2(a,c);var d=a.iadd(c);return d.cmp(this.m)>=0&&d.isub(this.m),d},se.prototype.sub=function(a,c){this._verify2(a,c);var d=a.sub(c);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},se.prototype.isub=function(a,c){this._verify2(a,c);var d=a.isub(c);return d.cmpn(0)<0&&d.iadd(this.m),d},se.prototype.shl=function(a,c){return this._verify1(a),this.imod(a.ushln(c))},se.prototype.imul=function(a,c){return this._verify2(a,c),this.imod(a.imul(c))},se.prototype.mul=function(a,c){return this._verify2(a,c),this.imod(a.mul(c))},se.prototype.isqr=function(a){return this.imul(a,a.clone())},se.prototype.sqr=function(a){return this.mul(a,a)},se.prototype.sqrt=function(a){if(a.isZero())return a.clone();var c=this.m.andln(3);if(v(c%2==1),3===c){var d=this.m.add(new h(1)).iushrn(2);return this.pow(a,d)}for(var p=this.m.subn(1),E=0;!p.isZero()&&0===p.andln(1);)E++,p.iushrn(1);v(!p.isZero());var C=new h(1).toRed(this),R=C.redNeg(),w=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new h(2*l*l).toRed(this);0!==this.pow(l,w).cmp(R);)l.redIAdd(R);for(var b=this.pow(l,p),ue=this.pow(a,p.addn(1).iushrn(1)),me=this.pow(a,p),ye=E;0!==me.cmp(C);){for(var xe=me,Ce=0;0!==xe.cmp(C);Ce++)xe=xe.redSqr();v(Ce<ye);var Ue=this.pow(b,new h(1).iushln(ye-Ce-1));ue=ue.redMul(Ue),b=Ue.redSqr(),me=me.redMul(b),ye=Ce}return ue},se.prototype.invm=function(a){var c=a._invmp(this.m);return 0!==c.negative?(c.negative=0,this.imod(c).redNeg()):this.imod(c)},se.prototype.pow=function(a,c){if(c.isZero())return new h(1).toRed(this);if(0===c.cmpn(1))return a.clone();var p=new Array(16);p[0]=new h(1).toRed(this),p[1]=a;for(var E=2;E<p.length;E++)p[E]=this.mul(p[E-1],a);var C=p[0],R=0,w=0,l=c.bitLength()%26;for(0===l&&(l=26),E=c.length-1;E>=0;E--){for(var b=c.words[E],ue=l-1;ue>=0;ue--){var me=b>>ue&1;C!==p[0]&&(C=this.sqr(C)),0!==me||0!==R?(R<<=1,R|=me,(4==++w||0===E&&0===ue)&&(C=this.mul(C,p[R]),w=0,R=0)):w=0}l=26}return C},se.prototype.convertTo=function(a){var c=a.umod(this.m);return c===a?c.clone():c},se.prototype.convertFrom=function(a){var c=a.clone();return c.red=null,c},h.mont=function(a){return new ce(a)},A(ce,se),ce.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},ce.prototype.convertFrom=function(a){var c=this.imod(a.mul(this.rinv));return c.red=null,c},ce.prototype.imul=function(a,c){if(a.isZero()||c.isZero())return a.words[0]=0,a.length=1,a;var d=a.imul(c),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=d.isub(p).iushrn(this.shift),C=E;return E.cmp(this.m)>=0?C=E.isub(this.m):E.cmpn(0)<0&&(C=E.iadd(this.m)),C._forceRed(this)},ce.prototype.mul=function(a,c){if(a.isZero()||c.isZero())return new h(0)._forceRed(this);var d=a.mul(c),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=d.isub(p).iushrn(this.shift),C=E;return E.cmp(this.m)>=0?C=E.isub(this.m):E.cmpn(0)<0&&(C=E.iadd(this.m)),C._forceRed(this)},ce.prototype.invm=function(a){return this.imod(a._invmp(this.m).mul(this.r2))._forceRed(this)}}(Ee=S.nmd(Ee),this)},243:Ee=>{"use strict";var U={single_source_shortest_paths:function(S,x,y){var v={},A={};A[x]=0;var T,B,N,q,oe,ee,h=U.PriorityQueue.make();for(h.push(x,0);!h.empty();)for(N in q=(T=h.pop()).cost,oe=S[B=T.value]||{})oe.hasOwnProperty(N)&&(ee=q+oe[N],(typeof A[N]>"u"||A[N]>ee)&&(A[N]=ee,h.push(N,ee),v[N]=B));if(typeof y<"u"&&typeof A[y]>"u"){var F=["Could not find a path from ",x," to ",y,"."].join("");throw new Error(F)}return v},extract_shortest_path_from_predecessor_list:function(S,x){for(var y=[],v=x;v;)y.push(v),v=S[v];return y.reverse(),y},find_path:function(S,x,y){var v=U.single_source_shortest_paths(S,x,y);return U.extract_shortest_path_from_predecessor_list(v,y)},PriorityQueue:{make:function(S){var v,x=U.PriorityQueue,y={};for(v in S=S||{},x)x.hasOwnProperty(v)&&(y[v]=x[v]);return y.queue=[],y.sorter=S.sorter||x.default_sorter,y},default_sorter:function(S,x){return S.cost-x.cost},push:function(S,x){this.queue.push({value:S,cost:x}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};Ee.exports=U},3174:Ee=>{"use strict";Ee.exports=function(S){for(var x=[],y=S.length,v=0;v<y;v++){var A=S.charCodeAt(v);if(A>=55296&&A<=56319&&y>v+1){var h=S.charCodeAt(v+1);h>=56320&&h<=57343&&(A=1024*(A-55296)+h-56320+65536,v+=1)}A<128?x.push(A):A<2048?(x.push(A>>6|192),x.push(63&A|128)):A<55296||A>=57344&&A<65536?(x.push(A>>12|224),x.push(A>>6&63|128),x.push(63&A|128)):A>=65536&&A<=1114111?(x.push(A>>18|240),x.push(A>>12&63|128),x.push(A>>6&63|128),x.push(63&A|128)):x.push(239,191,189)}return new Uint8Array(x).buffer}},6371:Ee=>{"use strict";var U=Object.prototype.hasOwnProperty,S="~";function x(){}function y(T,B,N){this.fn=T,this.context=B,this.once=N||!1}function v(T,B,N,q,oe){if("function"!=typeof N)throw new TypeError("The listener must be a function");var le=new y(N,q||T,oe),ee=S?S+B:B;return T._events[ee]?T._events[ee].fn?T._events[ee]=[T._events[ee],le]:T._events[ee].push(le):(T._events[ee]=le,T._eventsCount++),T}function A(T,B){0==--T._eventsCount?T._events=new x:delete T._events[B]}function h(){this._events=new x,this._eventsCount=0}Object.create&&(x.prototype=Object.create(null),(new x).__proto__||(S=!1)),h.prototype.eventNames=function(){var N,q,B=[];if(0===this._eventsCount)return B;for(q in N=this._events)U.call(N,q)&&B.push(S?q.slice(1):q);return Object.getOwnPropertySymbols?B.concat(Object.getOwnPropertySymbols(N)):B},h.prototype.listeners=function(B){var q=this._events[S?S+B:B];if(!q)return[];if(q.fn)return[q.fn];for(var oe=0,le=q.length,ee=new Array(le);oe<le;oe++)ee[oe]=q[oe].fn;return ee},h.prototype.listenerCount=function(B){var q=this._events[S?S+B:B];return q?q.fn?1:q.length:0},h.prototype.emit=function(B,N,q,oe,le,ee){var te=S?S+B:B;if(!this._events[te])return!1;var he,W,j=this._events[te],F=arguments.length;if(j.fn){switch(j.once&&this.removeListener(B,j.fn,void 0,!0),F){case 1:return j.fn.call(j.context),!0;case 2:return j.fn.call(j.context,N),!0;case 3:return j.fn.call(j.context,N,q),!0;case 4:return j.fn.call(j.context,N,q,oe),!0;case 5:return j.fn.call(j.context,N,q,oe,le),!0;case 6:return j.fn.call(j.context,N,q,oe,le,ee),!0}for(W=1,he=new Array(F-1);W<F;W++)he[W-1]=arguments[W];j.fn.apply(j.context,he)}else{var o,ne=j.length;for(W=0;W<ne;W++)switch(j[W].once&&this.removeListener(B,j[W].fn,void 0,!0),F){case 1:j[W].fn.call(j[W].context);break;case 2:j[W].fn.call(j[W].context,N);break;case 3:j[W].fn.call(j[W].context,N,q);break;case 4:j[W].fn.call(j[W].context,N,q,oe);break;default:if(!he)for(o=1,he=new Array(F-1);o<F;o++)he[o-1]=arguments[o];j[W].fn.apply(j[W].context,he)}}return!0},h.prototype.on=function(B,N,q){return v(this,B,N,q,!1)},h.prototype.once=function(B,N,q){return v(this,B,N,q,!0)},h.prototype.removeListener=function(B,N,q,oe){var le=S?S+B:B;if(!this._events[le])return this;if(!N)return A(this,le),this;var ee=this._events[le];if(ee.fn)ee.fn===N&&(!oe||ee.once)&&(!q||ee.context===q)&&A(this,le);else{for(var te=0,j=[],F=ee.length;te<F;te++)(ee[te].fn!==N||oe&&!ee[te].once||q&&ee[te].context!==q)&&j.push(ee[te]);j.length?this._events[le]=1===j.length?j[0]:j:A(this,le)}return this},h.prototype.removeAllListeners=function(B){var N;return B?this._events[N=S?S+B:B]&&A(this,N):(this._events=new x,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=S,h.EventEmitter=h,Ee.exports=h},7790:()=>{},9183:(Ee,U,S)=>{"use strict";S.d(U,{D6:()=>ee,LG:()=>oe});var x=S(4438),y=S(177),v=S(6600);const A=["determinateSpinner"];function h(te,j){if(1&te&&(x.qSk(),x.j41(0,"svg",11),x.nrm(1,"circle",12),x.k0s()),2&te){const F=x.XpG();x.BMQ("viewBox",F._viewBox()),x.R7$(),x.xc7("stroke-dasharray",F._strokeCircumference(),"px")("stroke-dashoffset",F._strokeCircumference()/2,"px")("stroke-width",F._circleStrokeWidth(),"%"),x.BMQ("r",F._circleRadius())}}const T=new x.nKC("mat-progress-spinner-default-options",{providedIn:"root",factory:function B(){return{diameter:N}}}),N=100;let oe=(()=>{class te{get color(){return this._color||this._defaultColor}set color(F){this._color=F}constructor(F,he,W){this._elementRef=F,this._defaultColor="primary",this._value=0,this._diameter=N,this._noopAnimations="NoopAnimations"===he&&!!W&&!W._forceAnimations,this.mode="mat-spinner"===F.nativeElement.nodeName.toLowerCase()?"indeterminate":"determinate",W&&(W.color&&(this.color=this._defaultColor=W.color),W.diameter&&(this.diameter=W.diameter),W.strokeWidth&&(this.strokeWidth=W.strokeWidth))}get value(){return"determinate"===this.mode?this._value:0}set value(F){this._value=Math.max(0,Math.min(100,F||0))}get diameter(){return this._diameter}set diameter(F){this._diameter=F||0}get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(F){this._strokeWidth=F||0}_circleRadius(){return(this.diameter-10)/2}_viewBox(){const F=2*this._circleRadius()+this.strokeWidth;return`0 0 ${F} ${F}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return"determinate"===this.mode?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static{this.\u0275fac=function(he){return new(he||te)(x.rXU(x.aKT),x.rXU(x.bc$,8),x.rXU(T))}}static{this.\u0275cmp=x.VBU({type:te,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(he,W){if(1&he&&x.GBs(A,5),2&he){let ne;x.mGM(ne=x.lsd())&&(W._determinateCircle=ne.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(he,W){2&he&&(x.BMQ("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow","determinate"===W.mode?W.value:null)("mode",W.mode),x.HbH("mat-"+W.color),x.xc7("width",W.diameter,"px")("height",W.diameter,"px")("--mdc-circular-progress-size",W.diameter+"px")("--mdc-circular-progress-active-indicator-width",W.diameter+"px"),x.AVh("_mat-animation-noopable",W._noopAnimations)("mdc-circular-progress--indeterminate","indeterminate"===W.mode))},inputs:{color:"color",mode:"mode",value:[2,"value","value",x.Udg],diameter:[2,"diameter","diameter",x.Udg],strokeWidth:[2,"strokeWidth","strokeWidth",x.Udg]},exportAs:["matProgressSpinner"],standalone:!0,features:[x.GFd,x.aNF],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(he,W){if(1&he&&(x.DNE(0,h,2,8,"ng-template",null,0,x.C5r),x.j41(2,"div",2,1),x.qSk(),x.j41(4,"svg",3),x.nrm(5,"circle",4),x.k0s()(),x.joV(),x.j41(6,"div",5)(7,"div",6)(8,"div",7),x.eu8(9,8),x.k0s(),x.j41(10,"div",9),x.eu8(11,8),x.k0s(),x.j41(12,"div",10),x.eu8(13,8),x.k0s()()()),2&he){const ne=x.sdS(1);x.R7$(4),x.BMQ("viewBox",W._viewBox()),x.R7$(),x.xc7("stroke-dasharray",W._strokeCircumference(),"px")("stroke-dashoffset",W._strokeDashOffset(),"px")("stroke-width",W._circleStrokeWidth(),"%"),x.BMQ("r",W._circleRadius()),x.R7$(4),x.Y8G("ngTemplateOutlet",ne),x.R7$(2),x.Y8G("ngTemplateOutlet",ne),x.R7$(2),x.Y8G("ngTemplateOutlet",ne)}},dependencies:[y.T3],styles:[".mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0;position:relative;direction:ltr;transition:opacity 250ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width)}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1;animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color, var(--mat-app-primary))}.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}"],encapsulation:2,changeDetection:0})}}return te})(),ee=(()=>{class te{static{this.\u0275fac=function(he){return new(he||te)}}static{this.\u0275mod=x.$C({type:te})}static{this.\u0275inj=x.G2t({imports:[y.MD,v.yE]})}}return te})()}}]);