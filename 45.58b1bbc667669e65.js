"use strict";(self.webpackChunkangor=self.webpackChunkangor||[]).push([[45],{2045:(U,p,n)=>{n.r(p),n.d(p,{default:()=>A});var l=n(3014),k=n(7785),m=n(4460),u=n(9471),y=n(2902),f=n(6071),h=n(3904),g=n(6389),_=n(2322),P=n(2675),b=n(1371),C=n(7712),v=n(1054),x=n(8716),I=n(8447),a=n(5424),j=n(2040),S=n(7178),$=n(3016),e=n(3107),R=n(9528),E=n(3149),B=n(7112);const D=i=>["/chat",i];function G(i,c){if(1&i){const t=e.RV6();e.j41(0,"button",27),e.bIt("click",function(){e.eBV(t);const r=e.XpG(),s=e.sdS(20);return e.Njj(r.resetSearch(s))}),e.nrm(1,"mat-icon",28),e.k0s()}2&i&&(e.R7$(),e.Y8G("svgIcon","heroicons_solid:x-mark"))}function w(i,c){if(1&i){const t=e.RV6();e.j41(0,"button",29),e.bIt("click",function(){e.eBV(t);const r=e.XpG(),s=e.sdS(20);return e.Njj(r.filterByQuery(s.value))}),e.nrm(1,"mat-icon",28),e.k0s()}2&i&&(e.R7$(),e.Y8G("svgIcon","heroicons_solid:magnifying-glass"))}function N(i,c){if(1&i){const t=e.RV6();e.j41(0,"div",44),e.bIt("click",function(){e.eBV(t);const r=e.XpG().$implicit,s=e.XpG();return e.Njj(s.goToProjectDetails(r))}),e.EFF(1),e.k0s()}if(2&i){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.displayName||t.nostrPubKey," ")}}function T(i,c){if(1&i&&(e.j41(0,"div",40),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.displayName||t.nostrPubKey," ")}}function F(i,c){if(1&i){const t=e.RV6();e.j41(0,"div",42)(1,"div",45)(2,"button",46),e.nrm(3,"mat-icon",47),e.k0s()(),e.j41(4,"div",45)(5,"button",48),e.bIt("click",function(){e.eBV(t);const r=e.XpG().$implicit,s=e.XpG();return e.Njj(s.toggleBookmark(r.nostrPubKey))}),e.nrm(6,"mat-icon",47),e.nI1(7,"async"),e.k0s()()()}if(2&i){let t;const o=e.XpG().$implicit,r=e.XpG();e.R7$(2),e.Y8G("routerLink",e.eq3(5,D,o.nostrPubKey)),e.R7$(),e.Y8G("svgIcon","heroicons_outline:chat-bubble-left-right"),e.R7$(3),e.Y8G("svgIcon",null!=(t=e.bMT(7,3,r.bookmarks$))&&t.includes(o.nostrPubKey)?"heroicons_solid:bookmark":"heroicons_outline:bookmark")}}function M(i,c){if(1&i&&(e.qex(0),e.j41(1,"angor-card",30)(2,"div",31),e.nrm(3,"img",32),e.k0s(),e.j41(4,"div",33)(5,"div",34),e.nrm(6,"img",35),e.k0s()(),e.j41(7,"div",36)(8,"div",37)(9,"div",38),e.DNE(10,N,2,1,"div",39)(11,T,2,1,"div",40),e.j41(12,"div",41),e.EFF(13),e.k0s()(),e.DNE(14,F,8,7,"div",42),e.k0s(),e.nrm(15,"hr",43),e.k0s()(),e.bVm()),2&i){const t=c.$implicit;e.R7$(3),e.Y8G("src",t.banner||"/images/pages/profile/cover.jpg",e.B4B),e.R7$(3),e.Y8G("src",t.picture||"images/avatars/avatar-placeholder.png",e.B4B),e.R7$(4),e.vxM(t.displayName||t.name?10:-1),e.R7$(),e.vxM(t.name||t.displayName?-1:11),e.R7$(2),e.SpI(" ",t.about||"No description available"," "),e.R7$(),e.vxM(t.displayName||t.name?14:-1)}}function Y(i,c){1&i&&(e.qex(0),e.j41(1,"div",49),e.nrm(2,"mat-icon",50),e.j41(3,"div",51),e.EFF(4," No projects "),e.k0s()(),e.bVm()),2&i&&(e.R7$(2),e.Y8G("svgIcon","heroicons_outline:archive-box-x-mark"))}function K(i,c){if(1&i&&(e.qex(0),e.DNE(1,Y,5,1,"ng-container",24),e.bVm()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",0===t.projectDetails.length)}}function V(i,c){1&i&&(e.qex(0),e.j41(1,"div",52),e.nrm(2,"mat-progress-spinner",53),e.j41(3,"div",54),e.EFF(4,"Loading projects..."),e.k0s()(),e.bVm())}function L(i,c){if(1&i){const t=e.RV6();e.j41(0,"div",55)(1,"button",56),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.loadMoreProjects())}),e.EFF(2),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(),e.Y8G("disabled",t.loading),e.R7$(),e.SpI(" ",t.loading?"Loading...":"Load More Projects"," ")}}function X(i,c){if(1&i&&(e.j41(0,"div",57),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.errorMessage," ")}}const A=[{path:"",component:(()=>{class i{constructor(t,o,r,s,d){this._projectsService=t,this._storageService=o,this._changeDetectorRef=r,this._router=s,this._bookmarkService=d,this.projects=[],this.projectDetails=[],this.filteredProjects=[],this.loading=!1,this.errorMessage="",this.noMoreProjects=!1,this.bookmarkedProjectNpubs=[],this.initialLoadComplete=!1,this._unsubscribeAll=new I.B,this.bookmarks$=this._bookmarkService.bookmarks$}ngOnInit(){var t=this;return(0,l.A)(function*(){yield t._bookmarkService.initializeForCurrentUser(),t.loadInitialProjects(),t.subscribeToProjectsUpdates(),t.subscribeToLoading(),t.subscribeToNoMoreProjects(),t.subscribeToBookmarkChanges()})()}loadInitialProjects(){this._projectsService.resetProjects(),this.loading=!0,this.initialLoadComplete=!1,this._projectsService.fetchProjects().pipe((0,a.Q)(this._unsubscribeAll)).subscribe({next:t=>{this.projects=t,this.filteredProjects=this.projectDetails,this.updateBookmarkStatus(),this.fetchProjectDetails(t),this.initialLoadComplete=!0,this._changeDetectorRef.detectChanges(),console.log(t)}})}subscribeToBookmarkChanges(){this.bookmarks$.pipe((0,a.Q)(this._unsubscribeAll)).subscribe(t=>{this.bookmarkedProjectNpubs=t,this.updateBookmarkStatus(),this._changeDetectorRef.detectChanges()})}updateBookmarkStatus(){this.projectDetails.forEach(t=>{t.isBookmarked=this.bookmarkedProjectNpubs.includes(t.nostrPubKey)}),this.filteredProjects=[...this.projectDetails]}fetchMetadataForProjects(t){var o=this;return(0,l.A)(function*(){for(const r of t)try{const s=yield o._storageService.getProfile(r.nostrPubKey);s?o.updateProjectMetadata(r,s):console.warn(`No metadata found for project with pubKey: ${r.nostrPubKey}`)}catch(s){console.error(`Error fetching metadata for pubKey: ${r.nostrPubKey}`,s)}})()}fetchProjectDetails(t){var o=this;return(0,l.A)(function*(){for(const r of t)try{const s=yield o._storageService.getProjectDetails(r.projectIdentifier);if(s){o.projectDetails.push(s);const d=yield o._storageService.getProfile(s.nostrPubKey);d?o.updateProjectMetadata(s,d):console.warn(`No metadata found for project with nostrPubKey: ${s.nostrPubKey}`)}else console.warn(`No details found for project with eventId: ${r.nostrEventId}`)}catch(s){console.error(`Error fetching details for eventId: ${r.nostrEventId}`,s)}})()}subscribeToProjectsUpdates(){this._storageService.profile$.pipe((0,a.Q)(this._unsubscribeAll)).subscribe(t=>{if(t&&t.pubKey){const o=this.projectDetails.find(r=>r.nostrPubKey===t.pubKey);o&&(this.updateProjectMetadata(o,t.metadata),this._changeDetectorRef.detectChanges())}})}updateProjectMetadata(t,o){t.displayName=o.additionalData.display_name||o.name||t.displayName,t.about=o.about||t.about,t.picture=o.picture||t.picture,t.banner=o.banner||t.banner}loadMoreProjects(){this._projectsService.fetchProjects().pipe((0,a.Q)(this._unsubscribeAll)).subscribe({next:t=>{const o=t.filter(r=>!this.projects.some(s=>s.projectIdentifier===r.projectIdentifier));this.projects=[...this.projects,...o],this.filteredProjects=[...this.projectDetails],this.fetchProjectDetails(o),this._changeDetectorRef.detectChanges()},error:t=>{this.errorMessage="Error loading more projects",this._changeDetectorRef.detectChanges()}})}subscribeToLoading(){this._projectsService.loading$.pipe((0,a.Q)(this._unsubscribeAll)).subscribe(t=>{this.loading=t,this._changeDetectorRef.detectChanges()})}subscribeToNoMoreProjects(){this._projectsService.noMoreProjects$.pipe((0,a.Q)(this._unsubscribeAll)).subscribe(t=>{this.noMoreProjects=t,this._changeDetectorRef.detectChanges()})}trackByFn(t,o){return o.projectIdentifier||t}goToProjectDetails(t){this._projectsService.fetchProjectStats(t.projectIdentifier).pipe((0,j.M)(o=>{this._storageService.saveProjectStats(t.projectIdentifier,o)}),(0,j.M)(()=>{this._router.navigate(["/profile",t.nostrPubKey,t.projectIdentifier])}),(0,S.W)(o=>(console.error(`Failed to navigate to project details for ${t.projectIdentifier}:`,o),(0,$.of)(null)))).subscribe()}filterByQuery(t){if(!t||""===t.trim())return this.filteredProjects=[...this.projectDetails],this.showCloseSearchButton=!1,void this._changeDetectorRef.detectChanges();const o=t.toLowerCase();this.filteredProjects=this.projectDetails.filter(r=>r.displayName&&r.displayName.toLowerCase().includes(o)||r.about&&r.about.toLowerCase().includes(o)||r.displayName&&r.displayName.toLowerCase().includes(o)||r.nostrPubKey&&r.nostrPubKey.toLowerCase().includes(o)||r.projectIdentifier&&r.projectIdentifier.toLowerCase().includes(o)),this.showCloseSearchButton=this.projects.length>0,this._changeDetectorRef.detectChanges()}resetSearch(t){t.value="",this.filterByQuery(""),this.showCloseSearchButton=!1}toggleBookmark(t){var o=this;return(0,l.A)(function*(){(yield o._bookmarkService.isBookmarked(t))?yield o._bookmarkService.removeBookmark(t):yield o._bookmarkService.addBookmark(t)})()}isProjectBookmarked(t){var o=this;return(0,l.A)(function*(){return yield o._bookmarkService.isBookmarked(t)})()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(R.i),e.rXU(E.n),e.rXU(e.gRc),e.rXU(x.Ix),e.rXU(B.U))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["explore"]],decls:32,vars:10,consts:[["query",""],[1,"flex","min-w-0","flex-auto","flex-col"],[1,"dark","relative","flex-0","overflow-hidden","bg-gray-800","px-4","py-8","sm:p-16"],["viewBox","0 0 960 540","width","100%","height","100%","preserveAspectRatio","xMidYMax slice","xmlns","http://www.w3.org/2000/svg",1,"pointer-events-none","absolute","inset-0"],["fill","none","stroke","currentColor","stroke-width","100",1,"text-gray-700","opacity-25"],["r","234","cx","196","cy","23"],["r","234","cx","790","cy","491"],[1,"relative","z-10","flex","flex-col","items-center"],[1,"text-xl","font-semibold"],[1,"mt-1","text-center","text-4xl","font-extrabold","leading-tight","tracking-tight","sm:text-7xl"],[1,"text-secondary","mt-6","max-w-2xl","text-center","tracking-tight","sm:text-2xl"],[1,"p-6","sm:p-10"],[1,"mx-auto","flex","w-full","max-w-xs","flex-auto","flex-col","sm:max-w-5xl"],[1,"flex","w-full","max-w-xs","flex-col","items-center","justify-between","sm:max-w-none","sm:flex-row"],[1,"flex","w-full","items-center","space-x-2","sm:w-auto"],[1,"mt-4","w-full","sm:w-80",3,"keyup.enter","subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["placeholder","Search ...","matInput",""],["mat-icon-button","","color","warn","class","mt-4",3,"click",4,"ngIf"],["mat-icon-button","","color","success","class","mt-4",3,"click",4,"ngIf"],[1,"mt-8","sm:ml-auto","sm:mt-0",3,"color"],[1,"mx-auto","flex","w-full","flex-auto","flex-col","sm:max-w-5xl"],[1,"mt-10","grid","w-full","min-w-0","grid-cols-1","gap-6","sm:grid-cols-1","md:grid-cols-1","lg:grid-cols-2"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","mt-10 flex justify-center",4,"ngIf"],["class","error-message",4,"ngIf"],["mat-icon-button","","color","warn",1,"mt-4",3,"click"],[3,"svgIcon"],["mat-icon-button","","color","success",1,"mt-4",3,"click"],[1,"filter-info","flex","w-full","flex-col"],[1,"flex","h-32"],["alt","Card cover image","onerror","this.onerror=null; this.src='/images/pages/profile/cover.jpg';","alt","Card cover image",1,"object-cover",3,"src"],[1,"flex","px-8"],[1,"bg-card","-mt-12","rounded-full","p-1"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';","alt","Project logo",1,"h-24","w-24","rounded-full","object-cover",3,"src"],[1,"flex","flex-col","px-8","pb-6","pt-4"],[1,"flex","items-center","justify-between"],[1,"min-w-0","flex-1"],["role","button",1,"truncate","text-2xl","font-semibold","leading-tight"],[1,"truncate","text-2xl","font-semibold","leading-tight"],[1,"text-secondary","mt-1","truncate","leading-tight"],[1,"absolute","top-2","right-2","flex","space-x-2"],[1,"my-6","w-full","border-t"],["role","button",1,"truncate","text-2xl","font-semibold","leading-tight",3,"click"],[1,"flex","h-10","w-10","items-center","justify-center","rounded-full","border","bg-white","shadow-md"],["mat-icon-button","",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-icon-button","",3,"click"],[1,"flex","flex-auto","flex-col","items-center","justify-center","bg-gray-100","dark:bg-transparent"],[1,"icon-size-24",3,"svgIcon"],[1,"text-secondary","mt-4","text-2xl","font-semibold","tracking-tight"],[1,"flex","flex-auto","flex-col","items-center","justify-center"],["mode","indeterminate","diameter","48"],[1,"text-secondary","mt-4","text-xl"],[1,"mt-10","flex","justify-center"],["mat-raised-button","","color","primary",1,"bg-card","text-gray-700","hover:bg-gray-200","dark:text-gray-300","dark:hover:bg-gray-700",3,"click","disabled"],[1,"error-message"]],template:function(o,r){if(1&o){const s=e.RV6();e.j41(0,"div",1)(1,"div",2),e.qSk(),e.j41(2,"svg",3)(3,"g",4),e.nrm(4,"circle",5)(5,"circle",6),e.k0s()(),e.joV(),e.j41(6,"div",7)(7,"h2",8),e.EFF(8,"Explore Projects"),e.k0s(),e.j41(9,"div",9),e.EFF(10," What\u2019s your next investment? "),e.k0s(),e.j41(11,"div",10),e.EFF(12," Check out our projects and find your next investment opportunity. "),e.k0s()()(),e.j41(13,"div",11)(14,"div",12)(15,"div",13)(16,"div",14)(17,"mat-form-field",15),e.bIt("keyup.enter",function(){e.eBV(s);const Q=e.sdS(20);return e.Njj(r.filterByQuery(Q.value))}),e.nrm(18,"mat-icon",16)(19,"input",17,0),e.k0s(),e.DNE(21,G,2,1,"button",18)(22,w,2,1,"button",19),e.k0s(),e.j41(23,"mat-slide-toggle",20),e.EFF(24," Hide completed "),e.k0s()()(),e.j41(25,"div",21)(26,"div",22),e.DNE(27,M,16,6,"ng-container",23),e.k0s(),e.DNE(28,K,2,1,"ng-container",24)(29,V,5,0,"ng-container",24)(30,L,3,2,"div",25)(31,X,2,1,"div",26),e.k0s()()()}2&o&&(e.R7$(17),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("svgIcon","heroicons_solid:magnifying-glass"),e.R7$(3),e.Y8G("ngIf",r.showCloseSearchButton),e.R7$(),e.Y8G("ngIf",!r.showCloseSearchButton),e.R7$(),e.Y8G("color","primary"),e.R7$(4),e.Y8G("ngForOf",r.projectDetails),e.R7$(),e.Y8G("ngIf",!r.loading||r.initialLoadComplete),e.R7$(),e.Y8G("ngIf",r.loading&&!r.initialLoadComplete),e.R7$(),e.Y8G("ngIf",r.filteredProjects.length>0),e.R7$(),e.Y8G("ngIf",!r.loading&&r.errorMessage))},dependencies:[x.Wk,u.Hl,u.$z,u.iY,h.m_,h.An,k.n,f.RG,f.rl,f.JW,P.Ve,y.Sy,g.fS,g.fg,b.mV,b.sG,C.uc,_.PO,m.MD,m.Sq,m.bT,m.Jj,v.D6,v.LG],encapsulation:2})}}return i})()}]}}]);