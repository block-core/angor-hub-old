"use strict";(self.webpackChunkangor=self.webpackChunkangor||[]).push([[524],{8364:(P,h,s)=>{s.r(h),s.d(h,{default:()=>G});var u=s(467),v=s(9345),d=s(177),b=s(8834),a=s(3),i=s(2408),m=s(9213),r=s(9042),o=s(7575),k=s(9183),f=s(7250),x=s(450),p=s(4823),B=s(5245),I=s(1413),j=s(6977),K=s(8141),S=s(9437),U=s(7673),e=s(4438),E=s(8098),F=s(7291),_=s(8729);const C=c=>["/chat",c];function T(c,y){if(1&c){const t=e.RV6();e.j41(0,"div",29),e.bIt("click",function(){e.eBV(t);const l=e.XpG().$implicit,g=e.XpG();return e.Njj(g.goToProjectDetails(l))}),e.EFF(1),e.k0s()}if(2&c){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.displayName||t.nostrPubKey," ")}}function R(c,y){if(1&c&&(e.j41(0,"div",25),e.EFF(1),e.k0s()),2&c){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.displayName||t.nostrPubKey," ")}}function A(c,y){if(1&c){const t=e.RV6();e.j41(0,"div",27)(1,"div",30)(2,"button",31),e.nrm(3,"mat-icon",32),e.k0s()(),e.j41(4,"div",30)(5,"button",33),e.bIt("click",function(){e.eBV(t);const l=e.XpG().$implicit,g=e.XpG();return e.Njj(g.toggleBookmark(l.nostrPubKey))}),e.nrm(6,"mat-icon",32),e.nI1(7,"async"),e.k0s()()()}if(2&c){let t;const n=e.XpG().$implicit,l=e.XpG();e.R7$(2),e.Y8G("routerLink",e.eq3(5,C,n.nostrPubKey)),e.R7$(),e.Y8G("svgIcon","heroicons_outline:chat-bubble-left-right"),e.R7$(3),e.Y8G("svgIcon",null!=(t=e.bMT(7,3,l.bookmarks$))&&t.includes(n.nostrPubKey)?"heroicons_solid:bookmark":"heroicons_outline:bookmark")}}function D(c,y){if(1&c&&(e.qex(0),e.j41(1,"angor-card",15)(2,"div",16),e.nrm(3,"img",17),e.k0s(),e.j41(4,"div",18)(5,"div",19),e.nrm(6,"img",20),e.k0s()(),e.j41(7,"div",21)(8,"div",22)(9,"div",23),e.DNE(10,T,2,1,"div",24)(11,R,2,1,"div",25),e.j41(12,"div",26),e.EFF(13),e.k0s()(),e.DNE(14,A,8,7,"div",27),e.k0s(),e.nrm(15,"hr",28),e.k0s()(),e.bVm()),2&c){const t=y.$implicit;e.R7$(3),e.Y8G("src",t.banner||"/images/pages/profile/cover.jpg",e.B4B),e.R7$(3),e.Y8G("src",t.picture||"images/avatars/avatar-placeholder.png",e.B4B),e.R7$(4),e.vxM(t.displayName||t.name?10:-1),e.R7$(),e.vxM(t.name||t.displayName?-1:11),e.R7$(2),e.SpI(" ",t.about||"No description available"," "),e.R7$(),e.vxM(t.displayName||t.name?14:-1)}}function L(c,y){1&c&&(e.qex(0),e.j41(1,"div",34),e.nrm(2,"mat-spinner",35),e.j41(3,"div",36),e.EFF(4,"Loading projects..."),e.k0s()(),e.bVm()),2&c&&(e.R7$(2),e.Y8G("diameter",40))}function $(c,y){1&c&&(e.qex(0),e.j41(1,"div",37),e.nrm(2,"mat-icon",38),e.j41(3,"div",39),e.EFF(4," No projects "),e.k0s()(),e.bVm()),2&c&&(e.R7$(2),e.Y8G("svgIcon","heroicons_outline:archive-box-x-mark"))}const G=[{path:"",component:(()=>{class c{constructor(t,n,l,g){this._bookmarkService=t,this._storageService=n,this._router=l,this._projectsService=g,this.savedProjects=[],this.savedProjectDetailes=[],this.isLoading=!0,this._unsubscribeAll=new I.B,this.bookmarks$=this._bookmarkService.bookmarks$}ngOnInit(){var t=this;return(0,u.A)(function*(){try{yield t._bookmarkService.initializeForCurrentUser(),yield t.loadBookmarkedProjects(),t.subscribeToBookmarkChanges(),t.isLoading=!1}catch(n){console.error("Error during initialization:",n),t.isLoading=!1}})()}trackByFn(t,n){return n.nostrPubKey||t}loadBookmarkedProjects(){var t=this;return(0,u.A)(function*(){t.isLoading=!0;try{const n=yield t._bookmarkService.getBookmarks(),l=yield t._storageService.getProjectsByNostrPubKeys(n);t.savedProjectDetailes=l,t.isLoading=!1}catch(n){console.error("Error loading bookmarked projects:",n),t.isLoading=!1}})()}subscribeToBookmarkChanges(){var t=this;this.bookmarks$.pipe((0,j.Q)(this._unsubscribeAll)).subscribe(function(){var n=(0,u.A)(function*(l){try{const g=yield t._storageService.getProjectsByNostrPubKeys(l);t.savedProjectDetailes=g,t.fetchMetadataForProjects(t.savedProjectDetailes),t.isLoading=!1}catch(g){console.error("Error updating bookmarks:",g),t.isLoading=!1}});return function(l){return n.apply(this,arguments)}}())}fetchMetadataForProjects(t){t.forEach(n=>{this._storageService.getProfile(n.nostrPubKey).then(l=>{l&&this.updateProjectMetadata(n,l)})})}updateProjectMetadata(t,n){t.displayName=n.name||t.displayName,t.about=n.about||t.about,t.picture=n.picture||t.picture,t.banner=n.banner||t.banner}toggleBookmark(t){var n=this;return(0,u.A)(function*(){(yield n._bookmarkService.isBookmarked(t))?yield n._bookmarkService.removeBookmark(t):yield n._bookmarkService.addBookmark(t)})()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}goToProjectDetails(t){this._projectsService.fetchProjectStats(t.projectIdentifier).pipe((0,K.M)(n=>{this._storageService.saveProjectStats(t.projectIdentifier,n)}),(0,K.M)(()=>{this._router.navigate(["/profile",t.nostrPubKey,t.projectIdentifier])}),(0,S.W)(n=>(console.error(`Failed to navigate to project details for ${t.projectIdentifier}:`,n),(0,U.of)(null)))).subscribe()}static{this.\u0275fac=function(n){return new(n||c)(e.rXU(E.U),e.rXU(F.n),e.rXU(B.Ix),e.rXU(_.i))}}static{this.\u0275cmp=e.VBU({type:c,selectors:[["app-bookmark"]],decls:19,vars:4,consts:[[1,"flex","min-w-0","flex-auto","flex-col"],[1,"dark","relative","flex-0","overflow-hidden","bg-gray-800","px-4","py-8","sm:p-16"],["viewBox","0 0 960 540","width","100%","height","100%","preserveAspectRatio","xMidYMax slice","xmlns","http://www.w3.org/2000/svg",1,"pointer-events-none","absolute","inset-0"],["fill","none","stroke","currentColor","stroke-width","100",1,"text-gray-700","opacity-25"],["r","234","cx","196","cy","23"],["r","234","cx","790","cy","491"],[1,"relative","z-10","flex","flex-col","items-center"],[1,"text-xl","font-semibold"],[1,"mt-1","text-center","text-4xl","font-extrabold","leading-tight","tracking-tight","sm:text-7xl"],[1,"text-secondary","mt-6","max-w-2xl","text-center","tracking-tight","sm:text-2xl"],[1,"p-6","sm:p-10"],[1,"mx-auto","flex","w-full","flex-auto","flex-col","sm:max-w-5xl"],[1,"mt-10","grid","w-full","min-w-0","grid-cols-1","gap-6","sm:grid-cols-1","md:grid-cols-1","lg:grid-cols-2"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"filter-info","flex","w-full","flex-col"],[1,"flex","h-32"],["alt","Card cover image","onerror","this.onerror=null; this.src='/images/pages/profile/cover.jpg';","alt","Card cover image",1,"object-cover",3,"src"],[1,"flex","px-8"],[1,"bg-card","-mt-12","rounded-full","p-1"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';","alt","Project logo",1,"h-24","w-24","rounded-full","object-cover",3,"src"],[1,"flex","flex-col","px-8","pb-6","pt-4"],[1,"flex","items-center","justify-between"],[1,"min-w-0","flex-1"],["role","button",1,"truncate","text-2xl","font-semibold","leading-tight"],[1,"truncate","text-2xl","font-semibold","leading-tight"],[1,"text-secondary","mt-1","truncate","leading-tight"],[1,"absolute","top-2","right-2","flex","space-x-2"],[1,"my-6","w-full","border-t"],["role","button",1,"truncate","text-2xl","font-semibold","leading-tight",3,"click"],[1,"flex","h-10","w-10","items-center","justify-center","rounded-full","border","bg-white","shadow-md"],["mat-icon-button","",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-icon-button","",3,"click"],[1,"flex","flex-auto","flex-col","items-center","justify-center"],[3,"diameter"],[1,"text-secondary","mt-4","text-lg"],[1,"flex","flex-auto","flex-col","items-center","justify-center","bg-gray-100","dark:bg-transparent"],[1,"icon-size-24",3,"svgIcon"],[1,"text-secondary","mt-4","text-2xl","font-semibold","tracking-tight"]],template:function(n,l){1&n&&(e.j41(0,"div",0)(1,"div",1),e.qSk(),e.j41(2,"svg",2)(3,"g",3),e.nrm(4,"circle",4)(5,"circle",5),e.k0s()(),e.joV(),e.j41(6,"div",6)(7,"h2",7),e.EFF(8,"Bookmark"),e.k0s(),e.j41(9,"div",8),e.EFF(10," Explore Your Saved Projects "),e.k0s(),e.j41(11,"div",9),e.EFF(12," Review and manage your bookmarked projects below. "),e.k0s()()(),e.j41(13,"div",10)(14,"div",11)(15,"div",12),e.DNE(16,D,16,6,"ng-container",13),e.k0s(),e.DNE(17,L,5,1,"ng-container",14)(18,$,5,1,"ng-container",14),e.k0s()()()),2&n&&(e.R7$(16),e.Y8G("ngForOf",l.savedProjectDetailes)("ngForTrackBy",l.trackByFn),e.R7$(),e.Y8G("ngIf",l.isLoading),e.R7$(),e.Y8G("ngIf",!l.isLoading&&0===l.savedProjectDetailes.length))},dependencies:[B.Wk,b.Hl,b.iY,m.m_,m.An,v.n,i.RG,f.Ve,a.Sy,r.fS,x.mV,p.uc,o.PO,d.MD,d.Sq,d.bT,d.Jj,k.D6,k.LG],encapsulation:2})}}return c})()}]},8098:(P,h,s)=>{s.d(h,{U:()=>a});var u=s(467),v=s(4412),d=s(4438),b=s(6324);let a=(()=>{class i{constructor(r){this._signerService=r,this.STORAGE_KEY="userBookmarkedProjects",this.bookmarksSubject=new v.t([]),this.bookmarks$=this.bookmarksSubject.asObservable(),this.currentUserPubKey=null,window.addEventListener("storage",o=>{o.key===this.STORAGE_KEY&&this.refreshBookmarksForCurrentUser()})}initializeForCurrentUser(){var r=this;return(0,u.A)(function*(){r.clearBookmarks(),r.currentUserPubKey=yield r._signerService.getPublicKey(),r.currentUserPubKey&&(yield r.loadBookmarksForCurrentUser())})()}clearBookmarks(){this.bookmarksSubject.next([])}loadBookmarksForCurrentUser(){var r=this;return(0,u.A)(function*(){if(!r.currentUserPubKey)return;const k=r.getUserBookmarks()[r.currentUserPubKey]||[];r.bookmarksSubject.next(k)})()}getUserBookmarks(){const r=localStorage.getItem(this.STORAGE_KEY);return r?JSON.parse(r):{}}saveUserBookmarks(r){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(r))}addBookmark(r){var o=this;return(0,u.A)(function*(){if(!o.currentUserPubKey&&(o.currentUserPubKey=yield o._signerService.getPublicKey(),!o.currentUserPubKey))return void console.warn("No public key found for the current user.");const k=o.getUserBookmarks(),f=k[o.currentUserPubKey]||[];f.includes(r)||(f.push(r),k[o.currentUserPubKey]=f,o.saveUserBookmarks(k),o.bookmarksSubject.next(f))})()}removeBookmark(r){var o=this;return(0,u.A)(function*(){if(!o.currentUserPubKey&&(o.currentUserPubKey=yield o._signerService.getPublicKey(),!o.currentUserPubKey))return void console.warn("No public key found for the current user.");const k=o.getUserBookmarks(),x=(k[o.currentUserPubKey]||[]).filter(p=>p!==r);k[o.currentUserPubKey]=x,o.saveUserBookmarks(k),o.bookmarksSubject.next(x)})()}isBookmarked(r){var o=this;return(0,u.A)(function*(){return o.currentUserPubKey||(o.currentUserPubKey=yield o._signerService.getPublicKey(),o.currentUserPubKey)?(o.getUserBookmarks()[o.currentUserPubKey]||[]).includes(r):(console.warn("No public key found for the current user."),!1)})()}getBookmarks(){var r=this;return(0,u.A)(function*(){return r.currentUserPubKey||(r.currentUserPubKey=yield r._signerService.getPublicKey(),r.currentUserPubKey)?r.getUserBookmarks()[r.currentUserPubKey]||[]:(console.warn("No public key found for the current user."),[])})()}removeAllBookmarks(){var r=this;return(0,u.A)(function*(){if(!r.currentUserPubKey&&(r.currentUserPubKey=yield r._signerService.getPublicKey(),!r.currentUserPubKey))return void console.warn("No public key found for the current user.");const o=r.getUserBookmarks();o[r.currentUserPubKey]=[],r.saveUserBookmarks(o),r.bookmarksSubject.next([])})()}refreshBookmarksForCurrentUser(){this.currentUserPubKey&&this.loadBookmarksForCurrentUser()}static{this.\u0275fac=function(o){return new(o||i)(d.KVO(b.A))}}static{this.\u0275prov=d.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})()},833:(P,h,s)=>{s.d(h,{F:()=>v});var u=s(4438);let v=(()=>{class d{constructor(){this.mainnetLocalStorageKey="mainnetIndexers",this.testnetLocalStorageKey="testnetIndexers",this.mainnetPrimaryIndexerKey="mainnetPrimaryIndexer",this.testnetPrimaryIndexerKey="testnetPrimaryIndexer",this.networkStorageKey="selectedNetwork",this.defaultMainnetIndexer="https://btc.indexer.angor.io/",this.defaultTestnetIndexer="https://tbtc.indexer.angor.io/",this.initializeDefaultIndexers()}initializeDefaultIndexers(){0===this.getIndexers("mainnet").length&&(this.addIndexer(this.defaultMainnetIndexer,"mainnet"),this.setPrimaryIndexer(this.defaultMainnetIndexer,"mainnet")),0===this.getIndexers("testnet").length&&(this.addIndexer(this.defaultTestnetIndexer,"testnet"),this.setPrimaryIndexer(this.defaultTestnetIndexer,"testnet"))}addIndexer(a,i){let m=this.getIndexers(i);m.includes(a)||(m.push(a),this.saveIndexers(m,i))}getIndexers(a){return JSON.parse(localStorage.getItem("mainnet"===a?this.mainnetLocalStorageKey:this.testnetLocalStorageKey)||"[]")}saveIndexers(a,i){localStorage.setItem("mainnet"===i?this.mainnetLocalStorageKey:this.testnetLocalStorageKey,JSON.stringify(a))}setPrimaryIndexer(a,i){this.getIndexers(i).includes(a)&&localStorage.setItem("mainnet"===i?this.mainnetPrimaryIndexerKey:this.testnetPrimaryIndexerKey,a)}getPrimaryIndexer(a){return localStorage.getItem("mainnet"===a?this.mainnetPrimaryIndexerKey:this.testnetPrimaryIndexerKey)}removeIndexer(a,i){let m=this.getIndexers(i);const r=m.indexOf(a);-1!==r&&(m.splice(r,1),this.saveIndexers(m,i),a===this.getPrimaryIndexer(i))&&localStorage.removeItem("mainnet"===i?this.mainnetPrimaryIndexerKey:this.testnetPrimaryIndexerKey)}clearAllIndexers(a){const m="mainnet"===a?this.mainnetPrimaryIndexerKey:this.testnetPrimaryIndexerKey;localStorage.removeItem("mainnet"===a?this.mainnetLocalStorageKey:this.testnetLocalStorageKey),localStorage.removeItem(m)}setNetwork(a){localStorage.setItem(this.networkStorageKey,a)}getNetwork(){return localStorage.getItem(this.networkStorageKey)||"testnet"}static{this.\u0275fac=function(i){return new(i||d)}}static{this.\u0275prov=u.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}}return d})()}}]);