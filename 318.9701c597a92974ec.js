"use strict";(self.webpackChunkangor=self.webpackChunkangor||[]).push([[318],{5318:(ut,B,u)=>{u.r(B),u.d(B,{default:()=>lt});var d=u(467),K=u(9345),D=u(7403),f=u(177),g=u(9417),_=u(8834),G=u(1997),b=u(2102),w=u(9213),j=u(9042),C=u(9115),z=u(9183),q=u(450),P=u(4823),T=u(5245),W=u(8865),U=u(5398),J=u(7540),R=u(1413),H=u(9454),L=u(882),ee=u(8703),e=u(4438),k=u(5351),N=u(5416);class te{constructor(a,t){this._document=t;const n=this._textarea=this._document.createElement("textarea"),i=n.style;i.position="fixed",i.top=i.opacity="0",i.left="-999em",n.setAttribute("aria-hidden","true"),n.value=a,n.readOnly=!0,(this._document.fullscreenElement||this._document.body).appendChild(n)}copy(){const a=this._textarea;let t=!1;try{if(a){const n=this._document.activeElement;a.select(),a.setSelectionRange(0,a.value.length),t=this._document.execCommand("copy"),n&&n.focus()}}catch{}return t}destroy(){const a=this._textarea;a&&(a.remove(),this._textarea=void 0)}}let V=(()=>{class o{constructor(t){this._document=t}copy(t){const n=this.beginCopy(t),i=n.copy();return n.destroy(),i}beginCopy(t){return new te(t,this._document)}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(f.qQ))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var M=u(7673),Y=u(9437),ne=u(1626);let O=(()=>{class o{constructor(t){this.http=t}getLightning(t){return this.http.get(t).pipe((0,Y.W)(n=>(console.error("Failed to fetch Lightning response:",n),(0,M.of)({status:"Failed"}))))}getLightningInvoice(t,n){return this.http.get(`${t}?amount=${n}`).pipe((0,Y.W)(r=>(console.error("Failed to fetch Lightning invoice:",r),(0,M.of)({pr:"",status:"Failed"}))))}getLightningAddress(t){try{const[n,i]=t.split("@");return`https://${i}/.well-known/lnurlp/${n}`}catch{return console.error("Invalid Lightning address format:",t),""}}sendZapRequest(t,n,i,r){const s=encodeURIComponent(JSON.stringify(n));return this.http.get(`${t}?amount=${i}&nostr=${s}&lnurl=${r}`).pipe((0,Y.W)(c=>(console.error("Failed to send zap request:",c),(0,M.of)({pr:"",status:"Failed"}))))}login(){return(0,d.A)(function*(){try{return window.webln&&!window.webln.isEnabled()&&(yield window.webln.enable()),!0}catch(t){return console.error("WebLN login failed:",t),!1}})()}hasWebln(){return!!window.webln}sendPayment(t){var n=this;return(0,d.A)(function*(){try{return n.hasWebln()?yield window.webln.sendPayment(t):(console.error("WebLN is not available"),null)}catch(i){throw console.error("Payment failed:",i),i}})()}payInvoice(t){var n=this;return(0,d.A)(function*(){if((yield n.login())&&n.hasWebln())try{return!!(yield n.sendPayment(t))}catch(r){return console.error("Failed to pay invoice:",r),!1}return console.error("WebLN not available or login failed"),!1})()}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(ne.Qq))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var x=u(719),S=u(6324),I=u(6231),ie=u(2798),F=u(5766),oe=u(9992);function re(o,a){if(1&o){const t=e.RV6();e.j41(0,"button",15),e.bIt("click",function(){let i;const r=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(null==(i=s.sendZapForm.get("amount"))?null:i.setValue(r.value))}),e.j41(1,"mat-icon"),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()}if(2&o){const t=a.$implicit;e.Mz_("aria-label","Set zap amount to ",t.label,""),e.R7$(2),e.JRh(t.icon),e.R7$(2),e.JRh(t.label)}}function se(o,a){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Zap amount is required "),e.k0s())}function le(o,a){1&o&&(e.j41(0,"mat-error"),e.EFF(1," Minimum amount is 1 sat "),e.k0s())}function ae(o,a){if(1&o){const t=e.RV6();e.j41(0,"mat-dialog-content",5)(1,"div",6),e.DNE(2,re,5,4,"button",7),e.k0s(),e.nrm(3,"mat-divider"),e.j41(4,"div",8)(5,"mat-form-field",9)(6,"mat-label"),e.EFF(7,"Zap Amount"),e.k0s(),e.nrm(8,"input",10),e.j41(9,"mat-hint",11),e.EFF(10,"Amount in sats"),e.k0s(),e.DNE(11,se,2,0,"mat-error",12)(12,le,2,0,"mat-error",12),e.k0s(),e.j41(13,"mat-form-field",9)(14,"mat-label"),e.EFF(15,"Comment"),e.k0s(),e.nrm(16,"input",13),e.j41(17,"mat-hint",11),e.EFF(18),e.k0s()()(),e.j41(19,"mat-dialog-actions",11)(20,"button",14),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onSubmit())}),e.EFF(21," Create Invoice "),e.k0s()()()}if(2&o){let t,n,i;const r=e.XpG();e.R7$(2),e.Y8G("ngForOf",r.zapButtons),e.R7$(2),e.Y8G("formGroup",r.sendZapForm),e.R7$(7),e.Y8G("ngIf",null==(t=r.sendZapForm.get("amount"))?null:t.hasError("required")),e.R7$(),e.Y8G("ngIf",null==(n=r.sendZapForm.get("amount"))?null:n.hasError("min")),e.R7$(6),e.SpI(" ",(null==(i=r.sendZapForm.get("comment"))||null==i.value?null:i.value.length)||0,"/100 "),e.R7$(2),e.Y8G("disabled",r.sendZapForm.invalid)}}function ce(o,a){if(1&o&&(e.j41(0,"div",19)(1,"span",20),e.EFF(2),e.k0s(),e.nrm(3,"mat-divider",21)(4,"qrcode",22),e.k0s()),2&o){const t=e.XpG(2);e.R7$(2),e.SpI("Scan with phone to pay (",t.invoiceAmount," sats)"),e.R7$(2),e.Y8G("qrdata",t.lightningInvoice)("matTooltip","Lightning Invoice")("errorCorrectionLevel","M")}}function ue(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",23)(1,"mat-form-field",24)(2,"mat-label"),e.EFF(3,"Invoice Address"),e.k0s(),e.nrm(4,"input",25),e.j41(5,"button",26),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.copyInvoice())}),e.nrm(6,"mat-icon",27),e.k0s()()()}if(2&o){const t=e.XpG(2);e.R7$(4),e.Y8G("value",t.lightningInvoice),e.R7$(),e.Y8G("matTooltip","Copy Invoice"),e.R7$(),e.Y8G("svgIcon","heroicons_outline:clipboard-document")}}function de(o,a){if(1&o&&(e.j41(0,"mat-dialog-content",16),e.DNE(1,ce,5,4,"div",17)(2,ue,7,3,"div",18),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.displayQRCode),e.R7$(),e.Y8G("ngIf",t.showInvoiceSection&&t.lightningInvoice)}}let pe=(()=>{class o{constructor(t){this.util=t,this.formBuilder=(0,e.WQX)(g.ok),this.lightningService=(0,e.WQX)(O),this.signerService=(0,e.WQX)(S.A),this.relayService=(0,e.WQX)(I.b),this.dialogRef=(0,e.WQX)(k.CP),this.snackBar=(0,e.WQX)(N.UG),this.clipboard=(0,e.WQX)(V),this.data=(0,e.WQX)(k.Vh),this.lightningInvoice="",this.payRequest=null,this.displayQRCode=!1,this.showInvoiceSection=!1,this.loading=!1,this.invoiceAmount=0,this.error="",this.zapButtons=[{icon:"thumb_up",label:"21",value:21},{icon:"favorite",label:"50",value:50},{icon:"emoji_emotions",label:"100",value:100},{icon:"star",label:"500",value:500},{icon:"celebration",label:"1k",value:1e3},{icon:"rocket",label:"5k",value:5e3},{icon:"local_fire_department",label:"10k",value:1e4},{icon:"flash_on",label:"100k",value:1e5},{icon:"diamond",label:"500k",value:5e5}]}ngOnInit(){this.initializeForm()}initializeForm(){this.sendZapForm=this.formBuilder.group({lightningAddress:[this.data.lud16||this.data.lud06,[g.k0.required,this.validateLightningAddress]],amount:["",[g.k0.required,g.k0.min(1)]],comment:[""]})}validateLightningAddress(t){return t.value.includes("@")?null:{invalidFormat:!0}}onSubmit(){var t=this;return(0,d.A)(function*(){t.sendZapForm.invalid?t.showError("Please fill out the form correctly."):(t.loading=!0,yield t.fetchPayRequest())})()}getCallbackUrl(t){if(t.includes("@")){const[n,i]=t.split("@");return`https://${i}/.well-known/lnurlp/${n}`}return t.toLowerCase().startsWith("lnurl")?this.util.convertBech32ToText(t).toString():null}fetchPayRequest(){var t=this;return(0,d.A)(function*(){t.resetState();const n=t.data.lud16||t.data.lud06;if(!n)return void t.showError("Lightning Address is required.");let i=t.getCallbackUrl(n);try{const r=yield fetch(i);if(!r.ok)throw new Error("Failed to fetch pay request.");const s=yield r.json();if("ERROR"===s.status)return void t.showError(s.reason||"Error fetching the pay request.");t.payRequest=s,t.showInvoiceSection=!1,t.configureAmountValidators(),yield t.generateInvoice()}catch(r){t.showError(r.message||"Error connecting to the server.")}finally{t.loading=!1}})()}generateInvoice(){var t=this;return(0,d.A)(function*(){const n=t.sendZapForm.get("amount")?.value,i=t.sendZapForm.get("comment")?.value,r=t.data.eventId||null;if(!t.payRequest)return void t.showError("Pay request is not loaded.");t.invoiceAmount=n;const s=new URL(t.payRequest.callback),l=new URLSearchParams({amount:(1e3*n).toString()});if(i&&t.payRequest.commentAllowed&&l.set("comment",i),r){const c=yield t.createAndSignZapRequest(r,i);l.set("nostr",JSON.stringify(c))}try{const c=yield fetch(`${s.origin}${s.pathname}?${l.toString()}`);if(!c.ok)throw new Error("Failed to fetch invoice.");const p=yield c.json();if("ERROR"===p.status)return void t.showError(p.reason||"Error fetching the invoice.");t.lightningInvoice=p.pr,t.showInvoiceSection=!0,t.toggleQRCodeDisplay(!0)}catch(c){t.showError(c.message||"Error fetching the invoice.")}})()}configureAmountValidators(){if(!this.payRequest)return;const t=(this.payRequest.minSendable||1e3)/1e3,n=(this.payRequest.maxSendable||21e6)/1e3,i=this.sendZapForm.get("amount");i?.setValidators([g.k0.required,g.k0.min(t),g.k0.max(n)]),i?.updateValueAndValidity()}createAndSignZapRequest(t,n){var i=this;return(0,d.A)(function*(){try{const r=i.createZapRequestData(t,n);let s;if(i.signerService.isUsingSecretKey()){const l=yield i.signerService.getDecryptedSecretKey();if(!l)throw new Error("Private key could not be retrieved.");const c=(0,F.aT)(l);s=(0,x.pC)(r,c)}else s=yield i.signerService.signEventWithExtension(r);if(!s)throw new Error("Signing failed. Signed event is null.");return s}catch(r){throw console.error("Error creating and signing zap request:",r),new Error("Failed to create and sign zap request.")}})()}createZapRequestData(t,n){return{kind:9734,content:n||"",tags:[["e",t],["p",this.payRequest?.nostrPubkey||""],["relays",...this.relayService.getConnectedRelays()]],pubkey:this.signerService.getPublicKey(),created_at:Math.floor(Date.now()/1e3)}}copyInvoice(){this.lightningInvoice?(this.clipboard.copy(this.lightningInvoice),this.showSuccess("Invoice copied to clipboard")):this.showError("No invoice available to copy")}toggleQRCodeDisplay(t=!1){this.displayQRCode=!!t||!this.displayQRCode}resetState(){this.error="",this.loading=!0,this.lightningInvoice=""}showError(t){this.error=t,this.loading=!1,this.snackBar.open(t,"Dismiss",{duration:2e3})}showSuccess(t){this.snackBar.open(t,"Dismiss",{duration:2e3})}closeDialog(){this.dialogRef.close()}static{this.\u0275fac=function(n){return new(n||o)(e.rXU(oe.FP))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-send-dialog"]],standalone:!0,features:[e.aNF],decls:7,vars:4,consts:[[1,"absolute","right-0","top-0","pr-4","pt-4"],["mat-icon-button","","aria-label","Close",3,"matDialogClose"],[1,"text-secondary",3,"svgIcon"],["class","p-0 mt-4",4,"ngIf"],["class","flex flex-col items-center justify-center text-center h-full space-y-4",4,"ngIf"],[1,"p-0","mt-4"],[1,"preset-buttons"],["mat-mini-fab","","color","primary",3,"aria-label","click",4,"ngFor","ngForOf"],[1,"zap-form",3,"formGroup"],["appearance","outline",1,"sats-input"],["matInput","","formControlName","amount","placeholder","Enter amount in sats, e.g., 100","type","number","aria-label","Zap Amount"],["align","end"],[4,"ngIf"],["matInput","","formControlName","comment","placeholder","Optional comment, e.g., as a gift...","aria-label","Comment","maxlength","100"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-mini-fab","","color","primary",3,"click","aria-label"],[1,"flex","flex-col","items-center","justify-center","text-center","h-full","space-y-4"],["class","w-full flex flex-col items-center",4,"ngIf"],["class","w-full max-w-md",4,"ngIf"],[1,"w-full","flex","flex-col","items-center"],[1,"mb-2"],[1,"w-full","mb-4"],[1,"qrcode-image","m-auto",3,"qrdata","matTooltip","errorCorrectionLevel"],[1,"w-full","max-w-md"],["appearance","outline",1,"w-full"],["matInput","","readonly","","aria-label","Invoice Address",3,"value"],["mat-icon-button","","matSuffix","","aria-label","Copy Invoice",3,"click","matTooltip"],[3,"svgIcon"]],template:function(n,i){1&n&&(e.j41(0,"div",0)(1,"button",1),e.nrm(2,"mat-icon",2),e.k0s()(),e.j41(3,"h1"),e.EFF(4,"\u26a1Zap"),e.k0s(),e.DNE(5,ae,22,6,"mat-dialog-content",3)(6,de,3,2,"mat-dialog-content",4)),2&n&&(e.R7$(),e.Y8G("matDialogClose",void 0),e.R7$(),e.Y8G("svgIcon","heroicons_outline:x-mark"),e.R7$(3),e.Y8G("ngIf",!i.showInvoiceSection||!i.lightningInvoice),e.R7$(),e.Y8G("ngIf",i.showInvoiceSection&&i.lightningInvoice))},dependencies:[L.vg,_.Hl,_.$z,_.iY,_.$0,w.m_,w.An,g.YN,g.me,g.Q0,g.BC,g.cb,g.tU,b.nJ,b.rl,g.X1,g.j4,g.JD,f.MD,f.Sq,f.bT,ie.Ve,b.MV,b.TL,b.yw,b.RG,j.fS,j.fg,k.Yi,k.E7,U.f,U.c,G.q,P.oV,k.tx],styles:[".preset-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;justify-items:center;margin-bottom:20px}.preset-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px;font-weight:700;width:100px;height:60px;display:flex;flex-direction:column;align-items:center;justify-content:center;max-height:60px!important}.sats-input[_ngcontent-%COMP%]{margin-top:20px;width:100%}.lightning-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;margin:10px 0}"]})}}return o})();var me=u(7291),ge=u(345);let X=(()=>{class o{constructor(t){this.relayService=t,this.requestQueue=[],this.isProcessingQueue=!1,this.maxConcurrentRequests=2,this.currentRequestCount=0}addRequestToQueue(t){const n=new R.B;return this.requestQueue.push({filters:t,subject:n}),this.processQueue(),n.asObservable()}processQueue(){var t=this;return(0,d.A)(function*(){if(!t.isProcessingQueue){for(t.isProcessingQueue=!0;t.requestQueue.length>0&&t.currentRequestCount<t.maxConcurrentRequests;){const n=t.requestQueue.shift();if(!n)break;try{t.currentRequestCount++,yield t.handleRequest(n)}catch(i){n.subject.error(i)}finally{t.currentRequestCount--}}t.isProcessingQueue=!1,t.requestQueue.length>0&&t.processQueue()}})()}handleRequest(t){var n=this;return(0,d.A)(function*(){try{yield n.relayService.ensureConnectedRelays();const i=n.relayService.getConnectedRelays();if(0===i.length)throw new Error("No connected relays available");yield n.fetchEvents(i,t.filters,t.subject)}catch(i){t.subject.error(i)}})()}fetchEvents(t,n,i){var r=this;return(0,d.A)(function*(){const l=r.relayService.getPool().subscribeMany(t,n,{onevent:c=>{i.next(c)},oneose:()=>{l.close(),i.complete()}});setTimeout(()=>{l.close||(l.close(),i.complete())},5e3)})()}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(I.b))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),fe=(()=>{class o{constructor(t,n,i){this.relayService=t,this.signerService=n,this.queueService=i,this.followersSubject=new R.B,this.followingSubject=new R.B}getFollowersObservable(){return this.followersSubject.asObservable()}getFollowingObservable(){return this.followingSubject.asObservable()}getFollowers(t){var n=this;return(0,d.A)(function*(){const i=[{kinds:[3],"#p":[t]}],r=[];return new Promise((s,l)=>{n.queueService.addRequestToQueue(i).subscribe({next:p=>{r.push(p),n.followersSubject.next(p)},error:p=>{console.error("Error fetching followers:",p),l(p)},complete:()=>{s(r)}})})})()}getFollowing(t){var n=this;return(0,d.A)(function*(){const i=[{kinds:[3],authors:[t]}],r=[];return new Promise((s,l)=>{n.queueService.addRequestToQueue(i).subscribe({next:p=>{p.tags.filter(h=>"p"===h[0]).forEach(h=>{r.push(h[1]),n.followingSubject.next(p)})},error:p=>{console.error("Error fetching following:",p),l(p)},complete:()=>{s(r)}})})})()}follow(t){var n=this;return(0,d.A)(function*(){const i=n.getFollowingList();if(i.includes(t))return void console.log(`Already following ${t}`);const r=[...i,t];n.setFollowingList(r);const s=n.signerService.getUnsignedEvent(3,r.map(l=>["p",l]),"");yield n.publishSignedEvent(s),console.log(`Now following ${t}`)})()}unfollow(t){var n=this;return(0,d.A)(function*(){const i=n.getFollowingList();if(!i.includes(t))return void console.log(`Not following ${t}`);const r=i.filter(l=>l!==t);n.setFollowingList(r);const s=n.signerService.getUnsignedEvent(3,r.map(l=>["p",l]),"");yield n.publishSignedEvent(s),console.log(`Unfollowed ${t}`)})()}publishSignedEvent(t){var n=this;return(0,d.A)(function*(){let r;if(yield n.signerService.isUsingExtension())r=yield n.signerService.signEventWithExtension(t);else{const s=yield n.signerService.getDecryptedSecretKey();if(!s)throw new Error("Secret key is missing. Unable to sign event.");r=n.signerService.getSignedEvent(t,s)}n.relayService.publishEventToWriteRelays(r)})()}getFollowingListAsTags(){const t=this.getFollowingList(),n=[],i=this.relayService.getConnectedRelays();return t.forEach(r=>{i.forEach(s=>{n.push(["p",r,s,localStorage.getItem(`${r}`)||""])})}),n}setFollowingListFromTags(t){const n=[];t.forEach(i=>{n.push(i[1])}),this.setFollowingList(n)}setFollowingList(t){const i=Array.from(new Set(t)).filter(r=>r).join(",");localStorage.setItem("following",i)}getFollowingList(){const t=localStorage.getItem("following");return null===t||""===t?[]:t.split(",").filter(i=>/[a-f0-9]{64}/.test(i))}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(I.b),e.KVO(S.A),e.KVO(X))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var he=u(881),ve=u(9979);class be{constructor(a,t,n,i,r,s,l=[]){this.username="",this.picture="/images/avatars/avatar-placeholder.png",this.replyCount=0,this.likeCount=0,this.zapCount=0,this.repostCount=0,this.likedByMe=!1,this.replies=[],this.likers=[],this.reposters=[],this.zappers=[],this.relatedEventIds=[],this.rootEventId="",this.replyToEventId="",this.mentions=[],this.hashtags=[],this.repostedByMe=!1,this.tags=[],this.isAReply=!1,this.kind=t,this.pubkey=n,this.content=i,this.noteId=r,this.createdAt=s,this.date=new Date(1e3*this.createdAt),this.fromNow=this.calculateTimeFromNow(this.date),this.tags=l,this.id=a}calculateTimeFromNow(a){const n=Math.floor(((new Date).getTime()-a.getTime())/1e3);return n<60?`${n} seconds ago`:n<3600?`${Math.floor(n/60)} minutes ago`:n<86400?`${Math.floor(n/3600)} hours ago`:n<2592e3?`${Math.floor(n/86400)} days ago`:n<31536e3?`${Math.floor(n/2592e3)} months ago`:`${Math.floor(n/31536e3)} years ago`}}var A=u(4412),ye=u(3236),_e=u(9974),Z=u(4360),ke=u(8750),xe=u(1584);let we=(()=>{class o{constructor(t,n,i){this.relayService=t,this.signerService=n,this.queueService=i,this.eventsSubject=new A.t([]),this.isLoading=new A.t(!1),this.lastLoadedEventTime=null,this.pageSize=10,this.noMoreEvents=new A.t(!1),this.seenEventIds=new Set,this.likesMap=new Map,this.repliesMap=new Map,this.zapsMap=new Map,this.repostsMap=new Map,this.hasLikedMap=new Map,this.hasRepostedMap=new Map,this.jobQueue=[],this.isProcessingQueue=!1,this.myLikedNoteIds=[]}subscribeToEvents(t){var n=this;return(0,d.A)(function*(){yield n.relayService.ensureConnectedRelays();const i=n.relayService.getConnectedRelays().slice(0,3);if(!i||0===i.length)return void console.error("No connected relays available.");const r=[{kinds:[1],authors:t,limit:n.pageSize},{"#p":t,limit:1}];n.relayService.getPool().subscribeMany(i,r,{onevent:l=>{n.isReply(l)||n.handleNewOrUpdatedEvent(l);const c=n.getParentEventId(l);switch(c&&n.enqueueJob(c),l.kind){case 7:case 9735:case 6:n.enqueueJob(c)}},oneose:()=>{}})})()}getParentEventId(t){const n=t.tags.find(i=>"e"===i[0]);return n?n[1]:null}handleNewOrUpdatedEvent(t){var n=this;return(0,d.A)(function*(){switch(t.kind){case 1:if(!n.seenEventIds.has(t.id)){n.seenEventIds.add(t.id);const i=yield n.createNewEvent(t);n.eventsSubject.next([i]),n.updateEventInSubject(t.id)}break;case 7:n.handleLikeEvent(t);break;case 9735:n.handleZapEvent(t);break;case 6:n.handleRepostEvent(t);break;case 4:n.handleReplyEvent(t)}})()}handleLikeEvent(t){const n=t.tags.find(i=>"e"===i[0])?.[1];if(n){const r=this.eventsSubject.getValue().find(s=>s.id===n);r&&(r.likeCount+=1,r.likers=[...r.likers||[],t.pubkey],this.eventsSubject.next([r]))}}handleZapEvent(t){const n=t.tags.find(i=>"e"===i[0])?.[1];if(n){const r=this.eventsSubject.getValue().find(s=>s.id===n);r&&(r.zapCount+=1,r.zappers=[...r.zappers||[],t.pubkey],this.eventsSubject.next([r]))}}handleRepostEvent(t){const n=t.tags.find(i=>"e"===i[0])?.[1];if(n){const r=this.eventsSubject.getValue().find(s=>s.id===n);r&&(r.repostCount+=1,r.reposters=[...r.reposters||[],t.pubkey],this.eventsSubject.next([r]))}}handleReplyEvent(t){var n=this;return(0,d.A)(function*(){const i=t.tags.find(r=>"e"===r[0])?.[1];if(i){const r=yield n.createNewEvent(t),l=n.eventsSubject.getValue().find(c=>c.id===i);l&&(l.replyCount+=1,l.replies=[...l.replies||[],r],n.eventsSubject.next([l]))}})()}isReply(t){return t.tags.filter(i=>"e"===i[0]||"p"===i[0]).length>0}getMyLikes(){var t=this;return(0,d.A)(function*(){const n={kinds:[7],authors:[t.signerService.getPublicKey()]};try{return(yield t.fetchFilteredEvents(n)).forEach(r=>{const s=r.tags.find(l=>"e"===l[0]);s&&t.myLikedNoteIds.push(s[1])}),t.myLikedNoteIds}catch(i){return console.error("Failed to get user likes:",i),[]}})()}loadMoreEvents(t){var n=this;return(0,d.A)(function*(){if(n.isLoading.value||n.noMoreEvents.value)return;n.isLoading.next(!0);const i={authors:t,kinds:[1],until:n.lastLoadedEventTime||Math.floor(Date.now()/1e3),limit:n.pageSize};try{const r=yield n.fetchFilteredEvents(i);if(r.length<n.pageSize&&n.noMoreEvents.next(!0),r.length>0){n.lastLoadedEventTime=r[r.length-1].created_at;const s=r.filter(c=>!n.seenEventIds.has(c.id)&&!n.isReply(c));s.forEach(c=>n.seenEventIds.add(c.id));const l=yield Promise.all(s.map(c=>n.createNewEvent(c)));n.eventsSubject.next([...n.eventsSubject.getValue(),...l].sort((c,p)=>p.createdAt-c.createdAt))}else n.noMoreEvents.next(!0)}catch(r){console.error("Error loading more events:",r)}finally{n.isLoading.next(!1)}})()}fetchFilteredEvents(t){var n=this;return(0,d.A)(function*(){return new Promise((i,r)=>{const s=new Map,l=[];n.queueService.addRequestToQueue([t]).subscribe({next:c=>{s.has(c.id)||(s.set(c.id,c),l.push(c))},error:c=>{console.error("Error fetching events:",c),r(c)},complete:()=>{console.log("All events fetched and completed"),i(l)}})})})()}createNewEvent(t){var n=this;return(0,d.A)(function*(){const i=new be(t.id,t.kind,t.pubkey,t.content,t.id,t.created_at,t.tags);return n.enqueueJob(t.id),yield n.processJobQueue(),i.likedByMe=n.myLikedNoteIds.includes(t.id),i})()}enqueueJob(t){this.jobQueue.some(n=>n.eventId===t)||(this.jobQueue.push({eventId:t}),this.isProcessingQueue||this.processJobQueue())}processJobQueue(){var t=this;return(0,d.A)(function*(){if(t.isProcessingQueue)return;t.isProcessingQueue=!0;const n=[];for(;t.jobQueue.length>0||n.length>0;){for(;t.jobQueue.length>0&&n.length<10;){const i=t.jobQueue.shift();if(!i)break;yield t.delay(1e3);const r=t.processJobWithQueueService(i);n.push(r),r.then(()=>{n.splice(n.indexOf(r),1)}).catch(s=>{console.error("Error processing job:",s),n.splice(n.indexOf(r),1)})}yield Promise.race(n)}t.isProcessingQueue=!1})()}processJobWithQueueService(t){var n=this;return(0,d.A)(function*(){try{const i=yield n.fetchMultiFilterEvents(t.eventId);n.repliesMap.set(t.eventId,i.replies),n.likesMap.set(t.eventId,i.likers),n.zapsMap.set(t.eventId,i.zappers),n.repostsMap.set(t.eventId,i.reposters),n.updateEventInSubject(t.eventId)}catch(i){throw console.error("Error processing job with QueueService:",i),i}})()}delay(t){return new Promise(n=>setTimeout(n,t))}updateEventInSubject(t){const i=this.eventsSubject.getValue().map(r=>(r.id===t&&(r.replyCount=this.getRepliesCount(t),r.replies=this.repliesMap.get(t)||[],r.likeCount=this.getLikesCount(t),r.likers=this.likesMap.get(t)||[],r.zapCount=this.getZapsCount(t),r.zappers=this.zapsMap.get(t)||[],r.repostCount=this.getRepostsCount(t),r.reposters=this.repostsMap.get(t)||[]),r));this.eventsSubject.next(i)}fetchMultiFilterEvents(t){var n=this;return(0,d.A)(function*(){const i=[{"#e":[t],kinds:[1]},{"#e":[t],kinds:[7]},{"#e":[t],kinds:[9735]},{"#e":[t],kinds:[6]}],r=new Map,s=[],l=[],c=[],p=[],y=n.queueService.addRequestToQueue(i);return new Promise((h,E)=>{var v;y.subscribe({next:(v=(0,d.A)(function*(m){if(r.has(m.id)||r.set(m.id,m),1===m.kind){const $=yield n.createNewEvent(m);s.push($)}else 7===m.kind?l.push(m.pubkey):9735===m.kind?c.push(m.pubkey):6===m.kind&&p.push(m.pubkey)}),function($){return v.apply(this,arguments)}),error:v=>{console.error("Error fetching events:",v),E(v)},complete:()=>{h({replies:s,likers:l,zappers:c,reposters:p})}})})})()}getRepliesCount(t){return(this.repliesMap.get(t)||[]).length}getLikesCount(t){return(this.likesMap.get(t)||[]).length}getZapsCount(t){return(this.zapsMap.get(t)||[]).length}getRepostsCount(t){return(this.repostsMap.get(t)||[]).length}hasUserLiked(t){return this.hasLikedMap.get(t)||!1}hasUserReposted(t){return this.hasRepostedMap.get(t)||!1}getEventStream(){return this.eventsSubject.asObservable().pipe(function Fe(o,a=ye.E,t){const n=(0,xe.O)(o,a);return function Ee(o,a){return(0,_e.N)((t,n)=>{const{leading:i=!0,trailing:r=!1}=a??{};let s=!1,l=null,c=null,p=!1;const y=()=>{c?.unsubscribe(),c=null,r&&(v(),p&&n.complete())},h=()=>{c=null,p&&n.complete()},E=m=>c=(0,ke.Tg)(o(m)).subscribe((0,Z._)(n,y,h)),v=()=>{if(s){s=!1;const m=l;l=null,n.next(m),!p&&E(m)}};t.subscribe((0,Z._)(n,m=>{s=!0,l=m,(!c||c.closed)&&(i?v():E(m))},()=>{p=!0,(!(r&&s&&c)||c.closed)&&n.complete()}))})}(()=>n,t)}(1e3))}hasMoreEvents(){return this.noMoreEvents.asObservable()}sendTextEvent(t){var n=this;return(0,d.A)(function*(){if(t)try{const r=n.signerService.getUnsignedEvent(1,[],t);let s;if(n.signerService.isUsingSecretKey()){const l=yield n.signerService.getDecryptedSecretKey(),c=(0,F.aT)(l);s=(0,x.pC)(r,c)}else s=yield n.signerService.signEventWithExtension(r);yield n.relayService.publishEventToWriteRelays(s)}catch(i){console.error("Failed to send text event:",i)}})()}sendLikeEvent(t){var n=this;return(0,d.A)(function*(){if(t)try{const s=n.signerService.getUnsignedEvent(7,[["e",t.id],["p",t.pubkey]],"+");let l;if(n.signerService.isUsingSecretKey()){const c=yield n.signerService.getDecryptedSecretKey(),p=(0,F.aT)(c);l=(0,x.pC)(s,p)}else l=yield n.signerService.signEventWithExtension(s);yield n.relayService.publishEventToWriteRelays(l),n.likesMap.set(t.id,[...n.likesMap.get(t.id)||[],n.signerService.getPublicKey()]),n.hasLikedMap.set(t.id,!0)}catch(i){console.error("Failed to send like event:",i)}})()}sendZapEvent(t,n){var i=this;return(0,d.A)(function*(){if(t&&!(n<=0))try{const r=[["e",t.id],["p",t.pubkey],["amount",n.toString()]],l=i.signerService.getUnsignedEvent(9735,r,`Zapped with ${n} sats`);let c;if(i.signerService.isUsingSecretKey()){const p=yield i.signerService.getDecryptedSecretKey(),y=(0,F.aT)(p);c=(0,x.pC)(l,y)}else c=yield i.signerService.signEventWithExtension(l);yield i.relayService.publishEventToWriteRelays(c)}catch(r){console.error("Failed to send zap event:",r)}})()}sendReplyEvent(t,n){var i=this;return(0,d.A)(function*(){if(t)try{const s=i.signerService.getUnsignedEvent(1,[["e",t.id],["p",t.pubkey]],n);let l;if(i.signerService.isUsingSecretKey()){const c=yield i.signerService.getDecryptedSecretKey(),p=(0,F.aT)(c);l=(0,x.pC)(s,p)}else l=yield i.signerService.signEventWithExtension(s);yield i.relayService.publishEventToWriteRelays(l)}catch(r){console.error("Failed to send reply event:",r)}})()}clearEvents(){this.eventsSubject.next([]),this.seenEventIds.clear(),this.lastLoadedEventTime=null,this.noMoreEvents.next(!1)}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(I.b),e.KVO(S.A),e.KVO(X))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var je=u(5645),Ce=u(413);const Re=["eventInput"],Se=["commentInput"],Ie=()=>["hex","npub"],$e=(o,a)=>({height:o,overflow:a}),Ge=(o,a)=>({"white-space":o,"max-height":a,overflow:"hidden"}),Q=o=>({"large-font":o});function Pe(o,a){if(1&o&&(e.qex(0),e.nrm(1,"img",35),e.bVm()),2&o){const t=e.XpG();e.R7$(),e.FS9("alt",(null==t.profileUser?null:t.profileUser.display_name)||(null==t.profileUser?null:t.profileUser.name)||""),e.Y8G("src",t.getSafeUrl(null==t.profileUser?null:t.profileUser.picture),e.B4B)}}function Te(o,a){if(1&o&&e.nrm(0,"img",36),2&o){const t=e.XpG();e.FS9("alt",(null==t.profileUser?null:t.profileUser.display_name)||(null==t.profileUser?null:t.profileUser.name)||"")}}function Ue(o,a){if(1&o&&(e.j41(0,"div",37)(1,"div",38)(2,"span",39),e.EFF(3),e.k0s(),e.j41(4,"span",40),e.EFF(5,"FOLLOWERS"),e.k0s()(),e.j41(6,"div",38)(7,"span",41),e.EFF(8),e.k0s(),e.j41(9,"span",42),e.EFF(10,"FOLLOWING"),e.k0s()()()),2&o){const t=a.ngIf;e.R7$(2),e.Y8G("matTooltip","Total contact: "+t.totalContacts),e.R7$(),e.JRh(t.followersCount),e.R7$(5),e.JRh(t.followingCount),e.R7$(),e.Y8G("matTooltip","Total contact: "+t.totalContacts)}}function Me(o,a){if(1&o){const t=e.RV6();e.j41(0,"div")(1,"button",43),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.toggleFollow())}),e.nrm(2,"mat-icon",44),e.k0s()()}if(2&o){const t=e.XpG();e.R7$(),e.Y8G("matTooltip",t.isFollowing?"Unfollow":"Follow"),e.R7$(),e.Y8G("svgIcon",t.isFollowing?"heroicons_outline:user-minus":"heroicons_outline:user-plus")}}function Ye(o,a){if(1&o){const t=e.RV6();e.j41(0,"button",45),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.openZapDialog())}),e.j41(1,"span",46),e.nrm(2,"mat-icon",47),e.j41(3,"span"),e.EFF(4),e.k0s()()()}if(2&o){const t=e.XpG();e.R7$(2),e.Y8G("svgIcon",t.isCurrentUserProfile?"heroicons_outline:qr-code":"feather:zap"),e.R7$(2),e.JRh(t.isCurrentUserProfile?"Receive Zap":"Send Zap")}}function Ae(o,a){if(1&o){const t=e.RV6();e.qex(0),e.j41(1,"button",45),e.bIt("click",function(){const i=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.copyKey(i))}),e.j41(2,"span",46),e.nrm(3,"mat-icon",47),e.j41(4,"span"),e.EFF(5),e.k0s()()(),e.bVm()}if(2&o){const t=a.$implicit;e.R7$(3),e.Y8G("svgIcon","heroicons_outline:clipboard-document"),e.R7$(2),e.SpI("Copy Public key (",t,")")}}function Be(o,a){1&o&&(e.j41(0,"button",48)(1,"span",46),e.nrm(2,"mat-icon",47),e.j41(3,"span"),e.EFF(4,"Edit your profile"),e.k0s()()()),2&o&&(e.Y8G("routerLink","/settings/profile"),e.R7$(2),e.Y8G("svgIcon","heroicons_outline:pencil-square"))}function De(o,a){1&o&&(e.qex(0),e.j41(1,"button",49)(2,"span",46),e.nrm(3,"mat-icon",47),e.j41(4,"span"),e.EFF(5,"Report"),e.k0s()()(),e.j41(6,"button",49)(7,"span",46),e.nrm(8,"mat-icon",47),e.j41(9,"span"),e.EFF(10,"Turn on notifications"),e.k0s()()(),e.bVm()),2&o&&(e.R7$(3),e.Y8G("svgIcon","heroicons_solid:exclamation-triangle"),e.R7$(5),e.Y8G("svgIcon","heroicons_solid:bell"))}function Le(o,a){1&o&&(e.j41(0,"span",56),e.EFF(1,"..."),e.k0s())}function Ne(o,a){if(1&o){const t=e.RV6();e.j41(0,"angor-card",50)(1,"div",51)(2,"div",52),e.EFF(3,"About"),e.k0s(),e.j41(4,"button",53),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.toggleAbout())}),e.j41(5,"mat-icon"),e.EFF(6),e.k0s()()(),e.j41(7,"div",54),e.EFF(8),e.DNE(9,Le,2,0,"span",55),e.k0s()()}if(2&o){const t=e.XpG();e.Y8G("ngStyle",e.l_i(5,$e,t.aboutExpanded?"auto":"80px",t.aboutExpanded?"visible":"hidden")),e.R7$(6),e.JRh(t.aboutExpanded?"expand_less":"expand_more"),e.R7$(),e.Y8G("ngStyle",e.l_i(8,Ge,t.aboutExpanded?"normal":"nowrap",t.aboutExpanded?"none":"1.5em")),e.R7$(),e.SpI(" ",(null==t.profileUser?null:t.profileUser.about)||""," "),e.R7$(),e.Y8G("ngIf",!t.aboutExpanded)}}function Ve(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",75)(1,"emoji-mart",76),e.bIt("emojiClick",function(i){e.eBV(t);const r=e.XpG(2);return e.Njj(r.addEmoji(i))}),e.k0s()()}if(2&o){const t=e.XpG(2);e.R7$(),e.Y8G("darkMode",t.darkMode)}}function Oe(o,a){if(1&o){const t=e.RV6();e.j41(0,"angor-card",57)(1,"div",58)(2,"div",59),e.EFF(3,"Create Post"),e.k0s(),e.j41(4,"mat-slide-toggle",60),e.bIt("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.togglePreview())}),e.EFF(5," Preview "),e.k0s()(),e.j41(6,"div",61)(7,"div",62),e.nrm(8,"img",63),e.j41(9,"div",64),e.EFF(10),e.k0s()(),e.j41(11,"mat-form-field",65),e.nrm(12,"textarea",66,2),e.k0s()(),e.j41(14,"div",67)(15,"div",46)(16,"button",68),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.toggleEmojiPicker())}),e.nrm(17,"mat-icon",22),e.j41(18,"span",69),e.EFF(19,"Feeling"),e.k0s()(),e.DNE(20,Ve,2,1,"div",70),e.j41(21,"button",71),e.nrm(22,"mat-icon",22),e.j41(23,"span",69),e.EFF(24,"Media"),e.k0s()(),e.j41(25,"button",71),e.nrm(26,"mat-icon",22),e.j41(27,"span",69),e.EFF(28,"Tag"),e.k0s()(),e.j41(29,"button",72),e.nrm(30,"mat-icon",22),e.k0s(),e.j41(31,"mat-menu",null,3)(33,"button",73)(34,"span",46),e.nrm(35,"mat-icon",47),e.j41(36,"span"),e.EFF(37,"Tag"),e.k0s()()(),e.j41(38,"button",73)(39,"span",46),e.nrm(40,"mat-icon",47),e.j41(41,"span"),e.EFF(42,"Feeling"),e.k0s()()(),e.j41(43,"button",49)(44,"span",46),e.nrm(45,"mat-icon",47),e.j41(46,"span"),e.EFF(47,"Live"),e.k0s()()(),e.j41(48,"button",49)(49,"span",46),e.nrm(50,"mat-icon",47),e.j41(51,"span"),e.EFF(52,"Gif"),e.k0s()()(),e.j41(53,"button",49)(54,"span",46),e.nrm(55,"mat-icon",47),e.j41(56,"span"),e.EFF(57,"Check in"),e.k0s()()()()(),e.j41(58,"button",74),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.sendEvent())}),e.nrm(59,"mat-icon",22),e.j41(60,"span",69),e.EFF(61,"Send"),e.k0s()()()()}if(2&o){const t=e.sdS(32),n=e.XpG();e.R7$(4),e.Y8G("color","primary"),e.R7$(4),e.FS9("alt",(null==n.profileUser?null:n.profileUser.display_name)||(null==n.profileUser?null:n.profileUser.name)||""),e.Y8G("src",n.getSafeUrl(null==n.profileUser?null:n.profileUser.picture),e.B4B),e.R7$(2),e.SpI(" ",(null==n.profileUser?null:n.profileUser.display_name)||(null==n.profileUser?null:n.profileUser.name)||""," "),e.R7$(),e.Y8G("subscriptSizing","dynamic"),e.R7$(),e.Y8G("placeholder","What's on your mind?")("rows",3),e.R7$(5),e.Y8G("svgIcon","heroicons_solid:face-smile"),e.R7$(3),e.Y8G("ngIf",n.showEmojiPicker),e.R7$(2),e.Y8G("svgIcon","heroicons_solid:photo"),e.R7$(4),e.Y8G("svgIcon","heroicons_solid:user-circle"),e.R7$(3),e.Y8G("matMenuTriggerFor",t),e.R7$(),e.Y8G("svgIcon","heroicons_solid:ellipsis-horizontal"),e.R7$(5),e.Y8G("svgIcon","heroicons_solid:user-circle"),e.R7$(5),e.Y8G("svgIcon","heroicons_solid:face-smile"),e.R7$(5),e.Y8G("svgIcon","heroicons_solid:play"),e.R7$(5),e.Y8G("svgIcon","heroicons_solid:sparkles"),e.R7$(5),e.Y8G("svgIcon","heroicons_solid:map-pin"),e.R7$(4),e.Y8G("svgIcon","heroicons_solid:paper-airplane")}}function Xe(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",99),e.nrm(2,"iframe",100),e.k0s(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(2),e.Y8G("src",t.safeWord,e.f$h)}}function Ze(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",99),e.nrm(2,"img",101),e.k0s(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(2),e.Y8G("src",t.safeWord,e.B4B)}}function Qe(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",99)(2,"video",102),e.nrm(3,"source",103),e.EFF(4," Your browser does not support the video tag. "),e.k0s()(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(3),e.Y8G("src",t.safeWord,e.B4B)}}function Ke(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",99)(2,"audio",104),e.nrm(3,"source",105),e.EFF(4," Your browser does not support the audio element. "),e.k0s()(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(3),e.Y8G("src",t.safeWord,e.B4B)}}function ze(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",106)(2,"a",107)(3,"span",108),e.EFF(4),e.k0s()()(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(2),e.Y8G("href",t.word,e.B4B),e.R7$(2),e.JRh(t.word)}}function qe(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",106)(2,"span",109),e.EFF(3),e.k0s()(),e.bVm()),2&o){const t=e.XpG().$implicit,n=e.XpG(2);e.R7$(2),e.Y8G("ngClass",e.eq3(2,Q,n.isSingleEmojiOrWord(t))),e.R7$(),e.SpI(" ",t.trim()," ")}}function We(o,a){if(1&o&&(e.j41(0,"div",98),e.DNE(1,Xe,3,1,"ng-container",20)(2,Ze,3,1,"ng-container",20)(3,Qe,5,1,"ng-container",20)(4,Ke,5,1,"ng-container",20)(5,ze,5,2,"ng-container",20)(6,qe,4,4,"ng-container",20),e.k0s()),2&o){const t=a.$implicit;e.R7$(),e.Y8G("ngIf","youtube"===t.token),e.R7$(),e.Y8G("ngIf","image"===t.token),e.R7$(),e.Y8G("ngIf","video"===t.token),e.R7$(),e.Y8G("ngIf","audio"===t.token),e.R7$(),e.Y8G("ngIf","link"===t.token),e.R7$(),e.Y8G("ngIf",!t.token)}}function Je(o,a){if(1&o&&(e.j41(0,"angor-card",77,4)(2,"div",78),e.nrm(3,"img",79),e.j41(4,"div",80)(5,"span",81),e.EFF(6),e.k0s(),e.j41(7,"span",82),e.EFF(8,"1 minutes ago"),e.k0s()()(),e.DNE(9,We,7,6,"div",83),e.j41(10,"div",84)(11,"button",85),e.nrm(12,"mat-icon",86),e.j41(13,"span",69),e.EFF(14,"Unlike"),e.k0s()(),e.j41(15,"button",85),e.nrm(16,"mat-icon",87),e.j41(17,"span",69),e.EFF(18,"Comment"),e.k0s()(),e.j41(19,"button",85),e.nrm(20,"mat-icon",88),e.j41(21,"span",69),e.EFF(22,"Share"),e.k0s()(),e.j41(23,"button",85),e.nrm(24,"mat-icon",89),e.j41(25,"span",69),e.EFF(26,"Zap"),e.k0s()()(),e.nrm(27,"hr",90),e.j41(28,"div",91)(29,"div",46)(30,"div",92),e.EFF(31," 0 Zap "),e.k0s()(),e.nrm(32,"div",93),e.j41(33,"div",94)(34,"button",95),e.EFF(35," 0 Like "),e.k0s(),e.j41(36,"button",95),e.EFF(37," 0 shares "),e.k0s(),e.j41(38,"button",96)(39,"span",97),e.EFF(40,"0 Comments"),e.k0s()()()()()),2&o){const t=e.XpG();e.R7$(3),e.FS9("alt",(null==t.profileUser?null:t.profileUser.display_name)||(null==t.profileUser?null:t.profileUser.name)||""),e.Y8G("src",t.getSafeUrl(null==t.profileUser?null:t.profileUser.picture),e.B4B),e.R7$(3),e.JRh((null==t.profileUser?null:t.profileUser.display_name)||(null==t.profileUser?null:t.profileUser.name)||""),e.R7$(3),e.Y8G("ngForOf",t.parseContent.parseContent(t.eventInput.nativeElement.value))("ngForTrackBy",t.trackByFn),e.R7$(3),e.Y8G("svgIcon","heroicons_solid:heart"),e.R7$(4),e.Y8G("svgIcon","heroicons_solid:chat-bubble-left-ellipsis"),e.R7$(4),e.Y8G("svgIcon","heroicons_solid:share"),e.R7$(4),e.Y8G("svgIcon","heroicons_solid:bolt")}}function He(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",99),e.nrm(2,"iframe",100),e.k0s(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(2),e.Y8G("src",t.safeWord,e.f$h)}}function et(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",99),e.nrm(2,"img",101),e.k0s(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(2),e.Y8G("src",t.safeWord,e.B4B)}}function tt(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",99)(2,"video",102),e.nrm(3,"source",103),e.EFF(4," Your browser does not support the video tag. "),e.k0s()(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(3),e.Y8G("src",t.safeWord,e.B4B)}}function nt(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",99)(2,"audio",104),e.nrm(3,"source",105),e.EFF(4," Your browser does not support the audio element. "),e.k0s()(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(3),e.Y8G("src",t.safeWord,e.B4B)}}function it(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",106)(2,"a",107)(3,"span",108),e.EFF(4),e.k0s()()(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(2),e.Y8G("href",t.word,e.B4B),e.R7$(2),e.JRh(t.word)}}function ot(o,a){if(1&o&&(e.qex(0),e.j41(1,"div",106)(2,"span",109),e.EFF(3),e.k0s()(),e.bVm()),2&o){const t=e.XpG().$implicit,n=e.XpG(2);e.R7$(2),e.Y8G("ngClass",e.eq3(2,Q,n.isSingleEmojiOrWord(t))),e.R7$(),e.SpI(" ",t.trim()," ")}}function rt(o,a){if(1&o&&(e.j41(0,"div",98),e.DNE(1,He,3,1,"ng-container",20)(2,et,3,1,"ng-container",20)(3,tt,5,1,"ng-container",20)(4,nt,5,1,"ng-container",20)(5,it,5,2,"ng-container",20)(6,ot,4,4,"ng-container",20),e.k0s()),2&o){const t=a.$implicit;e.R7$(),e.Y8G("ngIf","youtube"===t.token),e.R7$(),e.Y8G("ngIf","image"===t.token),e.R7$(),e.Y8G("ngIf","video"===t.token),e.R7$(),e.Y8G("ngIf","audio"===t.token),e.R7$(),e.Y8G("ngIf","link"===t.token),e.R7$(),e.Y8G("ngIf",!t.token)}}function st(o,a){if(1&o){const t=e.RV6();e.j41(0,"angor-card",32,5)(2,"div",78),e.nrm(3,"img",79),e.j41(4,"div",80)(5,"span",81),e.EFF(6),e.k0s(),e.j41(7,"span",82),e.EFF(8),e.nI1(9,"ago"),e.k0s()(),e.j41(10,"button",110),e.nrm(11,"mat-icon",22),e.k0s(),e.j41(12,"mat-menu",null,6)(14,"button",49)(15,"span",46),e.nrm(16,"mat-icon",47),e.j41(17,"span"),e.EFF(18,"Save post"),e.k0s()()(),e.j41(19,"button",49)(20,"span",46),e.nrm(21,"mat-icon",47),e.j41(22,"span"),e.EFF(23,"Hide post"),e.k0s()()(),e.j41(24,"button",49)(25,"span",46),e.nrm(26,"mat-icon",47),e.j41(27,"span"),e.EFF(28,"Snooze for 30 days"),e.k0s()()(),e.j41(29,"button",49)(30,"span",46),e.nrm(31,"mat-icon",47),e.j41(32,"span"),e.EFF(33,"Hide all"),e.k0s()()(),e.nrm(34,"mat-divider",25),e.j41(35,"button",49)(36,"span",46),e.nrm(37,"mat-icon",47),e.j41(38,"span"),e.EFF(39,"Report post"),e.k0s()()(),e.j41(40,"button",49)(41,"span",46),e.nrm(42,"mat-icon",47),e.j41(43,"span"),e.EFF(44,"Turn on notifications for this post"),e.k0s()()()()(),e.DNE(45,rt,7,6,"div",83),e.j41(46,"div",84)(47,"button",85),e.nrm(48,"mat-icon",86),e.j41(49,"span",69),e.EFF(50,"Unlike"),e.k0s()(),e.j41(51,"button",85),e.nrm(52,"mat-icon",87),e.j41(53,"span",69),e.EFF(54,"Comment"),e.k0s()(),e.j41(55,"button",85),e.nrm(56,"mat-icon",88),e.j41(57,"span",69),e.EFF(58,"Share"),e.k0s()(),e.j41(59,"button",68),e.bIt("click",function(){const i=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.openZapDialog(i.id))}),e.nrm(60,"mat-icon",89),e.j41(61,"span",69),e.EFF(62,"Zap"),e.k0s()()(),e.nrm(63,"hr",90),e.j41(64,"div",91)(65,"div",46),e.nrm(66,"img",111)(67,"img",112)(68,"img",112)(69,"img",112),e.j41(70,"div",92),e.EFF(71," 24 Reactions "),e.k0s()(),e.nrm(72,"div",93),e.j41(73,"div",94)(74,"button",113),e.bIt("click",function(){const i=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.openPost(i.id))}),e.j41(75,"span",97),e.EFF(76,"Read More ..."),e.k0s()()()()()}if(2&o){const t=a.$implicit,n=e.sdS(13),i=e.XpG();e.R7$(3),e.FS9("alt",(null==i.profileUser?null:i.profileUser.display_name)||(null==i.profileUser?null:i.profileUser.name)||""),e.Y8G("src",i.getSafeUrl(null==i.profileUser?null:i.profileUser.picture),e.B4B),e.R7$(3),e.JRh((null==i.profileUser?null:i.profileUser.display_name)||(null==i.profileUser?null:i.profileUser.name)||""),e.R7$(2),e.JRh(e.bMT(9,18,t.created_at)),e.R7$(2),e.Y8G("matMenuTriggerFor",n),e.R7$(),e.Y8G("svgIcon","heroicons_solid:ellipsis-vertical"),e.R7$(5),e.Y8G("svgIcon","heroicons_solid:arrow-up-tray"),e.R7$(5),e.Y8G("svgIcon","heroicons_solid:eye-slash"),e.R7$(5),e.Y8G("svgIcon","heroicons_solid:clock"),e.R7$(5),e.Y8G("svgIcon","heroicons_solid:minus-circle"),e.R7$(6),e.Y8G("svgIcon","heroicons_solid:exclamation-triangle"),e.R7$(5),e.Y8G("svgIcon","heroicons_solid:bell"),e.R7$(3),e.Y8G("ngForOf",i.parseContent.parseContent(t.content))("ngForTrackBy",i.trackByFn),e.R7$(3),e.Y8G("svgIcon","heroicons_solid:heart"),e.R7$(4),e.Y8G("svgIcon","heroicons_solid:chat-bubble-left-ellipsis"),e.R7$(4),e.Y8G("svgIcon","heroicons_solid:share"),e.R7$(4),e.Y8G("svgIcon","heroicons_solid:bolt")}}const lt=[{path:"",component:(()=>{class o{constructor(t,n,i,r,s,l,c,p,y,h,E,v,m,$,at,ct){this._changeDetectorRef=t,this._signerService=n,this._storageService=i,this._sanitizer=r,this._route=s,this._router=l,this._socialService=c,this._snackBar=p,this._lightning=y,this._dialog=h,this._angorConfigService=E,this._angorConfirmationService=v,this._eventService=m,this._subscriptionService=$,this._clipboard=at,this.parseContent=ct,this.darkMode=!1,this.isLoading=!0,this.errorMessage=null,this._unsubscribeAll=new R.B,this.allPublicKeys=[],this.isCurrentUserProfile=!1,this.isFollowing=!1,this.showEmojiPicker=!1,this.showCommentEmojiPicker=!1,this.lightningResponse=null,this.lightningInvoice=null,this.paymentInvoice="",this.invoiceAmount="?",this.isLiked=!1,this.isPreview=!1,this.posts=[],this.likes=[],this.currentPage=1,this.loading=!1,this.myLikes=[],this.myLikedNoteIds=[],this.isLoadingPosts=!0,this.noEventsMessage="",this.totalContacts=0,this.followersCount=0,this.followingCount=0,this.aboutExpanded=!0}ngOnInit(){var t=this;return(0,d.A)(function*(){t._angorConfigService.config$.subscribe(n=>{"auto"===n.scheme?t.detectSystemTheme():t.darkMode="dark"===n.scheme}),t._route.paramMap.subscribe(n=>{const i=n.get("pubkey");if(i)t.routePubKey=i;else{t.isCurrentUserProfile=!0;const r=t._signerService.getPublicKey();t.routePubKey=r}t.loadProfileUser(t.routePubKey),t.stats$=t._storageService.getContactStats$(t.routePubKey)}),t.loadInitialPosts(),t.subscribeToNewPosts()})()}loadInitialPosts(){var t=this;return(0,d.A)(function*(){t.loading=!0;try{yield t._storageService.loadPosts(t.currentPage)}catch(n){console.error("Error loading posts:",n)}finally{t.loading=!1}t._changeDetectorRef.detectChanges()})()}subscribeToNewPosts(){this._storageService.posts$.subscribe(t=>{t&&!this.posts.some(n=>n.id===t.id)&&(this.posts.push(t),this.posts.sort((n,i)=>i.created_at-n.created_at),this._changeDetectorRef.detectChanges())})}loadNextPage(){this.loading||(this.currentPage++,this.loadInitialPosts())}toggleAbout(){this.aboutExpanded=!this.aboutExpanded}ngOnDestroy(){this.subscriptionId&&this._subscriptionService.removeSubscriptionById(this.subscriptionId),this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}loadProfileUser(t){var n=this;return(0,d.A)(function*(){if(n.isLoading=!0,n.errorMessage=null,n.profileUser=null,n._changeDetectorRef.detectChanges(),!t)return n.errorMessage="No public key found. Please log in again.",n.isLoading=!1,void n._changeDetectorRef.detectChanges();try{const i=yield n._storageService.getProfile(t);i&&(n.profileUser=i,n._changeDetectorRef.detectChanges()),n.subscribeToUserProfile(t)}catch(i){console.error("Error loading user profile:",i)}})()}subscribeToUserProfile(t){var n=this;this.subscriptionId=this._subscriptionService.addSubscriptions([{authors:[t],kinds:[0],limit:1}],function(){var r=(0,d.A)(function*(s){try{const l=JSON.parse(s.content);n.profileUser=l,n.followersCount=l.followersCount??0,n.followingCount=l.followingCount??0,yield n._storageService.saveProfile(t,l),n._changeDetectorRef.markForCheck()}catch(l){console.error("Error processing metadata event:",l)}});return function(s){return r.apply(this,arguments)}}())}getSafeUrl(t){return this._sanitizer.bypassSecurityTrustUrl(t)}toggleFollow(){var t=this;return(0,d.A)(function*(){try{const n=t._signerService.getPublicKey(),i=t.routePubKey||t.currentUserPubKey;if(!i||!n)return void console.error("Public key missing. Unable to toggle follow.");t.isFollowing?(yield t._socialService.unfollow(i),console.log(`Unfollowed ${i}`)):(yield t._socialService.follow(i),console.log(`Followed ${i}`)),t.isFollowing=!t.isFollowing,t._changeDetectorRef.detectChanges()}catch(n){console.error("Failed to toggle follow:",n)}})()}openSnackBar(t,n="dismiss"){this._snackBar.open(t,n,{duration:1300})}canUseZap(){var t=this;return(0,d.A)(function*(){return!(!t.profileUser||!t.profileUser.lud06&&!t.profileUser.lud16)||(t.openSnackBar("User can't receive zaps"),!1)})()}openZapDialog(t=""){this.canUseZap()&&this._dialog.open(pe,{width:"405px",maxHeight:"90vh",data:{lud16:this.profileUser.lud16,lud06:this.profileUser.lud06,pubkey:this.profileUser.pubkey,eventId:t}})}toggleLike(){this.isLiked=!this.isLiked,this.isLiked&&setTimeout(()=>{this.isLiked=!1,this.isLiked=!0},300)}addEmoji(t){this.eventInput.nativeElement.value+=t.emoji.native,this.showEmojiPicker=!1}toggleEmojiPicker(){this.showCommentEmojiPicker=!1,this.showEmojiPicker=!this.showEmojiPicker}addEmojiTocomment(t){this.commentInput.nativeElement.value+=t.emoji.native,this.showCommentEmojiPicker=!1}detectSystemTheme(){const t=window.matchMedia("(prefers-color-scheme: dark)");this.darkMode=t.matches,t.addEventListener("change",n=>{this.darkMode=n.matches})}togglePreview(){this.isPreview=!this.isPreview}sendEvent(){""!=this.eventInput.nativeElement.value&&this._eventService.sendTextEvent(this.eventInput.nativeElement.value).then(()=>{this._changeDetectorRef.markForCheck()}).catch(t=>{console.error("Failed to send Event:",t)})}copyHex(){this._clipboard.copy(this.routePubKey),this.openSnackBar("hex public key copied","dismiss")}copyNpub(){var t=this._signerService.getNpubFromPubkey(this.routePubKey);this._clipboard.copy(t),this.openSnackBar("npub public key copied","dismiss")}isSingleEmojiOrWord(t){const n=t.trim(),i=/^\w+$/.test(n),r=/^[\p{Emoji}]+$/u.test(n);return i||r}openPost(t){this._router.navigate(["/post",t])}static{this.\u0275fac=function(n){return new(n||o)(e.rXU(e.gRc),e.rXU(S.A),e.rXU(me.n),e.rXU(ge.up),e.rXU(T.nX),e.rXU(T.Ix),e.rXU(fe),e.rXU(N.UG),e.rXU(O),e.rXU(k.bZ),e.rXU(he.P),e.rXU(ve.m),e.rXU(we),e.rXU(je.n),e.rXU(V),e.rXU(Ce.m))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["profile"]],viewQuery:function(n,i){if(1&n&&(e.GBs(Re,5),e.GBs(Se,5)),2&n){let r;e.mGM(r=e.lsd())&&(i.eventInput=r.first),e.mGM(r=e.lsd())&&(i.commentInput=r.first)}},standalone:!0,features:[e.aNF],decls:41,vars:22,consts:[["defaultAvatar",""],["profileMenu","matMenu"],["eventInput",""],["postCardMenu01","matMenu"],["expandableComments","angorCard"],["expandableCard02","angorCard"],["postCardMenu02","matMenu"],[1,"flex","min-w-0","flex-auto","flex-col"],[1,"bg-card","flex","flex-col","shadow"],["onerror","this.onerror=null; this.src='/images/pages/profile/cover.jpg';",1,"h-40","object-cover","lg:h-80",3,"src","alt"],[1,"bg-card","mx-auto","flex","w-full","max-w-5xl","flex-0","flex-col","items-center","px-8","lg:h-18","lg:flex-row"],[1,"-mt-26","flex-shrink-0","rounded-full","lg:-mt-22"],[4,"ngIf","ngIfElse"],[1,"mt-4","flex","flex-grow","flex-col","items-center","lg:ml-8","lg:mt-0","lg:items-start"],[1,"max-w-full","truncate","text-lg","font-bold","leading-tight","lg:max-w-[25rem]",2,"white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"text-secondary","max-w-full","truncate","leading-tight","lg:max-w-[25rem]",2,"white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"mx-8","hidden","h-8","flex-shrink-0","border-l-2","lg:flex"],[1,"flex","flex-shrink-0","items-center","space-x-6","lg:mt-0"],["class","mt-6 flex flex-shrink-0 items-center space-x-6 lg:mt-0",4,"ngIf"],[1,"mb-4","mt-8","flex","flex-shrink-0","items-center","space-x-6","lg:m-0","lg:ml-auto"],[4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"icon-size-5",3,"svgIcon"],["mat-menu-item","",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"my-2"],["mat-menu-item","",3,"routerLink",4,"ngIf"],[1,"mx-auto","w-full","max-w-5xl","p-6","sm:p-8"],[1,"flex","w-full","max-w-140","m-auto","flex-col","items-start"],["class","about-section mb-8 flex flex-col items-start p-6 transition-all duration-300 w-full pb-6 sm:p-8","style","position: relative",3,"ngStyle",4,"ngIf"],["class","mb-8 flex w-full flex-col p-6 pb-6 sm:p-8",4,"ngIf"],["class","mb-8 flex w-full flex-col bg-primary-50 dark:bg-primary-800",4,"ngIf"],[1,"mb-8","flex","w-full","flex-col"],[1,"mt-10","m-auto","flex","justify-center"],["mat-raised-button","","color","primary",3,"click","disabled"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"ring-bg-card","h-32","min-h-32","w-32","min-w-32","max-w-fit","rounded-full","object-cover","ring-4",3,"src","alt"],["src","/images/avatars/avatar-placeholder.png","onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"ring-bg-card","h-32","min-h-32","w-32","min-w-32","rounded-full","object-cover","ring-4",3,"alt"],[1,"mt-6","flex","flex-shrink-0","items-center","space-x-6","lg:mt-0"],[1,"flex","flex-col","items-center"],[1,"font-bold",3,"matTooltip"],[1,"text-secondary","text-sm","font-medium"],[1,"font-bold"],[1,"text-secondary","text-sm","font-medium",3,"matTooltip"],["mat-icon-button","",3,"click","matTooltip"],[3,"svgIcon"],["mat-menu-item","",3,"click"],[1,"flex","items-center"],[1,"mr-3","icon-size-5",3,"svgIcon"],["mat-menu-item","",3,"routerLink"],["mat-menu-item",""],[1,"about-section","mb-8","flex","flex-col","items-start","p-6","transition-all","duration-300","w-full","pb-6","sm:p-8",2,"position","relative",3,"ngStyle"],[1,"mb-2","flex","w-full","items-center","justify-between"],[1,"text-2xl","font-semibold","leading-tight"],["mat-icon-button","","color","primary","aria-label","Toggle about section",2,"position","absolute","top","16px","right","16px",3,"click"],[1,"about-content","text-base","text-gray-700","transition-all","duration-300",3,"ngStyle"],["class","text-gray-500",4,"ngIf"],[1,"text-gray-500"],[1,"mb-8","flex","w-full","flex-col","p-6","pb-6","sm:p-8"],[1,"flex","justify-between"],[1,"text-xl","font-semibold"],[1,"-mr-4","ml-auto",3,"change","color"],[1,"mt-8","flex","flex-col","items-start","sm:flex-row"],[1,"mb-6","flex","items-center","sm:mb-0"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"mr-4","h-12","w-12","min-w-12","rounded-full","object-cover",3,"src","alt"],[1,"sm:hidden"],[1,"w-full",3,"subscriptSizing"],["matInput","","cdkTextareaAutosize","",3,"placeholder","rows"],[1,"-mx-3","mt-6","flex","items-center","justify-between","sm:mt-8"],["mat-button","",1,"mr-1","px-3",3,"click"],[1,"ml-2"],["class","emoji-picker-container-global",4,"ngIf"],["mat-button","",1,"mr-1","hidden","px-3","sm:inline-flex"],["mat-button","",1,"px-3",3,"matMenuTriggerFor"],["mat-menu-item","",1,"sm:hidden"],["mat-button","",1,"mr-1","flex","px-3",3,"click"],[1,"emoji-picker-container-global"],[3,"emojiClick","darkMode"],[1,"mb-8","flex","w-full","flex-col","bg-primary-50","dark:bg-primary-800"],[1,"mx-6","mb-4","mt-6","flex","items-center","sm:mx-8"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"mr-4","h-10","w-10","rounded-full",3,"src","alt"],[1,"flex","flex-col"],[1,"font-semibold","leading-none"],[1,"text-secondary","mt-1","text-sm","leading-none"],["class","inline-block break-words whitespace-pre-wrap",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mx-3","flex","items-center","sm:mx-5"],["mat-button","",1,"mr-1","px-3"],[1,"text-red-500","icon-size-5",3,"svgIcon"],[1,"text-blue-500","icon-size-5",3,"svgIcon"],[1,"text-green-500","icon-size-5",3,"svgIcon"],[1,"text-orange-500","icon-size-5",3,"svgIcon"],[1,"mx-6","mb-6","mt-4","border-b","sm:mx-8"],[1,"mx-6","mb-4","flex","flex-col","sm:mx-8","sm:mb-6","sm:flex-row","sm:items-center"],[1,"ml-3","text-md","tracking-tight"],[1,"hidden","flex-auto","sm:flex"],[1,"mt-4","flex","items-center","sm:mt-0"],["mat-button","",1,"-ml-2","mr-1","px-3","sm:ml-0"],["mat-button","",1,"px-3","sm:-mr-4"],[1,"mr-1"],[1,"inline-block","break-words","whitespace-pre-wrap"],[1,"relative","mb-4","block"],["width","560","height","315","frameborder","0","allowfullscreen","",3,"src"],["alt","Embedded Image",1,"max-h-140","object-cover",2,"width","100%",3,"src"],["controls","",2,"width","100%"],["type","video/mp4",3,"src"],["controls",""],["type","audio/mpeg",3,"src"],[1,"mx-6","mb-6","mt-2","sm:mx-8"],["target","_blank",1,"inline-block","break-words","break-all","text-blue-500","underline",3,"href"],[1,"inline-block","break-words","break-all"],[1,"inline-block","break-words","break-all",3,"ngClass"],["mat-icon-button","",1,"-mr-4","ml-auto",3,"matMenuTriggerFor"],["src","/images/avatars/avatar-placeholder.png","alt","Card cover image",1,"text-card","m-0.5","h-6","w-6","rounded-full","ring-2","ring-white"],["src","/images/avatars/avatar-placeholder.png","alt","Card cover image",1,"text-card","m-0.5","-ml-3","h-6","w-6","rounded-full","ring-2","ring-white"],["mat-button","",1,"px-3","sm:-mr-4",3,"click"]],template:function(n,i){if(1&n){const r=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div"),e.nrm(3,"img",9),e.k0s(),e.j41(4,"div",10)(5,"div",11),e.DNE(6,Pe,2,2,"ng-container",12)(7,Te,1,1,"ng-template",null,0,e.C5r),e.k0s(),e.j41(9,"div",13)(10,"div",14),e.EFF(11),e.k0s(),e.j41(12,"div",15),e.EFF(13),e.k0s()(),e.nrm(14,"div",16),e.j41(15,"div",17),e.DNE(16,Ue,11,4,"div",18),e.nI1(17,"async"),e.nrm(18,"div",16),e.j41(19,"div",19),e.DNE(20,Me,3,2,"div",20),e.j41(21,"div")(22,"button",21),e.nrm(23,"mat-icon",22),e.k0s(),e.j41(24,"mat-menu",null,1),e.DNE(26,Ye,5,2,"button",23)(27,Ae,6,2,"ng-container",24),e.nrm(28,"mat-divider",25),e.DNE(29,Be,5,2,"button",26)(30,De,11,2,"ng-container",20),e.k0s()()()()()(),e.j41(31,"div",27)(32,"div",28),e.DNE(33,Ne,10,11,"angor-card",29)(34,Oe,62,19,"angor-card",30)(35,Je,41,9,"angor-card",31),e.Z7z(36,st,77,20,"angor-card",32,e.Vm6),e.j41(38,"div",33)(39,"button",34),e.bIt("click",function(){return e.eBV(r),e.Njj(i.loadNextPage())}),e.EFF(40),e.k0s()()()()()}if(2&n){const r=e.sdS(8),s=e.sdS(25);e.R7$(3),e.FS9("alt",(null==i.profileUser?null:i.profileUser.display_name)||(null==i.profileUser?null:i.profileUser.name)||"Banner"),e.Y8G("src",(null==i.profileUser?null:i.profileUser.banner)||"/images/pages/profile/cover.jpg",e.B4B),e.R7$(3),e.Y8G("ngIf",null==i.profileUser?null:i.profileUser.picture)("ngIfElse",r),e.R7$(5),e.SpI(" ",(null==i.profileUser?null:i.profileUser.display_name)||(null==i.profileUser?null:i.profileUser.name)||"Unknown User"," "),e.R7$(2),e.SpI(" ",(null==i.profileUser?null:i.profileUser.username)||(null==i.profileUser?null:i.profileUser.name)," "),e.R7$(3),e.Y8G("ngIf",e.bMT(17,19,i.stats$)),e.R7$(4),e.Y8G("ngIf",!i.isCurrentUserProfile),e.R7$(2),e.Y8G("matMenuTriggerFor",s),e.R7$(),e.Y8G("svgIcon","heroicons_solid:ellipsis-vertical"),e.R7$(3),e.Y8G("ngIf",!i.isCurrentUserProfile||i.isCurrentUserProfile),e.R7$(),e.Y8G("ngForOf",e.lJ4(21,Ie)),e.R7$(2),e.Y8G("ngIf",i.isCurrentUserProfile),e.R7$(),e.Y8G("ngIf",!i.isCurrentUserProfile),e.R7$(3),e.Y8G("ngIf",(null==i.profileUser?null:i.profileUser.about)&&""!==i.profileUser.about.trim()),e.R7$(),e.Y8G("ngIf",i.isCurrentUserProfile),e.R7$(),e.Y8G("ngIf",i.isPreview),e.R7$(),e.Dyx(i.posts),e.R7$(3),e.Y8G("disabled",i.loading),e.R7$(),e.SpI(" ",i.loading?"Loading...":"Load More Posts"," ")}},dependencies:[T.Wk,K.n,w.m_,w.An,_.Hl,_.$z,_.iY,C.Cn,C.kk,C.fb,C.Cp,b.RG,b.rl,j.fS,j.fg,D.xb,D.EE,G.w,G.q,P.uc,P.oV,f.YU,f.MD,f.Sq,f.bT,f.B3,f.Jj,g.YN,U.f,W.Ic,q.sG,z.D6,J.e,H.MY,L.vg,ee.g],styles:[".emoji-picker-container-global{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:9999;width:350px;max-width:100%}.heart-beat{animation:heartBeatAnimation .3s ease-in-out}@keyframes heartBeatAnimation{0%{transform:scale(1)}30%{transform:scale(2)}60%{transform:scale(1)}to{transform:scale(1)}}.loading-spinner{display:flex;justify-content:center;align-items:center;margin:20px 0}.loading-spinner .spinner{border:4px solid rgba(0,0,0,.1);border-left-color:#009fb5;border-radius:50%;width:30px;height:30px;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.about-section{overflow:hidden;transition:height .3s ease}.c-img,.c-video{max-width:100%;border-radius:10px}\n"],encapsulation:2,changeDetection:0})}}return o})()}]}}]);