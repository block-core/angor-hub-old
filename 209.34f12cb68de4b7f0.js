(self.webpackChunkangor=self.webpackChunkangor||[]).push([[209],{1146:Ee=>{"use strict";for(var N="qpzry9x8gf2tvdw0s3jn54khce6mua7l",M={},x=0;x<32;x++){var v=N.charAt(x);if(void 0!==M[v])throw new TypeError(v+" is ambiguous");M[v]=x}function y(O){var D=O>>25;return(33554431&O)<<5^996825010&-(1&D)^642813549&-(D>>1&1)^513874426&-(D>>2&1)^1027748829&-(D>>3&1)^705979059&-(D>>4&1)}function k(O){for(var D=1,he=0;he<O.length;++he){var H=O.charCodeAt(he);if(H<33||H>126)return"Invalid prefix ("+O+")";D=y(D)^H>>5}for(D=y(D),he=0;he<O.length;++he){var K=O.charCodeAt(he);D=y(D)^31&K}return D}function T(O,D){if(O.length<8)return O+" too short";if(O.length>(D=D||90))return"Exceeds length limit";var he=O.toLowerCase(),H=O.toUpperCase();if(O!==he&&O!==H)return"Mixed-case string "+O;var K=(O=he).lastIndexOf("1");if(-1===K)return"No separator character for "+O;if(0===K)return"Missing prefix for "+O;var o=O.slice(0,K),ae=O.slice(K+1);if(ae.length<6)return"Data too short";var ke=k(o);if("string"==typeof ke)return ke;for(var je=[],de=0;de<ae.length;++de){var we=ae.charAt(de),se=M[we];if(void 0===se)return"Unknown character "+we;ke=y(ke)^se,!(de+6>=ae.length)&&je.push(se)}return 1!==ke?"Invalid checksum for "+O:{prefix:o,words:je}}function $(O,D,he,H){for(var K=0,o=0,ae=(1<<he)-1,ke=[],je=0;je<O.length;++je)for(K=K<<D|O[je],o+=D;o>=he;)ke.push(K>>(o-=he)&ae);if(H)o>0&&ke.push(K<<he-o&ae);else{if(o>=D)return"Excess padding";if(K<<he-o&ae)return"Non-zero padding"}return ke}Ee.exports={decodeUnsafe:function B(){var O=T.apply(null,arguments);if("object"==typeof O)return O},decode:function U(O){var D=T.apply(null,arguments);if("object"==typeof D)return D;throw new Error(D)},encode:function h(O,D,he){if(O.length+7+D.length>(he=he||90))throw new TypeError("Exceeds length limit");var H=k(O=O.toLowerCase());if("string"==typeof H)throw new Error(H);for(var K=O+"1",o=0;o<D.length;++o){var ae=D[o];if(ae>>5)throw new Error("Non 5-bit word");H=y(H)^ae,K+=N.charAt(ae)}for(o=0;o<6;++o)H=y(H);for(H^=1,o=0;o<6;++o)K+=N.charAt(H>>5*(5-o)&31);return K},toWordsUnsafe:function oe(O){var D=$(O,8,5,!0);if(Array.isArray(D))return D},toWords:function le(O){var D=$(O,8,5,!0);if(Array.isArray(D))return D;throw new Error(D)},fromWordsUnsafe:function te(O){var D=$(O,5,8,!1);if(Array.isArray(D))return D},fromWords:function ne(O){var D=$(O,5,8,!1);if(Array.isArray(D))return D;throw new Error(D)}}},2862:Ee=>{"use strict";var N=Object.prototype.hasOwnProperty,M="~";function x(){}function v(T,B,U){this.fn=T,this.context=B,this.once=U||!1}function y(T,B,U,$,oe){if("function"!=typeof U)throw new TypeError("The listener must be a function");var le=new v(U,$||T,oe),te=M?M+B:B;return T._events[te]?T._events[te].fn?T._events[te]=[T._events[te],le]:T._events[te].push(le):(T._events[te]=le,T._eventsCount++),T}function k(T,B){0==--T._eventsCount?T._events=new x:delete T._events[B]}function h(){this._events=new x,this._eventsCount=0}Object.create&&(x.prototype=Object.create(null),(new x).__proto__||(M=!1)),h.prototype.eventNames=function(){var U,$,B=[];if(0===this._eventsCount)return B;for($ in U=this._events)N.call(U,$)&&B.push(M?$.slice(1):$);return Object.getOwnPropertySymbols?B.concat(Object.getOwnPropertySymbols(U)):B},h.prototype.listeners=function(B){var $=this._events[M?M+B:B];if(!$)return[];if($.fn)return[$.fn];for(var oe=0,le=$.length,te=new Array(le);oe<le;oe++)te[oe]=$[oe].fn;return te},h.prototype.listenerCount=function(B){var $=this._events[M?M+B:B];return $?$.fn?1:$.length:0},h.prototype.emit=function(B,U,$,oe,le,te){var ne=M?M+B:B;if(!this._events[ne])return!1;var he,H,O=this._events[ne],D=arguments.length;if(O.fn){switch(O.once&&this.removeListener(B,O.fn,void 0,!0),D){case 1:return O.fn.call(O.context),!0;case 2:return O.fn.call(O.context,U),!0;case 3:return O.fn.call(O.context,U,$),!0;case 4:return O.fn.call(O.context,U,$,oe),!0;case 5:return O.fn.call(O.context,U,$,oe,le),!0;case 6:return O.fn.call(O.context,U,$,oe,le,te),!0}for(H=1,he=new Array(D-1);H<D;H++)he[H-1]=arguments[H];O.fn.apply(O.context,he)}else{var o,K=O.length;for(H=0;H<K;H++)switch(O[H].once&&this.removeListener(B,O[H].fn,void 0,!0),D){case 1:O[H].fn.call(O[H].context);break;case 2:O[H].fn.call(O[H].context,U);break;case 3:O[H].fn.call(O[H].context,U,$);break;case 4:O[H].fn.call(O[H].context,U,$,oe);break;default:if(!he)for(o=1,he=new Array(D-1);o<D;o++)he[o-1]=arguments[o];O[H].fn.apply(O[H].context,he)}}return!0},h.prototype.on=function(B,U,$){return y(this,B,U,$,!1)},h.prototype.once=function(B,U,$){return y(this,B,U,$,!0)},h.prototype.removeListener=function(B,U,$,oe){var le=M?M+B:B;if(!this._events[le])return this;if(!U)return k(this,le),this;var te=this._events[le];if(te.fn)te.fn===U&&(!oe||te.once)&&(!$||te.context===$)&&k(this,le);else{for(var ne=0,O=[],D=te.length;ne<D;ne++)(te[ne].fn!==U||oe&&!te[ne].once||$&&te[ne].context!==$)&&O.push(te[ne]);O.length?this._events[le]=1===O.length?O[0]:O:k(this,le)}return this},h.prototype.removeAllListeners=function(B){var U;return B?this._events[U=M?M+B:B]&&k(this,U):(this._events=new x,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=M,h.EventEmitter=h,Ee.exports=h},8209:(Ee,N,M)=>{"use strict";M.r(N),M.d(N,{default:()=>kc});var x={};M.r(x),M.d(x,{OG:()=>_r,My:()=>un,Ph:()=>Ct,lX:()=>br,Id:()=>Jt,fg:()=>Ci,qj:()=>xt,aT:()=>fn,lq:()=>Vt,z:()=>ki,Q5:()=>kn});var v=M(467),y=M(5167),k=M(7403),h=M(177),T=M(9417),B=M(8834),U=M(1997),$=M(2102),oe=M(9213),le=M(9042),te=M(9115),ne=M(9183),O=M(450),D=M(4823),he=M(9192),H=M(8865),K=M(3813),o=M(4438),ae=M(2577),ke=M(345);const je=["qrcElement"];let de=(()=>{class t{constructor(e,r){this.renderer=e,this.sanitizer=r,this.allowEmptyString=!1,this.colorDark="#000000ff",this.colorLight="#ffffffff",this.cssClass="qrcode",this.elementType="canvas",this.errorCorrectionLevel="M",this.margin=4,this.qrdata="",this.scale=4,this.width=10,this.qrCodeURL=new o.bkB,this.context=null}ngOnChanges(){var e=this;return(0,v.A)(function*(){yield e.createQRCode()})()}isValidQrCodeText(e){return!1===this.allowEmptyString?!(typeof e>"u"||""===e||"null"===e||null===e):!(typeof e>"u")}toDataURL(e){return new Promise((r,i)=>{(0,ae.dY)(this.qrdata,e,(a,u)=>{a?i(a):r(u)})})}toCanvas(e,r){return new Promise((i,a)=>{(0,ae.mo)(e,this.qrdata,r,u=>{u?a(u):i("success")})})}toSVG(e){return new Promise((r,i)=>{(0,ae.toString)(this.qrdata,e,(a,u)=>{a?i(a):r(u)})})}renderElement(e){for(const r of this.qrcElement.nativeElement.childNodes)this.renderer.removeChild(this.qrcElement.nativeElement,r);this.renderer.appendChild(this.qrcElement.nativeElement,e)}createQRCode(){var e=this;return(0,v.A)(function*(){e.version&&e.version>40?(console.warn("[angularx-qrcode] max value for `version` is 40"),e.version=40):e.version&&e.version<1?(console.warn("[angularx-qrcode]`min value for `version` is 1"),e.version=1):void 0!==e.version&&isNaN(e.version)&&(console.warn("[angularx-qrcode] version should be a number, defaulting to auto."),e.version=void 0);try{if(!e.isValidQrCodeText(e.qrdata))throw new Error("[angularx-qrcode] Field `qrdata` is empty, set 'allowEmptyString=\"true\"' to overwrite this behaviour.");e.isValidQrCodeText(e.qrdata)&&""===e.qrdata&&(e.qrdata=" ");const r={color:{dark:e.colorDark,light:e.colorLight},errorCorrectionLevel:e.errorCorrectionLevel,margin:e.margin,scale:e.scale,version:e.version,width:e.width},i=e.imageSrc,a=e.imageHeight||40,u=e.imageWidth||40;switch(e.elementType){case"canvas":{const f=e.renderer.createElement("canvas");e.context=f.getContext("2d"),e.toCanvas(f,r).then(()=>{if(e.ariaLabel&&e.renderer.setAttribute(f,"aria-label",`${e.ariaLabel}`),e.title&&e.renderer.setAttribute(f,"title",`${e.title}`),i&&e.context){e.centerImage=new Image(u,a),i!==e.centerImage.src&&(e.centerImage.crossOrigin="anonymous",e.centerImage.src=i),a!==e.centerImage.height&&(e.centerImage.height=a),u!==e.centerImage.width&&(e.centerImage.width=u);const g=e.centerImage;g&&(g.onload=()=>{e.context?.drawImage(g,f.width/2-u/2,f.height/2-a/2,u,a)})}e.renderElement(f),e.emitQRCodeURL(f)}).catch(g=>{console.error("[angularx-qrcode] canvas error:",g)});break}case"svg":{const f=e.renderer.createElement("div");e.toSVG(r).then(g=>{e.renderer.setProperty(f,"innerHTML",g);const m=f.firstChild;e.renderer.setAttribute(m,"height",`${e.width}`),e.renderer.setAttribute(m,"width",`${e.width}`),e.renderElement(m),e.emitQRCodeURL(m)}).catch(g=>{console.error("[angularx-qrcode] svg error:",g)});break}default:{const f=e.renderer.createElement("img");e.toDataURL(r).then(g=>{e.alt&&f.setAttribute("alt",e.alt),e.ariaLabel&&f.setAttribute("aria-label",e.ariaLabel),f.setAttribute("src",g),e.title&&f.setAttribute("title",e.title),e.renderElement(f),e.emitQRCodeURL(f)}).catch(g=>{console.error("[angularx-qrcode] img/url error:",g)})}}}catch(r){console.error("[angularx-qrcode] Error generating QR Code:",r.message)}})()}convertBase64ImageUrlToBlob(e){const r=e.split(";base64,"),i=r[0].split(":")[1],a=atob(r[1]),u=new Uint8Array(a.length);for(let f=0;f<a.length;++f)u[f]=a.charCodeAt(f);return new Blob([u],{type:i})}emitQRCodeURL(e){const r=e.constructor.name;if(r===SVGSVGElement.name){const m=new Blob([e.outerHTML],{type:"image/svg+xml"}),S=URL.createObjectURL(m),C=this.sanitizer.bypassSecurityTrustUrl(S);return void this.qrCodeURL.emit(C)}let i="";r===HTMLCanvasElement.name&&(i=e.toDataURL("image/png")),r===HTMLImageElement.name&&(i=e.src);const a=this.convertBase64ImageUrlToBlob(i),u=URL.createObjectURL(a),f=this.sanitizer.bypassSecurityTrustUrl(u);this.qrCodeURL.emit(f)}static#e=this.\u0275fac=function(r){return new(r||t)(o.rXU(o.sFG),o.rXU(ke.up))};static#t=this.\u0275cmp=o.VBU({type:t,selectors:[["qrcode"]],viewQuery:function(r,i){if(1&r&&o.GBs(je,7),2&r){let a;o.mGM(a=o.lsd())&&(i.qrcElement=a.first)}},inputs:{allowEmptyString:"allowEmptyString",colorDark:"colorDark",colorLight:"colorLight",cssClass:"cssClass",elementType:"elementType",errorCorrectionLevel:"errorCorrectionLevel",imageSrc:"imageSrc",imageHeight:"imageHeight",imageWidth:"imageWidth",margin:"margin",qrdata:"qrdata",scale:"scale",version:"version",width:"width",alt:"alt",ariaLabel:"ariaLabel",title:"title"},outputs:{qrCodeURL:"qrCodeURL"},features:[o.OA$],decls:2,vars:2,consts:[["qrcElement",""]],template:function(r,i){1&r&&o.nrm(0,"div",null,0),2&r&&o.HbH(i.cssClass)},encapsulation:2,changeDetection:0})}return t})(),we=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=o.$C({type:t});static#n=this.\u0275inj=o.G2t({})}return t})(),On=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=o.$C({type:t});static#n=this.\u0275inj=o.G2t({})}return t})();var Ge=M(1413),Ve=M(6977),Tt=M(5351),Ye=M(2798),Ke=M(882);function Ze(t,n){this.v=t,this.k=n}function Fn(t){return new Ze(t,0)}function Fe(t){var n,e;function r(a,u){try{var f=t[a](u),g=f.value,m=g instanceof Ze;Promise.resolve(m?g.v:g).then(function(S){if(m){var C="return"===a?"return":"next";if(!g.k||S.done)return r(C,S);S=t[C](S).value}i(f.done?"return":"normal",S)},function(S){r("throw",S)})}catch(S){i("throw",S)}}function i(a,u){switch(a){case"return":n.resolve({value:u,done:!0});break;case"throw":n.reject(u);break;default:n.resolve({value:u,done:!1})}(n=n.next)?r(n.key,n.arg):e=null}this._invoke=function(a,u){return new Promise(function(f,g){var m={key:a,arg:u,resolve:f,reject:g,next:null};e?e=e.next=m:(n=e=m,r(a,u))})},"function"!=typeof t.return&&(this.return=void 0)}function nn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Xe(t,...n){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(n.length>0&&!n.includes(t.length))throw new Error(`Expected Uint8Array of length ${n}, not of length=${t.length}`)}M(2862),Fe.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Fe.prototype.next=function(t){return this._invoke("next",t)},Fe.prototype.throw=function(t){return this._invoke("throw",t)},Fe.prototype.return=function(t){return this._invoke("return",t)};const Pe={number:nn,bool:function it(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)},bytes:Xe,hash:function Dn(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");nn(t.outputLen),nn(t.blockLen)},exists:function ot(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called")},output:function st(t,n){Xe(t);const e=n.outputLen;if(t.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}},ze="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,rn=t=>t instanceof Uint8Array,on=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Le=(t,n)=>t<<32-n|t>>>n;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");const $n=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));function Be(t){if(!rn(t))throw new Error("Uint8Array expected");let n="";for(let e=0;e<t.length;e++)n+=$n[t[e]];return n}function De(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const n=t.length;if(n%2)throw new Error("padded hex string expected, got unpadded hex of length "+n);const e=new Uint8Array(n/2);for(let r=0;r<e.length;r++){const i=2*r,a=t.slice(i,i+2),u=Number.parseInt(a,16);if(Number.isNaN(u)||u<0)throw new Error("Invalid byte sequence");e[r]=u}return e}function Oe(t){if("string"==typeof t&&(t=function Gn(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),!rn(t))throw new Error("expected Uint8Array, got "+typeof t);return t}function $e(...t){const n=new Uint8Array(t.reduce((r,i)=>r+i.length,0));let e=0;return t.forEach(r=>{if(!rn(r))throw new Error("Uint8Array expected");n.set(r,e),e+=r.length}),n}class sn{clone(){return this._cloneInto()}}function an(t){const n=r=>t().update(Oe(r)).digest(),e=t();return n.outputLen=e.outputLen,n.blockLen=e.blockLen,n.create=()=>t(),n}function Wt(t=32){if(ze&&"function"==typeof ze.getRandomValues)return ze.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class bn extends sn{constructor(n,e,r,i){super(),this.blockLen=n,this.outputLen=e,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(n),this.view=on(this.buffer)}update(n){Pe.exists(this);const{view:e,buffer:r,blockLen:i}=this,a=(n=Oe(n)).length;for(let u=0;u<a;){const f=Math.min(i-this.pos,a-u);if(f!==i)r.set(n.subarray(u,u+f),this.pos),this.pos+=f,u+=f,this.pos===i&&(this.process(e,0),this.pos=0);else{const g=on(n);for(;i<=a-u;u+=i)this.process(g,u)}}return this.length+=n.length,this.roundClean(),this}digestInto(n){Pe.exists(this),Pe.output(n,this),this.finished=!0;const{buffer:e,view:r,blockLen:i,isLE:a}=this;let{pos:u}=this;e[u++]=128,this.buffer.subarray(u).fill(0),this.padOffset>i-u&&(this.process(r,0),u=0);for(let C=u;C<i;C++)e[C]=0;(function wn(t,n,e,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(n,e,r);const i=BigInt(32),a=BigInt(4294967295),u=Number(e>>i&a),f=Number(e&a),m=r?0:4;t.setUint32(n+(r?4:0),u,r),t.setUint32(n+m,f,r)})(r,i-8,BigInt(8*this.length),a),this.process(r,0);const f=on(n),g=this.outputLen;if(g%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const m=g/4,S=this.get();if(m>S.length)throw new Error("_sha2: outputLen bigger than state");for(let C=0;C<m;C++)f.setUint32(4*C,S[C],a)}digest(){const{buffer:n,outputLen:e}=this;this.digestInto(n);const r=n.slice(0,e);return this.destroy(),r}_cloneInto(n){n||(n=new this.constructor),n.set(...this.get());const{blockLen:e,buffer:r,length:i,finished:a,destroyed:u,pos:f}=this;return n.length=i,n.pos=f,n.finished=a,n.destroyed=u,i%e&&n.buffer.set(r),n}}const _n=(t,n,e)=>t&n^~t&e,En=(t,n,e)=>t&n^t&e^n&e,xn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ut=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Nt=new Uint32Array(64);class ln extends bn{constructor(){super(64,32,8,!1),this.A=0|Ut[0],this.B=0|Ut[1],this.C=0|Ut[2],this.D=0|Ut[3],this.E=0|Ut[4],this.F=0|Ut[5],this.G=0|Ut[6],this.H=0|Ut[7]}get(){const{A:n,B:e,C:r,D:i,E:a,F:u,G:f,H:g}=this;return[n,e,r,i,a,u,f,g]}set(n,e,r,i,a,u,f,g){this.A=0|n,this.B=0|e,this.C=0|r,this.D=0|i,this.E=0|a,this.F=0|u,this.G=0|f,this.H=0|g}process(n,e){for(let C=0;C<16;C++,e+=4)Nt[C]=n.getUint32(e,!1);for(let C=16;C<64;C++){const F=Nt[C-15],L=Nt[C-2],P=Le(F,7)^Le(F,18)^F>>>3,I=Le(L,17)^Le(L,19)^L>>>10;Nt[C]=I+Nt[C-7]+P+Nt[C-16]|0}let{A:r,B:i,C:a,D:u,E:f,F:g,G:m,H:S}=this;for(let C=0;C<64;C++){const L=S+(Le(f,6)^Le(f,11)^Le(f,25))+_n(f,g,m)+xn[C]+Nt[C]|0,I=(Le(r,2)^Le(r,13)^Le(r,22))+En(r,i,a)|0;S=m,m=g,g=f,f=u+L|0,u=a,a=i,i=r,r=L+I|0}r=r+this.A|0,i=i+this.B|0,a=a+this.C|0,u=u+this.D|0,f=f+this.E|0,g=g+this.F|0,m=m+this.G|0,S=S+this.H|0,this.set(r,i,a,u,f,g,m,S)}roundClean(){Nt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Mn extends ln{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const It=an(()=>new ln),Yn=(an(()=>new Mn),BigInt(0),BigInt(1)),Wo=BigInt(2),Kn=t=>t instanceof Uint8Array,Vo=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));function un(t){if(!Kn(t))throw new Error("Uint8Array expected");let n="";for(let e=0;e<t.length;e++)n+=Vo[t[e]];return n}function Mi(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function fn(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const n=t.length;if(n%2)throw new Error("padded hex string expected, got unpadded hex of length "+n);const e=new Uint8Array(n/2);for(let r=0;r<e.length;r++){const i=2*r,a=t.slice(i,i+2),u=Number.parseInt(a,16);if(Number.isNaN(u)||u<0)throw new Error("Invalid byte sequence");e[r]=u}return e}function Ct(t){return Mi(un(t))}function br(t){if(!Kn(t))throw new Error("Uint8Array expected");return Mi(un(Uint8Array.from(t).reverse()))}function Vt(t,n){return fn(t.toString(16).padStart(2*n,"0"))}function ki(t,n){return Vt(t,n).reverse()}function xt(t,n,e){let r;if("string"==typeof n)try{r=fn(n)}catch(a){throw new Error(`${t} must be valid hex string, got "${n}". Cause: ${a}`)}else{if(!Kn(n))throw new Error(`${t} must be hex string or Uint8Array`);r=Uint8Array.from(n)}const i=r.length;if("number"==typeof e&&i!==e)throw new Error(`${t} expected ${e} bytes, got ${i}`);return r}function Jt(...t){const n=new Uint8Array(t.reduce((r,i)=>r+i.length,0));let e=0;return t.forEach(r=>{if(!Kn(r))throw new Error("Uint8Array expected");n.set(r,e),e+=r.length}),n}const _r=t=>(Wo<<BigInt(t-1))-Yn,Er=t=>new Uint8Array(t),Si=t=>Uint8Array.from(t);function Ci(t,n,e){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof n||n<2)throw new Error("qByteLen must be a number");if("function"!=typeof e)throw new Error("hmacFn must be a function");let r=Er(t),i=Er(t),a=0;const u=()=>{r.fill(1),i.fill(0),a=0},f=(...C)=>e(i,r,...C),g=(C=Er())=>{i=f(Si([0]),C),r=f(),0!==C.length&&(i=f(Si([1]),C),r=f())},m=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let C=0;const F=[];for(;C<n;){r=f();const L=r.slice();F.push(L),C+=r.length}return Jt(...F)};return(C,F)=>{let L;for(u(),g(C);!(L=F(m()));)g();return u(),L}}const Ko={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,n)=>n.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function kn(t,n,e={}){const r=(i,a,u)=>{const f=Ko[a];if("function"!=typeof f)throw new Error(`Invalid validator "${a}", expected function`);const g=t[i];if(!(u&&void 0===g||f(g,t)))throw new Error(`Invalid param ${String(i)}=${g} (${typeof g}), expected ${a}`)};for(const[i,a]of Object.entries(n))r(i,a,!1);for(const[i,a]of Object.entries(e))r(i,a,!0);return t}const bt=BigInt(0),qe=BigInt(1),Yt=BigInt(2),Zo=BigInt(3),xr=BigInt(4),Ai=BigInt(5),Ti=BigInt(8);function _t(t,n){const e=t%n;return e>=bt?e:n+e}function Jo(t,n,e){if(e<=bt||n<bt)throw new Error("Expected power/modulo > 0");if(e===qe)return bt;let r=qe;for(;n>bt;)n&qe&&(r=r*t%e),t=t*t%e,n>>=qe;return r}function Pt(t,n,e){let r=t;for(;n-- >bt;)r*=r,r%=e;return r}function Zn(t,n){if(t===bt||n<=bt)throw new Error(`invert: expected positive integers, got n=${t} mod=${n}`);let e=_t(t,n),r=n,i=bt,a=qe,u=qe,f=bt;for(;e!==bt;){const m=r/e,S=r%e,C=i-u*m,F=a-f*m;r=e,e=S,i=u,a=f,u=C,f=F}if(r!==qe)throw new Error("invert: does not exist");return _t(i,n)}BigInt(9),BigInt(16);const ns=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Mr(t,n){const e=void 0!==n?n:t.toString(2).length;return{nBitLength:e,nByteLength:Math.ceil(e/8)}}const ls=BigInt(0),kr=BigInt(1);function Ii(t){return function rs(t){kn(t,ns.reduce((r,i)=>(r[i]="function",r),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}(t.Fp),kn(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Mr(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const{Ph:fs,aT:hs}=x,en={Err:class extends Error{constructor(n=""){super(n)}},_parseInt(t){const{Err:n}=en;if(t.length<2||2!==t[0])throw new n("Invalid signature integer tag");const e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new n("Invalid signature integer: wrong length");if(128&r[0])throw new n("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new n("Invalid signature integer: unnecessary leading zero");return{d:fs(r),l:t.subarray(e+2)}},toSig(t){const{Err:n}=en,e="string"==typeof t?hs(t):t;if(!(e instanceof Uint8Array))throw new Error("ui8a expected");let r=e.length;if(r<2||48!=e[0])throw new n("Invalid signature tag");if(e[1]!==r-2)throw new n("Invalid signature: incorrect length");const{d:i,l:a}=en._parseInt(e.subarray(2)),{d:u,l:f}=en._parseInt(a);if(f.length)throw new n("Invalid signature: left bytes after parsing");return{r:i,s:u}},hexFromSig(t){const n=m=>8&Number.parseInt(m[0],16)?"00"+m:m,e=m=>{const S=m.toString(16);return 1&S.length?`0${S}`:S},r=n(e(t.s)),i=n(e(t.r)),a=r.length/2,u=i.length/2,f=e(a),g=e(u);return`30${e(u+a+4)}02${g}${i}02${f}${r}`}},jt=BigInt(0),at=BigInt(1),Xn=(BigInt(2),BigInt(3));function ps(t){const n=function gs(t){const n=Ii(t);return kn(n,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...n})}(t),{Fp:e,n:r}=n,i=e.BYTES+1,a=2*e.BYTES+1;function f(z){return _t(z,r)}function g(z){return Zn(z,r)}const{ProjectivePoint:m,normPrivateKeyToScalar:S,weierstrassEquation:C,isWithinCurveOrder:F}=function ds(t){const n=function us(t){const n=Ii(t);kn(n,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:e,Fp:r,a:i}=n;if(e){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof e||"bigint"!=typeof e.beta||"function"!=typeof e.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...n})}(t),{Fp:e}=n,r=n.toBytes||((P,I,j)=>{const q=I.toAffine();return Jt(Uint8Array.from([4]),e.toBytes(q.x),e.toBytes(q.y))}),i=n.fromBytes||(P=>{const I=P.subarray(1);return{x:e.fromBytes(I.subarray(0,e.BYTES)),y:e.fromBytes(I.subarray(e.BYTES,2*e.BYTES))}});function a(P){const{a:I,b:j}=n,q=e.sqr(P),W=e.mul(q,P);return e.add(e.add(W,e.mul(P,I)),j)}if(!e.eql(e.sqr(n.Gy),a(n.Gx)))throw new Error("bad generator point: equation left != right");function u(P){return"bigint"==typeof P&&jt<P&&P<n.n}function f(P){if(!u(P))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function g(P){const{allowedPrivateKeyLengths:I,nByteLength:j,wrapPrivateKey:q,n:W}=n;if(I&&"bigint"!=typeof P){if(P instanceof Uint8Array&&(P=un(P)),"string"!=typeof P||!I.includes(P.length))throw new Error("Invalid key");P=P.padStart(2*j,"0")}let X;try{X="bigint"==typeof P?P:Ct(xt("private key",P,j))}catch{throw new Error(`private key must be ${j} bytes, hex or bigint, not ${typeof P}`)}return q&&(X=_t(X,W)),f(X),X}const m=new Map;function S(P){if(!(P instanceof C))throw new Error("ProjectivePoint expected")}class C{constructor(I,j,q){if(this.px=I,this.py=j,this.pz=q,null==I||!e.isValid(I))throw new Error("x required");if(null==j||!e.isValid(j))throw new Error("y required");if(null==q||!e.isValid(q))throw new Error("z required")}static fromAffine(I){const{x:j,y:q}=I||{};if(!I||!e.isValid(j)||!e.isValid(q))throw new Error("invalid affine point");if(I instanceof C)throw new Error("projective point not allowed");const W=X=>e.eql(X,e.ZERO);return W(j)&&W(q)?C.ZERO:new C(j,q,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(I){const j=e.invertBatch(I.map(q=>q.pz));return I.map((q,W)=>q.toAffine(j[W])).map(C.fromAffine)}static fromHex(I){const j=C.fromAffine(i(xt("pointHex",I)));return j.assertValidity(),j}static fromPrivateKey(I){return C.BASE.multiply(g(I))}_setWindowSize(I){this._WINDOW_SIZE=I,m.delete(this)}assertValidity(){if(this.is0()){if(n.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:I,y:j}=this.toAffine();if(!e.isValid(I)||!e.isValid(j))throw new Error("bad point: x or y not FE");const q=e.sqr(j),W=a(I);if(!e.eql(q,W))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:I}=this.toAffine();if(e.isOdd)return!e.isOdd(I);throw new Error("Field doesn't support isOdd")}equals(I){S(I);const{px:j,py:q,pz:W}=this,{px:X,py:V,pz:ee}=I,G=e.eql(e.mul(j,ee),e.mul(X,W)),Y=e.eql(e.mul(q,ee),e.mul(V,W));return G&&Y}negate(){return new C(this.px,e.neg(this.py),this.pz)}double(){const{a:I,b:j}=n,q=e.mul(j,Xn),{px:W,py:X,pz:V}=this;let ee=e.ZERO,G=e.ZERO,Y=e.ZERO,J=e.mul(W,W),Q=e.mul(X,X),pe=e.mul(V,V),ie=e.mul(W,X);return ie=e.add(ie,ie),Y=e.mul(W,V),Y=e.add(Y,Y),ee=e.mul(I,Y),G=e.mul(q,pe),G=e.add(ee,G),ee=e.sub(Q,G),G=e.add(Q,G),G=e.mul(ee,G),ee=e.mul(ie,ee),Y=e.mul(q,Y),pe=e.mul(I,pe),ie=e.sub(J,pe),ie=e.mul(I,ie),ie=e.add(ie,Y),Y=e.add(J,J),J=e.add(Y,J),J=e.add(J,pe),J=e.mul(J,ie),G=e.add(G,J),pe=e.mul(X,V),pe=e.add(pe,pe),J=e.mul(pe,ie),ee=e.sub(ee,J),Y=e.mul(pe,Q),Y=e.add(Y,Y),Y=e.add(Y,Y),new C(ee,G,Y)}add(I){S(I);const{px:j,py:q,pz:W}=this,{px:X,py:V,pz:ee}=I;let G=e.ZERO,Y=e.ZERO,J=e.ZERO;const Q=n.a,pe=e.mul(n.b,Xn);let ie=e.mul(j,X),ye=e.mul(q,V),_e=e.mul(W,ee),Ce=e.add(j,q),z=e.add(X,V);Ce=e.mul(Ce,z),z=e.add(ie,ye),Ce=e.sub(Ce,z),z=e.add(j,W);let Z=e.add(X,ee);return z=e.mul(z,Z),Z=e.add(ie,_e),z=e.sub(z,Z),Z=e.add(q,W),G=e.add(V,ee),Z=e.mul(Z,G),G=e.add(ye,_e),Z=e.sub(Z,G),J=e.mul(Q,z),G=e.mul(pe,_e),J=e.add(G,J),G=e.sub(ye,J),J=e.add(ye,J),Y=e.mul(G,J),ye=e.add(ie,ie),ye=e.add(ye,ie),_e=e.mul(Q,_e),z=e.mul(pe,z),ye=e.add(ye,_e),_e=e.sub(ie,_e),_e=e.mul(Q,_e),z=e.add(z,_e),ie=e.mul(ye,z),Y=e.add(Y,ie),ie=e.mul(Z,z),G=e.mul(Ce,G),G=e.sub(G,ie),ie=e.mul(Ce,ye),J=e.mul(Z,J),J=e.add(J,ie),new C(G,Y,J)}subtract(I){return this.add(I.negate())}is0(){return this.equals(C.ZERO)}wNAF(I){return L.wNAFCached(this,m,I,j=>{const q=e.invertBatch(j.map(W=>W.pz));return j.map((W,X)=>W.toAffine(q[X])).map(C.fromAffine)})}multiplyUnsafe(I){const j=C.ZERO;if(I===jt)return j;if(f(I),I===at)return this;const{endo:q}=n;if(!q)return L.unsafeLadder(this,I);let{k1neg:W,k1:X,k2neg:V,k2:ee}=q.splitScalar(I),G=j,Y=j,J=this;for(;X>jt||ee>jt;)X&at&&(G=G.add(J)),ee&at&&(Y=Y.add(J)),J=J.double(),X>>=at,ee>>=at;return W&&(G=G.negate()),V&&(Y=Y.negate()),Y=new C(e.mul(Y.px,q.beta),Y.py,Y.pz),G.add(Y)}multiply(I){f(I);let q,W,j=I;const{endo:X}=n;if(X){const{k1neg:V,k1:ee,k2neg:G,k2:Y}=X.splitScalar(j);let{p:J,f:Q}=this.wNAF(ee),{p:pe,f:ie}=this.wNAF(Y);J=L.constTimeNegate(V,J),pe=L.constTimeNegate(G,pe),pe=new C(e.mul(pe.px,X.beta),pe.py,pe.pz),q=J.add(pe),W=Q.add(ie)}else{const{p:V,f:ee}=this.wNAF(j);q=V,W=ee}return C.normalizeZ([q,W])[0]}multiplyAndAddUnsafe(I,j,q){const W=C.BASE,X=(ee,G)=>G!==jt&&G!==at&&ee.equals(W)?ee.multiply(G):ee.multiplyUnsafe(G),V=X(this,j).add(X(I,q));return V.is0()?void 0:V}toAffine(I){const{px:j,py:q,pz:W}=this,X=this.is0();null==I&&(I=X?e.ONE:e.inv(W));const V=e.mul(j,I),ee=e.mul(q,I),G=e.mul(W,I);if(X)return{x:e.ZERO,y:e.ZERO};if(!e.eql(G,e.ONE))throw new Error("invZ was invalid");return{x:V,y:ee}}isTorsionFree(){const{h:I,isTorsionFree:j}=n;if(I===at)return!0;if(j)return j(C,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:I,clearCofactor:j}=n;return I===at?this:j?j(C,this):this.multiplyUnsafe(n.h)}toRawBytes(I=!0){return this.assertValidity(),r(C,this,I)}toHex(I=!0){return un(this.toRawBytes(I))}}C.BASE=new C(n.Gx,n.Gy,e.ONE),C.ZERO=new C(e.ZERO,e.ONE,e.ZERO);const F=n.nBitLength,L=function cs(t,n){const e=(i,a)=>{const u=a.negate();return i?u:a},r=i=>({windows:Math.ceil(n/i)+1,windowSize:2**(i-1)});return{constTimeNegate:e,unsafeLadder(i,a){let u=t.ZERO,f=i;for(;a>ls;)a&kr&&(u=u.add(f)),f=f.double(),a>>=kr;return u},precomputeWindow(i,a){const{windows:u,windowSize:f}=r(a),g=[];let m=i,S=m;for(let C=0;C<u;C++){S=m,g.push(S);for(let F=1;F<f;F++)S=S.add(m),g.push(S);m=S.double()}return g},wNAF(i,a,u){const{windows:f,windowSize:g}=r(i);let m=t.ZERO,S=t.BASE;const C=BigInt(2**i-1),F=2**i,L=BigInt(i);for(let P=0;P<f;P++){const I=P*g;let j=Number(u&C);u>>=L,j>g&&(j-=F,u+=kr);const q=I,W=I+Math.abs(j)-1,V=j<0;0===j?S=S.add(e(P%2!=0,a[q])):m=m.add(e(V,a[W]))}return{p:m,f:S}},wNAFCached(i,a,u,f){const g=i._WINDOW_SIZE||1;let m=a.get(i);return m||(m=this.precomputeWindow(i,g),1!==g&&a.set(i,f(m))),this.wNAF(g,m,u)}}}(C,n.endo?Math.ceil(F/2):F);return{CURVE:n,ProjectivePoint:C,normPrivateKeyToScalar:g,weierstrassEquation:a,isWithinCurveOrder:u}}({...n,toBytes(z,Z,fe){const be=Z.toAffine(),re=e.toBytes(be.x),Me=Jt;return fe?Me(Uint8Array.from([Z.hasEvenY()?2:3]),re):Me(Uint8Array.from([4]),re,e.toBytes(be.y))},fromBytes(z){const Z=z.length,fe=z[0],be=z.subarray(1);if(Z!==i||2!==fe&&3!==fe){if(Z===a&&4===fe)return{x:e.fromBytes(be.subarray(0,e.BYTES)),y:e.fromBytes(be.subarray(e.BYTES,2*e.BYTES))};throw new Error(`Point of length ${Z} was invalid. Expected ${i} compressed bytes or ${a} uncompressed bytes`)}{const re=Ct(be);if(!function u(z){return jt<z&&z<e.ORDER}(re))throw new Error("Point is not on curve");const Me=C(re);let Re=e.sqrt(Me);return!(1&~fe)!=((Re&at)===at)&&(Re=e.neg(Re)),{x:re,y:Re}}}}),L=z=>un(Vt(z,n.nByteLength));function P(z){return z>r>>at}const j=(z,Z,fe)=>Ct(z.slice(Z,fe));class q{constructor(Z,fe,be){this.r=Z,this.s=fe,this.recovery=be,this.assertValidity()}static fromCompact(Z){const fe=n.nByteLength;return Z=xt("compactSignature",Z,2*fe),new q(j(Z,0,fe),j(Z,fe,2*fe))}static fromDER(Z){const{r:fe,s:be}=en.toSig(xt("DER",Z));return new q(fe,be)}assertValidity(){if(!F(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!F(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(Z){return new q(this.r,this.s,Z)}recoverPublicKey(Z){const{r:fe,s:be,recovery:re}=this,Me=Y(xt("msgHash",Z));if(null==re||![0,1,2,3].includes(re))throw new Error("recovery id invalid");const Re=2===re||3===re?fe+n.n:fe;if(Re>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");const Et=m.fromHex((1&re?"03":"02")+L(Re)),kt=g(Re),Bt=f(-Me*kt),Ot=f(be*kt),St=m.BASE.multiplyAndAddUnsafe(Et,Bt,Ot);if(!St)throw new Error("point at infinify");return St.assertValidity(),St}hasHighS(){return P(this.s)}normalizeS(){return this.hasHighS()?new q(this.r,f(-this.s),this.recovery):this}toDERRawBytes(){return fn(this.toDERHex())}toDERHex(){return en.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return fn(this.toCompactHex())}toCompactHex(){return L(this.r)+L(this.s)}}const W={isValidPrivateKey(z){try{return S(z),!0}catch{return!1}},normPrivateKeyToScalar:S,randomPrivateKey:()=>{const Z=function as(t,n,e=!1){const r=(t=xt("privateHash",t)).length,i=Mr(n).nByteLength+8;if(i<24||r<i||r>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${r}`);return _t(e?br(t):Ct(t),n-qe)+qe}(n.randomBytes(e.BYTES+8),r);return Vt(Z,n.nByteLength)},precompute:(z=8,Z=m.BASE)=>(Z._setWindowSize(z),Z.multiply(BigInt(3)),Z)};function V(z){const Z=z instanceof Uint8Array,fe="string"==typeof z,be=(Z||fe)&&z.length;return Z?be===i||be===a:fe?be===2*i||be===2*a:z instanceof m}const G=n.bits2int||function(z){const Z=Ct(z),fe=8*z.length-n.nBitLength;return fe>0?Z>>BigInt(fe):Z},Y=n.bits2int_modN||function(z){return f(G(z))},J=_r(n.nBitLength);function Q(z){if("bigint"!=typeof z)throw new Error("bigint expected");if(!(jt<=z&&z<J))throw new Error(`bigint expected < 2^${n.nBitLength}`);return Vt(z,n.nByteLength)}const ie={lowS:n.lowS,prehash:!1},ye={lowS:n.lowS,prehash:!1};return m.BASE._setWindowSize(8),{CURVE:n,getPublicKey:function X(z,Z=!0){return m.fromPrivateKey(z).toRawBytes(Z)},getSharedSecret:function ee(z,Z,fe=!0){if(V(z))throw new Error("first arg must be private key");if(!V(Z))throw new Error("second arg must be public key");return m.fromHex(Z).multiply(S(z)).toRawBytes(fe)},sign:function _e(z,Z,fe=ie){const{seed:be,k2sig:re}=function pe(z,Z,fe=ie){if(["recovered","canonical"].some(At=>At in fe))throw new Error("sign() legacy options not supported");const{hash:be,randomBytes:re}=n;let{lowS:Me,prehash:Re,extraEntropy:Ie}=fe;null==Me&&(Me=!0),z=xt("msgHash",z),Re&&(z=xt("prehashed msgHash",be(z)));const Et=Y(z),kt=S(Z),Bt=[Q(kt),Q(Et)];if(null!=Ie){const At=!0===Ie?re(e.BYTES):Ie;Bt.push(xt("extraEntropy",At,e.BYTES))}const Ot=Jt(...Bt),St=Et;return{seed:Ot,k2sig:function $t(At){const mn=G(At);if(!F(mn))return;const Go=g(mn),qt=m.BASE.multiply(mn).toAffine(),vn=f(qt.x);if(vn===jt)return;const mr=f(Go*f(St+vn*kt));if(mr===jt)return;let zo=(qt.x===vn?0:2)|Number(qt.y&at),Ho=mr;return Me&&P(mr)&&(Ho=function I(z){return P(z)?f(-z):z}(mr),zo^=1),new q(vn,Ho,zo)}}}(z,Z,fe);return Ci(n.hash.outputLen,n.nByteLength,n.hmac)(be,re)},verify:function Ce(z,Z,fe,be=ye){const re=z;if(Z=xt("msgHash",Z),fe=xt("publicKey",fe),"strict"in be)throw new Error("options.strict was renamed to lowS");const{lowS:Me,prehash:Re}=be;let Ie,Et;try{if("string"==typeof re||re instanceof Uint8Array)try{Ie=q.fromDER(re)}catch(qt){if(!(qt instanceof en.Err))throw qt;Ie=q.fromCompact(re)}else{if("object"!=typeof re||"bigint"!=typeof re.r||"bigint"!=typeof re.s)throw new Error("PARSE");{const{r:qt,s:vn}=re;Ie=new q(qt,vn)}}Et=m.fromHex(fe)}catch(qt){if("PARSE"===qt.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(Me&&Ie.hasHighS())return!1;Re&&(Z=n.hash(Z));const{r:kt,s:Bt}=Ie,Ot=Y(Z),St=g(Bt),$t=f(Ot*St),At=f(kt*St),mn=m.BASE.multiplyAndAddUnsafe(Et,$t,At)?.toAffine();return!!mn&&f(mn.x)===kt},ProjectivePoint:m,Signature:q,utils:W}}BigInt(4);class Ui extends sn{constructor(n,e){super(),this.finished=!1,this.destroyed=!1,Pe.hash(n);const r=Oe(e);if(this.iHash=n.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,a=new Uint8Array(i);a.set(r.length>i?n.create().update(r).digest():r);for(let u=0;u<a.length;u++)a[u]^=54;this.iHash.update(a),this.oHash=n.create();for(let u=0;u<a.length;u++)a[u]^=106;this.oHash.update(a),a.fill(0)}update(n){return Pe.exists(this),this.iHash.update(n),this}digestInto(n){Pe.exists(this),Pe.bytes(n,this.outputLen),this.finished=!0,this.iHash.digestInto(n),this.oHash.update(n),this.oHash.digestInto(n),this.destroy()}digest(){const n=new Uint8Array(this.oHash.outputLen);return this.digestInto(n),n}_cloneInto(n){n||(n=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:i,destroyed:a,blockLen:u,outputLen:f}=this;return n.finished=i,n.destroyed=a,n.blockLen=u,n.outputLen=f,n.oHash=e._cloneInto(n.oHash),n.iHash=r._cloneInto(n.iHash),n}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hn=(t,n,e)=>new Ui(t,n).update(e).digest();function Es(t){return{hash:t,hmac:(n,...e)=>hn(t,n,$e(...e)),randomBytes:Wt}}hn.create=(t,n)=>new Ui(t,n);const Qn=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Jn=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Ni=BigInt(1),er=BigInt(2),Pi=(t,n)=>(t+n/er)/n;function Li(t){const n=Qn,e=BigInt(3),r=BigInt(6),i=BigInt(11),a=BigInt(22),u=BigInt(23),f=BigInt(44),g=BigInt(88),m=t*t*t%n,S=m*m*t%n,C=Pt(S,e,n)*S%n,F=Pt(C,e,n)*S%n,L=Pt(F,er,n)*m%n,P=Pt(L,i,n)*L%n,I=Pt(P,a,n)*P%n,j=Pt(I,f,n)*I%n,q=Pt(j,g,n)*j%n,W=Pt(q,f,n)*I%n,X=Pt(W,e,n)*S%n,V=Pt(X,u,n)*P%n,ee=Pt(V,r,n)*m%n,G=Pt(ee,er,n);if(!Cr.eql(Cr.sqr(G),t))throw new Error("Cannot find square root");return G}const Cr=function ss(t,n,e=!1,r={}){if(t<=bt)throw new Error(`Expected Fp ORDER > 0, got ${t}`);const{nBitLength:i,nByteLength:a}=Mr(t,n);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");const u=function ts(t){if(t%xr===Zo){const n=(t+qe)/xr;return function(r,i){const a=r.pow(i,n);if(!r.eql(r.sqr(a),i))throw new Error("Cannot find square root");return a}}if(t%Ti===Ai){const n=(t-Ai)/Ti;return function(r,i){const a=r.mul(i,Yt),u=r.pow(a,n),f=r.mul(i,u),g=r.mul(r.mul(f,Yt),u),m=r.mul(f,r.sub(g,r.ONE));if(!r.eql(r.sqr(m),i))throw new Error("Cannot find square root");return m}}return function es(t){const n=(t-qe)/Yt;let e,r,i;for(e=t-qe,r=0;e%Yt===bt;e/=Yt,r++);for(i=Yt;i<t&&Jo(i,n,t)!==t-qe;i++);if(1===r){const u=(t+qe)/xr;return function(g,m){const S=g.pow(m,u);if(!g.eql(g.sqr(S),m))throw new Error("Cannot find square root");return S}}const a=(e+qe)/Yt;return function(f,g){if(f.pow(g,n)===f.neg(f.ONE))throw new Error("Cannot find square root");let m=r,S=f.pow(f.mul(f.ONE,i),e),C=f.pow(g,a),F=f.pow(g,e);for(;!f.eql(F,f.ONE);){if(f.eql(F,f.ZERO))return f.ZERO;let L=1;for(let I=f.sqr(F);L<m&&!f.eql(I,f.ONE);L++)I=f.sqr(I);const P=f.pow(S,qe<<BigInt(m-L-1));S=f.sqr(P),C=f.mul(C,P),F=f.mul(F,S),m=L}return C}}(t)}(t),f=Object.freeze({ORDER:t,BITS:i,BYTES:a,MASK:_r(i),ZERO:bt,ONE:qe,create:g=>_t(g,t),isValid:g=>{if("bigint"!=typeof g)throw new Error("Invalid field element: expected bigint, got "+typeof g);return bt<=g&&g<t},is0:g=>g===bt,isOdd:g=>(g&qe)===qe,neg:g=>_t(-g,t),eql:(g,m)=>g===m,sqr:g=>_t(g*g,t),add:(g,m)=>_t(g+m,t),sub:(g,m)=>_t(g-m,t),mul:(g,m)=>_t(g*m,t),pow:(g,m)=>function is(t,n,e){if(e<bt)throw new Error("Expected power > 0");if(e===bt)return t.ONE;if(e===qe)return n;let r=t.ONE,i=n;for(;e>bt;)e&qe&&(r=t.mul(r,i)),i=t.sqr(i),e>>=qe;return r}(f,g,m),div:(g,m)=>_t(g*Zn(m,t),t),sqrN:g=>g*g,addN:(g,m)=>g+m,subN:(g,m)=>g-m,mulN:(g,m)=>g*m,inv:g=>Zn(g,t),sqrt:r.sqrt||(g=>u(f,g)),invertBatch:g=>function os(t,n){const e=new Array(n.length),r=n.reduce((a,u,f)=>t.is0(u)?a:(e[f]=a,t.mul(a,u)),t.ONE),i=t.inv(r);return n.reduceRight((a,u,f)=>t.is0(u)?a:(e[f]=t.mul(a,e[f]),t.mul(a,u)),i),e}(f,g),cmov:(g,m,S)=>S?m:g,toBytes:g=>e?ki(g,a):Vt(g,a),fromBytes:g=>{if(g.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${g.length}`);return e?br(g):Ct(g)}});return Object.freeze(f)}(Qn,void 0,void 0,{sqrt:Li}),dn=function xs(t,n){const e=r=>ps({...t,...Es(r)});return Object.freeze({...e(n),create:e})}({a:BigInt(0),b:BigInt(7),Fp:Cr,n:Jn,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const n=Jn,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Ni*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=e,u=BigInt("0x100000000000000000000000000000000"),f=Pi(a*t,n),g=Pi(-r*t,n);let m=_t(t-f*e-g*i,n),S=_t(-f*r-g*a,n);const C=m>u,F=S>u;if(C&&(m=n-m),F&&(S=n-S),m>u||S>u)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:C,k1:m,k2neg:F,k2:S}}}},It),tr=BigInt(0),Oi=t=>"bigint"==typeof t&&tr<t&&t<Qn,ji={};function nr(t,...n){let e=ji[t];if(void 0===e){const r=It(Uint8Array.from(t,i=>i.charCodeAt(0)));e=Jt(r,r),ji[t]=e}return It(Jt(e,...n))}const Ar=t=>t.toRawBytes(!0).slice(1),Tr=t=>Vt(t,32),Ir=t=>_t(t,Qn),Cn=t=>_t(t,Jn),Rr=dn.ProjectivePoint;function Br(t){let n=dn.utils.normPrivateKeyToScalar(t),e=Rr.fromPrivateKey(n);return{scalar:e.hasEvenY()?n:Cn(-n),bytes:Ar(e)}}function Fi(t){if(!Oi(t))throw new Error("bad x: need 0 < x < p");const n=Ir(t*t);let r=Li(Ir(n*t+BigInt(7)));r%er!==tr&&(r=Ir(-r));const i=new Rr(t,r,Ni);return i.assertValidity(),i}function Di(...t){return Cn(Ct(nr("BIP0340/challenge",...t)))}function $i(t,n,e){const r=xt("signature",t,64),i=xt("message",n),a=xt("publicKey",e,32);try{const u=Fi(Ct(a)),f=Ct(r.subarray(0,32));if(!Oi(f))return!1;const g=Ct(r.subarray(32,64));if(!(t=>"bigint"==typeof t&&tr<t&&t<Jn)(g))return!1;const m=Di(Tr(f),Ar(u),i),S=((t,n,e)=>Rr.BASE.multiplyAndAddUnsafe(t,n,e))(u,g,Cn(-m));return!(!S||!S.hasEvenY()||S.toAffine().x!==f)}catch{return!1}}const gn={getPublicKey:function Ss(t){return Br(t).bytes},sign:function Cs(t,n,e=Wt(32)){const r=xt("message",t),{bytes:i,scalar:a}=Br(n),u=xt("auxRand",e,32),f=Tr(a^Ct(nr("BIP0340/aux",u))),g=nr("BIP0340/nonce",f,i,r),m=Cn(Ct(g));if(m===tr)throw new Error("sign failed: k is zero");const{bytes:S,scalar:C}=Br(m),F=Di(S,i,r),L=new Uint8Array(64);if(L.set(S,0),L.set(Tr(Cn(C+F*a)),32),!$i(L,r,i))throw new Error("sign: Invalid signature produced");return L},verify:$i,utils:{randomPrivateKey:dn.utils.randomPrivateKey,lift_x:Fi,pointToBytes:Ar,numberToBytesBE:Vt,bytesToNumberBE:Ct,taggedHash:nr,mod:_t}};var qi=M(5693),Ur=M(9673),As=M(9608);const Ft=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function Lr(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function Or(t){if("string"==typeof t&&(t=Lr(t)),!(t=>t instanceof Uint8Array)(t))throw new Error("expected Uint8Array, got "+typeof t);return t}function jr(t,n){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");if("number"==typeof n&&t.length!==n)throw new Error(`Uint8Array length ${n} expected`)}function Fr(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Gi(t,...n){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(n.length>0&&!n.includes(t.length))throw new Error(`Expected Uint8Array of length ${n}, not of length=${t.length}`)}const Rt={number:Fr,bool:function Ns(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)},bytes:Gi,hash:function Ps(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("hash must be wrapped by utils.wrapConstructor");Fr(t.outputLen),Fr(t.blockLen)},exists:function Ls(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called")},output:function Os(t,n){Gi(t);const e=n.outputLen;if(t.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}},Mt=(t,n)=>255&t[n++]|(255&t[n++])<<8;class js{constructor(n){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,jr(n=Or(n),32);const e=Mt(n,0),r=Mt(n,2),i=Mt(n,4),a=Mt(n,6),u=Mt(n,8),f=Mt(n,10),g=Mt(n,12),m=Mt(n,14);this.r[0]=8191&e,this.r[1]=8191&(e>>>13|r<<3),this.r[2]=7939&(r>>>10|i<<6),this.r[3]=8191&(i>>>7|a<<9),this.r[4]=255&(a>>>4|u<<12),this.r[5]=u>>>1&8190,this.r[6]=8191&(u>>>14|f<<2),this.r[7]=8065&(f>>>11|g<<5),this.r[8]=8191&(g>>>8|m<<8),this.r[9]=m>>>5&127;for(let S=0;S<8;S++)this.pad[S]=Mt(n,16+2*S)}process(n,e,r=!1){const i=r?0:2048,{h:a,r:u}=this,f=u[0],g=u[1],m=u[2],S=u[3],C=u[4],F=u[5],L=u[6],P=u[7],I=u[8],j=u[9],q=Mt(n,e+0),W=Mt(n,e+2),X=Mt(n,e+4),V=Mt(n,e+6),ee=Mt(n,e+8),G=Mt(n,e+10),Y=Mt(n,e+12),J=Mt(n,e+14);let Q=a[0]+(8191&q),pe=a[1]+(8191&(q>>>13|W<<3)),ie=a[2]+(8191&(W>>>10|X<<6)),ye=a[3]+(8191&(X>>>7|V<<9)),_e=a[4]+(8191&(V>>>4|ee<<12)),Ce=a[5]+(ee>>>1&8191),z=a[6]+(8191&(ee>>>14|G<<2)),Z=a[7]+(8191&(G>>>11|Y<<5)),fe=a[8]+(8191&(Y>>>8|J<<8)),be=a[9]+(J>>>5|i),re=0,Me=re+Q*f+pe*(5*j)+ie*(5*I)+ye*(5*P)+_e*(5*L);re=Me>>>13,Me&=8191,Me+=Ce*(5*F)+z*(5*C)+Z*(5*S)+fe*(5*m)+be*(5*g),re+=Me>>>13,Me&=8191;let Re=re+Q*g+pe*f+ie*(5*j)+ye*(5*I)+_e*(5*P);re=Re>>>13,Re&=8191,Re+=Ce*(5*L)+z*(5*F)+Z*(5*C)+fe*(5*S)+be*(5*m),re+=Re>>>13,Re&=8191;let Ie=re+Q*m+pe*g+ie*f+ye*(5*j)+_e*(5*I);re=Ie>>>13,Ie&=8191,Ie+=Ce*(5*P)+z*(5*L)+Z*(5*F)+fe*(5*C)+be*(5*S),re+=Ie>>>13,Ie&=8191;let Et=re+Q*S+pe*m+ie*g+ye*f+_e*(5*j);re=Et>>>13,Et&=8191,Et+=Ce*(5*I)+z*(5*P)+Z*(5*L)+fe*(5*F)+be*(5*C),re+=Et>>>13,Et&=8191;let kt=re+Q*C+pe*S+ie*m+ye*g+_e*f;re=kt>>>13,kt&=8191,kt+=Ce*(5*j)+z*(5*I)+Z*(5*P)+fe*(5*L)+be*(5*F),re+=kt>>>13,kt&=8191;let Bt=re+Q*F+pe*C+ie*S+ye*m+_e*g;re=Bt>>>13,Bt&=8191,Bt+=Ce*f+z*(5*j)+Z*(5*I)+fe*(5*P)+be*(5*L),re+=Bt>>>13,Bt&=8191;let Ot=re+Q*L+pe*F+ie*C+ye*S+_e*m;re=Ot>>>13,Ot&=8191,Ot+=Ce*g+z*f+Z*(5*j)+fe*(5*I)+be*(5*P),re+=Ot>>>13,Ot&=8191;let St=re+Q*P+pe*L+ie*F+ye*C+_e*S;re=St>>>13,St&=8191,St+=Ce*m+z*g+Z*f+fe*(5*j)+be*(5*I),re+=St>>>13,St&=8191;let $t=re+Q*I+pe*P+ie*L+ye*F+_e*C;re=$t>>>13,$t&=8191,$t+=Ce*S+z*m+Z*g+fe*f+be*(5*j),re+=$t>>>13,$t&=8191;let At=re+Q*j+pe*I+ie*P+ye*L+_e*F;re=At>>>13,At&=8191,At+=Ce*C+z*S+Z*m+fe*g+be*f,re+=At>>>13,At&=8191,re=(re<<2)+re|0,re=re+Me|0,Me=8191&re,re>>>=13,Re+=re,a[0]=Me,a[1]=Re,a[2]=Ie,a[3]=Et,a[4]=kt,a[5]=Bt,a[6]=Ot,a[7]=St,a[8]=$t,a[9]=At}finalize(){const{h:n,pad:e}=this,r=new Uint16Array(10);let i=n[1]>>>13;n[1]&=8191;for(let f=2;f<10;f++)n[f]+=i,i=n[f]>>>13,n[f]&=8191;n[0]+=5*i,i=n[0]>>>13,n[0]&=8191,n[1]+=i,i=n[1]>>>13,n[1]&=8191,n[2]+=i,r[0]=n[0]+5,i=r[0]>>>13,r[0]&=8191;for(let f=1;f<10;f++)r[f]=n[f]+i,i=r[f]>>>13,r[f]&=8191;r[9]-=8192;let a=(1^i)-1;for(let f=0;f<10;f++)r[f]&=a;a=~a;for(let f=0;f<10;f++)n[f]=n[f]&a|r[f];n[0]=65535&(n[0]|n[1]<<13),n[1]=65535&(n[1]>>>3|n[2]<<10),n[2]=65535&(n[2]>>>6|n[3]<<7),n[3]=65535&(n[3]>>>9|n[4]<<4),n[4]=65535&(n[4]>>>12|n[5]<<1|n[6]<<14),n[5]=65535&(n[6]>>>2|n[7]<<11),n[6]=65535&(n[7]>>>5|n[8]<<8),n[7]=65535&(n[8]>>>8|n[9]<<5);let u=n[0]+e[0];n[0]=65535&u;for(let f=1;f<8;f++)u=(n[f]+e[f]|0)+(u>>>16)|0,n[f]=65535&u}update(n){Rt.exists(this);const{buffer:e,blockLen:r}=this,i=(n=Or(n)).length;for(let a=0;a<i;){const u=Math.min(r-this.pos,i-a);if(u!==r)e.set(n.subarray(a,a+u),this.pos),this.pos+=u,a+=u,this.pos===r&&(this.process(e,0,!1),this.pos=0);else for(;r<=i-a;a+=r)this.process(n,a)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(n){Rt.exists(this),Rt.output(n,this),this.finished=!0;const{buffer:e,h:r}=this;let{pos:i}=this;if(i){for(e[i++]=1;i<16;i++)e[i]=0;this.process(e,0,!0)}this.finalize();let a=0;for(let u=0;u<8;u++)n[a++]=r[u]>>>0,n[a++]=r[u]>>>8;return n}digest(){const{buffer:n,outputLen:e}=this;this.digestInto(n);const r=n.slice(0,e);return this.destroy(),r}}!function Fs(t){const n=(r,i)=>t(i).update(Or(r)).digest(),e=t(new Uint8Array(32));n.outputLen=e.outputLen,n.blockLen=e.blockLen,n.create=r=>t(r)}(t=>new js(t));const Ds=Lr("expand 16-byte k"),$s=Lr("expand 32-byte k"),qs=Ft(Ds),Gs=Ft($s),zi=t=>!(t.byteOffset%4),ge=(t,n)=>t<<n|t>>>32-n;const Hi=(t=>{const{core:n,rounds:e,counterRight:r,counterLen:i,allow128bitKeys:a,extendNonceFn:u,blockLen:f}=function Bs(t,n){if(void 0!==n&&("object"!=typeof n||!(t=>"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object)(n)))throw new Error("options must be object or undefined");return Object.assign(t,n)}({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},t);Rt.number(i),Rt.number(e),Rt.number(f),Rt.bool(r),Rt.bool(a);const g=f/4;if(f%4!=0)throw new Error("Salsa/ChaCha: blockLen must be aligned to 4 bytes");return(m,S,C,F,L=0)=>{if(Rt.bytes(m),Rt.bytes(S),Rt.bytes(C),F||(F=new Uint8Array(C.length)),Rt.bytes(F),Rt.number(L),L<0||L>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(F.length<C.length)throw new Error(`Salsa/ChaCha: output (${F.length}) is shorter than data (${C.length})`);const P=[];let I,j;if(32===m.length)I=m,j=Gs;else{if(16!==m.length||!a)throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${m.length}`);I=new Uint8Array(32),I.set(m),I.set(m,16),j=qs,P.push(I)}if(u){if(S.length<=16)throw new Error("Salsa/ChaCha: extended nonce must be bigger than 16 bytes");I=u(j,I,S.subarray(0,16),new Uint8Array(32)),P.push(I),S=S.subarray(16)}const q=16-i;if(S.length!==q)throw new Error(`Salsa/ChaCha: nonce must be ${q} or 16 bytes`);if(12!==q){const Q=new Uint8Array(12);Q.set(S,r?0:12-S.length),P.push(S=Q)}const W=new Uint8Array(f),X=Ft(W),V=Ft(I),ee=Ft(S),G=zi(C)&&Ft(C),Y=zi(F)&&Ft(F);P.push(X);const J=C.length;for(let Q=0,pe=L;Q<J;pe++){if(n(j,V,ee,X,pe,e),pe>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");const ie=Math.min(f,J-Q);if(ie===f&&Y&&G){const ye=Q/4;if(Q%4!=0)throw new Error("Salsa/ChaCha: invalid block position");for(let _e=0;_e<g;_e++)Y[ye+_e]=G[ye+_e]^X[_e];Q+=f}else{for(let ye=0;ye<ie;ye++)F[Q+ye]=C[Q+ye]^W[ye];Q+=ie}}for(let Q=0;Q<P.length;Q++)P[Q].fill(0);return F}})({core:function Tn(t,n,e,r,i,a=20){let u=t[0],f=t[1],g=t[2],m=t[3],S=n[0],C=n[1],F=n[2],L=n[3],P=n[4],I=n[5],j=n[6],q=n[7],W=i,X=e[0],V=e[1],ee=e[2],G=u,Y=f,J=g,Q=m,pe=S,ie=C,ye=F,_e=L,Ce=P,z=I,Z=j,fe=q,be=W,re=X,Me=V,Re=ee;for(let Et=0;Et<a;Et+=2)G=G+pe|0,be=ge(be^G,16),Ce=Ce+be|0,pe=ge(pe^Ce,12),G=G+pe|0,be=ge(be^G,8),Ce=Ce+be|0,pe=ge(pe^Ce,7),Y=Y+ie|0,re=ge(re^Y,16),z=z+re|0,ie=ge(ie^z,12),Y=Y+ie|0,re=ge(re^Y,8),z=z+re|0,ie=ge(ie^z,7),J=J+ye|0,Me=ge(Me^J,16),Z=Z+Me|0,ye=ge(ye^Z,12),J=J+ye|0,Me=ge(Me^J,8),Z=Z+Me|0,ye=ge(ye^Z,7),Q=Q+_e|0,Re=ge(Re^Q,16),fe=fe+Re|0,_e=ge(_e^fe,12),Q=Q+_e|0,Re=ge(Re^Q,8),fe=fe+Re|0,_e=ge(_e^fe,7),G=G+ie|0,Re=ge(Re^G,16),Z=Z+Re|0,ie=ge(ie^Z,12),G=G+ie|0,Re=ge(Re^G,8),Z=Z+Re|0,ie=ge(ie^Z,7),Y=Y+ye|0,be=ge(be^Y,16),fe=fe+be|0,ye=ge(ye^fe,12),Y=Y+ye|0,be=ge(be^Y,8),fe=fe+be|0,ye=ge(ye^fe,7),J=J+_e|0,re=ge(re^J,16),Ce=Ce+re|0,_e=ge(_e^Ce,12),J=J+_e|0,re=ge(re^J,8),Ce=Ce+re|0,_e=ge(_e^Ce,7),Q=Q+pe|0,Me=ge(Me^Q,16),z=z+Me|0,pe=ge(pe^z,12),Q=Q+pe|0,Me=ge(Me^Q,8),z=z+Me|0,pe=ge(pe^z,7);let Ie=0;r[Ie++]=u+G|0,r[Ie++]=f+Y|0,r[Ie++]=g+J|0,r[Ie++]=m+Q|0,r[Ie++]=S+pe|0,r[Ie++]=C+ie|0,r[Ie++]=F+ye|0,r[Ie++]=L+_e|0,r[Ie++]=P+Ce|0,r[Ie++]=I+z|0,r[Ie++]=j+Z|0,r[Ie++]=q+fe|0,r[Ie++]=W+be|0,r[Ie++]=X+re|0,r[Ie++]=V+Me|0,r[Ie++]=ee+Re|0},counterRight:!1,counterLen:4,allow128bitKeys:!1}),Dr=new Uint8Array([0]),Yi=new Uint8Array;var Ks=Object.defineProperty,yt=(t,n)=>{for(var e in n)Ks(t,e,{get:n[e],enumerable:!0})};function Ki(){return Be(gn.utils.randomPrivateKey())}function $r(t){return Be(gn.getPublicKey(t))}yt({},{MessageNode:()=>Zi,MessageQueue:()=>Xi,insertEventIntoAscendingList:()=>Qs,insertEventIntoDescendingList:()=>Xs,normalizeURL:()=>qr,utf8Decoder:()=>Dt,utf8Encoder:()=>Lt});var Dt=new TextDecoder("utf-8"),Lt=new TextEncoder;function qr(t){let n=new URL(t);return n.pathname=n.pathname.replace(/\/+/g,"/"),n.pathname.endsWith("/")&&(n.pathname=n.pathname.slice(0,-1)),("80"===n.port&&"ws:"===n.protocol||"443"===n.port&&"wss:"===n.protocol)&&(n.port=""),n.searchParams.sort(),n.hash="",n.toString()}function Xs(t,n){let i,e=0,r=t.length-1,a=e;if(r<0)a=0;else if(n.created_at<t[r].created_at)a=r+1;else if(n.created_at>=t[e].created_at)a=e;else for(;;){if(r<=e+1){a=r;break}if(i=Math.floor(e+(r-e)/2),t[i].created_at>n.created_at)e=i;else{if(!(t[i].created_at<n.created_at)){a=i;break}r=i}}return t[a]?.id!==n.id?[...t.slice(0,a),n,...t.slice(a)]:t}function Qs(t,n){let i,e=0,r=t.length-1,a=e;if(r<0)a=0;else if(n.created_at>t[r].created_at)a=r+1;else if(n.created_at<=t[e].created_at)a=e;else for(;;){if(r<=e+1){a=r;break}if(i=Math.floor(e+(r-e)/2),t[i].created_at<n.created_at)e=i;else{if(!(t[i].created_at>n.created_at)){a=i;break}r=i}}return t[a]?.id!==n.id?[...t.slice(0,a),n,...t.slice(a)]:t}var Zi=class{_value;_next;get value(){return this._value}set value(t){this._value=t}get next(){return this._next}set next(t){this._next=t}constructor(t){this._value=t,this._next=null}},Xi=class{_first;_last;get first(){return this._first}set first(t){this._first=t}get last(){return this._last}set last(t){this._last=t}_size;get size(){return this._size}set size(t){this._size=t}constructor(){this._first=null,this._last=null,this._size=0}enqueue(t){const n=new Zi(t);return 0!==this._size&&this._last?(this._last.next=n,this._last=n):(this._first=n,this._last=n),this._size++,!0}dequeue(){if(0===this._size||!this._first)return null;let t=this._first;return this._first=t.next,t.next=null,this._size--,t.value}},pn=Symbol("verified");function Gt(t,n){const e=t;return e.pubkey=$r(n),e.id=In(e),e.sig=function Qi(t,n){return Be(gn.sign(In(t),n))}(e,n),e[pn]=!0,e}function In(t){let n=It(Lt.encode(function ta(t){if(!Gr(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}(t)));return Be(n)}var na=t=>t instanceof Object;function Gr(t){if(!na(t)||"number"!=typeof t.kind||"string"!=typeof t.content||"number"!=typeof t.created_at||"string"!=typeof t.pubkey||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let n=0;n<t.tags.length;n++){let e=t.tags[n];if(!Array.isArray(e))return!1;for(let r=0;r<e.length;r++)if("object"==typeof e[r])return!1}return!0}function rr(t){if("boolean"==typeof t[pn])return t[pn];const n=In(t);if(n!==t.id)return t[pn]=!1;try{return t[pn]=gn.verify(t.sig,n,t.pubkey)}catch{return t[pn]=!1}}function ra(t,n){if(t.ids&&-1===t.ids.indexOf(n.id)&&!t.ids.some(e=>n.id.startsWith(e))||t.kinds&&-1===t.kinds.indexOf(n.kind)||t.authors&&-1===t.authors.indexOf(n.pubkey)&&!t.authors.some(e=>n.pubkey.startsWith(e)))return!1;for(let e in t)if("#"===e[0]){let i=t[`#${e.slice(1)}`];if(i&&!n.tags.find(([a,u])=>a===e.slice(1)&&-1!==i.indexOf(u)))return!1}return!(t.since&&n.created_at<t.since||t.until&&n.created_at>t.until)}function ir(t,n){let e=n.length+3,r=t.indexOf(`"${n}":`)+e,i=t.slice(r).indexOf('"')+r+1;return t.slice(i,i+64)}function eo(t,n){let e=n.length,r=t.indexOf(`"${n}":`)+e+3,i=t.slice(r),a=Math.min(i.indexOf(","),i.indexOf("}"));return parseInt(i.slice(0,a),10)}function to(t){let n=t.slice(0,22).indexOf('"EVENT"');if(-1===n)return null;let e=t.slice(n+7+1).indexOf('"');if(-1===e)return null;let r=n+7+1+e,i=t.slice(r+1,80).indexOf('"');return-1===i?null:t.slice(r+1,r+1+i)}function sa(t,n){return n===ir(t,"id")}function aa(t,n){return n===ir(t,"pubkey")}function la(t,n){return n===eo(t,"kind")}function ro(t,n={}){let{listTimeout:e=3e3,getTimeout:r=3e3,countTimeout:i=3e3}=n;var a,S,u={},f={connect:[],disconnect:[],error:[],notice:[],auth:[]},g={},m={};function F(){return(F=(0,v.A)(function*(){return S||(S=new Promise((V,ee)=>{try{a=new WebSocket(t)}catch(Q){ee(Q)}a.onopen=()=>{f.connect.forEach(Q=>Q()),V()},a.onerror=()=>{S=void 0,f.error.forEach(Q=>Q()),ee()},a.onclose=(0,v.A)(function*(){S=void 0,f.disconnect.forEach(Q=>Q())});let Y,G=new Xi;function J(){if(0===G.size)return clearInterval(Y),void(Y=null);var Q=G.dequeue();if(!Q)return;let pe=to(Q);if(pe){let ie=u[pe];if(ie&&ie.alreadyHaveEvent&&ie.alreadyHaveEvent(ir(Q,"id"),t))return}try{let ie=JSON.parse(Q);switch(ie[0]){case"EVENT":{let z=ie[1],Z=ie[2];return void(Gr(Z)&&u[z]&&(u[z].skipVerification||rr(Z))&&function Ji(t,n){for(let e=0;e<t.length;e++)if(ra(t[e],n))return!0;return!1}(u[z].filters,Z)&&(g[z]?.event||[]).forEach(fe=>fe(Z)))}case"COUNT":let ye=ie[1],_e=ie[2];return void(u[ye]&&(g[ye]?.count||[]).forEach(z=>z(_e)));case"EOSE":{let z=ie[1];return void(z in g&&(g[z].eose.forEach(Z=>Z()),g[z].eose=[]))}case"OK":{let z=ie[1],Z=ie[2],fe=ie[3]||"";if(z in m){let{resolve:be,reject:re}=m[z];Z?be(null):re(new Error(fe))}return}case"NOTICE":let Ce=ie[1];return void f.notice.forEach(z=>z(Ce));case"AUTH":{let z=ie[1];return void f.auth?.forEach(Z=>Z(z))}}}catch{return}}a.onmessage=Q=>{G.enqueue(Q.data),Y||(Y=setInterval(J,0))}}))})).apply(this,arguments)}function L(){return 1===a?.readyState}function I(){return I=(0,v.A)(function*(){L()||(yield function C(){return F.apply(this,arguments)}())}),I.apply(this,arguments)}function j(V){return q.apply(this,arguments)}function q(){return(q=(0,v.A)(function*(V){let ee=JSON.stringify(V);if(L()||(yield new Promise(G=>setTimeout(G,1e3)),L()))try{a.send(ee)}catch(G){console.log(G)}})).apply(this,arguments)}const W=(V,{verb:ee="REQ",skipVerification:G=!1,alreadyHaveEvent:Y=null,id:J=Math.random().toString().slice(2)}={})=>{let Q=J;u[Q]={id:Q,filters:V,skipVerification:G,alreadyHaveEvent:Y},j([ee,Q,...V]);let pe={sub:(ie,ye={})=>W(ie||V,{skipVerification:ye.skipVerification||G,alreadyHaveEvent:ye.alreadyHaveEvent||Y,id:Q}),unsub:()=>{delete u[Q],delete g[Q],j(["CLOSE",Q])},on:(ie,ye)=>{g[Q]=g[Q]||{event:[],count:[],eose:[]},g[Q][ie].push(ye)},off:(ie,ye)=>{let _e=g[Q],Ce=_e[ie].indexOf(ye);Ce>=0&&_e[ie].splice(Ce,1)},get events(){return function io(t){return zr.apply(this,arguments)}(pe)}};return pe};function X(V,ee){return new Promise((G,Y)=>{if(!V.id)return void Y(new Error(`event ${V} has no id`));let J=V.id;j([ee,V]),m[J]={resolve:G,reject:Y}})}return{url:t,sub:W,on:(V,ee)=>{f[V].push(ee),"connect"===V&&1===a?.readyState&&ee()},off:(V,ee)=>{let G=f[V].indexOf(ee);-1!==G&&f[V].splice(G,1)},list:(V,ee)=>new Promise(G=>{let Y=W(V,ee),J=[],Q=setTimeout(()=>{Y.unsub(),G(J)},e);Y.on("eose",()=>{Y.unsub(),clearTimeout(Q),G(J)}),Y.on("event",pe=>{J.push(pe)})}),get:(V,ee)=>new Promise(G=>{let Y=W([V],ee),J=setTimeout(()=>{Y.unsub(),G(null)},r);Y.on("event",Q=>{Y.unsub(),clearTimeout(J),G(Q)})}),count:V=>new Promise(ee=>{let G=W(V,{...W,verb:"COUNT"}),Y=setTimeout(()=>{G.unsub(),ee(null)},i);G.on("count",J=>{G.unsub(),clearTimeout(Y),ee(J)})}),publish:V=>(0,v.A)(function*(){yield X(V,"EVENT")})(),auth:V=>(0,v.A)(function*(){yield X(V,"AUTH")})(),connect:function P(){return I.apply(this,arguments)},close(){f={connect:[],disconnect:[],error:[],notice:[],auth:[]},g={},m={},a?.readyState===WebSocket.OPEN&&a.close()},get status(){return a?.readyState??3}}}function zr(){return zr=function rt(t){return function(){return new Fe(t.apply(this,arguments))}}(function*(t){let n;const e=[],r=i=>{n?(n(i),n=void 0):e.push(i)};t.on("event",r);try{for(;;)e.length>0?yield e.shift():yield yield Fn(new Promise(a=>{n=a}))}finally{t.off("event",r)}}),zr.apply(this,arguments)}yt({},{getHex64:()=>ir,getInt:()=>eo,getSubscriptionId:()=>to,matchEventId:()=>sa,matchEventKind:()=>la,matchEventPubkey:()=>aa});var Hr={};yt(Hr,{BECH32_REGEX:()=>so,decode:()=>Rn,naddrEncode:()=>pa,neventEncode:()=>ga,noteEncode:()=>ha,nprofileEncode:()=>da,npubEncode:()=>fa,nrelayEncode:()=>ma,nsecEncode:()=>ua});var oo=5e3,so=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function Rn(t){let{prefix:n,words:e}=K.I.decode(t,oo),r=new Uint8Array(K.I.fromWords(e));switch(n){case"nprofile":{let i=or(r);if(!i[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(32!==i[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:Be(i[0][0]),relays:i[1]?i[1].map(a=>Dt.decode(a)):[]}}}case"nevent":{let i=or(r);if(!i[0]?.[0])throw new Error("missing TLV 0 for nevent");if(32!==i[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(i[2]&&32!==i[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(i[3]&&4!==i[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:Be(i[0][0]),relays:i[1]?i[1].map(a=>Dt.decode(a)):[],author:i[2]?.[0]?Be(i[2][0]):void 0,kind:i[3]?.[0]?parseInt(Be(i[3][0]),16):void 0}}}case"naddr":{let i=or(r);if(!i[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!i[2]?.[0])throw new Error("missing TLV 2 for naddr");if(32!==i[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!i[3]?.[0])throw new Error("missing TLV 3 for naddr");if(4!==i[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:Dt.decode(i[0][0]),pubkey:Be(i[2][0]),kind:parseInt(Be(i[3][0]),16),relays:i[1]?i[1].map(a=>Dt.decode(a)):[]}}}case"nrelay":{let i=or(r);if(!i[0]?.[0])throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:Dt.decode(i[0][0])}}case"nsec":case"npub":case"note":return{type:n,data:Be(r)};default:throw new Error(`unknown prefix ${n}`)}}function or(t){let n={},e=t;for(;e.length>0;){let r=e[0],i=e[1];if(!i)throw new Error(`malformed TLV ${r}`);let a=e.slice(2,2+i);if(e=e.slice(2+i),a.length<i)throw new Error(`not enough data to read on TLV ${r}`);n[r]=n[r]||[],n[r].push(a)}return n}function ua(t){return Wr("nsec",t)}function fa(t){return Wr("npub",t)}function ha(t){return Wr("note",t)}function Bn(t,n){let e=K.I.toWords(n);return K.I.encode(t,e,oo)}function Wr(t,n){return Bn(t,De(n))}function da(t){return Bn("nprofile",sr({0:[De(t.pubkey)],1:(t.relays||[]).map(e=>Lt.encode(e))}))}function ga(t){let n;return null!=t.kind&&(n=function ca(t){const n=new Uint8Array(4);return n[0]=t>>24&255,n[1]=t>>16&255,n[2]=t>>8&255,n[3]=255&t,n}(t.kind)),Bn("nevent",sr({0:[De(t.id)],1:(t.relays||[]).map(r=>Lt.encode(r)),2:t.author?[De(t.author)]:[],3:n?[new Uint8Array(n)]:[]}))}function pa(t){let n=new ArrayBuffer(4);return new DataView(n).setUint32(0,t.kind,!1),Bn("naddr",sr({0:[Lt.encode(t.identifier)],1:(t.relays||[]).map(r=>Lt.encode(r)),2:[De(t.pubkey)],3:[new Uint8Array(n)]}))}function ma(t){return Bn("nrelay",sr({0:[Lt.encode(t)]}))}function sr(t){let n=[];return Object.entries(t).forEach(([e,r])=>{r.forEach(i=>{let a=new Uint8Array(i.length+2);a.set([parseInt(e)],0),a.set([i.length],1),a.set(i,2),n.push(a)})}),$e(...n)}var Vr={};function ao(t,n,e){return Yr.apply(this,arguments)}function Yr(){return(Yr=(0,v.A)(function*(t,n,e){const i=lo(dn.getSharedSecret(t,"02"+n));let a=Uint8Array.from(Wt(16)),u=Lt.encode(e),f=yield crypto.subtle.importKey("raw",i,{name:"AES-CBC"},!1,["encrypt"]),g=yield crypto.subtle.encrypt({name:"AES-CBC",iv:a},f,u);return`${K.K3.encode(new Uint8Array(g))}?iv=${K.K3.encode(new Uint8Array(a.buffer))}`})).apply(this,arguments)}function ya(t,n,e){return Kr.apply(this,arguments)}function Kr(){return(Kr=(0,v.A)(function*(t,n,e){let[r,i]=e.split("?iv="),u=lo(dn.getSharedSecret(t,"02"+n)),f=yield crypto.subtle.importKey("raw",u,{name:"AES-CBC"},!1,["decrypt"]),g=K.K3.decode(r),m=K.K3.decode(i),S=yield crypto.subtle.decrypt({name:"AES-CBC",iv:m},f,g);return Dt.decode(S)})).apply(this,arguments)}function lo(t){return t.slice(1,33)}yt(Vr,{decrypt:()=>ya,encrypt:()=>ao}),typeof crypto<"u"&&!crypto.subtle&&crypto.webcrypto&&(crypto.subtle=crypto.webcrypto.subtle),yt({},{NIP05_REGEX:()=>co,queryProfile:()=>Ea,searchDomain:()=>_a,useFetchImplementation:()=>ba});var ar,co=/^(?:([\w.+-]+)@)?([\w.-]+)$/;try{ar=fetch}catch{}function ba(t){ar=t}function _a(t){return Zr.apply(this,arguments)}function Zr(){return(Zr=(0,v.A)(function*(t,n=""){try{return(yield(yield ar(`https://${t}/.well-known/nostr.json?name=${n}`)).json()).names}catch{return{}}})).apply(this,arguments)}function Ea(t){return Xr.apply(this,arguments)}function Xr(){return(Xr=(0,v.A)(function*(t){const n=t.match(co);if(!n)return null;const[e,r="_",i]=n;try{const a=yield ar(`https://${i}/.well-known/nostr.json?name=${r}`),{names:u,relays:f}=function xa(t){const n={names:{}};for(const[e,r]of Object.entries(t.names))"string"==typeof e&&"string"==typeof r&&(n.names[e]=r);if(t.relays){n.relays={};for(const[e,r]of Object.entries(t.relays))"string"==typeof e&&Array.isArray(r)&&(n.relays[e]=r.filter(i=>"string"==typeof i))}return n}(yield a.json()),g=u[r];return g?{pubkey:g,relays:f?.[g]}:null}catch{return null}})).apply(this,arguments)}function ka(t,n){let r=As.c.fromMasterSeed((0,Ur.kw)(t,n)).derive("m/44'/1237'/0'/0/0").privateKey;if(!r)throw new Error("could not derive private key");return Be(r)}function Sa(){return(0,Ur.we)(qi.p)}function Ca(t){return(0,Ur.JB)(t,qi.p)}function Ta(t){const n={reply:void 0,root:void 0,mentions:[],profiles:[]},e=[];for(const r of t.tags)"e"===r[0]&&r[1]&&e.push(r),"p"===r[0]&&r[1]&&n.profiles.push({pubkey:r[1],relays:r[2]?[r[2]]:[]});for(let r=0;r<e.length;r++){const i=e[r],[a,u,f,g]=i,m={id:u,relays:f?[f]:[]},C=r===e.length-1;"root"!==g?"reply"!==g?"mention"!==g?0===r?n.root=m:C?n.reply=m:n.mentions.push(m):n.mentions.push(m):n.reply=m:n.root=m}return n}function uo(t){let n=0;for(let e=0;e<t.length;e++){const r=parseInt(t[e],16);if(0!==r){n+=Math.clz32(r)-28;break}n+=4}return n}function Ra(t,n){let e=0;const r=t,i=["nonce",e.toString(),n.toString()];for(r.tags.push(i);;){const a=Math.floor((new Date).getTime()/1e3);if(a!==r.created_at&&(e=0,r.created_at=a),i[1]=(++e).toString(),r.id=In(r),uo(r.id)>=n)break}return r}function Ua(t,n,e,r){return Gt({kind:6,tags:[...t.tags??[],["e",n.id,e],["p",n.pubkey]],content:""===t.content?"":JSON.stringify(n),created_at:t.created_at},r)}function fo(t){if(6!==t.kind)return;let n,e;for(let r=t.tags.length-1;r>=0&&(void 0===n||void 0===e);r--){const i=t.tags[r];i.length>=2&&("e"===i[0]&&void 0===n?n=i:"p"===i[0]&&void 0===e&&(e=i))}return void 0!==n?{id:n[1],relays:[n[2],e?.[2]].filter(r=>"string"==typeof r),author:e?.[1]}:void 0}function Na(t,{skipVerification:n}={}){const e=fo(t);if(void 0===e||""===t.content)return;let r;try{r=JSON.parse(t.content)}catch{return}return r.id===e.id&&(n||rr(r))?r:void 0}yt({},{generateSeedWords:()=>Sa,privateKeyFromSeedWords:()=>ka,validateWords:()=>Ca}),yt({},{parse:()=>Ta}),yt({},{getPow:()=>uo,minePow:()=>Ra}),yt({},{finishRepostEvent:()=>Ua,getRepostedEvent:()=>Na,getRepostedEventPointer:()=>fo}),yt({},{NOSTR_URI_REGEX:()=>lr,parse:()=>Oa,test:()=>La});var lr=new RegExp(`nostr:(${so.source})`);function La(t){return"string"==typeof t&&new RegExp(`^${lr.source}$`).test(t)}function Oa(t){const n=t.match(new RegExp(`^${lr.source}$`));if(!n)throw new Error(`Invalid Nostr URI: ${t}`);return{uri:n[0],value:n[1],decoded:Rn(n[1])}}function Fa(t,n,e){const r=n.tags.filter(i=>i.length>=2&&("e"===i[0]||"p"===i[0]));return Gt({...t,kind:7,tags:[...t.tags??[],...r,["e",n.id],["p",n.pubkey]],content:t.content??"+"},e)}function Da(t){if(7!==t.kind)return;let n,e;for(let r=t.tags.length-1;r>=0&&(void 0===n||void 0===e);r--){const i=t.tags[r];i.length>=2&&("e"===i[0]&&void 0===n?n=i:"p"===i[0]&&void 0===e&&(e=i))}return void 0!==n&&void 0!==e?{id:n[1],relays:[n[2],e[2]].filter(r=>void 0!==r),author:e[1]}:void 0}function qa(t,n){let e=[];(n.kind||-1)>=0&&e.push(`kind=${n.kind}`),n.until&&e.push(`created_at<${n.until}`),n.since&&e.push(`created_at>${n.since}`);let r=e.join("&");if(""===r)throw new Error("refusing to create a delegation without any conditions");let i=It(Lt.encode(`nostr:delegation:${n.pubkey}:${r}`)),a=Be(gn.sign(i,t));return{from:$r(t),to:n.pubkey,cond:r,sig:a}}function Ga(t){let n=t.tags.find(f=>"delegation"===f[0]&&f.length>=4);if(!n)return null;let e=n[1],r=n[2],i=n[3],a=r.split("&");for(let f=0;f<a.length;f++){let[g,m,S]=a[f].split(/\b/);if("kind"!==g||"="!==m||t.kind!==parseInt(S)){if("created_at"===g&&"<"===m&&t.created_at<parseInt(S))continue;if("created_at"===g&&">"===m&&t.created_at>parseInt(S))continue;return null}}let u=It(Lt.encode(`nostr:delegation:${t.pubkey}:${r}`));return gn.verify(i,u,e)?e:null}yt({},{finishReactionEvent:()=>Fa,getReactedEventPointer:()=>Da}),yt({},{createDelegation:()=>qa,getDelegator:()=>Ga}),yt({},{matchAll:()=>Ha,regex:()=>Qr,replaceAll:()=>Wa});var Qr=()=>new RegExp(`\\b${lr.source}\\b`,"g");function*Ha(t){const n=t.matchAll(Qr());for(const e of n)try{const[r,i]=e;yield{uri:r,value:i,decoded:Rn(i),start:e.index,end:e.index+r.length}}catch{}}function Wa(t,n){return t.replaceAll(Qr(),(e,r)=>n({uri:e,value:r,decoded:Rn(r)}))}yt({},{channelCreateEvent:()=>Ya,channelHideMessageEvent:()=>Xa,channelMessageEvent:()=>Za,channelMetadataEvent:()=>Ka,channelMuteUserEvent:()=>Qa});var Jr,Ya=(t,n)=>{let e;if("object"==typeof t.content)e=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;e=t.content}return Gt({kind:40,tags:[...t.tags??[]],content:e,created_at:t.created_at},n)},Ka=(t,n)=>{let e;if("object"==typeof t.content)e=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;e=t.content}return Gt({kind:41,tags:[["e",t.channel_create_event_id],...t.tags??[]],content:e,created_at:t.created_at},n)},Za=(t,n)=>{const e=[["e",t.channel_create_event_id,t.relay_url,"root"]];return t.reply_to_channel_message_event_id&&e.push(["e",t.reply_to_channel_message_event_id,t.relay_url,"reply"]),Gt({kind:42,tags:[...e,...t.tags??[]],content:t.content,created_at:t.created_at},n)},Xa=(t,n)=>{let e;if("object"==typeof t.content)e=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;e=t.content}return Gt({kind:43,tags:[["e",t.channel_message_event_id],...t.tags??[]],content:e,created_at:t.created_at},n)},Qa=(t,n)=>{let e;if("object"==typeof t.content)e=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;e=t.content}return Gt({kind:44,tags:[["p",t.pubkey_to_mute],...t.tags??[]],content:e,created_at:t.created_at},n)};yt({},{useFetchImplementation:()=>el,validateGithub:()=>tl});try{Jr=fetch}catch{}function el(t){Jr=t}function tl(t,n,e){return ei.apply(this,arguments)}function ei(){return(ei=(0,v.A)(function*(t,n,e){try{return(yield(yield Jr(`https://gist.github.com/${n}/${e}/raw`)).text())===`Verifying that I control the following Nostr public key: ${t}`}catch{return!1}})).apply(this,arguments)}yt({},{authenticate:()=>rl});var rl=function(){var t=(0,v.A)(function*({challenge:n,relay:e,sign:r}){const i={kind:22242,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e.url],["challenge",n]],content:""};return e.auth(yield r(i))});return function(e){return t.apply(this,arguments)}}();yt({},{decrypt:()=>sl,encrypt:()=>ol,utils:()=>tn});var ni,tn={v2:{maxPlaintextSize:65408,minCiphertextSize:100,maxCiphertextSize:102400,getConversationKey:(t,n)=>dn.getSharedSecret(t,"02"+n).subarray(1,33),getMessageKeys(t,n){const e=((t,n,e,r,i)=>function Vs(t,n,e,r=32){if(Pe.hash(t),Pe.number(r),r>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/t.outputLen);void 0===e&&(e=Yi);const a=new Uint8Array(i*t.outputLen),u=hn.create(t,n),f=u._cloneInto(),g=new Uint8Array(u.outputLen);for(let m=0;m<i;m++)Dr[0]=m+1,f.update(0===m?Yi:g).update(e).update(Dr).digestInto(g),a.set(g,t.outputLen*m),u._cloneInto(f);return u.destroy(),f.destroy(),g.fill(0),Dr.fill(0),a.slice(0,r)}(t,function Ws(t,n,e){return Pe.hash(t),void 0===e&&(e=new Uint8Array(t.outputLen)),hn(t,Oe(e),Oe(n))}(t,n,e),r,i))(It,t,n,"nip44-v2",76);return{encryption:e.subarray(0,32),nonce:e.subarray(32,44),auth:e.subarray(44,76)}},calcPadding(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("expected positive integer");if(t<=32)return 32;const n=1<<Math.floor(Math.log2(t-1))+1,e=n<=256?32:n/8;return e*(Math.floor((t-1)/e)+1)},pad(t){const n=Lt.encode(t),e=n.length;if(e<1||e>=tn.v2.maxPlaintextSize)throw new Error("invalid plaintext length: must be between 1b and 64KB");const r=tn.v2.calcPadding(e),i=new Uint8Array(r-e),a=new Uint8Array(2);return new DataView(a.buffer).setUint16(0,e),$e(a,n,i)},unpad(t){const n=new DataView(t.buffer).getUint16(0),e=t.subarray(2,2+n);if(0===n||e.length!==n||t.length!==2+tn.v2.calcPadding(n))throw new Error("invalid padding");return Dt.decode(e)}}};function ol(t,n,e={}){const r=e.version??2;if(2!==r)throw new Error("unknown encryption version "+r);const i=e.salt??Wt(32);jr(i,32);const a=tn.v2.getMessageKeys(t,i),u=tn.v2.pad(n),f=Hi(a.encryption,a.nonce,u),g=hn(It,a.auth,f);return K.K3.encode($e(new Uint8Array([r]),i,f,g))}function sl(t,n){const e=tn.v2;jr(t,32);const r=n.length;if(r<e.minCiphertextSize||r>=e.maxCiphertextSize)throw new Error("invalid ciphertext length: "+r);if("#"===n[0])throw new Error("unknown encryption version");let i;try{i=K.K3.decode(n)}catch(F){throw new Error("invalid base64: "+F.message)}const a=i.subarray(0,1)[0];if(2!==a)throw new Error("unknown encryption version "+a);const u=i.subarray(1,33),f=i.subarray(33,-32),g=i.subarray(-32),m=e.getMessageKeys(t,u);if(!function Us(t,n){if(t.length!==n.length)throw new Error("equalBytes: Different size of Uint8Arrays");let e=!0;for(let r=0;r<t.length;r++)e&&(e=t[r]===n[r]);return e}(hn(It,m.auth,f),g))throw new Error("invalid MAC");const C=Hi(m.encryption,m.nonce,f);return e.unpad(C)}function ll(t){const{pathname:n,searchParams:e}=new URL(t),r=n,i=e.get("relay"),a=e.get("secret");if(!r||!i||!a)throw new Error("invalid connection string");return{pubkey:r,relay:i,secret:a}}function cl(t){return ti.apply(this,arguments)}function ti(){return(ti=(0,v.A)(function*({pubkey:t,secret:n,invoice:e}){const i=yield ao(n,t,JSON.stringify({method:"pay_invoice",params:{invoice:e}}));return Gt({kind:23194,created_at:Math.round(Date.now()/1e3),content:i,tags:[["p",t]]},n)})).apply(this,arguments)}yt({},{makeNwcRequestEvent:()=>cl,parseConnectionString:()=>ll}),yt({},{getZapEndpoint:()=>hl,makeZapReceipt:()=>pl,makeZapRequest:()=>dl,useFetchImplementation:()=>fl,validateZapRequest:()=>gl});try{ni=fetch}catch{}function fl(t){ni=t}function hl(t){return ri.apply(this,arguments)}function ri(){return(ri=(0,v.A)(function*(t){try{let n="",{lud06:e,lud16:r}=JSON.parse(t.content);if(e){let{words:u}=K.I.decode(e,1e3),f=K.I.fromWords(u);n=Dt.decode(f)}else{if(!r)return null;{let[u,f]=r.split("@");n=`https://${f}/.well-known/lnurlp/${u}`}}let a=yield(yield ni(n)).json();if(a.allowsNostr&&a.nostrPubkey)return a.callback}catch{}return null})).apply(this,arguments)}function dl({profile:t,event:n,amount:e,relays:r,comment:i=""}){if(!e)throw new Error("amount not given");if(!t)throw new Error("profile not given");let a={kind:9734,created_at:Math.round(Date.now()/1e3),content:i,tags:[["p",t],["amount",e.toString()],["relays",...r]]};return n&&a.tags.push(["e",n]),a}function gl(t){let n;try{n=JSON.parse(t)}catch{return"Invalid zap request JSON."}if(!Gr(n))return"Zap request is not a valid Nostr event.";if(!rr(n))return"Invalid signature on zap request.";let e=n.tags.find(([a,u])=>"p"===a&&u);if(!e)return"Zap request doesn't have a 'p' tag.";if(!e[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=n.tags.find(([a,u])=>"e"===a&&u);return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":n.tags.find(([a,u])=>"relays"===a&&u)?null:"Zap request doesn't have a 'relays' tag."}function pl({zapRequest:t,preimage:n,bolt11:e,paidAt:r}){let a=JSON.parse(t).tags.filter(([f])=>"e"===f||"p"===f||"a"===f),u={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...a,["bolt11",e],["description",t]]};return n&&u.tags.push(["preimage",n]),u}yt({},{getToken:()=>vl,unpackEventFromToken:()=>go,validateEvent:()=>po,validateToken:()=>yl});var ho="Nostr ";function vl(t,n,e){return ii.apply(this,arguments)}function ii(){return(ii=(0,v.A)(function*(t,n,e,r=!1){if(!t||!n)throw new Error("Missing loginUrl or httpMethod");const i=function ea(t=255){return{kind:t,content:"",tags:[],created_at:0}}(27235);i.tags=[["u",t],["method",n]],i.created_at=Math.round((new Date).getTime()/1e3);const a=yield e(i);return(r?ho:"")+K.K3.encode(Lt.encode(JSON.stringify(a)))})).apply(this,arguments)}function yl(t,n,e){return oi.apply(this,arguments)}function oi(){return(oi=(0,v.A)(function*(t,n,e){const r=yield go(t).catch(a=>{throw a});return yield po(r,n,e).catch(a=>{throw a})})).apply(this,arguments)}function go(t){return si.apply(this,arguments)}function si(){return(si=(0,v.A)(function*(t){if(!t)throw new Error("Missing token");t=t.replace(ho,"");const n=Dt.decode(K.K3.decode(t));if(!n||0===n.length||!n.startsWith("{"))throw new Error("Invalid token");return JSON.parse(n)})).apply(this,arguments)}function po(t,n,e){return ai.apply(this,arguments)}function ai(){return(ai=(0,v.A)(function*(t,n,e){if(!t)throw new Error("Invalid nostr event");if(!rr(t))throw new Error("Invalid nostr event, signature invalid");if(27235!==t.kind)throw new Error("Invalid nostr event, kind invalid");if(!t.created_at)throw new Error("Invalid nostr event, created_at invalid");if(Math.round((new Date).getTime()/1e3)-t.created_at>60)throw new Error("Invalid nostr event, expired");const r=t.tags.find(a=>"u"===a[0]);if(1!==r?.length&&r?.[1]!==n)throw new Error("Invalid nostr event, url tag invalid");const i=t.tags.find(a=>"method"===a[0]);if(1!==i?.length&&i?.[1].toLowerCase()!==e.toLowerCase())throw new Error("Invalid nostr event, method tag invalid");return!0})).apply(this,arguments)}function Te(){return Te=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},Te.apply(this,arguments)}const yo=t=>t.reduce((n,e)=>n+e.toString(16).padStart(2,"0"),"");class wo extends Error{constructor(n,e,r,i){let a=n.toString();e&&(a+=` ${e}`),a+=": ",a+=i.message?i.message:JSON.stringify(i),super(a),this.status=void 0,this.statusText=void 0,this.headers=void 0,this.error=void 0,this.status=n,this.statusText=e,this.headers=r,this.error=i}}const wl=["auth","endpoint","params","request_body","method","max_retries","base_url","user_agent","headers"],bl="https://api.getalby.com";function bo(t,n){return ci.apply(this,arguments)}function ci(){return(ci=(0,v.A)(function*(t,n,e=0){const r=yield fetch(t,n);if(429===r.status&&e>0){const i=Number(r.headers.get("x-rate-limit-reset")),a=Number(r.headers.get("x-rate-limit-remaining")),u=1e3*i-Date.now();let f=1e3;return 0===a&&(f=u),yield new Promise(g=>setTimeout(g,f)),bo(t,n,e-1)}return r})).apply(this,arguments)}function ui(){return(ui=(0,v.A)(function*(t){let{auth:n,endpoint:e,params:r={},request_body:i,method:a,max_retries:u,base_url:f=bl,user_agent:g,headers:m}=t,S=function li(t,n){if(null==t)return{};var e,r,i={},a=Object.keys(t);for(r=0;r<a.length;r++)n.indexOf(e=a[r])>=0||(i[e]=t[e]);return i}(t,wl);const C=new URL(f+e);C.search=function mo(t){return Object.entries(t).map(([n,e])=>n&&e?`${n}=${e}`:"").filter(n=>n).join("&")}(r);const F="POST"===a&&!!i,L=n?yield n.getAuthHeader(C.href,a):void 0,P=yield bo(C.toString(),Te({headers:Te({},F?{"Content-Type":"application/json; charset=utf-8"}:void 0,L,m,{"User-Agent":g??"@getalby/sdk","X-User-Agent":g??"@getalby/sdk"}),method:a,body:F?JSON.stringify(i):void 0},S),u);if(!P.ok){const I=yield P.json();throw new wo(P.status,P.statusText,P.headers,I)}return P})).apply(this,arguments)}function wt(t){return fi.apply(this,arguments)}function fi(){return fi=(0,v.A)(function*(t){return(yield function _l(t){return ui.apply(this,arguments)}(t)).json()}),fi.apply(this,arguments)}class Eo{constructor(n){this.bearer_token=void 0,this.bearer_token=n}getAuthHeader(){return{Authorization:`Bearer ${this.bearer_token}`}}}class Xt extends Error{constructor(n,e){super(n),this.error=void 0,this.code=void 0,this.error=n,this.code=e}}class xo extends Xt{}class hi extends Xt{}class di extends hi{}class gi extends hi{}class pi extends Xt{}class mi extends Xt{}class cr extends Xt{}class Mo extends Xt{}class ko extends Xt{}const So={alby:{authorizationUrl:"https://nwc.getalby.com/apps/new",relayUrl:"wss://relay.getalby.com/v1",walletPubkey:"69effe7b49a6dd5cf525bd0905917a5005ffe480b58eeb8e861418cf3ae760d9"}};class Un{static parseWalletConnectUrl(n){n=n.replace("nostrwalletconnect://","http://").replace("nostr+walletconnect://","http://").replace("nostrwalletconnect:","http://").replace("nostr+walletconnect:","http://");const e=new URL(n),r=e.searchParams.get("relay");if(!r)throw new Error("No relay URL found in connection string");const i={walletPubkey:e.host,relayUrl:r},a=e.searchParams.get("secret");a&&(i.secret=a);const u=e.searchParams.get("lud16");return u&&(i.lud16=u),i}static withNewSecret(n){return(n=n||{}).secret=Ki(),new Un(n)}constructor(n){var e;this.relay=void 0,this.relayUrl=void 0,this.secret=void 0,this.lud16=void 0,this.walletPubkey=void 0,this.options=void 0,n&&n.nostrWalletConnectUrl&&(n=Te({},Un.parseWalletConnectUrl(n.nostrWalletConnectUrl),n));const r=So[(null==(e=n)?void 0:e.providerName)||"alby"];this.options=Te({},r,n||{}),this.relayUrl=this.options.relayUrl,this.relay=ro(this.relayUrl),this.options.secret&&(this.secret=this.options.secret.toLowerCase().startsWith("nsec")?Hr.decode(this.options.secret).data:this.options.secret),this.lud16=this.options.lud16,this.walletPubkey=this.options.walletPubkey.toLowerCase().startsWith("npub")?Hr.decode(this.options.walletPubkey).data:this.options.walletPubkey,void 0===globalThis.WebSocket&&console.error("WebSocket is undefined. Make sure to `import websocket-polyfill` for nodejs environments")}get nostrWalletConnectUrl(){return this.getNostrWalletConnectUrl()}getNostrWalletConnectUrl(n=!0){let e=`nostr+walletconnect://${this.walletPubkey}?relay=${this.relayUrl}&pubkey=${this.publicKey}`;return n&&(e=`${e}&secret=${this.secret}`),e}get connected(){return 1===this.relay.status}get publicKey(){if(!this.secret)throw new Error("Missing secret key");return $r(this.secret)}getPublicKey(){return Promise.resolve(this.publicKey)}signEvent(n){if(!this.secret)throw new Error("Missing secret key");return Promise.resolve(Gt(n,this.secret))}getEventHash(n){return In(n)}close(){return this.relay.close()}encrypt(n,e){var r=this;return(0,v.A)(function*(){if(!r.secret)throw new Error("Missing secret");return yield Vr.encrypt(r.secret,n,e)})()}decrypt(n,e){var r=this;return(0,v.A)(function*(){if(!r.secret)throw new Error("Missing secret");return yield Vr.decrypt(r.secret,n,e)})()}getAuthorizationUrl(n){if(!this.options.authorizationUrl)throw new Error("Missing authorizationUrl option");const e=new URL(this.options.authorizationUrl);return null!=n&&n.name&&e.searchParams.set("name",n?.name),e.searchParams.set("pubkey",this.publicKey),null!=n&&n.returnTo&&e.searchParams.set("return_to",n.returnTo),null!=n&&n.budgetRenewal&&e.searchParams.set("budget_renewal",n.budgetRenewal),null!=n&&n.expiresAt&&e.searchParams.set("expires_at",Math.floor(n.expiresAt.getTime()/1e3).toString()),null!=n&&n.maxAmount&&e.searchParams.set("max_amount",n.maxAmount.toString()),void 0!==n?.editable&&e.searchParams.set("editable",n.editable.toString()),null!=n&&n.requestMethods&&e.searchParams.set("request_methods",n.requestMethods.join(" ")),e}initNWC(n={}){n.name||(n.name=document.location.host);const e=this.getAuthorizationUrl(n),r=window.outerHeight/2+window.screenY-300,i=window.outerWidth/2+window.screenX-200;return new Promise((a,u)=>{const f=window.open(e.toString(),`${document.title} - Wallet Connect`,`height=600,width=400,top=${r},left=${i}`);if(!f)return void u(new Error("failed to execute window.open"));const g=S=>{const C=S.data;C&&"nwc:success"===C.type&&S.origin===`${e.protocol}//${e.host}`&&(a(C),clearInterval(m),window.removeEventListener("message",g),f&&f.close())},m=setInterval(()=>{f&&f.closed&&(clearInterval(m),window.removeEventListener("message",g),u(new Error("Popup closed")))},500);window.addEventListener("message",g)})}getWalletServiceSupportedMethods(){var n=this;return(0,v.A)(function*(){return console.warn("getWalletServiceSupportedMethods is deprecated. Please use getWalletServiceInfo instead."),(yield n.getWalletServiceInfo()).capabilities})()}getWalletServiceInfo(){var n=this;return(0,v.A)(function*(){var e;yield n._checkConnected();const r=yield n.relay.list([{kinds:[13194],limit:1,authors:[n.walletPubkey]}],{eoseSubTimeout:1e4});if(!r.length)throw new Error("no info event (kind 13194) returned from relay");const i=r[0].content,a=r[0].tags.find(u=>"notifications"===u[0]);return{capabilities:i.split(/[ |,]/g),notifications:(null==a||null==(e=a[1])?void 0:e.split(" "))||[]}})()}getInfo(){var n=this;return(0,v.A)(function*(){try{return yield n.executeNip47Request("get_info",{},e=>!!e.methods)}catch(e){throw console.error("Failed to request get_info",e),e}})()}getBalance(){var n=this;return(0,v.A)(function*(){try{return yield n.executeNip47Request("get_balance",{},e=>void 0!==e.balance)}catch(e){throw console.error("Failed to request get_balance",e),e}})()}payInvoice(n){var e=this;return(0,v.A)(function*(){try{return yield e.executeNip47Request("pay_invoice",n,r=>!!r.preimage)}catch(r){throw console.error("Failed to request pay_invoice",r),r}})()}payKeysend(n){var e=this;return(0,v.A)(function*(){try{return yield e.executeNip47Request("pay_keysend",n,r=>!!r.preimage)}catch(r){throw console.error("Failed to request pay_keysend",r),r}})()}signMessage(n){var e=this;return(0,v.A)(function*(){try{return yield e.executeNip47Request("sign_message",n,r=>r.message===n.message&&!!r.signature)}catch(r){throw console.error("Failed to request sign_message",r),r}})()}multiPayInvoice(n){var e=this;return(0,v.A)(function*(){try{return{invoices:yield e.executeMultiNip47Request("multi_pay_invoice",n,n.invoices.length,r=>!!r.preimage),errors:[]}}catch(r){throw console.error("Failed to request multi_pay_invoice",r),r}})()}multiPayKeysend(n){var e=this;return(0,v.A)(function*(){try{return{keysends:yield e.executeMultiNip47Request("multi_pay_keysend",n,n.keysends.length,r=>!!r.preimage),errors:[]}}catch(r){throw console.error("Failed to request multi_pay_keysend",r),r}})()}makeInvoice(n){var e=this;return(0,v.A)(function*(){try{if(!n.amount)throw new Error("No amount specified");return yield e.executeNip47Request("make_invoice",n,r=>!!r.invoice)}catch(r){throw console.error("Failed to request make_invoice",r),r}})()}lookupInvoice(n){var e=this;return(0,v.A)(function*(){try{return yield e.executeNip47Request("lookup_invoice",n,r=>!!r.invoice)}catch(r){throw console.error("Failed to request lookup_invoice",r),r}})()}listTransactions(n){var e=this;return(0,v.A)(function*(){try{return yield e.executeNip47Request("list_transactions",n,r=>!!r.transactions)}catch(r){throw console.error("Failed to request list_transactions",r),r}})()}subscribeNotifications(n,e){var r=this;return(0,v.A)(function*(){var i=r;let a,u,f,g=!0;return(0,v.A)(function*(){for(;g;){try{yield i._checkConnected(),f=i.relay.sub([{kinds:[23196],authors:[i.walletPubkey],"#p":[i.publicKey]}]),console.info("subscribed to relay"),f.on("event",function(){var m=(0,v.A)(function*(S){const C=yield i.decrypt(i.walletPubkey,S.content);let F;try{F=JSON.parse(C)}catch(L){return void console.error("Failed to parse decrypted event content",L)}F.notification?(!e||e.indexOf(F.notification_type)>-1)&&n(F):console.error("No notification in response",F)});return function(S){return m.apply(this,arguments)}}()),yield new Promise(m=>{a=()=>{m()},u=()=>{console.info("relay disconnected"),a?.()},i.relay.on("disconnect",u)}),void 0!==u&&i.relay.off("disconnect",u)}catch(m){console.error("error subscribing to notifications",m||"unknown relay error")}g&&(yield new Promise(m=>setTimeout(m,1e3)))}})(),()=>{var m;g=!1,a?.(),null==(m=f)||m.unsub()}})()}executeNip47Request(n,e,r){var i=this;return(0,v.A)(function*(){var a=i;return yield i._checkConnected(),new Promise((u,f)=>{(0,v.A)(function*(){const g={method:n,params:e},m=yield a.encrypt(a.walletPubkey,JSON.stringify(g)),S={kind:23194,created_at:Math.floor(Date.now()/1e3),tags:[["p",a.walletPubkey]],content:m,pubkey:a.publicKey},C=yield a.signEvent(S),F=a.relay.sub([{kinds:[23195],authors:[a.walletPubkey],"#e":[C.id]}]),L=setTimeout(function(){F.unsub(),f(new gi(`reply timeout: event ${C.id}`,"INTERNAL"))},6e4);F.on("event",function(){var I=(0,v.A)(function*(j){clearTimeout(L),F.unsub();const q=yield a.decrypt(a.walletPubkey,j.content);let W;try{W=JSON.parse(q)}catch{return clearTimeout(L),F.unsub(),void f(new mi("failed to deserialize response","INTERNAL"))}var X,V;W.result?r(W.result)?u(W.result):(clearTimeout(L),F.unsub(),f(new cr("response from NWC failed validation: "+JSON.stringify(W.result),"INTERNAL"))):(clearTimeout(L),F.unsub(),f(new xo((null==(X=W.error)?void 0:X.message)||"unknown Error",(null==(V=W.error)?void 0:V.code)||"INTERNAL")))});return function(j){return I.apply(this,arguments)}}());const P=setTimeout(function(){F.unsub(),f(new di(`publish timeout: ${C.id}`,"INTERNAL"))},5e3);try{yield a.relay.publish(C),clearTimeout(P)}catch(I){clearTimeout(P),f(new pi(`failed to publish: ${I}`,"INTERNAL"))}})()})})()}executeMultiNip47Request(n,e,r,i){var a=this;return(0,v.A)(function*(){var u=a;yield a._checkConnected();const f=[];return new Promise((g,m)=>{(0,v.A)(function*(){const S={method:n,params:e},C=yield u.encrypt(u.walletPubkey,JSON.stringify(S)),F={kind:23194,created_at:Math.floor(Date.now()/1e3),tags:[["p",u.walletPubkey]],content:C,pubkey:u.publicKey},L=yield u.signEvent(F),P=u.relay.sub([{kinds:[23195],authors:[u.walletPubkey],"#e":[L.id]}]),I=setTimeout(function(){P.unsub(),m(new gi(`reply timeout: event ${L.id}`,"INTERNAL"))},6e4);P.on("event",function(){var q=(0,v.A)(function*(W){const X=yield u.decrypt(u.walletPubkey,W.content);let V;try{V=JSON.parse(X)}catch{clearTimeout(I),P.unsub(),m(new mi("failed to deserialize response","INTERNAL"))}if(V.result){var ee;if(!i(V.result))return clearTimeout(I),P.unsub(),void m(new cr("Response from NWC failed validation: "+JSON.stringify(V.result),"INTERNAL"));const J=null==(ee=W.tags.find(Q=>"d"===Q[0]))?void 0:ee[1];if(void 0===J)return clearTimeout(I),P.unsub(),void m(new cr("No d tag found in response event","INTERNAL"));f.push(Te({},V.result,{dTag:J})),f.length===r&&(clearTimeout(I),P.unsub(),g(f))}else{var G,Y;clearTimeout(I),P.unsub(),m(new Mo(null==(G=V.error)?void 0:G.message,null==(Y=V.error)?void 0:Y.code))}});return function(W){return q.apply(this,arguments)}}());const j=setTimeout(function(){P.unsub(),m(new di(`Publish timeout: ${L.id}`,"INTERNAL"))},5e3);try{yield u.relay.publish(L),clearTimeout(j)}catch(q){clearTimeout(j),m(new pi(`Failed to publish: ${q}`,"INTERNAL"))}})()})})()}_checkConnected(){var n=this;return(0,v.A)(function*(){if(!n.secret)throw new Error("Missing secret key");try{yield n.relay.connect()}catch{throw console.error("failed to connect to relay",n.relayUrl),new ko("Failed to connect to "+n.relayUrl,"OTHER")}})()}}const Ml={get_info:"getInfo",get_balance:"getBalance",make_invoice:"makeInvoice",pay_invoice:"sendPayment",pay_keysend:"payKeysend",lookup_invoice:"lookupInvoice",list_transactions:"listTransactions",multi_pay_invoice:"sendMultiPayment",multi_pay_keysend:"multiKeysend",sign_message:"signMessage"};class ur{get relay(){return console.warn("relay is deprecated. Please use client.relay instead."),this.client.relay}get relayUrl(){return console.warn("relayUrl is deprecated. Please use client.relayUrl instead."),this.client.relayUrl}get walletPubkey(){return console.warn("walletPubkey is deprecated. Please use client.walletPubkey instead."),this.client.walletPubkey}get options(){return this.client.options}get secret(){return console.warn("secret is deprecated. Please use client.secret instead."),this.client.secret}static withNewSecret(n){return(n=n||{}).secret=Ki(),new ur(n)}constructor(n){this._enabled=!1,this.client=void 0,this.subscribers=void 0,this.client=new Un(n),this.subscribers={}}on(n,e){this.subscribers[n]=e}notify(n,e){const r=this.subscribers[n];r&&r(e)}getNostrWalletConnectUrl(n=!0){return console.warn("getNostrWalletConnectUrl is deprecated. Please use client.getNostrWalletConnectUrl instead."),this.client.getNostrWalletConnectUrl(n)}get nostrWalletConnectUrl(){return console.warn("nostrWalletConnectUrl is deprecated. Please use client.nostrWalletConnectUrl instead."),this.client.nostrWalletConnectUrl}get connected(){return console.warn("connected is deprecated. Please use client.connected instead."),this.client.connected}get publicKey(){return console.warn("publicKey is deprecated. Please use client.publicKey instead."),this.client.publicKey}getPublicKey(){return this.client.getPublicKey()}signEvent(n){return this.client.signEvent(n)}getEventHash(n){return console.warn("getEventHash is deprecated. Please use client.getEventHash instead."),this.client.getEventHash(n)}enable(){var n=this;return(0,v.A)(function*(){n._enabled=!0})()}close(){return this.client.close()}encrypt(n,e){var r=this;return(0,v.A)(function*(){return console.warn("encrypt is deprecated. Please use client.encrypt instead."),r.client.encrypt(n,e)})()}decrypt(n,e){var r=this;return(0,v.A)(function*(){return console.warn("decrypt is deprecated. Please use client.decrypt instead."),r.client.decrypt(n,e)})()}getAuthorizationUrl(n){return console.warn("getAuthorizationUrl is deprecated. Please use client.getAuthorizationUrl instead."),this.client.getAuthorizationUrl(n)}initNWC(n={}){return console.warn("initNWC is deprecated. Please use client.initNWC instead."),this.client.initNWC(n)}getInfo(){var n=this;return(0,v.A)(function*(){yield n.checkEnabled();const e=["lightning","nostr"],r="Alby JS SDK";try{const i=yield n.client.getInfo(),a={methods:i.methods.map(u=>Ml[u]),node:{alias:i.alias,pubkey:i.pubkey,color:i.color},supports:e,version:r};return n.notify("getInfo",a),a}catch(i){return console.error("Using minimal getInfo",i),{methods:["sendPayment"],node:{},supports:e,version:r}}})()}getBalance(){var n=this;return(0,v.A)(function*(){yield n.checkEnabled();const e=yield n.client.getBalance(),r={balance:Math.floor(e.balance/1e3),currency:"sats"};return n.notify("getBalance",r),r})()}sendPayment(n){var e=this;return(0,v.A)(function*(){yield e.checkEnabled();const r={preimage:(yield e.client.payInvoice({invoice:n})).preimage};return e.notify("sendPayment",r),r})()}sendPaymentAsync(n){var e=this;return(0,v.A)(function*(){return yield e.checkEnabled(),e.client.payInvoice({invoice:n}),e.notify("sendPaymentAsync",{}),{}})()}keysend(n){var e=this;return(0,v.A)(function*(){yield e.checkEnabled();const r={preimage:(yield e.client.payKeysend(Co(n))).preimage};return e.notify("keysend",r),r})()}signMessage(n){var e=this;return(0,v.A)(function*(){yield e.checkEnabled();const r=yield e.client.signMessage({message:n}),i={message:r.message,signature:r.signature};return e.notify("keysend",i),i})()}makeInvoice(n){var e=this;return(0,v.A)(function*(){var r;yield e.checkEnabled();const i="object"==typeof n?n:void 0,a=+(null!=(r=i?.amount)?r:n);if(!a)throw new Error("No amount specified");const u={paymentRequest:(yield e.client.makeInvoice({amount:1e3*a,description:i?.defaultMemo})).invoice};return e.notify("makeInvoice",u),u})()}lookupInvoice(n){var e=this;return(0,v.A)(function*(){yield e.checkEnabled();const r=yield e.client.lookupInvoice({invoice:n.paymentRequest,payment_hash:n.paymentHash}),i={preimage:r.preimage,paymentRequest:r.invoice,paid:!!r.settled_at};return e.notify("lookupInvoice",i),i})()}listTransactions(n){var e=this;return(0,v.A)(function*(){yield e.checkEnabled();const r={transactions:(yield e.client.listTransactions(n)).transactions.map(kl)};return e.notify("listTransactions",r),r})()}sendMultiPayment(n){var e=this;return(0,v.A)(function*(){yield e.checkEnabled();const i={payments:(yield e.client.multiPayInvoice({invoices:n.map((a,u)=>({invoice:a,id:u.toString()}))})).invoices.map(a=>{const u=n[parseInt(a.dTag)];if(!u)throw new Error("Could not find paymentRequest matching response d tag");return{paymentRequest:u,preimage:a.preimage}}),errors:[]};return e.notify("sendMultiPayment",i),i})()}multiKeysend(n){var e=this;return(0,v.A)(function*(){yield e.checkEnabled();const i={keysends:(yield e.client.multiPayKeysend({keysends:n.map((a,u)=>Te({},Co(a),{id:u.toString()}))})).keysends.map(a=>{const u=n[parseInt(a.dTag)];if(!u)throw new Error("Could not find keysend matching response d tag");return{keysend:u,preimage:a.preimage}}),errors:[]};return e.notify("multiKeysend",i),i})()}lnurl(n){throw new Error("Method not implemented.")}request(n,e){throw new Error("Method not implemented.")}verifyMessage(n,e){throw new Error("Method not implemented.")}checkEnabled(){var n=this;return(0,v.A)(function*(){if(!n._enabled)throw new Error("please call enable() and await the promise before calling this function")})()}}function kl(t){return Te({},t,{amount:Math.floor(t.amount/1e3),fees_paid:t.fees_paid?Math.floor(t.fees_paid/1e3):0})}function Co(t){return{amount:1e3*+t.amount,pubkey:t.destination,tlv_records:t.customRecords?Object.entries(t.customRecords).map(n=>({type:parseInt(n[0]),value:yo((new TextEncoder).encode(n[1]))})):[]}}const Sl=ur;function Ao(t){const n={};return t.recipient.customKey&&t.recipient.customValue&&(n[t.recipient.customKey]=t.recipient.customValue),n[7629169]=JSON.stringify(t.boostagram),{destination:t.recipient.address,amount:t.amount,custom_records:n}}class To{constructor(n,e){this.auth=void 0,this.defaultRequestOptions=void 0,this.auth="string"==typeof n?new Eo(n):n,this.defaultRequestOptions=Te({},e,{user_agent:e?.user_agent})}accountBalance(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/balance",params:n,method:"GET"}))}accountSummary(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/user/summary",params:n,method:"GET"}))}accountInformation(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/user/me",params:n,method:"GET"}))}accountValue4Value(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/user/value4value",params:n,method:"GET"}))}incomingInvoices(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/invoices/incoming",params:n,method:"GET"}))}outgoingInvoices(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/invoices/outgoing",params:n,method:"GET"}))}invoices(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/invoices",params:n,method:"GET"}))}getInvoice(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:`/invoices/${n}`,method:"GET"}))}decodeInvoice(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:`/decode/bolt11/${n}`,method:"GET"}))}createInvoice(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/invoices",request_body:n,method:"POST"}))}keysend(n,e){let r,i;return Array.isArray(n)?(r="/payments/keysend/multi",i={keysends:n.map(a=>Te({},a,{custom_records:a.customRecords}))}):(r="/payments/keysend",i=Te({},n,{custom_records:n.customRecords})),wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:r,request_body:i,method:"POST"}))}sendPayment(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/payments/bolt11",request_body:n,method:"POST"}))}sendBoostagram(n,e){let r,i;return Array.isArray(n)?(r="/payments/keysend/multi",i={keysends:n.map(a=>Ao(a))}):(r="/payments/keysend",i=Ao(n)),wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:r,request_body:i,method:"POST"}))}sendToAlbyAccount(n,e){return console.warn("sendToAlbyAccount is deprecated. Please use sendBoostagramToAlbyAccount instead."),this.sendBoostagramToAlbyAccount(n,e)}sendBoostagramToAlbyAccount(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/payments/keysend",request_body:{destination:"030a58b8653d32b99200a2334cfe913e51dc7d155aa0116c176657a4f1722677a3",custom_records:{696969:n.account},amount:n.amount,memo:n.memo},method:"POST"}))}createWebhookEndpoint(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/webhook_endpoints",request_body:n,method:"POST"}))}deleteWebhookEndpoint(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:`/webhook_endpoints/${n}`,method:"DELETE"}))}getSwapInfo(n){return wt(Te({auth:this.auth},this.defaultRequestOptions,n,{endpoint:"/swaps/info",method:"GET"}))}createSwap(n,e){return wt(Te({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/swaps",method:"POST",request_body:n}))}}var fr={__proto__:null,NostrWebLNProvider:ur,NWC:Sl,OauthWeblnProvider:class{constructor(t){this.client=void 0,this.auth=void 0,this.oauth=void 0,this.subscribers=void 0,this.isExecuting=void 0,this.auth=t.auth,this.client=new To(t.auth),this.oauth=!0,this.subscribers={},this.isExecuting=!1}on(t,n){this.subscribers[t]=n}notify(t,n){const e=this.subscribers[t];e&&e(n)}enable(){var t=this;return(0,v.A)(function*(){var n;if(!t.isExecuting){if(null!=(n=t.auth.token)&&n.access_token)return{enabled:!0};if(typeof window>"u"||void 0===window.document)throw new Error("Missing access token");try{t.isExecuting=!0,yield t.openAuthorization()}finally{t.isExecuting=!1}}})()}sendPayment(t){var n=this;return(0,v.A)(function*(){if(!n.isExecuting)try{n.isExecuting=!0;const e=yield n.client.sendPayment({invoice:t});return n.notify("sendPayment",e),{preimage:e.payment_preimage}}catch(e){let r="Unknown Error";throw e instanceof Error&&(r=e.message),new Error(r)}finally{n.isExecuting=!1}})()}keysend(t){var n=this;return(0,v.A)(function*(){if(!n.isExecuting)try{n.isExecuting=!0;const e=yield n.client.keysend(t);return n.notify("keysend",e),{preimage:e.payment_preimage}}catch(e){let r="Unknown Error";throw e instanceof Error&&(r=e.message),new Error(r)}finally{n.isExecuting=!1}})()}getInfo(){return(0,v.A)(function*(){return{alias:"Alby"}})()}makeInvoice(t){var n=this;return(0,v.A)(function*(){if(!n.isExecuting)try{n.isExecuting=!0;const e=yield n.client.createInvoice({amount:parseInt(t.amount.toString()),description:t.defaultMemo});return n.notify("makeInvoice",e),{paymentRequest:e.payment_request}}catch(e){let r="Unknown Error";throw e instanceof Error&&(r=e.message),new Error(r)}finally{n.isExecuting=!1}})()}openAuthorization(){var t=this;return(0,v.A)(function*(){var n=t;const e=window.outerHeight/2+window.screenY-350,r=window.outerWidth/2+window.screenX-300,i=yield t.auth.generateAuthURL({code_challenge_method:"S256"});return new Promise((a,u)=>{const f=window.open(i,`${document.title} - WebLN enable`,`height=700,width=600,top=${e},left=${r}`);let g=!1;window.addEventListener("message",function(){var m=(0,v.A)(function*(S){const C=S.data;if(C&&"alby:oauth:success"===C.type&&S.origin===`${document.location.protocol}//${document.location.host}`&&!g){g=!0,console.info("Processing OAuth code response");const F=C.payload.code;try{yield n.auth.requestAccessToken(F),n.client=new To(n.auth),f&&f.close(),n.notify("enable"),a({enabled:!0})}catch(L){console.error(L),u({enabled:!1})}}});return function(S){return m.apply(this,arguments)}}())})})()}}},vi=M(5416);class Cl{constructor(n,e){this._document=e;const r=this._textarea=this._document.createElement("textarea"),i=r.style;i.position="fixed",i.top=i.opacity="0",i.left="-999em",r.setAttribute("aria-hidden","true"),r.value=n,r.readOnly=!0,(this._document.fullscreenElement||this._document.body).appendChild(r)}copy(){const n=this._textarea;let e=!1;try{if(n){const r=this._document.activeElement;n.select(),n.setSelectionRange(0,n.value.length),e=this._document.execCommand("copy"),r&&r.focus()}}catch{}return e}destroy(){const n=this._textarea;n&&(n.remove(),this._textarea=void 0)}}let Io=(()=>{class t{constructor(e){this._document=e}copy(e){const r=this.beginCopy(e),i=r.copy();return r.destroy(),i}beginCopy(e){return new Cl(e,this._document)}static#e=this.\u0275fac=function(r){return new(r||t)(o.KVO(h.qQ))};static#t=this.\u0275prov=o.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Al(t,n){if(1&t){const e=o.RV6();o.j41(0,"button",10),o.bIt("click",function(){const i=o.eBV(e).$implicit,a=o.XpG(2);return o.Njj(a.invoiceAmount=i.value)}),o.j41(1,"mat-icon"),o.EFF(2),o.k0s(),o.j41(3,"span"),o.EFF(4),o.k0s()()}if(2&t){const e=n.$implicit;o.R7$(2),o.JRh(e.icon),o.R7$(2),o.JRh(e.label)}}function Tl(t,n){if(1&t){const e=o.RV6();o.j41(0,"mat-dialog-content")(1,"div",4),o.DNE(2,Al,5,2,"button",5),o.k0s(),o.nrm(3,"mat-divider"),o.j41(4,"mat-form-field",6)(5,"mat-label"),o.EFF(6,"Zap Amount"),o.k0s(),o.j41(7,"input",7),o.mxI("ngModelChange",function(i){o.eBV(e);const a=o.XpG();return o.DH7(a.invoiceAmount,i)||(a.invoiceAmount=i),o.Njj(i)}),o.k0s()(),o.j41(8,"mat-dialog-actions",8)(9,"button",9),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.generateInvoice())}),o.EFF(10," Generate Invoice "),o.k0s()()()}if(2&t){const e=o.XpG();o.R7$(2),o.Y8G("ngForOf",e.zapButtons),o.R7$(5),o.R50("ngModel",e.invoiceAmount)}}function Il(t,n){if(1&t){const e=o.RV6();o.j41(0,"div",12)(1,"span"),o.EFF(2),o.k0s(),o.nrm(3,"mat-divider")(4,"qrcode",13),o.j41(5,"mat-dialog-actions",14)(6,"button",15),o.bIt("click",function(){o.eBV(e);const i=o.XpG(2);return o.Njj(i.copyInvoice())}),o.nrm(7,"mat-icon",16),o.k0s()()()}if(2&t){const e=o.XpG(2);o.R7$(2),o.SpI("Scan with phone to pay (",e.invoiceAmount," sats)"),o.R7$(2),o.Y8G("qrdata",e.lightningInvoice)("matTooltip","Lightning Invoice")("errorCorrectionLevel","M"),o.R7$(2),o.Y8G("matTooltip","Copy Invoice"),o.R7$(),o.Y8G("svgIcon","heroicons_outline:clipboard-document")}}function Rl(t,n){if(1&t&&(o.j41(0,"mat-dialog-content"),o.DNE(1,Il,8,6,"div",11),o.k0s()),2&t){const e=o.XpG();o.R7$(),o.Y8G("ngIf",e.displayQRCode)}}let Bl=(()=>{class t{constructor(e,r,i){this.dialogRef=e,this.snackBar=r,this.clipboard=i,this.invoiceAmount="",this.lightningInvoice="",this.displayQRCode=!1,this.zapButtons=[{icon:"thumb_up",label:"50",value:50},{icon:"favorite",label:"100",value:100},{icon:"emoji_emotions",label:"500",value:500},{icon:"star",label:"1k",value:1e3},{icon:"celebration",label:"5k",value:5e3},{icon:"rocket",label:"10k",value:1e4},{icon:"local_fire_department",label:"100k",value:1e5},{icon:"flash_on",label:"500k",value:5e5},{icon:"diamond",label:"1M",value:1e6}]}generateInvoice(){var e=this;return(0,v.A)(function*(){if(!e.invoiceAmount||Number(e.invoiceAmount)<=0)e.openSnackBar("Please enter a valid amount","dismiss");else try{e.nwc=new fr.NostrWebLNProvider({nostrWalletConnectUrl:yield e.loadNWCUrl()}),yield e.nwc.enable();const r=yield e.nwc.makeInvoice({amount:Number(e.invoiceAmount)});e.lightningInvoice=r.paymentRequest,e.showQRCode()}catch(r){console.error("Error generating invoice:",r),e.openSnackBar("Failed to generate invoice","dismiss")}})()}loadNWCUrl(){return(0,v.A)(function*(){try{const e=fr.NostrWebLNProvider.withNewSecret();return yield e.initNWC({name:"Angor Hub"}),e.getNostrWalletConnectUrl()}catch(e){throw console.error("Error initializing NWC:",e),new Error("Failed to initialize NWC provider")}})()}showQRCode(){this.displayQRCode=!this.displayQRCode}copyInvoice(){this.lightningInvoice?(this.clipboard.copy(this.lightningInvoice),this.openSnackBar("Invoice copied","dismiss")):this.openSnackBar("No invoice available to copy","dismiss")}openSnackBar(e,r){this.snackBar.open(e,r,{duration:1300})}closeDialog(){this.dialogRef.close()}static#e=this.\u0275fac=function(r){return new(r||t)(o.rXU(Tt.CP),o.rXU(vi.UG),o.rXU(Io))};static#t=this.\u0275cmp=o.VBU({type:t,selectors:[["app-receive-dialog"]],standalone:!0,features:[o.aNF],decls:7,vars:4,consts:[[1,"absolute","right-0","top-0","pr-4","pt-4"],["mat-icon-button","",3,"matDialogClose"],[1,"text-secondary",3,"svgIcon"],[4,"ngIf"],[1,"preset-buttons"],["mat-mini-fab","","color","primary",3,"click",4,"ngFor","ngForOf"],["appearance","outline",1,"sats-input"],["matInput","","placeholder","e.g., 100","type","number",3,"ngModelChange","ngModel"],["align","end"],["mat-raised-button","","color","primary",3,"click"],["mat-mini-fab","","color","primary",3,"click"],["class","qrcode",4,"ngIf"],[1,"qrcode"],[1,"qrcode-image",3,"qrdata","matTooltip","errorCorrectionLevel"],["align","center"],["mat-icon-button","",3,"click","matTooltip"],[3,"svgIcon"]],template:function(r,i){1&r&&(o.j41(0,"div",0)(1,"button",1),o.nrm(2,"mat-icon",2),o.k0s()(),o.j41(3,"h2"),o.EFF(4,"\u26a1 Receive Zap"),o.k0s(),o.DNE(5,Tl,11,2,"mat-dialog-content",3)(6,Rl,2,1,"mat-dialog-content",3)),2&r&&(o.R7$(),o.Y8G("matDialogClose",void 0),o.R7$(),o.Y8G("svgIcon","heroicons_outline:x-mark"),o.R7$(3),o.Y8G("ngIf",!i.displayQRCode),o.R7$(),o.Y8G("ngIf",i.displayQRCode))},dependencies:[Ke.vg,B.Hl,B.$z,B.iY,B.$0,oe.m_,oe.An,T.YN,T.me,T.Q0,T.BC,T.vS,$.nJ,$.rl,T.X1,h.MD,h.Sq,h.bT,Ye.Ve,$.RG,le.fS,le.fg,Tt.Yi,Tt.E7,we,de,U.q,D.oV,Tt.tx],styles:[".preset-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;justify-items:center;margin-bottom:20px}.preset-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px;font-weight:700;width:70px;height:60px;display:flex;flex-direction:column;align-items:center;justify-content:center;max-height:60px!important}.sats-input[_ngcontent-%COMP%]{margin-top:20px;width:100%}.lightning-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;margin:10px 0}.qrcode[_ngcontent-%COMP%]{text-align:center}.qrcode-image[_ngcontent-%COMP%]{width:100%!important}"]})}return t})();for(var Ro=M(1146),Ul=M(3838),zt=M(917),Bo={bech32:"bc",pubKeyHash:0,scriptHash:5,validWitnessVersions:[0]},Uo={bech32:"tb",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},No={bech32:"tbs",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},Po={bech32:"bcrt",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},Lo={bech32:"sb",pubKeyHash:63,scriptHash:123,validWitnessVersions:[0]},Nn=["option_data_loss_protect","initial_routing_sync","option_upfront_shutdown_script","gossip_queries","var_onion_optin","gossip_queries_ex","option_static_remotekey","payment_secret","basic_mpp","option_support_large_channel"],Nl={m:new zt.BN(1e3,10),u:new zt.BN(1e6,10),n:new zt.BN(1e9,10),p:new zt.BN(1e12,10)},Pl=new zt.BN("2100000000000000000",10),Oo=new zt.BN(1e11,10),yi={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27},jo={},hr=0,wi=Object.keys(yi);hr<wi.length;hr++){var Ll=wi[hr],Ol=yi[wi[hr]].toString();jo[Ol]=Ll}var jl={1:function(t){return Qt(t,!0)},16:function(t){return Qt(t,!0)},13:function(t){return Qt(t,!0).toString("utf8")},19:function(t){return Qt(t,!0)},23:function(t){return Qt(t,!0)},27:function(t){return Qt(t,!0)},6:dr,24:dr,3:function $l(t){for(var e,r,i,a,u,n=[],f=Qt(t,!0);f.length>0;)e=f.slice(0,33).toString("hex"),r=f.slice(33,41).toString("hex"),i=parseInt(f.slice(41,45).toString("hex"),16),a=parseInt(f.slice(45,49).toString("hex"),16),u=parseInt(f.slice(49,51).toString("hex"),16),f=f.slice(51),n.push({pubkey:e,short_channel_id:r,fee_base_msat:i,fee_proportional_millionths:a,cltv_expiry_delta:u});return n},5:function ql(t){for(var n=t.slice().reverse().map(function(i){return[!!(1&i),!!(2&i),!!(4&i),!!(8&i),!!(16&i)]}).reduce(function(i,a){return i.concat(a)},[]);n.length<2*Nn.length;)n.push(!1);var e={extra_bits:{}};if(Nn.forEach(function(i,a){var u;n[2*a]?u="required":n[2*a+1]&&(u="supported"),e[i]=u}),n.length>2*Nn.length){var r=n.slice(2*Nn.length);e.extra_bits={start_bit:2*Nn.length,bits:r,required:r.reduce(function(i,a,u){return u%2!=0?i||!1:i||a},!1)}}return e}};function Fl(t){return function(n){return{tagCode:parseInt(t),words:Ro.encode("unknown",n,Number.MAX_SAFE_INTEGER)}}}function dr(t){return t.reverse().reduce(function(n,e,r){return n+e*Math.pow(32,r)},0)}function Qt(t,n){var e=Ul.hp.from(function Dl(t,n,e){for(var r=0,i=0,a=(1<<e)-1,u=[],f=0;f<t.length;++f)for(r=r<<n|t[f],i+=n;i>=e;)u.push(r>>(i-=e)&a);return i>0&&u.push(r<<e-i&a),u}(t,5,8));return n&&5*t.length%8!=0&&(e=e.slice(0,-1)),e}var bi=M(7673),_i=M(9437),Hl=M(1626);let Fo=(()=>{class t{constructor(e){this.http=e}getLightning(e){return this.http.get(e).pipe((0,_i.W)(r=>(console.error("Failed to fetch Lightning response:",r),(0,bi.of)({status:"Failed"}))))}getLightningInvoice(e,r){return this.http.get(`${e}?amount=${r}`).pipe((0,_i.W)(a=>(console.error("Failed to fetch Lightning invoice:",a),(0,bi.of)({pr:"",status:"Failed"}))))}getLightningAddress(e){try{const[r,i]=e.split("@");return`https://${i}/.well-known/lnurlp/${r}`}catch{return console.error("Invalid Lightning address format:",e),""}}sendZapRequest(e,r,i,a){const u=encodeURIComponent(JSON.stringify(r));return this.http.get(`${e}?amount=${i}&nostr=${u}&lnurl=${a}`).pipe((0,_i.W)(g=>(console.error("Failed to send zap request:",g),(0,bi.of)({pr:"",status:"Failed"}))))}login(){return(0,v.A)(function*(){try{return window.webln&&!window.webln.isEnabled()&&(yield window.webln.enable()),!0}catch(e){return console.error("WebLN login failed:",e),!1}})()}hasWebln(){return!!window.webln}sendPayment(e){var r=this;return(0,v.A)(function*(){try{return r.hasWebln()?yield window.webln.sendPayment(e):(console.error("WebLN is not available"),null)}catch(i){throw console.error("Payment failed:",i),i}})()}payInvoice(e){var r=this;return(0,v.A)(function*(){if((yield r.login())&&r.hasWebln())try{return!!(yield r.sendPayment(e))}catch(a){return console.error("Failed to pay invoice:",a),!1}return console.error("WebLN not available or login failed"),!1})()}static#e=this.\u0275fac=function(r){return new(r||t)(o.KVO(Hl.Qq))};static#t=this.\u0275prov=o.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Wl(t,n){if(1&t){const e=o.RV6();o.j41(0,"button",10),o.bIt("click",function(){const i=o.eBV(e).$implicit,a=o.XpG(2);return o.Njj(a.sats=i.value)}),o.j41(1,"mat-icon"),o.EFF(2),o.k0s(),o.j41(3,"span"),o.EFF(4),o.k0s()()}if(2&t){const e=n.$implicit;o.R7$(2),o.JRh(e.icon),o.R7$(2),o.JRh(e.label)}}function Vl(t,n){if(1&t){const e=o.RV6();o.j41(0,"mat-dialog-content")(1,"div",4),o.DNE(2,Wl,5,2,"button",5),o.k0s(),o.nrm(3,"mat-divider"),o.j41(4,"mat-form-field",6)(5,"mat-label"),o.EFF(6,"Zap Amount"),o.k0s(),o.j41(7,"input",7),o.mxI("ngModelChange",function(i){o.eBV(e);const a=o.XpG();return o.DH7(a.sats,i)||(a.sats=i),o.Njj(i)}),o.k0s()(),o.j41(8,"mat-dialog-actions",8)(9,"button",9),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.sendZap())}),o.EFF(10," Create invoice "),o.k0s()()()}if(2&t){const e=o.XpG();o.R7$(2),o.Y8G("ngForOf",e.zapButtons),o.R7$(5),o.R50("ngModel",e.sats)}}function Yl(t,n){if(1&t&&(o.j41(0,"div",16)(1,"span"),o.EFF(2),o.k0s(),o.nrm(3,"mat-divider")(4,"qrcode",17),o.k0s()),2&t){const e=o.XpG(2);o.R7$(2),o.SpI("Scan with phone to pay (",e.invoiceAmount," sats)"),o.R7$(2),o.Y8G("qrdata",e.lightningInvoice)("matTooltip","Lightning Invoice")("errorCorrectionLevel","M")}}function Kl(t,n){if(1&t){const e=o.RV6();o.j41(0,"mat-dialog-content"),o.DNE(1,Yl,5,4,"div",11),o.j41(2,"mat-dialog-actions",12)(3,"button",13),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.copyInvoice())}),o.nrm(4,"mat-icon",14),o.k0s(),o.j41(5,"button",13),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.payInvoice())}),o.nrm(6,"mat-icon",15),o.k0s()()()}if(2&t){const e=o.XpG();o.R7$(),o.Y8G("ngIf",e.displayQRCode),o.R7$(2),o.Y8G("matTooltip","Copy Invoice"),o.R7$(),o.Y8G("svgIcon","heroicons_outline:clipboard-document"),o.R7$(),o.Y8G("matTooltip","Pay Invoice"),o.R7$(),o.Y8G("svgIcon","feather:zap")}}let Zl=(()=>{class t{constructor(e,r,i,a,u){this.dialogRef=e,this.metadata=r,this.lightning=i,this.snackBar=a,this.clipboard=u,this.lightningInvoice="",this.showInvoiceSection=!1,this.displayQRCode=!1,this.invoiceAmount="?",this.zapButtons=[{icon:"thumb_up",label:"50",value:50},{icon:"favorite",label:"100",value:100},{icon:"emoji_emotions",label:"500",value:500},{icon:"star",label:"1k",value:1e3},{icon:"celebration",label:"5k",value:5e3},{icon:"rocket",label:"10k",value:1e4},{icon:"local_fire_department",label:"100k",value:1e5},{icon:"flash_on",label:"500k",value:5e5},{icon:"diamond",label:"1M",value:1e6}],this.getLightningInfo()}getLightningInfo(){let e="";if(this.metadata?.lud06){const{words:r}=K.I.decode(this.metadata.lud06,5e3),i=new Uint8Array(K.I.fromWords(r));e=(new TextDecoder).decode(Uint8Array.from(i))}else if(this.metadata?.lud16?.toLowerCase().startsWith("lnurl")){const{words:r}=K.I.decode(this.metadata.lud16,5e3),i=new Uint8Array(K.I.fromWords(r));e=(new TextDecoder).decode(Uint8Array.from(i))}else this.metadata?.lud16&&(e=this.lightning.getLightningAddress(this.metadata.lud16));""!==e?this.lightning.getLightning(e).subscribe(r=>{this.lightningResponse=r,"Failed"===this.lightningResponse.status?this.openSnackBar("Failed to lookup lightning address","dismiss"):this.lightningResponse.callback?this.showInvoiceSection=!0:this.openSnackBar("Couldn't find user's lightning address","dismiss")}):this.openSnackBar("No lightning address found","dismiss")}getLightningInvoice(e){var r=this;this.lightningResponse&&this.lightningResponse.callback&&this.lightning.getLightningInvoice(this.lightningResponse.callback,e).subscribe(function(){var i=(0,v.A)(function*(a){r.lightningInvoice=a.pr,r.setInvoiceAmount(r.lightningInvoice),r.showInvoiceSection=!0,r.showQRCode()});return function(a){return i.apply(this,arguments)}}())}setInvoiceAmount(e){if(e){const i=function zl(t,n){if("string"!=typeof t)throw new Error("Lightning Payment Request must be string");if("ln"!==t.slice(0,2).toLowerCase())throw new Error("Not a proper lightning payment request");var e=[],r=Ro.decode(t,Number.MAX_SAFE_INTEGER);t=t.toLowerCase();var i=r.prefix,a=r.words,u=t.slice(i.length+1),f=a.slice(-104);a=a.slice(0,-104);var g=i.match(/^ln(\S+?)(\d*)([a-zA-Z]?)$/);if(g&&!g[2]&&(g=i.match(/^ln(\S+)$/)),!g)throw new Error("Not a proper lightning payment request");e.push({name:"lightning_network",letters:"ln"});var S,m=g[1];if(n){if(void 0===n.bech32||void 0===n.pubKeyHash||void 0===n.scriptHash||!Array.isArray(n.validWitnessVersions))throw new Error("Invalid network");S=n}else switch(m){case Bo.bech32:S=Bo;break;case Uo.bech32:S=Uo;break;case No.bech32:S=No;break;case Po.bech32:S=Po;break;case Lo.bech32:S=Lo}if(!S||S.bech32!==m)throw new Error("Unknown coin bech32 prefix");e.push({name:"coin_network",letters:m,value:S});var F,C=g[2];C?(F=function Gl(t,n){var e,r;if(t.slice(-1).match(/^[munp]$/))e=t.slice(-1),r=t.slice(0,-1);else{if(t.slice(-1).match(/^[^munp0-9]$/))throw new Error("Not a valid multiplier for the amount");r=t}if(!r.match(/^\d+$/))throw new Error("Not a valid human readable amount");var i=new zt.BN(r,10),a=e?i.mul(Oo).div(Nl[e]):i.mul(Oo);if("p"===e&&!i.mod(new zt.BN(10,10)).eq(new zt.BN(0,10))||a.gt(Pl))throw new Error("Amount is outside of valid range");return n?a.toString():a}(C+g[3],!0),e.push({name:"amount",letters:g[2]+g[3],value:F})):F=null,e.push({name:"separator",letters:"1"});var I,j,q,W,P=dr(a.slice(0,7));for(a=a.slice(7),e.push({name:"timestamp",letters:u.slice(0,7),value:P}),u=u.slice(7);a.length>0;){var X=a[0].toString();I=jo[X]||"unknown_tag",j=jl[X]||Fl(X),q=dr((a=a.slice(1)).slice(0,2)),W=(a=a.slice(2)).slice(0,q),a=a.slice(q),e.push({name:I,tag:u[0],letters:u.slice(0,3+q),value:j(W)}),u=u.slice(3+q)}e.push({name:"signature",letters:u.slice(0,104),value:Qt(f,!0)}),u=u.slice(104),e.push({name:"checksum",letters:u});var V={paymentRequest:t,sections:e,get expiry(){var J=e.find(function(Q){return"expiry"===Q.name});if(J)return Y("timestamp")+J.value},get route_hints(){return e.filter(function(J){return"route_hint"===J.name}).map(function(J){return J.value})}},ee=function(J){if("route_hint"===J)return"continue";Object.defineProperty(V,J,{get:function(){return Y(J)}})};for(var G in yi)ee(G);return V;function Y(J){var Q=e.find(function(pe){return pe.name===J});return Q?Q.value:void 0}}(e).sections.find(a=>"amount"===a.name);i&&(this.invoiceAmount=String(Number(i.value)/1e3))}}showQRCode(){this.displayQRCode=!this.displayQRCode}sendZap(){this.getLightningInvoice(String(1e3*Number(this.sats)))}payInvoice(){var e=this;return(0,v.A)(function*(){if(!e.lightningInvoice)return void console.error("Lightning invoice is not set");const r=new fr.NostrWebLNProvider({nostrWalletConnectUrl:yield e.loadNWCUrl()});r.enable().then(()=>r.sendPayment(e.lightningInvoice)).then(i=>{i&&i.preimage?(console.log(`Payment successful, preimage: ${i.preimage}`),e.openSnackBar("Zapped!","dismiss"),e.dialogRef.close()):e.listenForPaymentStatus(r)}).catch(i=>{console.error("Payment failed:",i),e.openSnackBar("Failed to pay invoice","dismiss"),e.listenForPaymentStatus(r)})})()}loadNWCUrl(){const e=fr.NostrWebLNProvider.withNewSecret();return e.initNWC({name:"Angor Hub"}).then(()=>e.getNostrWalletConnectUrl()).catch(r=>{throw console.error("Error initializing NWC:",r),r})}listenForPaymentStatus(e){const r=()=>{e.sendPayment(this.lightningInvoice).then(i=>{i&&i.preimage?(console.log("Payment confirmed, preimage:",i.preimage),this.openSnackBar("Payment confirmed!","dismiss"),this.dialogRef.close()):setTimeout(r,5e3)}).catch(i=>{console.error("Error checking payment status:",i),setTimeout(r,5e3)})};r()}copyInvoice(){this.lightningInvoice?(this.clipboard.copy(this.lightningInvoice),this.openSnackBar("Invoice copied","dismiss")):this.openSnackBar("No invoice available to copy","dismiss")}openSnackBar(e,r){this.snackBar.open(e,r,{duration:1300})}closeDialog(){this.dialogRef.close()}static#e=this.\u0275fac=function(r){return new(r||t)(o.rXU(Tt.CP),o.rXU(Tt.Vh),o.rXU(Fo),o.rXU(vi.UG),o.rXU(Io))};static#t=this.\u0275cmp=o.VBU({type:t,selectors:[["app-send-dialog"]],standalone:!0,features:[o.aNF],decls:7,vars:4,consts:[[1,"absolute","right-0","top-0","pr-4","pt-4"],["mat-icon-button","",3,"matDialogClose"],[1,"text-secondary",3,"svgIcon"],[4,"ngIf"],[1,"preset-buttons"],["mat-mini-fab","","color","primary",3,"click",4,"ngFor","ngForOf"],["appearance","outline",1,"sats-input"],["matInput","","placeholder","e.g., 100","type","number",3,"ngModelChange","ngModel"],["align","end"],["mat-raised-button","","color","primary",3,"click"],["mat-mini-fab","","color","primary",3,"click"],["class","qrcode",4,"ngIf"],["align","center"],["mat-icon-button","",3,"click","matTooltip"],[3,"svgIcon"],["color","#f79318",3,"svgIcon"],[1,"qrcode"],[1,"qrcode-image",3,"qrdata","matTooltip","errorCorrectionLevel"]],template:function(r,i){1&r&&(o.j41(0,"div",0)(1,"button",1),o.nrm(2,"mat-icon",2),o.k0s()(),o.j41(3,"h1"),o.EFF(4,"\u26a1 Send Zap"),o.k0s(),o.DNE(5,Vl,11,2,"mat-dialog-content",3)(6,Kl,7,5,"mat-dialog-content",3)),2&r&&(o.R7$(),o.Y8G("matDialogClose",void 0),o.R7$(),o.Y8G("svgIcon","heroicons_outline:x-mark"),o.R7$(3),o.Y8G("ngIf",!i.showInvoiceSection||!i.lightningInvoice),o.R7$(),o.Y8G("ngIf",i.showInvoiceSection&&i.lightningInvoice))},dependencies:[Ke.vg,B.Hl,B.$z,B.iY,B.$0,oe.m_,oe.An,T.YN,T.me,T.Q0,T.BC,T.vS,$.nJ,$.rl,T.X1,h.MD,h.Sq,h.bT,Ye.Ve,$.RG,le.fS,le.fg,Tt.Yi,Tt.E7,we,de,U.q,D.oV,Tt.tx],styles:[".preset-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;justify-items:center;margin-bottom:20px}.preset-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px;font-weight:700;width:70px;height:60px;display:flex;flex-direction:column;align-items:center;justify-content:center;max-height:60px!important}.sats-input[_ngcontent-%COMP%]{margin-top:20px;width:100%}.lightning-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;margin:10px 0}.qrcode[_ngcontent-%COMP%]{text-align:center}.qrcode-image[_ngcontent-%COMP%]{width:100%!important}"]})}return t})();var Do=M(2827),Ei=M(4930),Xl=M(7291),$o=M(6231),qo=M(7343);let Ql=(()=>{class t{constructor(e,r,i){this.relayService=e,this.signerService=r,this.queueService=i,this.followersSubject=new Ge.B,this.followingSubject=new Ge.B}getFollowersObservable(){return this.followersSubject.asObservable()}getFollowingObservable(){return this.followingSubject.asObservable()}getFollowers(e){var r=this;return(0,v.A)(function*(){const i=[{kinds:[3],"#p":[e]}],a=[];return new Promise((u,f)=>{r.queueService.addRequestToQueue(i).subscribe({next:m=>{a.push(m),r.followersSubject.next(m)},error:m=>{console.error("Error fetching followers:",m),f(m)},complete:()=>{u(a)}})})})()}getFollowing(e){var r=this;return(0,v.A)(function*(){const i=[{kinds:[3],authors:[e]}],a=[];return new Promise((u,f)=>{r.queueService.addRequestToQueue(i).subscribe({next:m=>{m.tags.filter(C=>"p"===C[0]).forEach(C=>{a.push(C[1]),r.followingSubject.next(m)})},error:m=>{console.error("Error fetching following:",m),f(m)},complete:()=>{u(a)}})})})()}follow(e){var r=this;return(0,v.A)(function*(){const i=r.getFollowingList();if(i.includes(e))return void console.log(`Already following ${e}`);const a=[...i,e];r.setFollowingList(a);const u=r.signerService.getUnsignedEvent(3,a.map(f=>["p",f]),"");yield r.publishSignedEvent(u),console.log(`Now following ${e}`)})()}unfollow(e){var r=this;return(0,v.A)(function*(){const i=r.getFollowingList();if(!i.includes(e))return void console.log(`Not following ${e}`);const a=i.filter(f=>f!==e);r.setFollowingList(a);const u=r.signerService.getUnsignedEvent(3,a.map(f=>["p",f]),"");yield r.publishSignedEvent(u),console.log(`Unfollowed ${e}`)})()}publishSignedEvent(e){var r=this;return(0,v.A)(function*(){let a;if(yield r.signerService.isUsingExtension())a=yield r.signerService.signEventWithExtension(e);else{const u=yield r.signerService.getDecryptedSecretKey();if(!u)throw new Error("Secret key is missing. Unable to sign event.");a=r.signerService.getSignedEvent(e,u)}r.relayService.publishEventToWriteRelays(a)})()}getFollowingListAsTags(){const e=this.getFollowingList(),r=[],i=this.relayService.getConnectedRelays();return e.forEach(a=>{i.forEach(u=>{r.push(["p",a,u,localStorage.getItem(`${a}`)||""])})}),r}setFollowingListFromTags(e){const r=[];e.forEach(i=>{r.push(i[1])}),this.setFollowingList(r)}setFollowingList(e){const i=Array.from(new Set(e)).filter(a=>a).join(",");localStorage.setItem("following",i)}getFollowingList(){const e=localStorage.getItem("following");return null===e||""===e?[]:e.split(",").filter(i=>/[a-f0-9]{64}/.test(i))}static#e=this.\u0275fac=function(r){return new(r||t)(o.KVO($o.b),o.KVO(Ei.A),o.KVO(qo.F))};static#t=this.\u0275prov=o.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Jl=M(881),ec=M(9979),gr=M(5766);class tc{constructor(n,e,r,i,a,u,f=[]){this.username="",this.picture="/images/avatars/avatar-placeholder.png",this.replyCount=0,this.likeCount=0,this.zapCount=0,this.repostCount=0,this.likedByMe=!1,this.replies=[],this.likers=[],this.reposters=[],this.zappers=[],this.relatedEventIds=[],this.rootEventId="",this.replyToEventId="",this.mentions=[],this.hashtags=[],this.repostedByMe=!1,this.tags=[],this.isAReply=!1,this.kind=e,this.pubkey=r,this.content=i,this.noteId=a,this.createdAt=u,this.date=new Date(1e3*this.createdAt),this.fromNow=this.calculateTimeFromNow(this.date),this.tags=f,this.id=n}calculateTimeFromNow(n){const r=Math.floor(((new Date).getTime()-n.getTime())/1e3);return r<60?`${r} seconds ago`:r<3600?`${Math.floor(r/60)} minutes ago`:r<86400?`${Math.floor(r/3600)} hours ago`:r<2592e3?`${Math.floor(r/86400)} days ago`:r<31536e3?`${Math.floor(r/2592e3)} months ago`:`${Math.floor(r/31536e3)} years ago`}}var pr=M(7442),xi=M(4412),nc=M(3386);let rc=(()=>{class t{constructor(e,r,i,a){this.relayService=e,this.signerService=r,this.metadataService=i,this.queueService=a,this.eventsSubject=new xi.t([]),this.isLoading=new xi.t(!1),this.lastLoadedEventTime=null,this.pageSize=10,this.noMoreEvents=new xi.t(!1),this.seenEventIds=new Set,this.likesMap=new Map,this.repliesMap=new Map,this.zapsMap=new Map,this.repostsMap=new Map,this.hasLikedMap=new Map,this.hasRepostedMap=new Map,this.jobQueue=[],this.isProcessingQueue=!1,this.myLikedNoteIds=[]}subscribeToEvents(e){var r=this;return(0,v.A)(function*(){yield r.relayService.ensureConnectedRelays();const i=r.relayService.getConnectedRelays().slice(0,3);if(!i||0===i.length)return void console.error("No connected relays available.");const a=[{kinds:[1],authors:e,limit:r.pageSize},{"#p":e,limit:1}];r.relayService.getPool().subscribeMany(i,a,{onevent:f=>{r.isReply(f)||r.handleNewOrUpdatedEvent(f);const g=r.getParentEventId(f);switch(g&&r.enqueueJob(g),f.kind){case 7:case 9735:case 6:r.enqueueJob(g)}},oneose:()=>{}})})()}getParentEventId(e){const r=e.tags.find(i=>"e"===i[0]);return r?r[1]:null}handleNewOrUpdatedEvent(e){var r=this;return(0,v.A)(function*(){switch(e.kind){case 1:if(!r.seenEventIds.has(e.id)){r.seenEventIds.add(e.id);const i=yield r.createNewEvent(e);r.eventsSubject.next([i]),r.updateEventInSubject(e.id)}break;case 7:r.handleLikeEvent(e);break;case 9735:r.handleZapEvent(e);break;case 6:r.handleRepostEvent(e);break;case 4:r.handleReplyEvent(e)}})()}handleLikeEvent(e){const r=e.tags.find(i=>"e"===i[0])?.[1];if(r){const a=this.eventsSubject.getValue().find(u=>u.id===r);a&&(a.likeCount+=1,a.likers=[...a.likers||[],e.pubkey],this.eventsSubject.next([a]))}}handleZapEvent(e){const r=e.tags.find(i=>"e"===i[0])?.[1];if(r){const a=this.eventsSubject.getValue().find(u=>u.id===r);a&&(a.zapCount+=1,a.zappers=[...a.zappers||[],e.pubkey],this.eventsSubject.next([a]))}}handleRepostEvent(e){const r=e.tags.find(i=>"e"===i[0])?.[1];if(r){const a=this.eventsSubject.getValue().find(u=>u.id===r);a&&(a.repostCount+=1,a.reposters=[...a.reposters||[],e.pubkey],this.eventsSubject.next([a]))}}handleReplyEvent(e){var r=this;return(0,v.A)(function*(){const i=e.tags.find(a=>"e"===a[0])?.[1];if(i){const a=yield r.createNewEvent(e),f=r.eventsSubject.getValue().find(g=>g.id===i);f&&(f.replyCount+=1,f.replies=[...f.replies||[],a],r.eventsSubject.next([f]))}})()}isReply(e){return e.tags.filter(i=>"e"===i[0]||"p"===i[0]).length>0}getMyLikes(){var e=this;return(0,v.A)(function*(){const r={kinds:[7],authors:[e.signerService.getPublicKey()]};try{return(yield e.fetchFilteredEvents(r)).forEach(a=>{const u=a.tags.find(f=>"e"===f[0]);u&&e.myLikedNoteIds.push(u[1])}),e.myLikedNoteIds}catch(i){return console.error("Failed to get user likes:",i),[]}})()}loadMoreEvents(e){var r=this;return(0,v.A)(function*(){if(r.isLoading.value||r.noMoreEvents.value)return;r.isLoading.next(!0);const i={authors:e,kinds:[1],until:r.lastLoadedEventTime||Math.floor(Date.now()/1e3),limit:r.pageSize};try{const a=yield r.fetchFilteredEvents(i);if(a.length<r.pageSize&&r.noMoreEvents.next(!0),a.length>0){r.lastLoadedEventTime=a[a.length-1].created_at;const u=a.filter(g=>!r.seenEventIds.has(g.id)&&!r.isReply(g));u.forEach(g=>r.seenEventIds.add(g.id));const f=yield Promise.all(u.map(g=>r.createNewEvent(g)));r.eventsSubject.next([...r.eventsSubject.getValue(),...f].sort((g,m)=>m.createdAt-g.createdAt))}else r.noMoreEvents.next(!0)}catch(a){console.error("Error loading more events:",a)}finally{r.isLoading.next(!1)}})()}fetchFilteredEvents(e){var r=this;return(0,v.A)(function*(){return new Promise((i,a)=>{const u=new Map,f=[];r.queueService.addRequestToQueue([e]).subscribe({next:g=>{u.has(g.id)||(u.set(g.id,g),f.push(g))},error:g=>{console.error("Error fetching events:",g),a(g)},complete:()=>{console.log("All events fetched and completed"),i(f)}})})})()}createNewEvent(e){var r=this;return(0,v.A)(function*(){const i=new tc(e.id,e.kind,e.pubkey,e.content,e.id,e.created_at,e.tags);r.enqueueJob(e.id),yield r.processJobQueue(),i.likedByMe=r.myLikedNoteIds.includes(e.id);const a=yield r.metadataService.fetchMetadataWithCache(e.pubkey);return a&&(i.username=a.name||i.npub,i.picture=a.picture||"/images/avatars/avatar-placeholder.png"),i})()}enqueueJob(e){this.jobQueue.some(r=>r.eventId===e)||(this.jobQueue.push({eventId:e}),this.isProcessingQueue||this.processJobQueue())}processJobQueue(){var e=this;return(0,v.A)(function*(){if(e.isProcessingQueue)return;e.isProcessingQueue=!0;const r=[];for(;e.jobQueue.length>0||r.length>0;){for(;e.jobQueue.length>0&&r.length<10;){const i=e.jobQueue.shift();if(!i)break;yield e.delay(1e3);const a=e.processJobWithQueueService(i);r.push(a),a.then(()=>{r.splice(r.indexOf(a),1)}).catch(u=>{console.error("Error processing job:",u),r.splice(r.indexOf(a),1)})}yield Promise.race(r)}e.isProcessingQueue=!1})()}processJobWithQueueService(e){var r=this;return(0,v.A)(function*(){try{const i=yield r.fetchMultiFilterEvents(e.eventId);r.repliesMap.set(e.eventId,i.replies),r.likesMap.set(e.eventId,i.likers),r.zapsMap.set(e.eventId,i.zappers),r.repostsMap.set(e.eventId,i.reposters),r.updateEventInSubject(e.eventId)}catch(i){throw console.error("Error processing job with QueueService:",i),i}})()}delay(e){return new Promise(r=>setTimeout(r,e))}updateEventInSubject(e){const i=this.eventsSubject.getValue().map(a=>(a.id===e&&(a.replyCount=this.getRepliesCount(e),a.replies=this.repliesMap.get(e)||[],a.likeCount=this.getLikesCount(e),a.likers=this.likesMap.get(e)||[],a.zapCount=this.getZapsCount(e),a.zappers=this.zapsMap.get(e)||[],a.repostCount=this.getRepostsCount(e),a.reposters=this.repostsMap.get(e)||[]),a));this.eventsSubject.next(i)}fetchMultiFilterEvents(e){var r=this;return(0,v.A)(function*(){const i=[{"#e":[e],kinds:[1]},{"#e":[e],kinds:[7]},{"#e":[e],kinds:[9735]},{"#e":[e],kinds:[6]}],a=new Map,u=[],f=[],g=[],m=[],S=r.queueService.addRequestToQueue(i);return new Promise((C,F)=>{var L;S.subscribe({next:(L=(0,v.A)(function*(P){if(a.has(P.id)||a.set(P.id,P),1===P.kind){const I=yield r.createNewEvent(P);u.push(I)}else 7===P.kind?f.push(P.pubkey):9735===P.kind?g.push(P.pubkey):6===P.kind&&m.push(P.pubkey)}),function(I){return L.apply(this,arguments)}),error:L=>{console.error("Error fetching events:",L),F(L)},complete:()=>{C({replies:u,likers:f,zappers:g,reposters:m})}})})})()}getRepliesCount(e){return(this.repliesMap.get(e)||[]).length}getLikesCount(e){return(this.likesMap.get(e)||[]).length}getZapsCount(e){return(this.zapsMap.get(e)||[]).length}getRepostsCount(e){return(this.repostsMap.get(e)||[]).length}hasUserLiked(e){return this.hasLikedMap.get(e)||!1}hasUserReposted(e){return this.hasRepostedMap.get(e)||!1}getEventStream(){return this.eventsSubject.asObservable().pipe((0,nc.c)(1e3))}hasMoreEvents(){return this.noMoreEvents.asObservable()}sendTextEvent(e){var r=this;return(0,v.A)(function*(){if(e)try{const a=r.signerService.getUnsignedEvent(1,[],e);let u;if(r.signerService.isUsingSecretKey()){const f=yield r.signerService.getDecryptedSecretKey(),g=(0,gr.aT)(f);u=(0,pr.pC)(a,g)}else u=yield r.signerService.signEventWithExtension(a);yield r.relayService.publishEventToWriteRelays(u)}catch(i){console.error("Failed to send text event:",i)}})()}sendLikeEvent(e){var r=this;return(0,v.A)(function*(){if(e)try{const u=r.signerService.getUnsignedEvent(7,[["e",e.id],["p",e.pubkey]],"+");let f;if(r.signerService.isUsingSecretKey()){const g=yield r.signerService.getDecryptedSecretKey(),m=(0,gr.aT)(g);f=(0,pr.pC)(u,m)}else f=yield r.signerService.signEventWithExtension(u);yield r.relayService.publishEventToWriteRelays(f),r.likesMap.set(e.id,[...r.likesMap.get(e.id)||[],r.signerService.getPublicKey()]),r.hasLikedMap.set(e.id,!0)}catch(i){console.error("Failed to send like event:",i)}})()}sendZapEvent(e,r){var i=this;return(0,v.A)(function*(){if(e&&!(r<=0))try{const a=[["e",e.id],["p",e.pubkey],["amount",r.toString()]],f=i.signerService.getUnsignedEvent(9735,a,`Zapped with ${r} sats`);let g;if(i.signerService.isUsingSecretKey()){const m=yield i.signerService.getDecryptedSecretKey(),S=(0,gr.aT)(m);g=(0,pr.pC)(f,S)}else g=yield i.signerService.signEventWithExtension(f);yield i.relayService.publishEventToWriteRelays(g)}catch(a){console.error("Failed to send zap event:",a)}})()}sendReplyEvent(e,r){var i=this;return(0,v.A)(function*(){if(e)try{const u=i.signerService.getUnsignedEvent(1,[["e",e.id],["p",e.pubkey]],r);let f;if(i.signerService.isUsingSecretKey()){const g=yield i.signerService.getDecryptedSecretKey(),m=(0,gr.aT)(g);f=(0,pr.pC)(u,m)}else f=yield i.signerService.signEventWithExtension(u);yield i.relayService.publishEventToWriteRelays(f)}catch(a){console.error("Failed to send reply event:",a)}})()}clearEvents(){this.eventsSubject.next([]),this.seenEventIds.clear(),this.lastLoadedEventTime=null,this.noMoreEvents.next(!1)}static#e=this.\u0275fac=function(r){return new(r||t)(o.KVO($o.b),o.KVO(Ei.A),o.KVO(Do.T),o.KVO(qo.F))};static#t=this.\u0275prov=o.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var ic=M(2083),oc=M(5645);const sc=["eventInput"],ac=["commentInput"],lc=()=>["/explore"],cc=()=>["./"],uc=t=>({"heart-beat":t}),fc=t=>({"rotate-180":t});function hc(t,n){if(1&t&&(o.qex(0),o.nrm(1,"img",50),o.bVm()),2&t){const e=o.XpG();o.R7$(),o.FS9("alt",(null==e.profileUser?null:e.profileUser.display_name)||(null==e.profileUser?null:e.profileUser.name)||""),o.Y8G("src",e.getSafeUrl(null==e.profileUser?null:e.profileUser.picture),o.B4B)}}function dc(t,n){if(1&t&&o.nrm(0,"img",51),2&t){const e=o.XpG();o.FS9("alt",(null==e.profileUser?null:e.profileUser.display_name)||(null==e.profileUser?null:e.profileUser.name)||"")}}function gc(t,n){if(1&t){const e=o.RV6();o.j41(0,"div")(1,"button",52),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.toggleFollow())}),o.nrm(2,"mat-icon",53),o.k0s()()}if(2&t){const e=o.XpG();o.R7$(),o.Y8G("matTooltip",e.isFollowing?"Unfollow":"Follow"),o.R7$(),o.Y8G("svgIcon",e.isFollowing?"heroicons_outline:user-minus":"heroicons_outline:user-plus")}}function pc(t,n){if(1&t){const e=o.RV6();o.j41(0,"button",54),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.zap())}),o.j41(1,"span",39),o.nrm(2,"mat-icon",55),o.j41(3,"span"),o.EFF(4,"Send Zap"),o.k0s()()()}2&t&&(o.R7$(2),o.Y8G("svgIcon","feather:zap"))}function mc(t,n){if(1&t){const e=o.RV6();o.j41(0,"button",54),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.openReceiveZapDialog())}),o.j41(1,"span",39),o.nrm(2,"mat-icon",55),o.j41(3,"span"),o.EFF(4,"Receive Zap"),o.k0s()()()}2&t&&(o.R7$(2),o.Y8G("svgIcon","heroicons_outline:qr-code"))}function vc(t,n){1&t&&(o.j41(0,"button",56)(1,"span",39),o.nrm(2,"mat-icon",55),o.j41(3,"span"),o.EFF(4,"Edit your profile"),o.k0s()()()),2&t&&(o.Y8G("routerLink","/settings/profile"),o.R7$(2),o.Y8G("svgIcon","heroicons_outline:pencil-square"))}function yc(t,n){1&t&&(o.j41(0,"button",37)(1,"span",39),o.nrm(2,"mat-icon",55),o.j41(3,"span"),o.EFF(4,"Report"),o.k0s()()()),2&t&&(o.R7$(2),o.Y8G("svgIcon","heroicons_solid:exclamation-triangle"))}function wc(t,n){1&t&&(o.j41(0,"button",37)(1,"span",39),o.nrm(2,"mat-icon",55),o.j41(3,"span"),o.EFF(4,"Turn on notifications"),o.k0s()()()),2&t&&(o.R7$(2),o.Y8G("svgIcon","heroicons_solid:bell"))}function bc(t,n){if(1&t&&(o.j41(0,"angor-card",57)(1,"div",35),o.EFF(2,"About"),o.k0s(),o.j41(3,"div",58),o.EFF(4),o.k0s(),o.j41(5,"a",59),o.EFF(6," See complete about "),o.k0s()()),2&t){const e=o.XpG();o.R7$(4),o.SpI(" ",(null==e.profileUser?null:e.profileUser.about)||""," "),o.R7$(),o.Y8G("color","primary")("routerLink",o.lJ4(3,cc))}}function _c(t,n){if(1&t){const e=o.RV6();o.j41(0,"div",78)(1,"emoji-mart",79),o.bIt("emojiClick",function(i){o.eBV(e);const a=o.XpG(2);return o.Njj(a.addEmoji(i))}),o.k0s()()}if(2&t){const e=o.XpG(2);o.R7$(),o.Y8G("darkMode",e.darkMode)}}function Ec(t,n){if(1&t){const e=o.RV6();o.j41(0,"angor-card",60)(1,"div",61)(2,"div",62),o.EFF(3,"Create Post"),o.k0s(),o.j41(4,"mat-slide-toggle",63),o.bIt("change",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.togglePreview())}),o.EFF(5," Preview "),o.k0s()(),o.j41(6,"div",64)(7,"div",65),o.nrm(8,"img",66),o.j41(9,"div",67),o.EFF(10),o.k0s()(),o.j41(11,"mat-form-field",68),o.nrm(12,"textarea",69,3),o.k0s()(),o.j41(14,"div",70)(15,"div",39)(16,"button",71),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.toggleEmojiPicker())}),o.nrm(17,"mat-icon",25),o.j41(18,"span",72),o.EFF(19,"Feeling"),o.k0s()(),o.DNE(20,_c,2,1,"div",73),o.j41(21,"button",74),o.nrm(22,"mat-icon",25),o.j41(23,"span",72),o.EFF(24,"Media"),o.k0s()(),o.j41(25,"button",74),o.nrm(26,"mat-icon",25),o.j41(27,"span",72),o.EFF(28,"Tag"),o.k0s()(),o.j41(29,"button",75),o.nrm(30,"mat-icon",25),o.k0s(),o.j41(31,"mat-menu",null,4)(33,"button",76)(34,"span",39),o.nrm(35,"mat-icon",55),o.j41(36,"span"),o.EFF(37,"Tag"),o.k0s()()(),o.j41(38,"button",76)(39,"span",39),o.nrm(40,"mat-icon",55),o.j41(41,"span"),o.EFF(42,"Feeling"),o.k0s()()(),o.j41(43,"button",37)(44,"span",39),o.nrm(45,"mat-icon",55),o.j41(46,"span"),o.EFF(47,"Live"),o.k0s()()(),o.j41(48,"button",37)(49,"span",39),o.nrm(50,"mat-icon",55),o.j41(51,"span"),o.EFF(52,"Gif"),o.k0s()()(),o.j41(53,"button",37)(54,"span",39),o.nrm(55,"mat-icon",55),o.j41(56,"span"),o.EFF(57,"Check in"),o.k0s()()()()(),o.j41(58,"button",77),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.sendEvent())}),o.nrm(59,"mat-icon",25),o.j41(60,"span",72),o.EFF(61,"Send"),o.k0s()()()()}if(2&t){const e=o.sdS(32),r=o.XpG();o.R7$(4),o.Y8G("color","primary"),o.R7$(4),o.FS9("alt",(null==r.currentUser?null:r.currentUser.display_name)||(null==r.currentUser?null:r.currentUser.name)||"Avatar"),o.Y8G("src",(null==r.currentUser?null:r.currentUser.picture)||"images/avatars/avatar-placeholder.png",o.B4B),o.R7$(2),o.SpI(" ",(null==r.currentUser?null:r.currentUser.name)||"Unknown User"," "),o.R7$(),o.Y8G("subscriptSizing","dynamic"),o.R7$(),o.Y8G("placeholder","What's on your mind?")("rows",3),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:face-smile"),o.R7$(3),o.Y8G("ngIf",r.showEmojiPicker),o.R7$(2),o.Y8G("svgIcon","heroicons_solid:photo"),o.R7$(4),o.Y8G("svgIcon","heroicons_solid:user-circle"),o.R7$(3),o.Y8G("matMenuTriggerFor",e),o.R7$(),o.Y8G("svgIcon","heroicons_solid:ellipsis-horizontal"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:user-circle"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:face-smile"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:play"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:sparkles"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:map-pin"),o.R7$(4),o.Y8G("svgIcon","heroicons_solid:paper-airplane")}}function xc(t,n){if(1&t){const e=o.RV6();o.j41(0,"div",78)(1,"emoji-mart",79),o.bIt("emojiClick",function(i){o.eBV(e);const a=o.XpG(2);return o.Njj(a.addEmojiTocomment(i))}),o.k0s()()}if(2&t){const e=o.XpG(2);o.R7$(),o.Y8G("darkMode",e.darkMode)}}function Mc(t,n){if(1&t){const e=o.RV6();o.j41(0,"angor-card",80,5)(2,"div",81),o.nrm(3,"img",82),o.j41(4,"div",83)(5,"span",84),o.EFF(6),o.k0s(),o.j41(7,"span",85),o.EFF(8,"1 minutes ago"),o.k0s()(),o.j41(9,"button",86),o.nrm(10,"mat-icon",25),o.k0s(),o.j41(11,"mat-menu",null,6)(13,"button",37)(14,"span",39),o.nrm(15,"mat-icon",55),o.j41(16,"span"),o.EFF(17,"Save post"),o.k0s()()(),o.j41(18,"button",37)(19,"span",39),o.nrm(20,"mat-icon",55),o.j41(21,"span"),o.EFF(22,"Hide post"),o.k0s()()(),o.j41(23,"button",37)(24,"span",39),o.nrm(25,"mat-icon",55),o.j41(26,"span"),o.EFF(27,"Snooze for 30 days"),o.k0s()()(),o.j41(28,"button",37)(29,"span",39),o.nrm(30,"mat-icon",55),o.j41(31,"span"),o.EFF(32,"Hide all"),o.k0s()()(),o.nrm(33,"mat-divider",27),o.j41(34,"button",37)(35,"span",39),o.nrm(36,"mat-icon",55),o.j41(37,"span"),o.EFF(38,"Report post"),o.k0s()()(),o.j41(39,"button",37)(40,"span",39),o.nrm(41,"mat-icon",55),o.j41(42,"span"),o.EFF(43,"Turn on notifications for this post"),o.k0s()()()()(),o.j41(44,"div",87),o.EFF(45),o.k0s(),o.nrm(46,"div",88),o.j41(47,"div",89)(48,"button",71),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.toggleLike())}),o.nrm(49,"mat-icon",90),o.j41(50,"span",72),o.EFF(51),o.k0s()(),o.j41(52,"button",71),o.bIt("click",function(){o.eBV(e);const i=o.sdS(1);return o.Njj(i.expanded=!i.expanded)}),o.nrm(53,"mat-icon",25),o.j41(54,"span",72),o.EFF(55,"Comment"),o.k0s()(),o.j41(56,"button",91),o.nrm(57,"mat-icon",25),o.j41(58,"span",72),o.EFF(59,"Share"),o.k0s()()(),o.nrm(60,"hr",92),o.j41(61,"div",93)(62,"div",39),o.nrm(63,"img",94)(64,"img",95)(65,"img",95)(66,"img",95),o.j41(67,"div",96),o.EFF(68," You and 4 more liked this "),o.k0s()(),o.nrm(69,"div",97),o.j41(70,"div",98)(71,"button",99),o.EFF(72," 0 shares "),o.k0s(),o.j41(73,"button",100),o.bIt("click",function(){o.eBV(e);const i=o.sdS(1);return o.Njj(i.expanded=!i.expanded)}),o.j41(74,"span",101),o.EFF(75,"0 Comments"),o.k0s(),o.nrm(76,"mat-icon",102),o.k0s()()(),o.qex(77,103),o.nrm(78,"hr",104),o.j41(79,"div",105)(80,"div",106),o.nrm(81,"img",107),o.j41(82,"mat-form-field",68),o.nrm(83,"textarea",69,7),o.k0s()(),o.j41(85,"div",108)(86,"div",39)(87,"button",109),o.bIt("click",function(){o.eBV(e);const i=o.XpG();return o.Njj(i.toggleCommentEmojiPicker())}),o.nrm(88,"mat-icon",25),o.k0s(),o.DNE(89,xc,2,1,"div",73),o.j41(90,"button",110),o.nrm(91,"mat-icon",25),o.k0s(),o.j41(92,"button",110),o.nrm(93,"mat-icon",25),o.k0s()(),o.j41(94,"button",111),o.nrm(95,"mat-icon",25),o.j41(96,"span",72),o.EFF(97,"Send"),o.k0s()()()(),o.bVm(),o.k0s()}if(2&t){const e=o.sdS(1),r=o.sdS(12),i=o.XpG();o.R7$(3),o.FS9("alt",(null==i.currentUser?null:i.currentUser.display_name)||(null==i.currentUser?null:i.currentUser.name)||"Avatar"),o.Y8G("src",(null==i.currentUser?null:i.currentUser.picture)||"images/avatars/avatar-placeholder.png",o.B4B),o.R7$(3),o.JRh((null==i.currentUser?null:i.currentUser.display_name)||(null==i.currentUser?null:i.currentUser.name)),o.R7$(3),o.Y8G("matMenuTriggerFor",r),o.R7$(),o.Y8G("svgIcon","heroicons_solid:ellipsis-vertical"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:arrow-up-tray"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:eye-slash"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:clock"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:minus-circle"),o.R7$(6),o.Y8G("svgIcon","heroicons_solid:exclamation-triangle"),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:bell"),o.R7$(4),o.SpI(" ",i.eventInput.nativeElement.value," "),o.R7$(4),o.Y8G("ngClass",o.eq3(29,uc,i.isLiked))("svgIcon",i.isLiked?"heroicons_solid:heart":"heroicons_outline:heart"),o.R7$(2),o.JRh(i.isLiked?"Unlike":"Like"),o.R7$(2),o.Y8G("svgIcon","heroicons_solid:chat-bubble-left-ellipsis"),o.R7$(4),o.Y8G("svgIcon","heroicons_solid:share"),o.R7$(19),o.Y8G("ngClass",o.eq3(31,fc,e.expanded))("svgIcon","heroicons_mini:chevron-down"),o.R7$(5),o.FS9("alt",(null==i.currentUser?null:i.currentUser.display_name)||(null==i.currentUser?null:i.currentUser.name)||"Avatar"),o.Y8G("src",(null==i.currentUser?null:i.currentUser.picture)||"images/avatars/avatar-placeholder.png",o.B4B),o.R7$(),o.Y8G("subscriptSizing","dynamic"),o.R7$(),o.Y8G("placeholder","Write a comment...")("rows",3),o.R7$(5),o.Y8G("svgIcon","heroicons_solid:face-smile"),o.R7$(),o.Y8G("ngIf",i.showCommentEmojiPicker),o.R7$(2),o.Y8G("svgIcon","heroicons_solid:photo"),o.R7$(2),o.Y8G("svgIcon","heroicons_solid:sparkles"),o.R7$(2),o.Y8G("svgIcon","heroicons_solid:paper-airplane")}}const kc=[{path:"",component:(()=>{class t{constructor(e,r,i,a,u,f,g,m,S,C,F,L,P,I,j){this._changeDetectorRef=e,this._metadataService=r,this._signerService=i,this.storageService=a,this._sanitizer=u,this._route=f,this._socialService=g,this.snackBar=m,this.lightning=S,this._dialog=C,this._angorConfigService=F,this._angorConfirmationService=L,this.eventService=P,this.stateService=I,this.subscriptionService=j,this.darkMode=!1,this.isLoading=!0,this.errorMessage=null,this._unsubscribeAll=new Ge.B,this.followers=[],this.following=[],this.allPublicKeys=[],this.isCurrentUserProfile=!1,this.isFollowing=!1,this.showEmojiPicker=!1,this.showCommentEmojiPicker=!1,this.lightningResponse=null,this.lightningInvoice=null,this.paymentInvoice="",this.invoiceAmount="?",this.isLiked=!1,this.isPreview=!1,this.posts=[],this.likes=[],this.myLikes=[],this.myLikedNoteIds=[],this.isLoadingPosts=!0,this.noEventsMessage=""}ngOnInit(){var e=this;return(0,v.A)(function*(){e._angorConfigService.config$.subscribe(r=>{"auto"===r.scheme?e.detectSystemTheme():e.darkMode="dark"===r.scheme}),e._route.paramMap.subscribe(r=>{const i=r.get("pubkey");if(i)e.routePubKey=i;else{e.isCurrentUserProfile=!0;const a=e._signerService.getPublicKey();e.routePubKey=a}e.loadProfileUser(e.routePubKey)}),yield e.loadCurrentUser(),e._socialService.getFollowersObservable().pipe((0,Ve.Q)(e._unsubscribeAll)).subscribe(r=>{e.followers.push(r.pubkey),e._changeDetectorRef.detectChanges()}),e._socialService.getFollowingObservable().pipe((0,Ve.Q)(e._unsubscribeAll)).subscribe(r=>{r.tags.filter(a=>"p"===a[0]).forEach(a=>{e.following.push({nostrPubKey:a[1]})}),e._changeDetectorRef.detectChanges()})})()}ngOnDestroy(){this.subscriptionId&&this.subscriptionService.removeSubscriptionById(this.subscriptionId),this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}loadCurrentUser(){var e=this;return(0,v.A)(function*(){e.currentUser=null,e.stateService.profileMetadata$.subscribe(r=>{e.currentUser=r,e._changeDetectorRef.detectChanges()})})()}loadProfileUser(e){var r=this;return(0,v.A)(function*(){if(r.isLoading=!0,r.errorMessage=null,r.profileUser=null,r.followers=[],r.following=[],r._changeDetectorRef.detectChanges(),!e)return r.errorMessage="No public key found. Please log in again.",r.isLoading=!1,void r._changeDetectorRef.detectChanges();try{const i=yield r.storageService.getUserMetadata(e);i&&(r.profileUser=i,r._changeDetectorRef.detectChanges()),r.subscribeToUserProfile(e)}catch(i){console.error("Error loading user profile:",i)}try{r.followers=yield r._socialService.getFollowers(e);const i=r._signerService.getPublicKey();r.isFollowing=r.followers.includes(i),r.following=yield r._socialService.getFollowing(e),r._changeDetectorRef.detectChanges()}catch(i){console.error("Failed to load profile data:",i),r.errorMessage="Failed to load profile data. Please try again later.",r._changeDetectorRef.detectChanges()}finally{r.isLoading=!1,r._changeDetectorRef.detectChanges()}})()}subscribeToUserProfile(e){var r=this;this.subscriptionId=this.subscriptionService.addSubscriptions([{authors:[e],kinds:[0],limit:1}],function(){var a=(0,v.A)(function*(u){try{const f=JSON.parse(u.content);r.profileUser=f,yield r.storageService.saveUserMetadata(e,f),r._changeDetectorRef.detectChanges()}catch(f){console.error("Error processing metadata event:",f)}});return function(u){return a.apply(this,arguments)}}())}getSafeUrl(e){return this._sanitizer.bypassSecurityTrustUrl(e)}toggleFollow(){var e=this;return(0,v.A)(function*(){try{const r=e._signerService.getPublicKey(),i=e.routePubKey||e.currentUserPubKey;if(!i||!r)return void console.error("Public key missing. Unable to toggle follow.");e.isFollowing?(yield e._socialService.unfollow(i),console.log(`Unfollowed ${i}`),e.followers=e.followers.filter(a=>a!==r)):(yield e._socialService.follow(i),console.log(`Followed ${i}`),e.followers.push(r)),e.isFollowing=!e.isFollowing,e._changeDetectorRef.detectChanges()}catch(r){console.error("Failed to toggle follow:",r)}})()}openSnackBar(e,r){this.snackBar.open(e,r,{duration:1300})}getLightningInfo(){let e="";if(this.profileUser?.lud06){const{words:r}=K.I.decode(this.profileUser.lud06,5e3),i=new Uint8Array(K.I.fromWords(r));e=(new TextDecoder).decode(Uint8Array.from(i))}else if(this.profileUser?.lud16?.toLowerCase().startsWith("lnurl")){const{words:r}=K.I.decode(this.profileUser.lud16,5e3),i=new Uint8Array(K.I.fromWords(r));e=(new TextDecoder).decode(Uint8Array.from(i))}else this.profileUser?.lud16&&(e=this.lightning.getLightningAddress(this.profileUser.lud16));""!==e?this.lightning.getLightning(e).subscribe(r=>{this.lightningResponse=r,"Failed"===this.lightningResponse.status?this.openSnackBar("Failed to lookup lightning address","dismiss"):this.lightningResponse.callback?this.openZapDialog():this.openSnackBar("couldn't find user's lightning address","dismiss")}):this.openSnackBar("No lightning address found","dismiss")}zap(){var e=this;return(0,v.A)(function*(){e.profileUser&&(e.profileUser.lud06||e.profileUser.lud16)?e.getLightningInfo():e.openSnackBar("user can't receive zaps","dismiss")})()}openZapDialog(){this._dialog.open(Zl,{width:"405px",maxHeight:"90vh",data:this.profileUser})}openReceiveZapDialog(){this._dialog.open(Bl,{width:"405px",maxHeight:"90vh",data:this.profileUser})}toggleLike(){this.isLiked=!this.isLiked,this.isLiked&&setTimeout(()=>{this.isLiked=!1,this.isLiked=!0},300)}addEmoji(e){this.eventInput.nativeElement.value+=e.emoji.native,this.showEmojiPicker=!1}toggleEmojiPicker(){this.showCommentEmojiPicker=!1,this.showEmojiPicker=!this.showEmojiPicker}addEmojiTocomment(e){this.commentInput.nativeElement.value+=e.emoji.native,this.showCommentEmojiPicker=!1}detectSystemTheme(){const e=window.matchMedia("(prefers-color-scheme: dark)");this.darkMode=e.matches,e.addEventListener("change",r=>{this.darkMode=r.matches})}togglePreview(){this.isPreview=!this.isPreview}sendEvent(){""!=this.eventInput.nativeElement.value&&this.eventService.sendTextEvent(this.eventInput.nativeElement.value).then(()=>{this._changeDetectorRef.markForCheck()}).catch(e=>{console.error("Failed to send Event:",e)})}static#e=this.\u0275fac=function(r){return new(r||t)(o.rXU(o.gRc),o.rXU(Do.T),o.rXU(Ei.A),o.rXU(Xl.n),o.rXU(ke.up),o.rXU(he.nX),o.rXU(Ql),o.rXU(vi.UG),o.rXU(Fo),o.rXU(Tt.bZ),o.rXU(Jl.P),o.rXU(ec.m),o.rXU(rc),o.rXU(ic.d),o.rXU(oc.n))};static#t=this.\u0275cmp=o.VBU({type:t,selectors:[["profile"]],viewQuery:function(r,i){if(1&r&&(o.GBs(sc,5),o.GBs(ac,5)),2&r){let a;o.mGM(a=o.lsd())&&(i.eventInput=a.first),o.mGM(a=o.lsd())&&(i.commentInput=a.first)}},standalone:!0,features:[o.aNF],decls:70,vars:24,consts:[["defaultAvatar",""],["profileMenu","matMenu"],["listEventMenu","matMenu"],["eventInput",""],["postCardMenu01","matMenu"],["expandableComments","angorCard"],["postCardMenu02","matMenu"],["commentInput",""],[1,"flex","min-w-0","flex-auto","flex-col"],[1,"bg-card","flex","flex-col","shadow"],["onerror","this.onerror=null; this.src='/images/pages/profile/cover.jpg';",1,"h-40","object-cover","lg:h-80",3,"src","alt"],[1,"bg-card","mx-auto","flex","w-full","max-w-5xl","flex-0","flex-col","items-center","px-8","lg:h-18","lg:flex-row"],[1,"-mt-26","flex-shrink-0","rounded-full","lg:-mt-22"],[4,"ngIf","ngIfElse"],[1,"mt-4","flex","flex-grow","flex-col","items-center","lg:ml-8","lg:mt-0","lg:items-start"],[1,"max-w-full","truncate","text-lg","font-bold","leading-tight","lg:max-w-[25rem]",2,"white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"text-secondary","max-w-full","truncate","leading-tight","lg:max-w-[25rem]",2,"white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"mx-8","hidden","h-8","flex-shrink-0","border-l-2","lg:flex"],[1,"mt-6","flex","flex-shrink-0","items-center","space-x-6","lg:mt-0"],[1,"flex","flex-col","items-center"],[1,"font-bold"],[1,"text-secondary","text-sm","font-medium"],[1,"mb-4","mt-8","flex","flex-shrink-0","items-center","space-x-6","lg:m-0","lg:ml-auto"],[4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"icon-size-5",3,"svgIcon"],["mat-menu-item","",3,"click",4,"ngIf"],[1,"my-2"],["mat-menu-item","",3,"routerLink",4,"ngIf"],["mat-menu-item","",4,"ngIf"],[1,"mx-auto","flex","w-full","max-w-5xl","flex-auto","justify-center","p-6","sm:p-8"],[1,"mr-8","hidden","flex-col","items-start","lg:flex"],["class","flex w-full max-w-80 flex-col p-8",4,"ngIf"],[1,"mt-8","flex","w-full","max-w-80","flex-col","px-8","pb-4","pt-6"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-semibold","leading-tight"],[1,"-mr-3"],["mat-menu-item",""],[1,"mt-5","flex","flex-col"],[1,"flex","items-center"],["src","images/cards/coffee-shop-01-320x200.jpg","alt","Card cover image",1,"mr-4","h-14","w-14","rounded","object-cover"],[1,"flex","min-w-0","flex-col"],[1,"font-medium","leading-none"],[1,"mt-1","truncate","text-md","leading-none"],[1,"text-secondary","mt-2","text-md","leading-none"],[1,"-mx-3","mt-6","flex","items-center"],["mat-button","",1,"px-3",3,"color","routerLink"],[1,"flex","w-full","flex-col","items-start"],["class","mb-8 flex w-full flex-col p-6 pb-6 sm:p-8",4,"ngIf"],["class","mb-8 flex w-full flex-col bg-primary-50 dark:bg-primary-800",4,"ngIf"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"ring-bg-card","h-32","min-h-32","w-32","min-w-32","max-w-fit","rounded-full","object-cover","ring-4",3,"src","alt"],["src","/images/avatars/avatar-placeholder.png","onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"ring-bg-card","h-32","min-h-32","w-32","min-w-32","rounded-full","object-cover","ring-4",3,"alt"],["mat-icon-button","",3,"click","matTooltip"],[3,"svgIcon"],["mat-menu-item","",3,"click"],[1,"mr-3","icon-size-5",3,"svgIcon"],["mat-menu-item","",3,"routerLink"],[1,"flex","w-full","max-w-80","flex-col","p-8"],[1,"mt-4"],["mat-flat-button","",1,"mt-8","px-6",3,"color","routerLink"],[1,"mb-8","flex","w-full","flex-col","p-6","pb-6","sm:p-8"],[1,"flex","justify-between"],[1,"text-xl","font-semibold"],[1,"-mr-4","ml-auto",3,"change","color"],[1,"mt-8","flex","flex-col","items-start","sm:flex-row"],[1,"mb-6","flex","items-center","sm:mb-0"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"mr-4","h-12","w-12","min-w-12","rounded-full","object-cover",3,"src","alt"],[1,"sm:hidden"],[1,"w-full",3,"subscriptSizing"],["matInput","","cdkTextareaAutosize","",3,"placeholder","rows"],[1,"-mx-3","mt-6","flex","items-center","justify-between","sm:mt-8"],["mat-button","",1,"mr-1","px-3",3,"click"],[1,"ml-2"],["class","emoji-picker-container-global",4,"ngIf"],["mat-button","",1,"mr-1","hidden","px-3","sm:inline-flex"],["mat-button","",1,"px-3",3,"matMenuTriggerFor"],["mat-menu-item","",1,"sm:hidden"],["mat-button","",1,"mr-1","flex","px-3",3,"click"],[1,"emoji-picker-container-global"],[3,"emojiClick","darkMode"],[1,"mb-8","flex","w-full","flex-col","bg-primary-50","dark:bg-primary-800"],[1,"mx-6","mb-4","mt-6","flex","items-center","sm:mx-8"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"mr-4","h-10","w-10","rounded-full",3,"src","alt"],[1,"flex","flex-col"],[1,"font-semibold","leading-none"],[1,"text-secondary","mt-1","text-sm","leading-none"],["mat-icon-button","",1,"-mr-4","ml-auto",3,"matMenuTriggerFor"],[1,"mx-6","mb-6","mt-2","sm:mx-8"],[1,"relative","mb-4"],[1,"mx-3","flex","items-center","sm:mx-5"],[1,"text-red-500","icon-size-5",3,"ngClass","svgIcon"],["mat-button","",1,"mr-1","px-3"],[1,"mx-6","mb-6","mt-4","border-b","sm:mx-8"],[1,"mx-6","mb-4","flex","flex-col","sm:mx-8","sm:mb-6","sm:flex-row","sm:items-center"],["src","images/avatars/avatar-placeholder.png","alt","Card cover image",1,"text-card","m-0.5","h-6","w-6","rounded-full","ring-2","ring-white"],["src","images/avatars/avatar-placeholder.png","alt","Card cover image",1,"text-card","m-0.5","-ml-3","h-6","w-6","rounded-full","ring-2","ring-white"],[1,"ml-3","text-md","tracking-tight"],[1,"hidden","flex-auto","sm:flex"],[1,"mt-4","flex","items-center","sm:mt-0"],["mat-button","",1,"-ml-2","mr-1","px-3","sm:ml-0"],["mat-button","",1,"px-3","sm:-mr-4",3,"click"],[1,"mr-1"],[1,"rotate-0","transition-transform","duration-150","ease-in-out","icon-size-5",3,"ngClass","svgIcon"],["angorCardExpansion",""],[1,"m-0","border-b"],[1,"mx-4","mb-3","mt-6","flex","flex-col","sm:mx-8"],[1,"flex","items-start"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"mr-5","h-12","w-12","rounded-full","object-cover",3,"src","alt"],[1,"mt-3","flex","items-center","justify-between"],["mat-icon-button","",3,"click"],["mat-icon-button",""],["mat-button","",1,"mr-1","flex","px-3"]],template:function(r,i){if(1&r&&(o.j41(0,"div",8)(1,"div",9)(2,"div"),o.nrm(3,"img",10),o.k0s(),o.j41(4,"div",11)(5,"div",12),o.DNE(6,hc,2,2,"ng-container",13)(7,dc,1,1,"ng-template",null,0,o.C5r),o.k0s(),o.j41(9,"div",14)(10,"div",15),o.EFF(11),o.k0s(),o.j41(12,"div",16),o.EFF(13),o.k0s()(),o.nrm(14,"div",17),o.j41(15,"div",18)(16,"div",19)(17,"span",20),o.EFF(18),o.k0s(),o.j41(19,"span",21),o.EFF(20,"FOLLOWERS"),o.k0s()(),o.j41(21,"div",19)(22,"span",20),o.EFF(23),o.k0s(),o.j41(24,"span",21),o.EFF(25,"FOLLOWING"),o.k0s()()(),o.nrm(26,"div",17),o.j41(27,"div",22),o.DNE(28,gc,3,2,"div",23),o.j41(29,"div")(30,"button",24),o.nrm(31,"mat-icon",25),o.k0s(),o.j41(32,"mat-menu",null,1),o.DNE(34,pc,5,1,"button",26)(35,mc,5,1,"button",26),o.nrm(36,"mat-divider",27),o.DNE(37,vc,5,2,"button",28)(38,yc,5,1,"button",29)(39,wc,5,1,"button",29),o.k0s()()()()(),o.j41(40,"div",30)(41,"div",31),o.DNE(42,bc,7,4,"angor-card",32),o.j41(43,"angor-card",33)(44,"div",34)(45,"div",35),o.EFF(46," Last projects "),o.k0s(),o.j41(47,"div",36)(48,"button",24),o.nrm(49,"mat-icon",25),o.k0s(),o.j41(50,"mat-menu",null,2)(52,"button",37),o.EFF(53,"Search for groups"),o.k0s()()()(),o.j41(54,"div",38)(55,"div",39),o.nrm(56,"img",40),o.j41(57,"div",41)(58,"div",42),o.EFF(59," The Port Cafe "),o.k0s(),o.j41(60,"div",43),o.EFF(61," Best cafe of the downtown New York "),o.k0s(),o.j41(62,"div",44),o.EFF(63," 1.2k followers "),o.k0s()()()(),o.j41(64,"div",45)(65,"a",46),o.EFF(66," See all Project "),o.k0s()()()(),o.j41(67,"div",47),o.DNE(68,Ec,62,19,"angor-card",48)(69,Mc,98,33,"angor-card",49),o.k0s()()()),2&r){const a=o.sdS(8),u=o.sdS(33),f=o.sdS(51);o.R7$(3),o.FS9("alt",(null==i.profileUser?null:i.profileUser.display_name)||(null==i.profileUser?null:i.profileUser.name)||"Banner"),o.Y8G("src",(null==i.profileUser?null:i.profileUser.banner)||"/images/pages/profile/cover.jpg",o.B4B),o.R7$(3),o.Y8G("ngIf",null==i.profileUser?null:i.profileUser.picture)("ngIfElse",a),o.R7$(5),o.SpI(" ",(null==i.profileUser?null:i.profileUser.display_name)||(null==i.profileUser?null:i.profileUser.name)||"Unknown User"," "),o.R7$(2),o.SpI(" ",(null==i.profileUser?null:i.profileUser.username)||(null==i.profileUser?null:i.profileUser.name)," "),o.R7$(5),o.JRh(i.followers.length),o.R7$(5),o.JRh(i.following.length),o.R7$(5),o.Y8G("ngIf",!i.isCurrentUserProfile),o.R7$(2),o.Y8G("matMenuTriggerFor",u),o.R7$(),o.Y8G("svgIcon","heroicons_solid:ellipsis-vertical"),o.R7$(3),o.Y8G("ngIf",!i.isCurrentUserProfile),o.R7$(),o.Y8G("ngIf",i.isCurrentUserProfile),o.R7$(2),o.Y8G("ngIf",i.isCurrentUserProfile),o.R7$(),o.Y8G("ngIf",!i.isCurrentUserProfile),o.R7$(),o.Y8G("ngIf",!i.isCurrentUserProfile),o.R7$(3),o.Y8G("ngIf",(null==i.profileUser?null:i.profileUser.about)&&""!==i.profileUser.about.trim()),o.R7$(6),o.Y8G("matMenuTriggerFor",f),o.R7$(),o.Y8G("svgIcon","heroicons_solid:ellipsis-vertical"),o.R7$(16),o.Y8G("color","primary")("routerLink",o.lJ4(23,lc)),o.R7$(3),o.Y8G("ngIf",i.isCurrentUserProfile),o.R7$(),o.Y8G("ngIf",i.isPreview)}},dependencies:[he.Wk,y.n,oe.m_,oe.An,B.Hl,B.It,B.$z,B.iY,te.Cn,te.kk,te.fb,te.Cp,$.RG,$.rl,le.fS,le.fg,k.xb,k.EE,U.w,U.q,D.uc,D.oV,h.YU,h.MD,h.bT,T.YN,we,H.Ic,O.sG,ne.D6,On],styles:[".emoji-picker-container-global{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:9999;width:350px;max-width:100%}.heart-beat{animation:heartBeatAnimation .3s ease-in-out}@keyframes heartBeatAnimation{0%{transform:scale(1)}30%{transform:scale(2)}60%{transform:scale(1)}to{transform:scale(1)}}.loading-spinner{display:flex;justify-content:center;align-items:center;margin:20px 0}.loading-spinner .spinner{border:4px solid rgba(0,0,0,.1);border-left-color:#009fb5;border-radius:50%;width:30px;height:30px;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}\n"],encapsulation:2,changeDetection:0})}return t})()}]},2577:(Ee,N,M)=>{const v=M(531),y=M(8715),k=M(465),h=M(5510);function T(B,U,$,oe,le){const te=[].slice.call(arguments,1),ne=te.length,O="function"==typeof te[ne-1];if(!O&&!v())throw new Error("Callback required as last argument");if(!O){if(ne<1)throw new Error("Too few arguments provided");return 1===ne?($=U,U=oe=void 0):2===ne&&!U.getContext&&(oe=$,$=U,U=void 0),new Promise(function(D,he){try{const H=y.create($,oe);D(B(H,U,oe))}catch(H){he(H)}})}if(ne<2)throw new Error("Too few arguments provided");2===ne?(le=$,$=U,U=oe=void 0):3===ne&&(U.getContext&&typeof le>"u"?(le=oe,oe=void 0):(le=oe,oe=$,$=U,U=void 0));try{const D=y.create($,oe);le(null,B(D,U,oe))}catch(D){le(D)}}N.mo=T.bind(null,k.render),N.dY=T.bind(null,k.renderToDataURL),N.toString=T.bind(null,function(B,U,$){return h.render(B,$)})},531:Ee=>{Ee.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},919:(Ee,N,M)=>{const x=M(2656).getSymbolSize;N.getRowColCoords=function(y){if(1===y)return[];const k=Math.floor(y/7)+2,h=x(y),T=145===h?26:2*Math.ceil((h-13)/(2*k-2)),B=[h-7];for(let U=1;U<k-1;U++)B[U]=B[U-1]-T;return B.push(6),B.reverse()},N.getPositions=function(y){const k=[],h=N.getRowColCoords(y),T=h.length;for(let B=0;B<T;B++)for(let U=0;U<T;U++)0===B&&0===U||0===B&&U===T-1||B===T-1&&0===U||k.push([h[B],h[U]]);return k}},387:(Ee,N,M)=>{const x=M(838),v=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function y(k){this.mode=x.ALPHANUMERIC,this.data=k}y.getBitsLength=function(h){return 11*Math.floor(h/2)+h%2*6},y.prototype.getLength=function(){return this.data.length},y.prototype.getBitsLength=function(){return y.getBitsLength(this.data.length)},y.prototype.write=function(h){let T;for(T=0;T+2<=this.data.length;T+=2){let B=45*v.indexOf(this.data[T]);B+=v.indexOf(this.data[T+1]),h.put(B,11)}this.data.length%2&&h.put(v.indexOf(this.data[T]),6)},Ee.exports=y},4481:Ee=>{function N(){this.buffer=[],this.length=0}N.prototype={get:function(M){const x=Math.floor(M/8);return 1==(this.buffer[x]>>>7-M%8&1)},put:function(M,x){for(let v=0;v<x;v++)this.putBit(1==(M>>>x-v-1&1))},getLengthInBits:function(){return this.length},putBit:function(M){const x=Math.floor(this.length/8);this.buffer.length<=x&&this.buffer.push(0),M&&(this.buffer[x]|=128>>>this.length%8),this.length++}},Ee.exports=N},8038:Ee=>{function N(M){if(!M||M<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=M,this.data=new Uint8Array(M*M),this.reservedBit=new Uint8Array(M*M)}N.prototype.set=function(M,x,v,y){const k=M*this.size+x;this.data[k]=v,y&&(this.reservedBit[k]=!0)},N.prototype.get=function(M,x){return this.data[M*this.size+x]},N.prototype.xor=function(M,x,v){this.data[M*this.size+x]^=v},N.prototype.isReserved=function(M,x){return this.reservedBit[M*this.size+x]},Ee.exports=N},1736:(Ee,N,M)=>{const x=M(3174),v=M(838);function y(k){this.mode=v.BYTE,"string"==typeof k&&(k=x(k)),this.data=new Uint8Array(k)}y.getBitsLength=function(h){return 8*h},y.prototype.getLength=function(){return this.data.length},y.prototype.getBitsLength=function(){return y.getBitsLength(this.data.length)},y.prototype.write=function(k){for(let h=0,T=this.data.length;h<T;h++)k.put(this.data[h],8)},Ee.exports=y},2296:(Ee,N,M)=>{const x=M(139),v=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],y=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];N.getBlocksCount=function(h,T){switch(T){case x.L:return v[4*(h-1)+0];case x.M:return v[4*(h-1)+1];case x.Q:return v[4*(h-1)+2];case x.H:return v[4*(h-1)+3];default:return}},N.getTotalCodewordsCount=function(h,T){switch(T){case x.L:return y[4*(h-1)+0];case x.M:return y[4*(h-1)+1];case x.Q:return y[4*(h-1)+2];case x.H:return y[4*(h-1)+3];default:return}}},139:(Ee,N)=>{N.L={bit:1},N.M={bit:0},N.Q={bit:3},N.H={bit:2},N.isValid=function(v){return v&&typeof v.bit<"u"&&v.bit>=0&&v.bit<4},N.from=function(v,y){if(N.isValid(v))return v;try{return function M(x){if("string"!=typeof x)throw new Error("Param is not a string");switch(x.toLowerCase()){case"l":case"low":return N.L;case"m":case"medium":return N.M;case"q":case"quartile":return N.Q;case"h":case"high":return N.H;default:throw new Error("Unknown EC Level: "+x)}}(v)}catch{return y}}},9202:(Ee,N,M)=>{const x=M(2656).getSymbolSize;N.getPositions=function(k){const h=x(k);return[[0,0],[h-7,0],[0,h-7]]}},9211:(Ee,N,M)=>{const x=M(2656),k=x.getBCHDigit(1335);N.getEncodedBits=function(T,B){const U=T.bit<<3|B;let $=U<<10;for(;x.getBCHDigit($)-k>=0;)$^=1335<<x.getBCHDigit($)-k;return 21522^(U<<10|$)}},6965:(Ee,N)=>{const M=new Uint8Array(512),x=new Uint8Array(256);(function(){let y=1;for(let k=0;k<255;k++)M[k]=y,x[y]=k,y<<=1,256&y&&(y^=285);for(let k=255;k<512;k++)M[k]=M[k-255]})(),N.log=function(y){if(y<1)throw new Error("log("+y+")");return x[y]},N.exp=function(y){return M[y]},N.mul=function(y,k){return 0===y||0===k?0:M[x[y]+x[k]]}},1971:(Ee,N,M)=>{const x=M(838),v=M(2656);function y(k){this.mode=x.KANJI,this.data=k}y.getBitsLength=function(h){return 13*h},y.prototype.getLength=function(){return this.data.length},y.prototype.getBitsLength=function(){return y.getBitsLength(this.data.length)},y.prototype.write=function(k){let h;for(h=0;h<this.data.length;h++){let T=v.toSJIS(this.data[h]);if(T>=33088&&T<=40956)T-=33088;else{if(!(T>=57408&&T<=60351))throw new Error("Invalid SJIS character: "+this.data[h]+"\nMake sure your charset is UTF-8");T-=49472}T=192*(T>>>8&255)+(255&T),k.put(T,13)}},Ee.exports=y},9366:(Ee,N)=>{N.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function x(v,y,k){switch(v){case N.Patterns.PATTERN000:return(y+k)%2==0;case N.Patterns.PATTERN001:return y%2==0;case N.Patterns.PATTERN010:return k%3==0;case N.Patterns.PATTERN011:return(y+k)%3==0;case N.Patterns.PATTERN100:return(Math.floor(y/2)+Math.floor(k/3))%2==0;case N.Patterns.PATTERN101:return y*k%2+y*k%3==0;case N.Patterns.PATTERN110:return(y*k%2+y*k%3)%2==0;case N.Patterns.PATTERN111:return(y*k%3+(y+k)%2)%2==0;default:throw new Error("bad maskPattern:"+v)}}N.isValid=function(y){return null!=y&&""!==y&&!isNaN(y)&&y>=0&&y<=7},N.from=function(y){return N.isValid(y)?parseInt(y,10):void 0},N.getPenaltyN1=function(y){const k=y.size;let h=0,T=0,B=0,U=null,$=null;for(let oe=0;oe<k;oe++){T=B=0,U=$=null;for(let le=0;le<k;le++){let te=y.get(oe,le);te===U?T++:(T>=5&&(h+=T-5+3),U=te,T=1),te=y.get(le,oe),te===$?B++:(B>=5&&(h+=B-5+3),$=te,B=1)}T>=5&&(h+=T-5+3),B>=5&&(h+=B-5+3)}return h},N.getPenaltyN2=function(y){const k=y.size;let h=0;for(let T=0;T<k-1;T++)for(let B=0;B<k-1;B++){const U=y.get(T,B)+y.get(T,B+1)+y.get(T+1,B)+y.get(T+1,B+1);(4===U||0===U)&&h++}return 3*h},N.getPenaltyN3=function(y){const k=y.size;let h=0,T=0,B=0;for(let U=0;U<k;U++){T=B=0;for(let $=0;$<k;$++)T=T<<1&2047|y.get(U,$),$>=10&&(1488===T||93===T)&&h++,B=B<<1&2047|y.get($,U),$>=10&&(1488===B||93===B)&&h++}return 40*h},N.getPenaltyN4=function(y){let k=0;const h=y.data.length;for(let B=0;B<h;B++)k+=y.data[B];return 10*Math.abs(Math.ceil(100*k/h/5)-10)},N.applyMask=function(y,k){const h=k.size;for(let T=0;T<h;T++)for(let B=0;B<h;B++)k.isReserved(B,T)||k.xor(B,T,x(y,B,T))},N.getBestMask=function(y,k){const h=Object.keys(N.Patterns).length;let T=0,B=1/0;for(let U=0;U<h;U++){k(U),N.applyMask(U,y);const $=N.getPenaltyN1(y)+N.getPenaltyN2(y)+N.getPenaltyN3(y)+N.getPenaltyN4(y);N.applyMask(U,y),$<B&&(B=$,T=U)}return T}},838:(Ee,N,M)=>{const x=M(1604),v=M(6082);N.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},N.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},N.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},N.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},N.MIXED={bit:-1},N.getCharCountIndicator=function(h,T){if(!h.ccBits)throw new Error("Invalid mode: "+h);if(!x.isValid(T))throw new Error("Invalid version: "+T);return T>=1&&T<10?h.ccBits[0]:T<27?h.ccBits[1]:h.ccBits[2]},N.getBestModeForData=function(h){return v.testNumeric(h)?N.NUMERIC:v.testAlphanumeric(h)?N.ALPHANUMERIC:v.testKanji(h)?N.KANJI:N.BYTE},N.toString=function(h){if(h&&h.id)return h.id;throw new Error("Invalid mode")},N.isValid=function(h){return h&&h.bit&&h.ccBits},N.from=function(h,T){if(N.isValid(h))return h;try{return function y(k){if("string"!=typeof k)throw new Error("Param is not a string");switch(k.toLowerCase()){case"numeric":return N.NUMERIC;case"alphanumeric":return N.ALPHANUMERIC;case"kanji":return N.KANJI;case"byte":return N.BYTE;default:throw new Error("Unknown mode: "+k)}}(h)}catch{return T}}},7035:(Ee,N,M)=>{const x=M(838);function v(y){this.mode=x.NUMERIC,this.data=y.toString()}v.getBitsLength=function(k){return 10*Math.floor(k/3)+(k%3?k%3*3+1:0)},v.prototype.getLength=function(){return this.data.length},v.prototype.getBitsLength=function(){return v.getBitsLength(this.data.length)},v.prototype.write=function(k){let h,T,B;for(h=0;h+3<=this.data.length;h+=3)T=this.data.substr(h,3),B=parseInt(T,10),k.put(B,10);const U=this.data.length-h;U>0&&(T=this.data.substr(h),B=parseInt(T,10),k.put(B,3*U+1))},Ee.exports=v},7767:(Ee,N,M)=>{const x=M(6965);N.mul=function(y,k){const h=new Uint8Array(y.length+k.length-1);for(let T=0;T<y.length;T++)for(let B=0;B<k.length;B++)h[T+B]^=x.mul(y[T],k[B]);return h},N.mod=function(y,k){let h=new Uint8Array(y);for(;h.length-k.length>=0;){const T=h[0];for(let U=0;U<k.length;U++)h[U]^=x.mul(k[U],T);let B=0;for(;B<h.length&&0===h[B];)B++;h=h.slice(B)}return h},N.generateECPolynomial=function(y){let k=new Uint8Array([1]);for(let h=0;h<y;h++)k=N.mul(k,new Uint8Array([1,x.exp(h)]));return k}},8715:(Ee,N,M)=>{const x=M(2656),v=M(139),y=M(4481),k=M(8038),h=M(919),T=M(9202),B=M(9366),U=M(2296),$=M(6758),oe=M(8925),le=M(9211),te=M(838),ne=M(7939);function K(de,we,se){const ce=de.size,_=le.getEncodedBits(we,se);let s,c;for(s=0;s<15;s++)c=1==(_>>s&1),de.set(s<6?s:s<8?s+1:ce-15+s,8,c,!0),de.set(8,s<8?ce-s-1:s<9?15-s-1+1:15-s-1,c,!0);de.set(ce-8,8,1,!0)}function je(de,we,se,ce){let _;if(Array.isArray(de))_=ne.fromArray(de);else{if("string"!=typeof de)throw new Error("Invalid data");{let E=we;if(!E){const A=ne.rawSplit(de);E=oe.getBestVersionForData(A,se)}_=ne.fromString(de,E||40)}}const s=oe.getBestVersionForData(_,se);if(!s)throw new Error("The amount of data is too big to be stored in a QR Code");if(we){if(we<s)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+s+".\n")}else we=s;const c=function ae(de,we,se){const ce=new y;se.forEach(function(p){ce.put(p.mode.bit,4),ce.put(p.getLength(),te.getCharCountIndicator(p.mode,de)),p.write(ce)});const c=8*(x.getSymbolTotalCodewords(de)-U.getTotalCodewordsCount(de,we));for(ce.getLengthInBits()+4<=c&&ce.put(0,4);ce.getLengthInBits()%8!=0;)ce.putBit(0);const d=(c-ce.getLengthInBits())/8;for(let p=0;p<d;p++)ce.put(p%2?17:236,8);return function ke(de,we,se){const ce=x.getSymbolTotalCodewords(we),s=ce-U.getTotalCodewordsCount(we,se),c=U.getBlocksCount(we,se),p=c-ce%c,E=Math.floor(ce/c),A=Math.floor(s/c),R=A+1,w=E-A,l=new $(w);let b=0;const ue=new Array(c),me=new Array(c);let ve=0;const xe=new Uint8Array(de.buffer);for(let Ue=0;Ue<c;Ue++){const Ht=Ue<p?A:R;ue[Ue]=xe.slice(b,b+Ht),me[Ue]=l.encode(ue[Ue]),b+=Ht,ve=Math.max(ve,Ht)}const Ae=new Uint8Array(ce);let lt,Se,Ne=0;for(lt=0;lt<ve;lt++)for(Se=0;Se<c;Se++)lt<ue[Se].length&&(Ae[Ne++]=ue[Se][lt]);for(lt=0;lt<w;lt++)for(Se=0;Se<c;Se++)Ae[Ne++]=me[Se][lt];return Ae}(ce,de,we)}(we,se,_),d=x.getSymbolSize(we),p=new k(d);return function O(de,we){const se=de.size,ce=T.getPositions(we);for(let _=0;_<ce.length;_++){const s=ce[_][0],c=ce[_][1];for(let d=-1;d<=7;d++)if(!(s+d<=-1||se<=s+d))for(let p=-1;p<=7;p++)c+p<=-1||se<=c+p||de.set(s+d,c+p,d>=0&&d<=6&&(0===p||6===p)||p>=0&&p<=6&&(0===d||6===d)||d>=2&&d<=4&&p>=2&&p<=4,!0)}}(p,we),function D(de){const we=de.size;for(let se=8;se<we-8;se++){const ce=se%2==0;de.set(se,6,ce,!0),de.set(6,se,ce,!0)}}(p),function he(de,we){const se=h.getPositions(we);for(let ce=0;ce<se.length;ce++){const _=se[ce][0],s=se[ce][1];for(let c=-2;c<=2;c++)for(let d=-2;d<=2;d++)de.set(_+c,s+d,-2===c||2===c||-2===d||2===d||0===c&&0===d,!0)}}(p,we),K(p,se,0),we>=7&&function H(de,we){const se=de.size,ce=oe.getEncodedBits(we);let _,s,c;for(let d=0;d<18;d++)_=Math.floor(d/3),s=d%3+se-8-3,c=1==(ce>>d&1),de.set(_,s,c,!0),de.set(s,_,c,!0)}(p,we),function o(de,we){const se=de.size;let ce=-1,_=se-1,s=7,c=0;for(let d=se-1;d>0;d-=2)for(6===d&&d--;;){for(let p=0;p<2;p++)if(!de.isReserved(_,d-p)){let E=!1;c<we.length&&(E=1==(we[c]>>>s&1)),de.set(_,d-p,E),s--,-1===s&&(c++,s=7)}if(_+=ce,_<0||se<=_){_-=ce,ce=-ce;break}}}(p,c),isNaN(ce)&&(ce=B.getBestMask(p,K.bind(null,p,se))),B.applyMask(ce,p),K(p,se,ce),{modules:p,version:we,errorCorrectionLevel:se,maskPattern:ce,segments:_}}N.create=function(we,se){if(typeof we>"u"||""===we)throw new Error("No input text");let _,s,ce=v.M;return typeof se<"u"&&(ce=v.from(se.errorCorrectionLevel,v.M),_=oe.from(se.version),s=B.from(se.maskPattern),se.toSJISFunc&&x.setToSJISFunction(se.toSJISFunc)),je(we,_,ce,s)}},6758:(Ee,N,M)=>{const x=M(7767);function v(y){this.genPoly=void 0,this.degree=y,this.degree&&this.initialize(this.degree)}v.prototype.initialize=function(k){this.degree=k,this.genPoly=x.generateECPolynomial(this.degree)},v.prototype.encode=function(k){if(!this.genPoly)throw new Error("Encoder not initialized");const h=new Uint8Array(k.length+this.degree);h.set(k);const T=x.mod(h,this.genPoly),B=this.degree-T.length;if(B>0){const U=new Uint8Array(this.degree);return U.set(T,B),U}return T},Ee.exports=v},6082:(Ee,N)=>{const M="[0-9]+";let v="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";v=v.replace(/u/g,"\\u");const y="(?:(?![A-Z0-9 $%*+\\-./:]|"+v+")(?:.|[\r\n]))+";N.KANJI=new RegExp(v,"g"),N.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),N.BYTE=new RegExp(y,"g"),N.NUMERIC=new RegExp(M,"g"),N.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const k=new RegExp("^"+v+"$"),h=new RegExp("^"+M+"$"),T=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");N.testKanji=function(U){return k.test(U)},N.testNumeric=function(U){return h.test(U)},N.testAlphanumeric=function(U){return T.test(U)}},7939:(Ee,N,M)=>{const x=M(838),v=M(7035),y=M(387),k=M(1736),h=M(1971),T=M(6082),B=M(2656),U=M(243);function $(H){return unescape(encodeURIComponent(H)).length}function oe(H,K,o){const ae=[];let ke;for(;null!==(ke=H.exec(o));)ae.push({data:ke[0],index:ke.index,mode:K,length:ke[0].length});return ae}function le(H){const K=oe(T.NUMERIC,x.NUMERIC,H),o=oe(T.ALPHANUMERIC,x.ALPHANUMERIC,H);let ae,ke;return B.isKanjiModeEnabled()?(ae=oe(T.BYTE,x.BYTE,H),ke=oe(T.KANJI,x.KANJI,H)):(ae=oe(T.BYTE_KANJI,x.BYTE,H),ke=[]),K.concat(o,ae,ke).sort(function(de,we){return de.index-we.index}).map(function(de){return{data:de.data,mode:de.mode,length:de.length}})}function te(H,K){switch(K){case x.NUMERIC:return v.getBitsLength(H);case x.ALPHANUMERIC:return y.getBitsLength(H);case x.KANJI:return h.getBitsLength(H);case x.BYTE:return k.getBitsLength(H)}}function he(H,K){let o;const ae=x.getBestModeForData(H);if(o=x.from(K,ae),o!==x.BYTE&&o.bit<ae.bit)throw new Error('"'+H+'" cannot be encoded with mode '+x.toString(o)+".\n Suggested mode is: "+x.toString(ae));switch(o===x.KANJI&&!B.isKanjiModeEnabled()&&(o=x.BYTE),o){case x.NUMERIC:return new v(H);case x.ALPHANUMERIC:return new y(H);case x.KANJI:return new h(H);case x.BYTE:return new k(H)}}N.fromArray=function(K){return K.reduce(function(o,ae){return"string"==typeof ae?o.push(he(ae,null)):ae.data&&o.push(he(ae.data,ae.mode)),o},[])},N.fromString=function(K,o){const ke=function O(H){const K=[];for(let o=0;o<H.length;o++){const ae=H[o];switch(ae.mode){case x.NUMERIC:K.push([ae,{data:ae.data,mode:x.ALPHANUMERIC,length:ae.length},{data:ae.data,mode:x.BYTE,length:ae.length}]);break;case x.ALPHANUMERIC:K.push([ae,{data:ae.data,mode:x.BYTE,length:ae.length}]);break;case x.KANJI:K.push([ae,{data:ae.data,mode:x.BYTE,length:$(ae.data)}]);break;case x.BYTE:K.push([{data:ae.data,mode:x.BYTE,length:$(ae.data)}])}}return K}(le(K,B.isKanjiModeEnabled())),je=function D(H,K){const o={},ae={start:{}};let ke=["start"];for(let je=0;je<H.length;je++){const de=H[je],we=[];for(let se=0;se<de.length;se++){const ce=de[se],_=""+je+se;we.push(_),o[_]={node:ce,lastCount:0},ae[_]={};for(let s=0;s<ke.length;s++){const c=ke[s];o[c]&&o[c].node.mode===ce.mode?(ae[c][_]=te(o[c].lastCount+ce.length,ce.mode)-te(o[c].lastCount,ce.mode),o[c].lastCount+=ce.length):(o[c]&&(o[c].lastCount=ce.length),ae[c][_]=te(ce.length,ce.mode)+4+x.getCharCountIndicator(ce.mode,K))}}ke=we}for(let je=0;je<ke.length;je++)ae[ke[je]].end=0;return{map:ae,table:o}}(ke,o),de=U.find_path(je.map,"start","end"),we=[];for(let se=1;se<de.length-1;se++)we.push(je.table[de[se]].node);return N.fromArray(function ne(H){return H.reduce(function(K,o){const ae=K.length-1>=0?K[K.length-1]:null;return ae&&ae.mode===o.mode?(K[K.length-1].data+=o.data,K):(K.push(o),K)},[])}(we))},N.rawSplit=function(K){return N.fromArray(le(K,B.isKanjiModeEnabled()))}},2656:(Ee,N)=>{let M;const x=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];N.getSymbolSize=function(y){if(!y)throw new Error('"version" cannot be null or undefined');if(y<1||y>40)throw new Error('"version" should be in range from 1 to 40');return 4*y+17},N.getSymbolTotalCodewords=function(y){return x[y]},N.getBCHDigit=function(v){let y=0;for(;0!==v;)y++,v>>>=1;return y},N.setToSJISFunction=function(y){if("function"!=typeof y)throw new Error('"toSJISFunc" is not a valid function.');M=y},N.isKanjiModeEnabled=function(){return typeof M<"u"},N.toSJIS=function(y){return M(y)}},1604:(Ee,N)=>{N.isValid=function(x){return!isNaN(x)&&x>=1&&x<=40}},8925:(Ee,N,M)=>{const x=M(2656),v=M(2296),y=M(139),k=M(838),h=M(1604),B=x.getBCHDigit(7973);function $(te,ne){return k.getCharCountIndicator(te,ne)+4}function oe(te,ne){let O=0;return te.forEach(function(D){const he=$(D.mode,ne);O+=he+D.getBitsLength()}),O}N.from=function(ne,O){return h.isValid(ne)?parseInt(ne,10):O},N.getCapacity=function(ne,O,D){if(!h.isValid(ne))throw new Error("Invalid QR Code version");typeof D>"u"&&(D=k.BYTE);const K=8*(x.getSymbolTotalCodewords(ne)-v.getTotalCodewordsCount(ne,O));if(D===k.MIXED)return K;const o=K-$(D,ne);switch(D){case k.NUMERIC:return Math.floor(o/10*3);case k.ALPHANUMERIC:return Math.floor(o/11*2);case k.KANJI:return Math.floor(o/13);default:return Math.floor(o/8)}},N.getBestVersionForData=function(ne,O){let D;const he=y.from(O,y.M);if(Array.isArray(ne)){if(ne.length>1)return function le(te,ne){for(let O=1;O<=40;O++)if(oe(te,O)<=N.getCapacity(O,ne,k.MIXED))return O}(ne,he);if(0===ne.length)return 1;D=ne[0]}else D=ne;return function U(te,ne,O){for(let D=1;D<=40;D++)if(ne<=N.getCapacity(D,O,te))return D}(D.mode,D.getLength(),he)},N.getEncodedBits=function(ne){if(!h.isValid(ne)||ne<7)throw new Error("Invalid QR Code version");let O=ne<<12;for(;x.getBCHDigit(O)-B>=0;)O^=7973<<x.getBCHDigit(O)-B;return ne<<12|O}},465:(Ee,N,M)=>{const x=M(8428);N.render=function(h,T,B){let U=B,$=T;typeof U>"u"&&(!T||!T.getContext)&&(U=T,T=void 0),T||($=function y(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}()),U=x.getOptions(U);const oe=x.getImageWidth(h.modules.size,U),le=$.getContext("2d"),te=le.createImageData(oe,oe);return x.qrToImageData(te.data,h,U),function v(k,h,T){k.clearRect(0,0,h.width,h.height),h.style||(h.style={}),h.height=T,h.width=T,h.style.height=T+"px",h.style.width=T+"px"}(le,$,oe),le.putImageData(te,0,0),$},N.renderToDataURL=function(h,T,B){let U=B;return typeof U>"u"&&(!T||!T.getContext)&&(U=T,T=void 0),U||(U={}),N.render(h,T,U).toDataURL(U.type||"image/png",(U.rendererOpts||{}).quality)}},5510:(Ee,N,M)=>{const x=M(8428);function v(h,T){const B=h.a/255,U=T+'="'+h.hex+'"';return B<1?U+" "+T+'-opacity="'+B.toFixed(2).slice(1)+'"':U}function y(h,T,B){let U=h+T;return typeof B<"u"&&(U+=" "+B),U}N.render=function(T,B,U){const $=x.getOptions(B),oe=T.modules.size,le=T.modules.data,te=oe+2*$.margin,ne=$.color.light.a?"<path "+v($.color.light,"fill")+' d="M0 0h'+te+"v"+te+'H0z"/>':"",O="<path "+v($.color.dark,"stroke")+' d="'+function k(h,T,B){let U="",$=0,oe=!1,le=0;for(let te=0;te<h.length;te++){const ne=Math.floor(te%T),O=Math.floor(te/T);!ne&&!oe&&(oe=!0),h[te]?(le++,te>0&&ne>0&&h[te-1]||(U+=oe?y("M",ne+B,.5+O+B):y("m",$,0),$=0,oe=!1),ne+1<T&&h[te+1]||(U+=y("h",le),le=0)):$++}return U}(le,oe,$.margin)+'"/>',H='<svg xmlns="http://www.w3.org/2000/svg" '+($.width?'width="'+$.width+'" height="'+$.width+'" ':"")+'viewBox="0 0 '+te+" "+te+'" shape-rendering="crispEdges">'+ne+O+"</svg>\n";return"function"==typeof U&&U(null,H),H}},8428:(Ee,N)=>{function M(x){if("number"==typeof x&&(x=x.toString()),"string"!=typeof x)throw new Error("Color should be defined as hex string");let v=x.slice().replace("#","").split("");if(v.length<3||5===v.length||v.length>8)throw new Error("Invalid hex color: "+x);(3===v.length||4===v.length)&&(v=Array.prototype.concat.apply([],v.map(function(k){return[k,k]}))),6===v.length&&v.push("F","F");const y=parseInt(v.join(""),16);return{r:y>>24&255,g:y>>16&255,b:y>>8&255,a:255&y,hex:"#"+v.slice(0,6).join("")}}N.getOptions=function(v){v||(v={}),v.color||(v.color={});const k=v.width&&v.width>=21?v.width:void 0;return{width:k,scale:k?4:v.scale||4,margin:typeof v.margin>"u"||null===v.margin||v.margin<0?4:v.margin,color:{dark:M(v.color.dark||"#000000ff"),light:M(v.color.light||"#ffffffff")},type:v.type,rendererOpts:v.rendererOpts||{}}},N.getScale=function(v,y){return y.width&&y.width>=v+2*y.margin?y.width/(v+2*y.margin):y.scale},N.getImageWidth=function(v,y){const k=N.getScale(v,y);return Math.floor((v+2*y.margin)*k)},N.qrToImageData=function(v,y,k){const h=y.modules.size,T=y.modules.data,B=N.getScale(h,k),U=Math.floor((h+2*k.margin)*B),$=k.margin*B,oe=[k.color.light,k.color.dark];for(let le=0;le<U;le++)for(let te=0;te<U;te++){let ne=4*(le*U+te),O=k.color.light;le>=$&&te>=$&&le<U-$&&te<U-$&&(O=oe[T[Math.floor((le-$)/B)*h+Math.floor((te-$)/B)]?1:0]),v[ne++]=O.r,v[ne++]=O.g,v[ne++]=O.b,v[ne]=O.a}}},917:function(Ee,N,M){!function(x,v){"use strict";function y(_,s){if(!_)throw new Error(s||"Assertion failed")}function k(_,s){_.super_=s;var c=function(){};c.prototype=s.prototype,_.prototype=new c,_.prototype.constructor=_}function h(_,s,c){if(h.isBN(_))return _;this.negative=0,this.words=null,this.length=0,this.red=null,null!==_&&(("le"===s||"be"===s)&&(c=s,s=10),this._init(_||0,s||10,c||"be"))}var T;"object"==typeof x?x.exports=h:v.BN=h,h.BN=h,h.wordSize=26;try{T=typeof window<"u"&&typeof window.Buffer<"u"?window.Buffer:M(7790).Buffer}catch{}function B(_,s){var c=_.charCodeAt(s);return c>=65&&c<=70?c-55:c>=97&&c<=102?c-87:c-48&15}function U(_,s,c){var d=B(_,c);return c-1>=s&&(d|=B(_,c-1)<<4),d}function $(_,s,c,d){for(var p=0,E=Math.min(_.length,c),A=s;A<E;A++){var R=_.charCodeAt(A)-48;p*=d,p+=R>=49?R-49+10:R>=17?R-17+10:R}return p}h.isBN=function(s){return s instanceof h||null!==s&&"object"==typeof s&&s.constructor.wordSize===h.wordSize&&Array.isArray(s.words)},h.max=function(s,c){return s.cmp(c)>0?s:c},h.min=function(s,c){return s.cmp(c)<0?s:c},h.prototype._init=function(s,c,d){if("number"==typeof s)return this._initNumber(s,c,d);if("object"==typeof s)return this._initArray(s,c,d);"hex"===c&&(c=16),y(c===(0|c)&&c>=2&&c<=36);var p=0;"-"===(s=s.toString().replace(/\s+/g,""))[0]&&(p++,this.negative=1),p<s.length&&(16===c?this._parseHex(s,p,d):(this._parseBase(s,c,p),"le"===d&&this._initArray(this.toArray(),c,d)))},h.prototype._initNumber=function(s,c,d){s<0&&(this.negative=1,s=-s),s<67108864?(this.words=[67108863&s],this.length=1):s<4503599627370496?(this.words=[67108863&s,s/67108864&67108863],this.length=2):(y(s<9007199254740992),this.words=[67108863&s,s/67108864&67108863,1],this.length=3),"le"===d&&this._initArray(this.toArray(),c,d)},h.prototype._initArray=function(s,c,d){if(y("number"==typeof s.length),s.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(s.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var E,A,R=0;if("be"===d)for(p=s.length-1,E=0;p>=0;p-=3)this.words[E]|=(A=s[p]|s[p-1]<<8|s[p-2]<<16)<<R&67108863,this.words[E+1]=A>>>26-R&67108863,(R+=24)>=26&&(R-=26,E++);else if("le"===d)for(p=0,E=0;p<s.length;p+=3)this.words[E]|=(A=s[p]|s[p+1]<<8|s[p+2]<<16)<<R&67108863,this.words[E+1]=A>>>26-R&67108863,(R+=24)>=26&&(R-=26,E++);return this.strip()},h.prototype._parseHex=function(s,c,d){this.length=Math.ceil((s.length-c)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var R,E=0,A=0;if("be"===d)for(p=s.length-1;p>=c;p-=2)R=U(s,c,p)<<E,this.words[A]|=67108863&R,E>=18?(E-=18,this.words[A+=1]|=R>>>26):E+=8;else for(p=(s.length-c)%2==0?c+1:c;p<s.length;p+=2)R=U(s,c,p)<<E,this.words[A]|=67108863&R,E>=18?(E-=18,this.words[A+=1]|=R>>>26):E+=8;this.strip()},h.prototype._parseBase=function(s,c,d){this.words=[0],this.length=1;for(var p=0,E=1;E<=67108863;E*=c)p++;p--,E=E/c|0;for(var A=s.length-d,R=A%p,w=Math.min(A,A-R)+d,l=0,b=d;b<w;b+=p)l=$(s,b,b+p,c),this.imuln(E),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(0!==R){var ue=1;for(l=$(s,b,s.length,c),b=0;b<R;b++)ue*=c;this.imuln(ue),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}this.strip()},h.prototype.copy=function(s){s.words=new Array(this.length);for(var c=0;c<this.length;c++)s.words[c]=this.words[c];s.length=this.length,s.negative=this.negative,s.red=this.red},h.prototype.clone=function(){var s=new h(null);return this.copy(s),s},h.prototype._expand=function(s){for(;this.length<s;)this.words[this.length++]=0;return this},h.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},h.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},h.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var oe=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],le=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],te=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function O(_,s,c){c.negative=s.negative^_.negative;var d=_.length+s.length|0;c.length=d,d=d-1|0;var p=0|_.words[0],E=0|s.words[0],A=p*E,w=A/67108864|0;c.words[0]=67108863&A;for(var l=1;l<d;l++){for(var b=w>>>26,ue=67108863&w,me=Math.min(l,s.length-1),ve=Math.max(0,l-_.length+1);ve<=me;ve++)b+=(A=(p=0|_.words[l-ve|0])*(E=0|s.words[ve])+ue)/67108864|0,ue=67108863&A;c.words[l]=0|ue,w=0|b}return 0!==w?c.words[l]=0|w:c.length--,c.strip()}h.prototype.toString=function(s,c){var d;if(c=0|c||1,16===(s=s||10)||"hex"===s){d="";for(var p=0,E=0,A=0;A<this.length;A++){var R=this.words[A],w=(16777215&(R<<p|E)).toString(16);d=0!=(E=R>>>24-p&16777215)||A!==this.length-1?oe[6-w.length]+w+d:w+d,(p+=2)>=26&&(p-=26,A--)}for(0!==E&&(d=E.toString(16)+d);d.length%c!=0;)d="0"+d;return 0!==this.negative&&(d="-"+d),d}if(s===(0|s)&&s>=2&&s<=36){var l=le[s],b=te[s];d="";var ue=this.clone();for(ue.negative=0;!ue.isZero();){var me=ue.modn(b).toString(s);d=(ue=ue.idivn(b)).isZero()?me+d:oe[l-me.length]+me+d}for(this.isZero()&&(d="0"+d);d.length%c!=0;)d="0"+d;return 0!==this.negative&&(d="-"+d),d}y(!1,"Base should be between 2 and 36")},h.prototype.toNumber=function(){var s=this.words[0];return 2===this.length?s+=67108864*this.words[1]:3===this.length&&1===this.words[2]?s+=4503599627370496+67108864*this.words[1]:this.length>2&&y(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-s:s},h.prototype.toJSON=function(){return this.toString(16)},h.prototype.toBuffer=function(s,c){return y(typeof T<"u"),this.toArrayLike(T,s,c)},h.prototype.toArray=function(s,c){return this.toArrayLike(Array,s,c)},h.prototype.toArrayLike=function(s,c,d){var p=this.byteLength(),E=d||Math.max(1,p);y(p<=E,"byte array longer than desired length"),y(E>0,"Requested array length <= 0"),this.strip();var w,l,A="le"===c,R=new s(E),b=this.clone();if(A){for(l=0;!b.isZero();l++)w=b.andln(255),b.iushrn(8),R[l]=w;for(;l<E;l++)R[l]=0}else{for(l=0;l<E-p;l++)R[l]=0;for(l=0;!b.isZero();l++)w=b.andln(255),b.iushrn(8),R[E-l-1]=w}return R},h.prototype._countBits=Math.clz32?function(s){return 32-Math.clz32(s)}:function(s){var c=s,d=0;return c>=4096&&(d+=13,c>>>=13),c>=64&&(d+=7,c>>>=7),c>=8&&(d+=4,c>>>=4),c>=2&&(d+=2,c>>>=2),d+c},h.prototype._zeroBits=function(s){if(0===s)return 26;var c=s,d=0;return 8191&c||(d+=13,c>>>=13),127&c||(d+=7,c>>>=7),15&c||(d+=4,c>>>=4),3&c||(d+=2,c>>>=2),1&c||d++,d},h.prototype.bitLength=function(){var c=this._countBits(this.words[this.length-1]);return 26*(this.length-1)+c},h.prototype.zeroBits=function(){if(this.isZero())return 0;for(var s=0,c=0;c<this.length;c++){var d=this._zeroBits(this.words[c]);if(s+=d,26!==d)break}return s},h.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},h.prototype.toTwos=function(s){return 0!==this.negative?this.abs().inotn(s).iaddn(1):this.clone()},h.prototype.fromTwos=function(s){return this.testn(s-1)?this.notn(s).iaddn(1).ineg():this.clone()},h.prototype.isNeg=function(){return 0!==this.negative},h.prototype.neg=function(){return this.clone().ineg()},h.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},h.prototype.iuor=function(s){for(;this.length<s.length;)this.words[this.length++]=0;for(var c=0;c<s.length;c++)this.words[c]=this.words[c]|s.words[c];return this.strip()},h.prototype.ior=function(s){return y(!(this.negative|s.negative)),this.iuor(s)},h.prototype.or=function(s){return this.length>s.length?this.clone().ior(s):s.clone().ior(this)},h.prototype.uor=function(s){return this.length>s.length?this.clone().iuor(s):s.clone().iuor(this)},h.prototype.iuand=function(s){var c;c=this.length>s.length?s:this;for(var d=0;d<c.length;d++)this.words[d]=this.words[d]&s.words[d];return this.length=c.length,this.strip()},h.prototype.iand=function(s){return y(!(this.negative|s.negative)),this.iuand(s)},h.prototype.and=function(s){return this.length>s.length?this.clone().iand(s):s.clone().iand(this)},h.prototype.uand=function(s){return this.length>s.length?this.clone().iuand(s):s.clone().iuand(this)},h.prototype.iuxor=function(s){var c,d;this.length>s.length?(c=this,d=s):(c=s,d=this);for(var p=0;p<d.length;p++)this.words[p]=c.words[p]^d.words[p];if(this!==c)for(;p<c.length;p++)this.words[p]=c.words[p];return this.length=c.length,this.strip()},h.prototype.ixor=function(s){return y(!(this.negative|s.negative)),this.iuxor(s)},h.prototype.xor=function(s){return this.length>s.length?this.clone().ixor(s):s.clone().ixor(this)},h.prototype.uxor=function(s){return this.length>s.length?this.clone().iuxor(s):s.clone().iuxor(this)},h.prototype.inotn=function(s){y("number"==typeof s&&s>=0);var c=0|Math.ceil(s/26),d=s%26;this._expand(c),d>0&&c--;for(var p=0;p<c;p++)this.words[p]=67108863&~this.words[p];return d>0&&(this.words[p]=~this.words[p]&67108863>>26-d),this.strip()},h.prototype.notn=function(s){return this.clone().inotn(s)},h.prototype.setn=function(s,c){y("number"==typeof s&&s>=0);var d=s/26|0,p=s%26;return this._expand(d+1),this.words[d]=c?this.words[d]|1<<p:this.words[d]&~(1<<p),this.strip()},h.prototype.iadd=function(s){var c,d,p;if(0!==this.negative&&0===s.negative)return this.negative=0,c=this.isub(s),this.negative^=1,this._normSign();if(0===this.negative&&0!==s.negative)return s.negative=0,c=this.isub(s),s.negative=1,c._normSign();this.length>s.length?(d=this,p=s):(d=s,p=this);for(var E=0,A=0;A<p.length;A++)this.words[A]=67108863&(c=(0|d.words[A])+(0|p.words[A])+E),E=c>>>26;for(;0!==E&&A<d.length;A++)this.words[A]=67108863&(c=(0|d.words[A])+E),E=c>>>26;if(this.length=d.length,0!==E)this.words[this.length]=E,this.length++;else if(d!==this)for(;A<d.length;A++)this.words[A]=d.words[A];return this},h.prototype.add=function(s){var c;return 0!==s.negative&&0===this.negative?(s.negative=0,c=this.sub(s),s.negative^=1,c):0===s.negative&&0!==this.negative?(this.negative=0,c=s.sub(this),this.negative=1,c):this.length>s.length?this.clone().iadd(s):s.clone().iadd(this)},h.prototype.isub=function(s){if(0!==s.negative){s.negative=0;var c=this.iadd(s);return s.negative=1,c._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(s),this.negative=1,this._normSign();var p,E,d=this.cmp(s);if(0===d)return this.negative=0,this.length=1,this.words[0]=0,this;d>0?(p=this,E=s):(p=s,E=this);for(var A=0,R=0;R<E.length;R++)A=(c=(0|p.words[R])-(0|E.words[R])+A)>>26,this.words[R]=67108863&c;for(;0!==A&&R<p.length;R++)A=(c=(0|p.words[R])+A)>>26,this.words[R]=67108863&c;if(0===A&&R<p.length&&p!==this)for(;R<p.length;R++)this.words[R]=p.words[R];return this.length=Math.max(this.length,R),p!==this&&(this.negative=1),this.strip()},h.prototype.sub=function(s){return this.clone().isub(s)};var D=function(s,c,d){var w,l,b,p=s.words,E=c.words,A=d.words,R=0,ue=0|p[0],me=8191&ue,ve=ue>>>13,xe=0|p[1],Ae=8191&xe,Ne=xe>>>13,lt=0|p[2],Se=8191&lt,Ue=lt>>>13,Ht=0|p[3],Qe=8191&Ht,Je=Ht>>>13,vr=0|p[4],ct=8191&vr,ut=vr>>>13,yr=0|p[5],et=8191&yr,ft=yr>>>13,Pn=0|p[6],tt=8191&Pn,We=Pn>>>13,Ln=0|p[7],ht=8191&Ln,dt=Ln>>>13,On=0|p[8],Ge=8191&On,Ve=On>>>13,Tt=0|p[9],Ye=8191&Tt,Ke=Tt>>>13,jn=0|E[0],nt=8191&jn,Ze=jn>>>13,Fn=0|E[1],rt=8191&Fn,Fe=Fn>>>13,nn=0|E[2],it=8191&nn,Xe=nn>>>13,Dn=0|E[3],ot=8191&Dn,st=Dn>>>13,wr=0|E[4],Pe=8191&wr,ze=wr>>>13,rn=0|E[5],gt=8191&rn,pt=rn>>>13,on=0|E[6],Le=8191&on,mt=on>>>13,$n=0|E[7],Be=8191&$n,De=$n>>>13,qn=0|E[8],vt=8191&qn,He=qn>>>13,Gn=0|E[9],Oe=8191&Gn,$e=Gn>>>13;d.negative=s.negative^c.negative,d.length=19;var sn=(R+(w=Math.imul(me,nt))|0)+((8191&(l=(l=Math.imul(me,Ze))+Math.imul(ve,nt)|0))<<13)|0;R=((b=Math.imul(ve,Ze))+(l>>>13)|0)+(sn>>>26)|0,sn&=67108863,w=Math.imul(Ae,nt),l=(l=Math.imul(Ae,Ze))+Math.imul(Ne,nt)|0,b=Math.imul(Ne,Ze);var yn=(R+(w=w+Math.imul(me,rt)|0)|0)+((8191&(l=(l=l+Math.imul(me,Fe)|0)+Math.imul(ve,rt)|0))<<13)|0;R=((b=b+Math.imul(ve,Fe)|0)+(l>>>13)|0)+(yn>>>26)|0,yn&=67108863,w=Math.imul(Se,nt),l=(l=Math.imul(Se,Ze))+Math.imul(Ue,nt)|0,b=Math.imul(Ue,Ze),w=w+Math.imul(Ae,rt)|0,l=(l=l+Math.imul(Ae,Fe)|0)+Math.imul(Ne,rt)|0,b=b+Math.imul(Ne,Fe)|0;var zn=(R+(w=w+Math.imul(me,it)|0)|0)+((8191&(l=(l=l+Math.imul(me,Xe)|0)+Math.imul(ve,it)|0))<<13)|0;R=((b=b+Math.imul(ve,Xe)|0)+(l>>>13)|0)+(zn>>>26)|0,zn&=67108863,w=Math.imul(Qe,nt),l=(l=Math.imul(Qe,Ze))+Math.imul(Je,nt)|0,b=Math.imul(Je,Ze),w=w+Math.imul(Se,rt)|0,l=(l=l+Math.imul(Se,Fe)|0)+Math.imul(Ue,rt)|0,b=b+Math.imul(Ue,Fe)|0,w=w+Math.imul(Ae,it)|0,l=(l=l+Math.imul(Ae,Xe)|0)+Math.imul(Ne,it)|0,b=b+Math.imul(Ne,Xe)|0;var an=(R+(w=w+Math.imul(me,ot)|0)|0)+((8191&(l=(l=l+Math.imul(me,st)|0)+Math.imul(ve,ot)|0))<<13)|0;R=((b=b+Math.imul(ve,st)|0)+(l>>>13)|0)+(an>>>26)|0,an&=67108863,w=Math.imul(ct,nt),l=(l=Math.imul(ct,Ze))+Math.imul(ut,nt)|0,b=Math.imul(ut,Ze),w=w+Math.imul(Qe,rt)|0,l=(l=l+Math.imul(Qe,Fe)|0)+Math.imul(Je,rt)|0,b=b+Math.imul(Je,Fe)|0,w=w+Math.imul(Se,it)|0,l=(l=l+Math.imul(Se,Xe)|0)+Math.imul(Ue,it)|0,b=b+Math.imul(Ue,Xe)|0,w=w+Math.imul(Ae,ot)|0,l=(l=l+Math.imul(Ae,st)|0)+Math.imul(Ne,ot)|0,b=b+Math.imul(Ne,st)|0;var Hn=(R+(w=w+Math.imul(me,Pe)|0)|0)+((8191&(l=(l=l+Math.imul(me,ze)|0)+Math.imul(ve,Pe)|0))<<13)|0;R=((b=b+Math.imul(ve,ze)|0)+(l>>>13)|0)+(Hn>>>26)|0,Hn&=67108863,w=Math.imul(et,nt),l=(l=Math.imul(et,Ze))+Math.imul(ft,nt)|0,b=Math.imul(ft,Ze),w=w+Math.imul(ct,rt)|0,l=(l=l+Math.imul(ct,Fe)|0)+Math.imul(ut,rt)|0,b=b+Math.imul(ut,Fe)|0,w=w+Math.imul(Qe,it)|0,l=(l=l+Math.imul(Qe,Xe)|0)+Math.imul(Je,it)|0,b=b+Math.imul(Je,Xe)|0,w=w+Math.imul(Se,ot)|0,l=(l=l+Math.imul(Se,st)|0)+Math.imul(Ue,ot)|0,b=b+Math.imul(Ue,st)|0,w=w+Math.imul(Ae,Pe)|0,l=(l=l+Math.imul(Ae,ze)|0)+Math.imul(Ne,Pe)|0,b=b+Math.imul(Ne,ze)|0;var Wn=(R+(w=w+Math.imul(me,gt)|0)|0)+((8191&(l=(l=l+Math.imul(me,pt)|0)+Math.imul(ve,gt)|0))<<13)|0;R=((b=b+Math.imul(ve,pt)|0)+(l>>>13)|0)+(Wn>>>26)|0,Wn&=67108863,w=Math.imul(tt,nt),l=(l=Math.imul(tt,Ze))+Math.imul(We,nt)|0,b=Math.imul(We,Ze),w=w+Math.imul(et,rt)|0,l=(l=l+Math.imul(et,Fe)|0)+Math.imul(ft,rt)|0,b=b+Math.imul(ft,Fe)|0,w=w+Math.imul(ct,it)|0,l=(l=l+Math.imul(ct,Xe)|0)+Math.imul(ut,it)|0,b=b+Math.imul(ut,Xe)|0,w=w+Math.imul(Qe,ot)|0,l=(l=l+Math.imul(Qe,st)|0)+Math.imul(Je,ot)|0,b=b+Math.imul(Je,st)|0,w=w+Math.imul(Se,Pe)|0,l=(l=l+Math.imul(Se,ze)|0)+Math.imul(Ue,Pe)|0,b=b+Math.imul(Ue,ze)|0,w=w+Math.imul(Ae,gt)|0,l=(l=l+Math.imul(Ae,pt)|0)+Math.imul(Ne,gt)|0,b=b+Math.imul(Ne,pt)|0;var Wt=(R+(w=w+Math.imul(me,Le)|0)|0)+((8191&(l=(l=l+Math.imul(me,mt)|0)+Math.imul(ve,Le)|0))<<13)|0;R=((b=b+Math.imul(ve,mt)|0)+(l>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,w=Math.imul(ht,nt),l=(l=Math.imul(ht,Ze))+Math.imul(dt,nt)|0,b=Math.imul(dt,Ze),w=w+Math.imul(tt,rt)|0,l=(l=l+Math.imul(tt,Fe)|0)+Math.imul(We,rt)|0,b=b+Math.imul(We,Fe)|0,w=w+Math.imul(et,it)|0,l=(l=l+Math.imul(et,Xe)|0)+Math.imul(ft,it)|0,b=b+Math.imul(ft,Xe)|0,w=w+Math.imul(ct,ot)|0,l=(l=l+Math.imul(ct,st)|0)+Math.imul(ut,ot)|0,b=b+Math.imul(ut,st)|0,w=w+Math.imul(Qe,Pe)|0,l=(l=l+Math.imul(Qe,ze)|0)+Math.imul(Je,Pe)|0,b=b+Math.imul(Je,ze)|0,w=w+Math.imul(Se,gt)|0,l=(l=l+Math.imul(Se,pt)|0)+Math.imul(Ue,gt)|0,b=b+Math.imul(Ue,pt)|0,w=w+Math.imul(Ae,Le)|0,l=(l=l+Math.imul(Ae,mt)|0)+Math.imul(Ne,Le)|0,b=b+Math.imul(Ne,mt)|0;var wn=(R+(w=w+Math.imul(me,Be)|0)|0)+((8191&(l=(l=l+Math.imul(me,De)|0)+Math.imul(ve,Be)|0))<<13)|0;R=((b=b+Math.imul(ve,De)|0)+(l>>>13)|0)+(wn>>>26)|0,wn&=67108863,w=Math.imul(Ge,nt),l=(l=Math.imul(Ge,Ze))+Math.imul(Ve,nt)|0,b=Math.imul(Ve,Ze),w=w+Math.imul(ht,rt)|0,l=(l=l+Math.imul(ht,Fe)|0)+Math.imul(dt,rt)|0,b=b+Math.imul(dt,Fe)|0,w=w+Math.imul(tt,it)|0,l=(l=l+Math.imul(tt,Xe)|0)+Math.imul(We,it)|0,b=b+Math.imul(We,Xe)|0,w=w+Math.imul(et,ot)|0,l=(l=l+Math.imul(et,st)|0)+Math.imul(ft,ot)|0,b=b+Math.imul(ft,st)|0,w=w+Math.imul(ct,Pe)|0,l=(l=l+Math.imul(ct,ze)|0)+Math.imul(ut,Pe)|0,b=b+Math.imul(ut,ze)|0,w=w+Math.imul(Qe,gt)|0,l=(l=l+Math.imul(Qe,pt)|0)+Math.imul(Je,gt)|0,b=b+Math.imul(Je,pt)|0,w=w+Math.imul(Se,Le)|0,l=(l=l+Math.imul(Se,mt)|0)+Math.imul(Ue,Le)|0,b=b+Math.imul(Ue,mt)|0,w=w+Math.imul(Ae,Be)|0,l=(l=l+Math.imul(Ae,De)|0)+Math.imul(Ne,Be)|0,b=b+Math.imul(Ne,De)|0;var bn=(R+(w=w+Math.imul(me,vt)|0)|0)+((8191&(l=(l=l+Math.imul(me,He)|0)+Math.imul(ve,vt)|0))<<13)|0;R=((b=b+Math.imul(ve,He)|0)+(l>>>13)|0)+(bn>>>26)|0,bn&=67108863,w=Math.imul(Ye,nt),l=(l=Math.imul(Ye,Ze))+Math.imul(Ke,nt)|0,b=Math.imul(Ke,Ze),w=w+Math.imul(Ge,rt)|0,l=(l=l+Math.imul(Ge,Fe)|0)+Math.imul(Ve,rt)|0,b=b+Math.imul(Ve,Fe)|0,w=w+Math.imul(ht,it)|0,l=(l=l+Math.imul(ht,Xe)|0)+Math.imul(dt,it)|0,b=b+Math.imul(dt,Xe)|0,w=w+Math.imul(tt,ot)|0,l=(l=l+Math.imul(tt,st)|0)+Math.imul(We,ot)|0,b=b+Math.imul(We,st)|0,w=w+Math.imul(et,Pe)|0,l=(l=l+Math.imul(et,ze)|0)+Math.imul(ft,Pe)|0,b=b+Math.imul(ft,ze)|0,w=w+Math.imul(ct,gt)|0,l=(l=l+Math.imul(ct,pt)|0)+Math.imul(ut,gt)|0,b=b+Math.imul(ut,pt)|0,w=w+Math.imul(Qe,Le)|0,l=(l=l+Math.imul(Qe,mt)|0)+Math.imul(Je,Le)|0,b=b+Math.imul(Je,mt)|0,w=w+Math.imul(Se,Be)|0,l=(l=l+Math.imul(Se,De)|0)+Math.imul(Ue,Be)|0,b=b+Math.imul(Ue,De)|0,w=w+Math.imul(Ae,vt)|0,l=(l=l+Math.imul(Ae,He)|0)+Math.imul(Ne,vt)|0,b=b+Math.imul(Ne,He)|0;var _n=(R+(w=w+Math.imul(me,Oe)|0)|0)+((8191&(l=(l=l+Math.imul(me,$e)|0)+Math.imul(ve,Oe)|0))<<13)|0;R=((b=b+Math.imul(ve,$e)|0)+(l>>>13)|0)+(_n>>>26)|0,_n&=67108863,w=Math.imul(Ye,rt),l=(l=Math.imul(Ye,Fe))+Math.imul(Ke,rt)|0,b=Math.imul(Ke,Fe),w=w+Math.imul(Ge,it)|0,l=(l=l+Math.imul(Ge,Xe)|0)+Math.imul(Ve,it)|0,b=b+Math.imul(Ve,Xe)|0,w=w+Math.imul(ht,ot)|0,l=(l=l+Math.imul(ht,st)|0)+Math.imul(dt,ot)|0,b=b+Math.imul(dt,st)|0,w=w+Math.imul(tt,Pe)|0,l=(l=l+Math.imul(tt,ze)|0)+Math.imul(We,Pe)|0,b=b+Math.imul(We,ze)|0,w=w+Math.imul(et,gt)|0,l=(l=l+Math.imul(et,pt)|0)+Math.imul(ft,gt)|0,b=b+Math.imul(ft,pt)|0,w=w+Math.imul(ct,Le)|0,l=(l=l+Math.imul(ct,mt)|0)+Math.imul(ut,Le)|0,b=b+Math.imul(ut,mt)|0,w=w+Math.imul(Qe,Be)|0,l=(l=l+Math.imul(Qe,De)|0)+Math.imul(Je,Be)|0,b=b+Math.imul(Je,De)|0,w=w+Math.imul(Se,vt)|0,l=(l=l+Math.imul(Se,He)|0)+Math.imul(Ue,vt)|0,b=b+Math.imul(Ue,He)|0;var En=(R+(w=w+Math.imul(Ae,Oe)|0)|0)+((8191&(l=(l=l+Math.imul(Ae,$e)|0)+Math.imul(Ne,Oe)|0))<<13)|0;R=((b=b+Math.imul(Ne,$e)|0)+(l>>>13)|0)+(En>>>26)|0,En&=67108863,w=Math.imul(Ye,it),l=(l=Math.imul(Ye,Xe))+Math.imul(Ke,it)|0,b=Math.imul(Ke,Xe),w=w+Math.imul(Ge,ot)|0,l=(l=l+Math.imul(Ge,st)|0)+Math.imul(Ve,ot)|0,b=b+Math.imul(Ve,st)|0,w=w+Math.imul(ht,Pe)|0,l=(l=l+Math.imul(ht,ze)|0)+Math.imul(dt,Pe)|0,b=b+Math.imul(dt,ze)|0,w=w+Math.imul(tt,gt)|0,l=(l=l+Math.imul(tt,pt)|0)+Math.imul(We,gt)|0,b=b+Math.imul(We,pt)|0,w=w+Math.imul(et,Le)|0,l=(l=l+Math.imul(et,mt)|0)+Math.imul(ft,Le)|0,b=b+Math.imul(ft,mt)|0,w=w+Math.imul(ct,Be)|0,l=(l=l+Math.imul(ct,De)|0)+Math.imul(ut,Be)|0,b=b+Math.imul(ut,De)|0,w=w+Math.imul(Qe,vt)|0,l=(l=l+Math.imul(Qe,He)|0)+Math.imul(Je,vt)|0,b=b+Math.imul(Je,He)|0;var xn=(R+(w=w+Math.imul(Se,Oe)|0)|0)+((8191&(l=(l=l+Math.imul(Se,$e)|0)+Math.imul(Ue,Oe)|0))<<13)|0;R=((b=b+Math.imul(Ue,$e)|0)+(l>>>13)|0)+(xn>>>26)|0,xn&=67108863,w=Math.imul(Ye,ot),l=(l=Math.imul(Ye,st))+Math.imul(Ke,ot)|0,b=Math.imul(Ke,st),w=w+Math.imul(Ge,Pe)|0,l=(l=l+Math.imul(Ge,ze)|0)+Math.imul(Ve,Pe)|0,b=b+Math.imul(Ve,ze)|0,w=w+Math.imul(ht,gt)|0,l=(l=l+Math.imul(ht,pt)|0)+Math.imul(dt,gt)|0,b=b+Math.imul(dt,pt)|0,w=w+Math.imul(tt,Le)|0,l=(l=l+Math.imul(tt,mt)|0)+Math.imul(We,Le)|0,b=b+Math.imul(We,mt)|0,w=w+Math.imul(et,Be)|0,l=(l=l+Math.imul(et,De)|0)+Math.imul(ft,Be)|0,b=b+Math.imul(ft,De)|0,w=w+Math.imul(ct,vt)|0,l=(l=l+Math.imul(ct,He)|0)+Math.imul(ut,vt)|0,b=b+Math.imul(ut,He)|0;var Ut=(R+(w=w+Math.imul(Qe,Oe)|0)|0)+((8191&(l=(l=l+Math.imul(Qe,$e)|0)+Math.imul(Je,Oe)|0))<<13)|0;R=((b=b+Math.imul(Je,$e)|0)+(l>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,w=Math.imul(Ye,Pe),l=(l=Math.imul(Ye,ze))+Math.imul(Ke,Pe)|0,b=Math.imul(Ke,ze),w=w+Math.imul(Ge,gt)|0,l=(l=l+Math.imul(Ge,pt)|0)+Math.imul(Ve,gt)|0,b=b+Math.imul(Ve,pt)|0,w=w+Math.imul(ht,Le)|0,l=(l=l+Math.imul(ht,mt)|0)+Math.imul(dt,Le)|0,b=b+Math.imul(dt,mt)|0,w=w+Math.imul(tt,Be)|0,l=(l=l+Math.imul(tt,De)|0)+Math.imul(We,Be)|0,b=b+Math.imul(We,De)|0,w=w+Math.imul(et,vt)|0,l=(l=l+Math.imul(et,He)|0)+Math.imul(ft,vt)|0,b=b+Math.imul(ft,He)|0;var Nt=(R+(w=w+Math.imul(ct,Oe)|0)|0)+((8191&(l=(l=l+Math.imul(ct,$e)|0)+Math.imul(ut,Oe)|0))<<13)|0;R=((b=b+Math.imul(ut,$e)|0)+(l>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,w=Math.imul(Ye,gt),l=(l=Math.imul(Ye,pt))+Math.imul(Ke,gt)|0,b=Math.imul(Ke,pt),w=w+Math.imul(Ge,Le)|0,l=(l=l+Math.imul(Ge,mt)|0)+Math.imul(Ve,Le)|0,b=b+Math.imul(Ve,mt)|0,w=w+Math.imul(ht,Be)|0,l=(l=l+Math.imul(ht,De)|0)+Math.imul(dt,Be)|0,b=b+Math.imul(dt,De)|0,w=w+Math.imul(tt,vt)|0,l=(l=l+Math.imul(tt,He)|0)+Math.imul(We,vt)|0,b=b+Math.imul(We,He)|0;var ln=(R+(w=w+Math.imul(et,Oe)|0)|0)+((8191&(l=(l=l+Math.imul(et,$e)|0)+Math.imul(ft,Oe)|0))<<13)|0;R=((b=b+Math.imul(ft,$e)|0)+(l>>>13)|0)+(ln>>>26)|0,ln&=67108863,w=Math.imul(Ye,Le),l=(l=Math.imul(Ye,mt))+Math.imul(Ke,Le)|0,b=Math.imul(Ke,mt),w=w+Math.imul(Ge,Be)|0,l=(l=l+Math.imul(Ge,De)|0)+Math.imul(Ve,Be)|0,b=b+Math.imul(Ve,De)|0,w=w+Math.imul(ht,vt)|0,l=(l=l+Math.imul(ht,He)|0)+Math.imul(dt,vt)|0,b=b+Math.imul(dt,He)|0;var Mn=(R+(w=w+Math.imul(tt,Oe)|0)|0)+((8191&(l=(l=l+Math.imul(tt,$e)|0)+Math.imul(We,Oe)|0))<<13)|0;R=((b=b+Math.imul(We,$e)|0)+(l>>>13)|0)+(Mn>>>26)|0,Mn&=67108863,w=Math.imul(Ye,Be),l=(l=Math.imul(Ye,De))+Math.imul(Ke,Be)|0,b=Math.imul(Ke,De),w=w+Math.imul(Ge,vt)|0,l=(l=l+Math.imul(Ge,He)|0)+Math.imul(Ve,vt)|0,b=b+Math.imul(Ve,He)|0;var It=(R+(w=w+Math.imul(ht,Oe)|0)|0)+((8191&(l=(l=l+Math.imul(ht,$e)|0)+Math.imul(dt,Oe)|0))<<13)|0;R=((b=b+Math.imul(dt,$e)|0)+(l>>>13)|0)+(It>>>26)|0,It&=67108863,w=Math.imul(Ye,vt),l=(l=Math.imul(Ye,He))+Math.imul(Ke,vt)|0,b=Math.imul(Ke,He);var Vn=(R+(w=w+Math.imul(Ge,Oe)|0)|0)+((8191&(l=(l=l+Math.imul(Ge,$e)|0)+Math.imul(Ve,Oe)|0))<<13)|0;R=((b=b+Math.imul(Ve,$e)|0)+(l>>>13)|0)+(Vn>>>26)|0,Vn&=67108863;var cn=(R+(w=Math.imul(Ye,Oe))|0)+((8191&(l=(l=Math.imul(Ye,$e))+Math.imul(Ke,Oe)|0))<<13)|0;return R=((b=Math.imul(Ke,$e))+(l>>>13)|0)+(cn>>>26)|0,cn&=67108863,A[0]=sn,A[1]=yn,A[2]=zn,A[3]=an,A[4]=Hn,A[5]=Wn,A[6]=Wt,A[7]=wn,A[8]=bn,A[9]=_n,A[10]=En,A[11]=xn,A[12]=Ut,A[13]=Nt,A[14]=ln,A[15]=Mn,A[16]=It,A[17]=Vn,A[18]=cn,0!==R&&(A[19]=R,d.length++),d};function H(_,s,c){return(new K).mulp(_,s,c)}function K(_,s){this.x=_,this.y=s}Math.imul||(D=O),h.prototype.mulTo=function(s,c){var d,p=this.length+s.length;return d=10===this.length&&10===s.length?D(this,s,c):p<63?O(this,s,c):p<1024?function he(_,s,c){c.negative=s.negative^_.negative,c.length=_.length+s.length;for(var d=0,p=0,E=0;E<c.length-1;E++){var A=p;p=0;for(var R=67108863&d,w=Math.min(E,s.length-1),l=Math.max(0,E-_.length+1);l<=w;l++){var ve=(0|_.words[E-l])*(0|s.words[l]),xe=67108863&ve;R=67108863&(xe=xe+R|0),p+=(A=(A=A+(ve/67108864|0)|0)+(xe>>>26)|0)>>>26,A&=67108863}c.words[E]=R,d=A,A=p}return 0!==d?c.words[E]=d:c.length--,c.strip()}(this,s,c):H(this,s,c),d},K.prototype.makeRBT=function(s){for(var c=new Array(s),d=h.prototype._countBits(s)-1,p=0;p<s;p++)c[p]=this.revBin(p,d,s);return c},K.prototype.revBin=function(s,c,d){if(0===s||s===d-1)return s;for(var p=0,E=0;E<c;E++)p|=(1&s)<<c-E-1,s>>=1;return p},K.prototype.permute=function(s,c,d,p,E,A){for(var R=0;R<A;R++)p[R]=c[s[R]],E[R]=d[s[R]]},K.prototype.transform=function(s,c,d,p,E,A){this.permute(A,s,c,d,p,E);for(var R=1;R<E;R<<=1)for(var w=R<<1,l=Math.cos(2*Math.PI/w),b=Math.sin(2*Math.PI/w),ue=0;ue<E;ue+=w)for(var me=l,ve=b,xe=0;xe<R;xe++){var Ae=d[ue+xe],Ne=p[ue+xe],lt=d[ue+xe+R],Se=p[ue+xe+R],Ue=me*lt-ve*Se;Se=me*Se+ve*lt,d[ue+xe]=Ae+(lt=Ue),p[ue+xe]=Ne+Se,d[ue+xe+R]=Ae-lt,p[ue+xe+R]=Ne-Se,xe!==w&&(Ue=l*me-b*ve,ve=l*ve+b*me,me=Ue)}},K.prototype.guessLen13b=function(s,c){var d=1|Math.max(c,s),p=1&d,E=0;for(d=d/2|0;d;d>>>=1)E++;return 1<<E+1+p},K.prototype.conjugate=function(s,c,d){if(!(d<=1))for(var p=0;p<d/2;p++){var E=s[p];s[p]=s[d-p-1],s[d-p-1]=E,E=c[p],c[p]=-c[d-p-1],c[d-p-1]=-E}},K.prototype.normalize13b=function(s,c){for(var d=0,p=0;p<c/2;p++){var E=8192*Math.round(s[2*p+1]/c)+Math.round(s[2*p]/c)+d;s[p]=67108863&E,d=E<67108864?0:E/67108864|0}return s},K.prototype.convert13b=function(s,c,d,p){for(var E=0,A=0;A<c;A++)d[2*A]=8191&(E+=0|s[A]),d[2*A+1]=8191&(E>>>=13),E>>>=13;for(A=2*c;A<p;++A)d[A]=0;y(0===E),y(!(-8192&E))},K.prototype.stub=function(s){for(var c=new Array(s),d=0;d<s;d++)c[d]=0;return c},K.prototype.mulp=function(s,c,d){var p=2*this.guessLen13b(s.length,c.length),E=this.makeRBT(p),A=this.stub(p),R=new Array(p),w=new Array(p),l=new Array(p),b=new Array(p),ue=new Array(p),me=new Array(p),ve=d.words;ve.length=p,this.convert13b(s.words,s.length,R,p),this.convert13b(c.words,c.length,b,p),this.transform(R,A,w,l,p,E),this.transform(b,A,ue,me,p,E);for(var xe=0;xe<p;xe++){var Ae=w[xe]*ue[xe]-l[xe]*me[xe];l[xe]=w[xe]*me[xe]+l[xe]*ue[xe],w[xe]=Ae}return this.conjugate(w,l,p),this.transform(w,l,ve,A,p,E),this.conjugate(ve,A,p),this.normalize13b(ve,p),d.negative=s.negative^c.negative,d.length=s.length+c.length,d.strip()},h.prototype.mul=function(s){var c=new h(null);return c.words=new Array(this.length+s.length),this.mulTo(s,c)},h.prototype.mulf=function(s){var c=new h(null);return c.words=new Array(this.length+s.length),H(this,s,c)},h.prototype.imul=function(s){return this.clone().mulTo(s,this)},h.prototype.imuln=function(s){y("number"==typeof s),y(s<67108864);for(var c=0,d=0;d<this.length;d++){var p=(0|this.words[d])*s,E=(67108863&p)+(67108863&c);c>>=26,c+=p/67108864|0,c+=E>>>26,this.words[d]=67108863&E}return 0!==c&&(this.words[d]=c,this.length++),this},h.prototype.muln=function(s){return this.clone().imuln(s)},h.prototype.sqr=function(){return this.mul(this)},h.prototype.isqr=function(){return this.imul(this.clone())},h.prototype.pow=function(s){var c=function ne(_){for(var s=new Array(_.bitLength()),c=0;c<s.length;c++){var p=c%26;s[c]=(_.words[c/26|0]&1<<p)>>>p}return s}(s);if(0===c.length)return new h(1);for(var d=this,p=0;p<c.length&&0===c[p];p++,d=d.sqr());if(++p<c.length)for(var E=d.sqr();p<c.length;p++,E=E.sqr())0!==c[p]&&(d=d.mul(E));return d},h.prototype.iushln=function(s){y("number"==typeof s&&s>=0);var E,c=s%26,d=(s-c)/26,p=67108863>>>26-c<<26-c;if(0!==c){var A=0;for(E=0;E<this.length;E++){var R=this.words[E]&p;this.words[E]=(0|this.words[E])-R<<c|A,A=R>>>26-c}A&&(this.words[E]=A,this.length++)}if(0!==d){for(E=this.length-1;E>=0;E--)this.words[E+d]=this.words[E];for(E=0;E<d;E++)this.words[E]=0;this.length+=d}return this.strip()},h.prototype.ishln=function(s){return y(0===this.negative),this.iushln(s)},h.prototype.iushrn=function(s,c,d){var p;y("number"==typeof s&&s>=0),p=c?(c-c%26)/26:0;var E=s%26,A=Math.min((s-E)/26,this.length),R=67108863^67108863>>>E<<E,w=d;if(p-=A,p=Math.max(0,p),w){for(var l=0;l<A;l++)w.words[l]=this.words[l];w.length=A}if(0!==A)if(this.length>A)for(this.length-=A,l=0;l<this.length;l++)this.words[l]=this.words[l+A];else this.words[0]=0,this.length=1;var b=0;for(l=this.length-1;l>=0&&(0!==b||l>=p);l--){var ue=0|this.words[l];this.words[l]=b<<26-E|ue>>>E,b=ue&R}return w&&0!==b&&(w.words[w.length++]=b),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},h.prototype.ishrn=function(s,c,d){return y(0===this.negative),this.iushrn(s,c,d)},h.prototype.shln=function(s){return this.clone().ishln(s)},h.prototype.ushln=function(s){return this.clone().iushln(s)},h.prototype.shrn=function(s){return this.clone().ishrn(s)},h.prototype.ushrn=function(s){return this.clone().iushrn(s)},h.prototype.testn=function(s){y("number"==typeof s&&s>=0);var c=s%26,d=(s-c)/26;return!(this.length<=d||!(this.words[d]&1<<c))},h.prototype.imaskn=function(s){y("number"==typeof s&&s>=0);var c=s%26,d=(s-c)/26;return y(0===this.negative,"imaskn works only with positive numbers"),this.length<=d?this:(0!==c&&d++,this.length=Math.min(d,this.length),0!==c&&(this.words[this.length-1]&=67108863^67108863>>>c<<c),this.strip())},h.prototype.maskn=function(s){return this.clone().imaskn(s)},h.prototype.iaddn=function(s){return y("number"==typeof s),y(s<67108864),s<0?this.isubn(-s):0!==this.negative?1===this.length&&(0|this.words[0])<s?(this.words[0]=s-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(s),this.negative=1,this):this._iaddn(s)},h.prototype._iaddn=function(s){this.words[0]+=s;for(var c=0;c<this.length&&this.words[c]>=67108864;c++)this.words[c]-=67108864,c===this.length-1?this.words[c+1]=1:this.words[c+1]++;return this.length=Math.max(this.length,c+1),this},h.prototype.isubn=function(s){if(y("number"==typeof s),y(s<67108864),s<0)return this.iaddn(-s);if(0!==this.negative)return this.negative=0,this.iaddn(s),this.negative=1,this;if(this.words[0]-=s,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var c=0;c<this.length&&this.words[c]<0;c++)this.words[c]+=67108864,this.words[c+1]-=1;return this.strip()},h.prototype.addn=function(s){return this.clone().iaddn(s)},h.prototype.subn=function(s){return this.clone().isubn(s)},h.prototype.iabs=function(){return this.negative=0,this},h.prototype.abs=function(){return this.clone().iabs()},h.prototype._ishlnsubmul=function(s,c,d){var E;this._expand(s.length+d);var A,R=0;for(E=0;E<s.length;E++){A=(0|this.words[E+d])+R;var w=(0|s.words[E])*c;R=((A-=67108863&w)>>26)-(w/67108864|0),this.words[E+d]=67108863&A}for(;E<this.length-d;E++)R=(A=(0|this.words[E+d])+R)>>26,this.words[E+d]=67108863&A;if(0===R)return this.strip();for(y(-1===R),R=0,E=0;E<this.length;E++)R=(A=-(0|this.words[E])+R)>>26,this.words[E]=67108863&A;return this.negative=1,this.strip()},h.prototype._wordDiv=function(s,c){var d,p=this.clone(),E=s,A=0|E.words[E.length-1];0!=(d=26-this._countBits(A))&&(E=E.ushln(d),p.iushln(d),A=0|E.words[E.length-1]);var l,w=p.length-E.length;if("mod"!==c){(l=new h(null)).length=w+1,l.words=new Array(l.length);for(var b=0;b<l.length;b++)l.words[b]=0}var ue=p.clone()._ishlnsubmul(E,1,w);0===ue.negative&&(p=ue,l&&(l.words[w]=1));for(var me=w-1;me>=0;me--){var ve=67108864*(0|p.words[E.length+me])+(0|p.words[E.length+me-1]);for(ve=Math.min(ve/A|0,67108863),p._ishlnsubmul(E,ve,me);0!==p.negative;)ve--,p.negative=0,p._ishlnsubmul(E,1,me),p.isZero()||(p.negative^=1);l&&(l.words[me]=ve)}return l&&l.strip(),p.strip(),"div"!==c&&0!==d&&p.iushrn(d),{div:l||null,mod:p}},h.prototype.divmod=function(s,c,d){return y(!s.isZero()),this.isZero()?{div:new h(0),mod:new h(0)}:0!==this.negative&&0===s.negative?(A=this.neg().divmod(s,c),"mod"!==c&&(p=A.div.neg()),"div"!==c&&(E=A.mod.neg(),d&&0!==E.negative&&E.iadd(s)),{div:p,mod:E}):0===this.negative&&0!==s.negative?(A=this.divmod(s.neg(),c),"mod"!==c&&(p=A.div.neg()),{div:p,mod:A.mod}):this.negative&s.negative?(A=this.neg().divmod(s.neg(),c),"div"!==c&&(E=A.mod.neg(),d&&0!==E.negative&&E.isub(s)),{div:A.div,mod:E}):s.length>this.length||this.cmp(s)<0?{div:new h(0),mod:this}:1===s.length?"div"===c?{div:this.divn(s.words[0]),mod:null}:"mod"===c?{div:null,mod:new h(this.modn(s.words[0]))}:{div:this.divn(s.words[0]),mod:new h(this.modn(s.words[0]))}:this._wordDiv(s,c);var p,E,A},h.prototype.div=function(s){return this.divmod(s,"div",!1).div},h.prototype.mod=function(s){return this.divmod(s,"mod",!1).mod},h.prototype.umod=function(s){return this.divmod(s,"mod",!0).mod},h.prototype.divRound=function(s){var c=this.divmod(s);if(c.mod.isZero())return c.div;var d=0!==c.div.negative?c.mod.isub(s):c.mod,p=s.ushrn(1),E=s.andln(1),A=d.cmp(p);return A<0||1===E&&0===A?c.div:0!==c.div.negative?c.div.isubn(1):c.div.iaddn(1)},h.prototype.modn=function(s){y(s<=67108863);for(var c=(1<<26)%s,d=0,p=this.length-1;p>=0;p--)d=(c*d+(0|this.words[p]))%s;return d},h.prototype.idivn=function(s){y(s<=67108863);for(var c=0,d=this.length-1;d>=0;d--){var p=(0|this.words[d])+67108864*c;this.words[d]=p/s|0,c=p%s}return this.strip()},h.prototype.divn=function(s){return this.clone().idivn(s)},h.prototype.egcd=function(s){y(0===s.negative),y(!s.isZero());var c=this,d=s.clone();c=0!==c.negative?c.umod(s):c.clone();for(var p=new h(1),E=new h(0),A=new h(0),R=new h(1),w=0;c.isEven()&&d.isEven();)c.iushrn(1),d.iushrn(1),++w;for(var l=d.clone(),b=c.clone();!c.isZero();){for(var ue=0,me=1;!(c.words[0]&me)&&ue<26;++ue,me<<=1);if(ue>0)for(c.iushrn(ue);ue-- >0;)(p.isOdd()||E.isOdd())&&(p.iadd(l),E.isub(b)),p.iushrn(1),E.iushrn(1);for(var ve=0,xe=1;!(d.words[0]&xe)&&ve<26;++ve,xe<<=1);if(ve>0)for(d.iushrn(ve);ve-- >0;)(A.isOdd()||R.isOdd())&&(A.iadd(l),R.isub(b)),A.iushrn(1),R.iushrn(1);c.cmp(d)>=0?(c.isub(d),p.isub(A),E.isub(R)):(d.isub(c),A.isub(p),R.isub(E))}return{a:A,b:R,gcd:d.iushln(w)}},h.prototype._invmp=function(s){y(0===s.negative),y(!s.isZero());var ue,c=this,d=s.clone();c=0!==c.negative?c.umod(s):c.clone();for(var p=new h(1),E=new h(0),A=d.clone();c.cmpn(1)>0&&d.cmpn(1)>0;){for(var R=0,w=1;!(c.words[0]&w)&&R<26;++R,w<<=1);if(R>0)for(c.iushrn(R);R-- >0;)p.isOdd()&&p.iadd(A),p.iushrn(1);for(var l=0,b=1;!(d.words[0]&b)&&l<26;++l,b<<=1);if(l>0)for(d.iushrn(l);l-- >0;)E.isOdd()&&E.iadd(A),E.iushrn(1);c.cmp(d)>=0?(c.isub(d),p.isub(E)):(d.isub(c),E.isub(p))}return(ue=0===c.cmpn(1)?p:E).cmpn(0)<0&&ue.iadd(s),ue},h.prototype.gcd=function(s){if(this.isZero())return s.abs();if(s.isZero())return this.abs();var c=this.clone(),d=s.clone();c.negative=0,d.negative=0;for(var p=0;c.isEven()&&d.isEven();p++)c.iushrn(1),d.iushrn(1);for(;;){for(;c.isEven();)c.iushrn(1);for(;d.isEven();)d.iushrn(1);var E=c.cmp(d);if(E<0){var A=c;c=d,d=A}else if(0===E||0===d.cmpn(1))break;c.isub(d)}return d.iushln(p)},h.prototype.invm=function(s){return this.egcd(s).a.umod(s)},h.prototype.isEven=function(){return!(1&this.words[0])},h.prototype.isOdd=function(){return!(1&~this.words[0])},h.prototype.andln=function(s){return this.words[0]&s},h.prototype.bincn=function(s){y("number"==typeof s);var c=s%26,d=(s-c)/26,p=1<<c;if(this.length<=d)return this._expand(d+1),this.words[d]|=p,this;for(var E=p,A=d;0!==E&&A<this.length;A++){var R=0|this.words[A];E=(R+=E)>>>26,this.words[A]=R&=67108863}return 0!==E&&(this.words[A]=E,this.length++),this},h.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},h.prototype.cmpn=function(s){var d,c=s<0;if(0!==this.negative&&!c)return-1;if(0===this.negative&&c)return 1;if(this.strip(),this.length>1)d=1;else{c&&(s=-s),y(s<=67108863,"Number is too big");var p=0|this.words[0];d=p===s?0:p<s?-1:1}return 0!==this.negative?0|-d:d},h.prototype.cmp=function(s){if(0!==this.negative&&0===s.negative)return-1;if(0===this.negative&&0!==s.negative)return 1;var c=this.ucmp(s);return 0!==this.negative?0|-c:c},h.prototype.ucmp=function(s){if(this.length>s.length)return 1;if(this.length<s.length)return-1;for(var c=0,d=this.length-1;d>=0;d--){var p=0|this.words[d],E=0|s.words[d];if(p!==E){p<E?c=-1:p>E&&(c=1);break}}return c},h.prototype.gtn=function(s){return 1===this.cmpn(s)},h.prototype.gt=function(s){return 1===this.cmp(s)},h.prototype.gten=function(s){return this.cmpn(s)>=0},h.prototype.gte=function(s){return this.cmp(s)>=0},h.prototype.ltn=function(s){return-1===this.cmpn(s)},h.prototype.lt=function(s){return-1===this.cmp(s)},h.prototype.lten=function(s){return this.cmpn(s)<=0},h.prototype.lte=function(s){return this.cmp(s)<=0},h.prototype.eqn=function(s){return 0===this.cmpn(s)},h.prototype.eq=function(s){return 0===this.cmp(s)},h.red=function(s){return new se(s)},h.prototype.toRed=function(s){return y(!this.red,"Already a number in reduction context"),y(0===this.negative,"red works only with positives"),s.convertTo(this)._forceRed(s)},h.prototype.fromRed=function(){return y(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},h.prototype._forceRed=function(s){return this.red=s,this},h.prototype.forceRed=function(s){return y(!this.red,"Already a number in reduction context"),this._forceRed(s)},h.prototype.redAdd=function(s){return y(this.red,"redAdd works only with red numbers"),this.red.add(this,s)},h.prototype.redIAdd=function(s){return y(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,s)},h.prototype.redSub=function(s){return y(this.red,"redSub works only with red numbers"),this.red.sub(this,s)},h.prototype.redISub=function(s){return y(this.red,"redISub works only with red numbers"),this.red.isub(this,s)},h.prototype.redShl=function(s){return y(this.red,"redShl works only with red numbers"),this.red.shl(this,s)},h.prototype.redMul=function(s){return y(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.mul(this,s)},h.prototype.redIMul=function(s){return y(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.imul(this,s)},h.prototype.redSqr=function(){return y(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},h.prototype.redISqr=function(){return y(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},h.prototype.redSqrt=function(){return y(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},h.prototype.redInvm=function(){return y(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},h.prototype.redNeg=function(){return y(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},h.prototype.redPow=function(s){return y(this.red&&!s.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,s)};var o={k256:null,p224:null,p192:null,p25519:null};function ae(_,s){this.name=_,this.p=new h(s,16),this.n=this.p.bitLength(),this.k=new h(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function ke(){ae.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function je(){ae.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function de(){ae.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function we(){ae.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function se(_){if("string"==typeof _){var s=h._prime(_);this.m=s.p,this.prime=s}else y(_.gtn(1),"modulus must be greater than 1"),this.m=_,this.prime=null}function ce(_){se.call(this,_),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new h(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}ae.prototype._tmp=function(){var s=new h(null);return s.words=new Array(Math.ceil(this.n/13)),s},ae.prototype.ireduce=function(s){var d,c=s;do{this.split(c,this.tmp),d=(c=(c=this.imulK(c)).iadd(this.tmp)).bitLength()}while(d>this.n);var p=d<this.n?-1:c.ucmp(this.p);return 0===p?(c.words[0]=0,c.length=1):p>0?c.isub(this.p):void 0!==c.strip?c.strip():c._strip(),c},ae.prototype.split=function(s,c){s.iushrn(this.n,0,c)},ae.prototype.imulK=function(s){return s.imul(this.k)},k(ke,ae),ke.prototype.split=function(s,c){for(var d=4194303,p=Math.min(s.length,9),E=0;E<p;E++)c.words[E]=s.words[E];if(c.length=p,s.length<=9)return s.words[0]=0,void(s.length=1);var A=s.words[9];for(c.words[c.length++]=A&d,E=10;E<s.length;E++){var R=0|s.words[E];s.words[E-10]=(R&d)<<4|A>>>22,A=R}s.words[E-10]=A>>>=22,s.length-=0===A&&s.length>10?10:9},ke.prototype.imulK=function(s){s.words[s.length]=0,s.words[s.length+1]=0,s.length+=2;for(var c=0,d=0;d<s.length;d++){var p=0|s.words[d];s.words[d]=67108863&(c+=977*p),c=64*p+(c/67108864|0)}return 0===s.words[s.length-1]&&(s.length--,0===s.words[s.length-1]&&s.length--),s},k(je,ae),k(de,ae),k(we,ae),we.prototype.imulK=function(s){for(var c=0,d=0;d<s.length;d++){var p=19*(0|s.words[d])+c,E=67108863&p;p>>>=26,s.words[d]=E,c=p}return 0!==c&&(s.words[s.length++]=c),s},h._prime=function(s){if(o[s])return o[s];var c;if("k256"===s)c=new ke;else if("p224"===s)c=new je;else if("p192"===s)c=new de;else{if("p25519"!==s)throw new Error("Unknown prime "+s);c=new we}return o[s]=c,c},se.prototype._verify1=function(s){y(0===s.negative,"red works only with positives"),y(s.red,"red works only with red numbers")},se.prototype._verify2=function(s,c){y(!(s.negative|c.negative),"red works only with positives"),y(s.red&&s.red===c.red,"red works only with red numbers")},se.prototype.imod=function(s){return this.prime?this.prime.ireduce(s)._forceRed(this):s.umod(this.m)._forceRed(this)},se.prototype.neg=function(s){return s.isZero()?s.clone():this.m.sub(s)._forceRed(this)},se.prototype.add=function(s,c){this._verify2(s,c);var d=s.add(c);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},se.prototype.iadd=function(s,c){this._verify2(s,c);var d=s.iadd(c);return d.cmp(this.m)>=0&&d.isub(this.m),d},se.prototype.sub=function(s,c){this._verify2(s,c);var d=s.sub(c);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},se.prototype.isub=function(s,c){this._verify2(s,c);var d=s.isub(c);return d.cmpn(0)<0&&d.iadd(this.m),d},se.prototype.shl=function(s,c){return this._verify1(s),this.imod(s.ushln(c))},se.prototype.imul=function(s,c){return this._verify2(s,c),this.imod(s.imul(c))},se.prototype.mul=function(s,c){return this._verify2(s,c),this.imod(s.mul(c))},se.prototype.isqr=function(s){return this.imul(s,s.clone())},se.prototype.sqr=function(s){return this.mul(s,s)},se.prototype.sqrt=function(s){if(s.isZero())return s.clone();var c=this.m.andln(3);if(y(c%2==1),3===c){var d=this.m.add(new h(1)).iushrn(2);return this.pow(s,d)}for(var p=this.m.subn(1),E=0;!p.isZero()&&0===p.andln(1);)E++,p.iushrn(1);y(!p.isZero());var A=new h(1).toRed(this),R=A.redNeg(),w=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new h(2*l*l).toRed(this);0!==this.pow(l,w).cmp(R);)l.redIAdd(R);for(var b=this.pow(l,p),ue=this.pow(s,p.addn(1).iushrn(1)),me=this.pow(s,p),ve=E;0!==me.cmp(A);){for(var xe=me,Ae=0;0!==xe.cmp(A);Ae++)xe=xe.redSqr();y(Ae<ve);var Ne=this.pow(b,new h(1).iushln(ve-Ae-1));ue=ue.redMul(Ne),b=Ne.redSqr(),me=me.redMul(b),ve=Ae}return ue},se.prototype.invm=function(s){var c=s._invmp(this.m);return 0!==c.negative?(c.negative=0,this.imod(c).redNeg()):this.imod(c)},se.prototype.pow=function(s,c){if(c.isZero())return new h(1).toRed(this);if(0===c.cmpn(1))return s.clone();var p=new Array(16);p[0]=new h(1).toRed(this),p[1]=s;for(var E=2;E<p.length;E++)p[E]=this.mul(p[E-1],s);var A=p[0],R=0,w=0,l=c.bitLength()%26;for(0===l&&(l=26),E=c.length-1;E>=0;E--){for(var b=c.words[E],ue=l-1;ue>=0;ue--){var me=b>>ue&1;A!==p[0]&&(A=this.sqr(A)),0!==me||0!==R?(R<<=1,R|=me,(4==++w||0===E&&0===ue)&&(A=this.mul(A,p[R]),w=0,R=0)):w=0}l=26}return A},se.prototype.convertTo=function(s){var c=s.umod(this.m);return c===s?c.clone():c},se.prototype.convertFrom=function(s){var c=s.clone();return c.red=null,c},h.mont=function(s){return new ce(s)},k(ce,se),ce.prototype.convertTo=function(s){return this.imod(s.ushln(this.shift))},ce.prototype.convertFrom=function(s){var c=this.imod(s.mul(this.rinv));return c.red=null,c},ce.prototype.imul=function(s,c){if(s.isZero()||c.isZero())return s.words[0]=0,s.length=1,s;var d=s.imul(c),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=d.isub(p).iushrn(this.shift),A=E;return E.cmp(this.m)>=0?A=E.isub(this.m):E.cmpn(0)<0&&(A=E.iadd(this.m)),A._forceRed(this)},ce.prototype.mul=function(s,c){if(s.isZero()||c.isZero())return new h(0)._forceRed(this);var d=s.mul(c),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=d.isub(p).iushrn(this.shift),A=E;return E.cmp(this.m)>=0?A=E.isub(this.m):E.cmpn(0)<0&&(A=E.iadd(this.m)),A._forceRed(this)},ce.prototype.invm=function(s){return this.imod(s._invmp(this.m).mul(this.r2))._forceRed(this)}}(Ee=M.nmd(Ee),this)},243:Ee=>{"use strict";var N={single_source_shortest_paths:function(M,x,v){var y={},k={};k[x]=0;var T,B,U,$,oe,te,h=N.PriorityQueue.make();for(h.push(x,0);!h.empty();)for(U in $=(T=h.pop()).cost,oe=M[B=T.value]||{})oe.hasOwnProperty(U)&&(te=$+oe[U],(typeof k[U]>"u"||k[U]>te)&&(k[U]=te,h.push(U,te),y[U]=B));if(typeof v<"u"&&typeof k[v]>"u"){var D=["Could not find a path from ",x," to ",v,"."].join("");throw new Error(D)}return y},extract_shortest_path_from_predecessor_list:function(M,x){for(var v=[],y=x;y;)v.push(y),y=M[y];return v.reverse(),v},find_path:function(M,x,v){var y=N.single_source_shortest_paths(M,x,v);return N.extract_shortest_path_from_predecessor_list(y,v)},PriorityQueue:{make:function(M){var y,x=N.PriorityQueue,v={};for(y in M=M||{},x)x.hasOwnProperty(y)&&(v[y]=x[y]);return v.queue=[],v.sorter=M.sorter||x.default_sorter,v},default_sorter:function(M,x){return M.cost-x.cost},push:function(M,x){this.queue.push({value:M,cost:x}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};Ee.exports=N},3174:Ee=>{"use strict";Ee.exports=function(M){for(var x=[],v=M.length,y=0;y<v;y++){var k=M.charCodeAt(y);if(k>=55296&&k<=56319&&v>y+1){var h=M.charCodeAt(y+1);h>=56320&&h<=57343&&(k=1024*(k-55296)+h-56320+65536,y+=1)}k<128?x.push(k):k<2048?(x.push(k>>6|192),x.push(63&k|128)):k<55296||k>=57344&&k<65536?(x.push(k>>12|224),x.push(k>>6&63|128),x.push(63&k|128)):k>=65536&&k<=1114111?(x.push(k>>18|240),x.push(k>>12&63|128),x.push(k>>6&63|128),x.push(63&k|128)):x.push(239,191,189)}return new Uint8Array(x).buffer}},7790:()=>{},9183:(Ee,N,M)=>{"use strict";M.d(N,{D6:()=>te,LG:()=>oe});var x=M(4438),v=M(177),y=M(6600);const k=["determinateSpinner"];function h(ne,O){if(1&ne&&(x.qSk(),x.j41(0,"svg",11),x.nrm(1,"circle",12),x.k0s()),2&ne){const D=x.XpG();x.BMQ("viewBox",D._viewBox()),x.R7$(),x.xc7("stroke-dasharray",D._strokeCircumference(),"px")("stroke-dashoffset",D._strokeCircumference()/2,"px")("stroke-width",D._circleStrokeWidth(),"%"),x.BMQ("r",D._circleRadius())}}const T=new x.nKC("mat-progress-spinner-default-options",{providedIn:"root",factory:function B(){return{diameter:U}}}),U=100;let oe=(()=>{class ne{get color(){return this._color||this._defaultColor}set color(D){this._color=D}constructor(D,he,H){this._elementRef=D,this._defaultColor="primary",this._value=0,this._diameter=U,this._noopAnimations="NoopAnimations"===he&&!!H&&!H._forceAnimations,this.mode="mat-spinner"===D.nativeElement.nodeName.toLowerCase()?"indeterminate":"determinate",H&&(H.color&&(this.color=this._defaultColor=H.color),H.diameter&&(this.diameter=H.diameter),H.strokeWidth&&(this.strokeWidth=H.strokeWidth))}get value(){return"determinate"===this.mode?this._value:0}set value(D){this._value=Math.max(0,Math.min(100,D||0))}get diameter(){return this._diameter}set diameter(D){this._diameter=D||0}get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(D){this._strokeWidth=D||0}_circleRadius(){return(this.diameter-10)/2}_viewBox(){const D=2*this._circleRadius()+this.strokeWidth;return`0 0 ${D} ${D}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return"determinate"===this.mode?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static#e=this.\u0275fac=function(he){return new(he||ne)(x.rXU(x.aKT),x.rXU(x.bc$,8),x.rXU(T))};static#t=this.\u0275cmp=x.VBU({type:ne,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(he,H){if(1&he&&x.GBs(k,5),2&he){let K;x.mGM(K=x.lsd())&&(H._determinateCircle=K.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(he,H){2&he&&(x.BMQ("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow","determinate"===H.mode?H.value:null)("mode",H.mode),x.HbH("mat-"+H.color),x.xc7("width",H.diameter,"px")("height",H.diameter,"px")("--mdc-circular-progress-size",H.diameter+"px")("--mdc-circular-progress-active-indicator-width",H.diameter+"px"),x.AVh("_mat-animation-noopable",H._noopAnimations)("mdc-circular-progress--indeterminate","indeterminate"===H.mode))},inputs:{color:"color",mode:"mode",value:[2,"value","value",x.Udg],diameter:[2,"diameter","diameter",x.Udg],strokeWidth:[2,"strokeWidth","strokeWidth",x.Udg]},exportAs:["matProgressSpinner"],standalone:!0,features:[x.GFd,x.aNF],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(he,H){if(1&he&&(x.DNE(0,h,2,8,"ng-template",null,0,x.C5r),x.j41(2,"div",2,1),x.qSk(),x.j41(4,"svg",3),x.nrm(5,"circle",4),x.k0s()(),x.joV(),x.j41(6,"div",5)(7,"div",6)(8,"div",7),x.eu8(9,8),x.k0s(),x.j41(10,"div",9),x.eu8(11,8),x.k0s(),x.j41(12,"div",10),x.eu8(13,8),x.k0s()()()),2&he){const K=x.sdS(1);x.R7$(4),x.BMQ("viewBox",H._viewBox()),x.R7$(),x.xc7("stroke-dasharray",H._strokeCircumference(),"px")("stroke-dashoffset",H._strokeDashOffset(),"px")("stroke-width",H._circleStrokeWidth(),"%"),x.BMQ("r",H._circleRadius()),x.R7$(4),x.Y8G("ngTemplateOutlet",K),x.R7$(2),x.Y8G("ngTemplateOutlet",K),x.R7$(2),x.Y8G("ngTemplateOutlet",K)}},dependencies:[v.T3],styles:[".mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0;position:relative;direction:ltr;transition:opacity 250ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width)}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1;animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color, var(--mat-app-primary))}.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}"],encapsulation:2,changeDetection:0})}return ne})(),te=(()=>{class ne{static#e=this.\u0275fac=function(he){return new(he||ne)};static#t=this.\u0275mod=x.$C({type:ne});static#n=this.\u0275inj=x.G2t({imports:[v.MD,y.yE]})}return ne})()}}]);