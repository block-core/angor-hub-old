"use strict";(self.webpackChunkangor=self.webpackChunkangor||[]).push([[770],{770:(U,g,r)=>{r.r(g),r.d(g,{default:()=>z});var u=r(467),x=r(3830),f=r(177),a=r(9417),d=r(8834),_=r(2765),p=r(2102),h=r(9213),v=r(9042),y=r(9183),F=r(9192),e=r(4438),w=r(4930),k=r(2083);const L=()=>["/register"];function j(t,i){if(1&t&&(e.j41(0,"angor-alert",37),e.EFF(1),e.k0s()),2&t){const o=e.XpG();e.Y8G("appearance","outline")("showIcon",!1)("type",o.secAlert.type)("@shake","error"===o.secAlert.type),e.R7$(),e.SpI(" ",o.secAlert.message," ")}}function E(t,i){if(1&t){const o=e.RV6();e.j41(0,"div")(1,"div",12),e.nrm(2,"div",13),e.j41(3,"div",14),e.EFF(4,"Login with extension"),e.k0s(),e.nrm(5,"div",13),e.k0s(),e.j41(6,"div",38)(7,"button",39),e.bIt("click",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.loginWithNostrExtension())}),e.nrm(8,"mat-icon",40),e.j41(9,"span"),e.EFF(10,"Login with Nostr Extension"),e.k0s()()(),e.j41(11,"div",12),e.nrm(12,"div",13),e.j41(13,"div",14),e.EFF(14,"Or"),e.k0s(),e.nrm(15,"div",13),e.k0s()()}2&t&&(e.R7$(8),e.Y8G("svgIcon","feather:zap"))}function I(t,i){1&t&&(e.j41(0,"mat-error"),e.EFF(1," Secret key is required "),e.k0s())}function b(t,i){1&t&&e.nrm(0,"mat-icon",40),2&t&&e.Y8G("svgIcon","heroicons_solid:eye")}function S(t,i){1&t&&e.nrm(0,"mat-icon",40),2&t&&e.Y8G("svgIcon","heroicons_solid:eye-slash")}function C(t,i){1&t&&(e.j41(0,"mat-error"),e.EFF(1," Password is required "),e.k0s())}function G(t,i){1&t&&(e.j41(0,"span"),e.EFF(1,"Login"),e.k0s())}function Y(t,i){1&t&&e.nrm(0,"mat-progress-spinner",41)}function N(t,i){if(1&t&&(e.j41(0,"angor-alert",37),e.EFF(1),e.k0s()),2&t){const o=e.XpG();e.Y8G("appearance","outline")("showIcon",!1)("type",o.menemonicAlert.type)("@shake","error"===o.menemonicAlert.type),e.R7$(),e.SpI(" ",o.menemonicAlert.message," ")}}function A(t,i){1&t&&(e.j41(0,"mat-error"),e.EFF(1," Menemonic is required "),e.k0s())}function R(t,i){1&t&&e.nrm(0,"mat-icon",40),2&t&&e.Y8G("svgIcon","heroicons_solid:eye")}function T(t,i){1&t&&e.nrm(0,"mat-icon",40),2&t&&e.Y8G("svgIcon","heroicons_solid:eye-slash")}function $(t,i){1&t&&(e.j41(0,"mat-error"),e.EFF(1," Passphrase is required "),e.k0s())}function M(t,i){1&t&&e.nrm(0,"mat-icon",40),2&t&&e.Y8G("svgIcon","heroicons_solid:eye")}function K(t,i){1&t&&e.nrm(0,"mat-icon",40),2&t&&e.Y8G("svgIcon","heroicons_solid:eye-slash")}function B(t,i){1&t&&(e.j41(0,"mat-error"),e.EFF(1," Password is required "),e.k0s())}function D(t,i){1&t&&(e.j41(0,"span"),e.EFF(1,"Login"),e.k0s())}function P(t,i){1&t&&e.nrm(0,"mat-progress-spinner",41)}const z=[{path:"",component:(()=>{class t{constructor(o,s,n,c){this._formBuilder=o,this._router=s,this._signerService=n,this._stateService=c,this.secAlert={type:"error",message:""},this.showSecAlert=!1,this.menemonicAlert={type:"error",message:""},this.showMenemonicAlert=!1,this.loading=!1,this.isInstalledExtension=!1,this.privateKey=new Uint8Array,this.publicKey="",this.npub="",this.nsec=""}ngOnInit(){this.initializeForms(),this.checkNostrExtensionAvailability()}initializeAppState(){var o=this;return(0,u.A)(function*(){const s=o._signerService.getPublicKey();s&&(yield o._stateService.loadUserProfile(s),console.log("User profile loaded with public key:",s))})()}initializeForms(){this.SecretKeyLoginForm=this._formBuilder.group({secretKey:["",[a.k0.required,a.k0.minLength(3)]],password:["",a.k0.required]}),this.MenemonicLoginForm=this._formBuilder.group({menemonic:["",[a.k0.required,a.k0.minLength(3)]],passphrase:[""],password:["",a.k0.required]})}checkNostrExtensionAvailability(){const o=globalThis;this.isInstalledExtension=!(!o.nostr||"function"!=typeof o.nostr.signEvent)}loginWithSecretKey(){if(this.SecretKeyLoginForm.invalid)return;const o=this.SecretKeyLoginForm.get("secretKey")?.value,s=this.SecretKeyLoginForm.get("password")?.value;this.loading=!0,this.showSecAlert=!1;try{if(!this._signerService.handleLoginWithKey(o,s))throw new Error("Secret key is missing or invalid.");this.initializeAppState(),this._router.navigateByUrl("/home")}catch(n){this.loading=!1,this.secAlert.message=n instanceof Error?n.message:"An unexpected error occurred.",this.showSecAlert=!0,console.error("Login error: ",n)}}loginWithMenemonic(){if(this.MenemonicLoginForm.invalid)return;const o=this.MenemonicLoginForm.get("menemonic")?.value,s=this.MenemonicLoginForm.get("passphrase")?.value||"",n=this.MenemonicLoginForm.get("password")?.value;this.loading=!0,this.showMenemonicAlert=!1,this._signerService.handleLoginWithMenemonic(o,s,n)?(this.initializeAppState(),this._router.navigateByUrl("/home")):(this.loading=!1,this.menemonicAlert.message="Menemonic is missing or invalid.",this.showMenemonicAlert=!0)}loginWithNostrExtension(){var o=this;return(0,u.A)(function*(){(yield o._signerService.handleLoginWithExtension())?(o.initializeAppState(),o._router.navigateByUrl("/home")):console.error("Failed to log in using Nostr extension")})()}static#e=this.\u0275fac=function(s){return new(s||t)(e.rXU(a.ok),e.rXU(F.Ix),e.rXU(w.A),e.rXU(k.d))};static#t=this.\u0275cmp=e.VBU({type:t,selectors:[["auth-sign-in"]],standalone:!0,features:[e.aNF],decls:84,vars:27,consts:[["secretPasswordField",""],["passphraseField",""],["menemonicPasswordField",""],[1,"flex","min-w-0","flex-auto","flex-col","items-center","sm:flex-row","sm:justify-center","md:items-start","md:justify-start"],[1,"w-full","px-4","py-8","sm:bg-card","sm:w-auto","sm:rounded-2xl","sm:p-12","sm:shadow","md:flex","md:h-full","md:w-1/2","md:items-center","md:justify-end","md:rounded-none","md:p-16","md:shadow-none"],[1,"mx-auto","w-full","max-w-80","sm:mx-0","sm:w-80"],[1,"mt-8","text-4xl","font-extrabold","leading-tight","tracking-tight"],[1,"mt-0.5","flex","items-baseline","font-medium"],[1,"ml-1","text-primary-500","hover:underline",3,"routerLink"],["class","mt-8",3,"appearance","showIcon","type",4,"ngIf"],[4,"ngIf"],[1,"mt-8",3,"ngSubmit","formGroup"],[1,"mt-8","flex","items-center"],[1,"mt-px","flex-auto","border-t"],[1,"text-secondary","mx-2"],[1,"w-full"],["matInput","","formControlName","secretKey","autocomplete","secretKey"],["matInput","","type","password","autocomplete","current-password-seckey",3,"formControlName"],["mat-icon-button","","type","button","matSuffix","",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["mat-flat-button","","color","primary",1,"angor-mat-button-large","mt-6","w-full",3,"disabled"],["diameter","24","mode","indeterminate",4,"ngIf"],["matInput","","formControlName","menemonic","autocomplete","menemonic"],["matInput","","type","password","autocomplete","current-passphrase-menemonic",3,"formControlName"],["matInput","","type","password","autocomplete","current-password-menemonic",3,"formControlName"],[1,"relative","hidden","h-full","w-1/2","flex-auto","items-center","justify-center","overflow-hidden","bg-gray-800","p-16","dark:border-l","md:flex","lg:px-28"],["viewBox","0 0 960 540","width","100%","height","100%","preserveAspectRatio","xMidYMax slice","xmlns","http://www.w3.org/2000/svg",1,"pointer-events-none","absolute","inset-0"],["fill","none","stroke","currentColor","stroke-width","100",1,"text-gray-700","opacity-25"],["r","234","cx","196","cy","23"],["r","234","cx","790","cy","491"],["viewBox","0 0 220 192","width","220","height","192","fill","none",1,"absolute","-right-16","-top-16","text-gray-700"],["id","837c3e70-6c3a-44e6-8854-cc48c737b659","x","0","y","0","width","20","height","20","patternUnits","userSpaceOnUse"],["x","0","y","0","width","4","height","4","fill","currentColor"],["width","220","height","192","fill","url(#837c3e70-6c3a-44e6-8854-cc48c737b659)"],[1,"relative","z-10","w-full","max-w-2xl"],[1,"text-7xl","font-bold","leading-none","text-gray-100"],[1,"mt-6","text-lg","leading-6","tracking-tight","text-gray-400"],[1,"mt-8",3,"appearance","showIcon","type"],[1,"mt-8","flex","items-center","space-x-4"],["type","button","mat-stroked-button","",1,"flex-auto","space-x-2",3,"click"],[1,"icon-size-5",3,"svgIcon"],["diameter","24","mode","indeterminate"]],template:function(s,n){if(1&s){const c=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6),e.EFF(4," Login "),e.k0s(),e.j41(5,"div",7)(6,"div"),e.EFF(7,"Don't have an account?"),e.k0s(),e.j41(8,"a",8),e.EFF(9,"Register"),e.k0s()(),e.DNE(10,j,2,5,"angor-alert",9)(11,E,16,1,"div",10),e.j41(12,"form",11),e.bIt("ngSubmit",function(){return e.eBV(c),e.Njj(n.loginWithSecretKey())}),e.j41(13,"div",12),e.nrm(14,"div",13),e.j41(15,"div",14),e.EFF(16,"Enter secret key"),e.k0s(),e.nrm(17,"div",13),e.k0s(),e.j41(18,"mat-form-field",15)(19,"mat-label"),e.EFF(20,"Secret Key"),e.k0s(),e.nrm(21,"input",16),e.DNE(22,I,2,0,"mat-error"),e.k0s(),e.j41(23,"mat-form-field",15)(24,"mat-label"),e.EFF(25,"Password"),e.k0s(),e.nrm(26,"input",17,0),e.j41(28,"button",18),e.bIt("click",function(){e.eBV(c);const m=e.sdS(27);return e.Njj(m.type="password"===m.type?"text":"password")}),e.DNE(29,b,1,1,"mat-icon",19)(30,S,1,1,"mat-icon",19),e.k0s(),e.DNE(31,C,2,0,"mat-error",10),e.k0s(),e.j41(32,"button",20),e.DNE(33,G,2,0,"span",10)(34,Y,1,0,"mat-progress-spinner",21),e.k0s()(),e.j41(35,"div",12),e.nrm(36,"div",13),e.j41(37,"div",14),e.EFF(38,"Or enter menemonic"),e.k0s(),e.nrm(39,"div",13),e.k0s(),e.DNE(40,N,2,5,"angor-alert",9),e.j41(41,"form",11),e.bIt("ngSubmit",function(){return e.eBV(c),e.Njj(n.loginWithMenemonic())}),e.j41(42,"mat-form-field",15)(43,"mat-label"),e.EFF(44,"Menemonic"),e.k0s(),e.nrm(45,"input",22),e.DNE(46,A,2,0,"mat-error"),e.k0s(),e.j41(47,"mat-form-field",15)(48,"mat-label"),e.EFF(49,"Passphrase (Optional)"),e.k0s(),e.nrm(50,"input",23,1),e.j41(52,"button",18),e.bIt("click",function(){e.eBV(c);const m=e.sdS(51);return e.Njj(m.type="password"===m.type?"text":"password")}),e.DNE(53,R,1,1,"mat-icon",19)(54,T,1,1,"mat-icon",19),e.k0s(),e.DNE(55,$,2,0,"mat-error",10),e.k0s(),e.j41(56,"mat-form-field",15)(57,"mat-label"),e.EFF(58,"Password"),e.k0s(),e.nrm(59,"input",24,2),e.j41(61,"button",18),e.bIt("click",function(){e.eBV(c);const m=e.sdS(60);return e.Njj(m.type="password"===m.type?"text":"password")}),e.DNE(62,M,1,1,"mat-icon",19)(63,K,1,1,"mat-icon",19),e.k0s(),e.DNE(64,B,2,0,"mat-error",10),e.k0s(),e.j41(65,"button",20),e.DNE(66,D,2,0,"span",10)(67,P,1,0,"mat-progress-spinner",21),e.k0s()()()(),e.j41(68,"div",25),e.qSk(),e.j41(69,"svg",26)(70,"g",27),e.nrm(71,"circle",28)(72,"circle",29),e.k0s()(),e.j41(73,"svg",30)(74,"defs")(75,"pattern",31),e.nrm(76,"rect",32),e.k0s()(),e.nrm(77,"rect",33),e.k0s(),e.joV(),e.j41(78,"div",34)(79,"div",35)(80,"div"),e.EFF(81,"Angor Hub"),e.k0s()(),e.j41(82,"div",36),e.EFF(83," Angor Hub is a Nostr client customized around the Angor protocol, a decentralized crowdfunding platform. "),e.k0s()()()()}if(2&s){const c=e.sdS(27),l=e.sdS(51),m=e.sdS(60);e.R7$(8),e.Y8G("routerLink",e.lJ4(26,L)),e.R7$(2),e.Y8G("ngIf",n.showSecAlert),e.R7$(),e.Y8G("ngIf",n.isInstalledExtension),e.R7$(),e.Y8G("formGroup",n.SecretKeyLoginForm),e.R7$(10),e.vxM(n.SecretKeyLoginForm.get("secretKey").hasError("required")?22:-1),e.R7$(4),e.Y8G("formControlName","password"),e.R7$(3),e.Y8G("ngIf","password"===c.type),e.R7$(),e.Y8G("ngIf","text"===c.type),e.R7$(),e.Y8G("ngIf",n.SecretKeyLoginForm.get("password").hasError("required")),e.R7$(),e.Y8G("disabled",n.SecretKeyLoginForm.invalid),e.R7$(),e.Y8G("ngIf",!n.loading),e.R7$(),e.Y8G("ngIf",n.loading),e.R7$(6),e.Y8G("ngIf",n.showMenemonicAlert),e.R7$(),e.Y8G("formGroup",n.MenemonicLoginForm),e.R7$(5),e.vxM(n.MenemonicLoginForm.get("menemonic").hasError("required")?46:-1),e.R7$(4),e.Y8G("formControlName","passphrase"),e.R7$(3),e.Y8G("ngIf","password"===l.type),e.R7$(),e.Y8G("ngIf","text"===l.type),e.R7$(),e.Y8G("ngIf",n.MenemonicLoginForm.get("passphrase").hasError("required")),e.R7$(4),e.Y8G("formControlName","password"),e.R7$(3),e.Y8G("ngIf","password"===m.type),e.R7$(),e.Y8G("ngIf","text"===m.type),e.R7$(),e.Y8G("ngIf",n.MenemonicLoginForm.get("password").hasError("required")),e.R7$(),e.Y8G("disabled",n.MenemonicLoginForm.invalid),e.R7$(),e.Y8G("ngIf",!n.loading),e.R7$(),e.Y8G("ngIf",n.loading)}},dependencies:[F.Wk,x.h,a.YN,a.qT,a.me,a.BC,a.cb,a.X1,a.j4,a.JD,p.RG,p.rl,p.nJ,p.TL,p.yw,v.fS,v.fg,d.Hl,d.$z,d.iY,h.m_,h.An,_.g7,y.D6,y.LG,f.MD,f.bT],encapsulation:2})}return t})()}]}}]);