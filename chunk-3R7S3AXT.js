import{b as re,c as ae,d as se}from"./chunk-BV42OAT6.js";import{j as ne,q as oe}from"./chunk-PELDCWYZ.js";import{D as q,E as P,H as B,K as W,L as z,Q as R,S as x,T as H,U as Y,X as J,Z as Q,_ as X,aa as Z,ca as $,da as ee,ea as te,fa as ie}from"./chunk-QKCATVCD.js";import{$ as U,X as j,Z as G,ba as D,ca as O}from"./chunk-OXX2SIMU.js";import{Ab as v,Bb as s,Bc as K,Cc as V,Da as o,Db as I,Ea as w,Jb as A,Kb as k,Ra as c,Wa as n,bb as E,ca as b,eb as i,fb as t,gb as a,h as C,hc as T,ka as h,kb as L,la as _,ma as M,na as F,nb as y,oc as N,pb as S}from"./chunk-FUI3C4R4.js";var le=()=>["/register"];function ce(e,m){if(e&1&&(i(0,"angor-alert",37),s(1),t()),e&2){let g=S();n("appearance","outline")("showIcon",!1)("type",g.secAlert.type)("@shake",g.secAlert.type==="error"),o(),I(" ",g.secAlert.message," ")}}function pe(e,m){if(e&1){let g=L();i(0,"div")(1,"div",12),a(2,"div",13),i(3,"div",14),s(4,"Login with extension"),t(),a(5,"div",13),t(),i(6,"div",38)(7,"button",39),y("click",function(){h(g);let d=S();return _(d.loginWithNostrExtension())}),a(8,"mat-icon",40),i(9,"span"),s(10,"Login with Nostr Extension"),t()()(),i(11,"div",12),a(12,"div",13),i(13,"div",14),s(14,"Or"),t(),a(15,"div",13),t()()}e&2&&(o(8),n("svgIcon","feather:zap"))}function de(e,m){e&1&&(i(0,"mat-error"),s(1," Secret key is required "),t())}function ge(e,m){e&1&&a(0,"mat-icon",40),e&2&&n("svgIcon","heroicons_solid:eye")}function ue(e,m){e&1&&a(0,"mat-icon",40),e&2&&n("svgIcon","heroicons_solid:eye-slash")}function fe(e,m){e&1&&(i(0,"mat-error"),s(1," Password is required "),t())}function he(e,m){e&1&&(i(0,"span"),s(1,"Login"),t())}function _e(e,m){e&1&&a(0,"mat-progress-spinner",41)}function ye(e,m){if(e&1&&(i(0,"angor-alert",37),s(1),t()),e&2){let g=S();n("appearance","outline")("showIcon",!1)("type",g.menemonicAlert.type)("@shake",g.menemonicAlert.type==="error"),o(),I(" ",g.menemonicAlert.message," ")}}function ve(e,m){e&1&&(i(0,"mat-error"),s(1," Menemonic is required "),t())}function xe(e,m){e&1&&a(0,"mat-icon",40),e&2&&n("svgIcon","heroicons_solid:eye")}function we(e,m){e&1&&a(0,"mat-icon",40),e&2&&n("svgIcon","heroicons_solid:eye-slash")}function Se(e,m){e&1&&(i(0,"mat-error"),s(1," Passphrase is required "),t())}function Ee(e,m){e&1&&a(0,"mat-icon",40),e&2&&n("svgIcon","heroicons_solid:eye")}function Le(e,m){e&1&&a(0,"mat-icon",40),e&2&&n("svgIcon","heroicons_solid:eye-slash")}function Ie(e,m){e&1&&(i(0,"mat-error"),s(1," Password is required "),t())}function Ce(e,m){e&1&&(i(0,"span"),s(1,"Login"),t())}function be(e,m){e&1&&a(0,"mat-progress-spinner",41)}var me=(()=>{let m=class m{constructor(p,d,r){this._formBuilder=p,this._router=d,this._signerService=r,this.secAlert={type:"error",message:""},this.showSecAlert=!1,this.menemonicAlert={type:"error",message:""},this.showMenemonicAlert=!1,this.loading=!1,this.isInstalledExtension=!1,this.privateKey=new Uint8Array,this.publicKey="",this.npub="",this.nsec=""}ngOnInit(){this.initializeForms(),this.checkNostrExtensionAvailability()}initializeForms(){this.SecretKeyLoginForm=this._formBuilder.group({secretKey:["",[x.required,x.minLength(3)]],password:["",x.required]}),this.MenemonicLoginForm=this._formBuilder.group({menemonic:["",[x.required,x.minLength(3)]],passphrase:[""],password:["",x.required]})}checkNostrExtensionAvailability(){let p=globalThis;p.nostr&&typeof p.nostr.signEvent=="function"?this.isInstalledExtension=!0:this.isInstalledExtension=!1}loginWithSecretKey(){if(this.SecretKeyLoginForm.invalid)return;let p=this.SecretKeyLoginForm.get("secretKey")?.value,d=this.SecretKeyLoginForm.get("password")?.value;this.loading=!0,this.showSecAlert=!1;try{if(this._signerService.handleLoginWithKey(p,d))this._router.navigateByUrl("/home");else throw new Error("Secret key is missing or invalid.")}catch(r){this.loading=!1,this.secAlert.message=r instanceof Error?r.message:"An unexpected error occurred.",this.showSecAlert=!0,console.error("Login error: ",r)}}loginWithMenemonic(){if(this.MenemonicLoginForm.invalid)return;let p=this.MenemonicLoginForm.get("menemonic")?.value,d=this.MenemonicLoginForm.get("passphrase")?.value||"",r=this.MenemonicLoginForm.get("password")?.value;this.loading=!0,this.showMenemonicAlert=!1,this._signerService.handleLoginWithMenemonic(p,d,r)?this._router.navigateByUrl("/home"):(this.loading=!1,this.menemonicAlert.message="Menemonic is missing or invalid.",this.showMenemonicAlert=!0)}loginWithNostrExtension(){return C(this,null,function*(){(yield this._signerService.handleLoginWithExtension())?this._router.navigateByUrl("/home"):console.error("Failed to log in using Nostr extension")})}};m.\u0275fac=function(d){return new(d||m)(w(Z),w(K),w(oe))},m.\u0275cmp=b({type:m,selectors:[["auth-sign-in"]],standalone:!0,features:[A],decls:84,vars:27,consts:[["secretPasswordField",""],["passphraseField",""],["menemonicPasswordField",""],[1,"flex","min-w-0","flex-auto","flex-col","items-center","sm:flex-row","sm:justify-center","md:items-start","md:justify-start"],[1,"w-full","px-4","py-8","sm:bg-card","sm:w-auto","sm:rounded-2xl","sm:p-12","sm:shadow","md:flex","md:h-full","md:w-1/2","md:items-center","md:justify-end","md:rounded-none","md:p-16","md:shadow-none"],[1,"mx-auto","w-full","max-w-80","sm:mx-0","sm:w-80"],[1,"mt-8","text-4xl","font-extrabold","leading-tight","tracking-tight"],[1,"mt-0.5","flex","items-baseline","font-medium"],[1,"ml-1","text-primary-500","hover:underline",3,"routerLink"],["class","mt-8",3,"appearance","showIcon","type",4,"ngIf"],[4,"ngIf"],[1,"mt-8",3,"ngSubmit","formGroup"],[1,"mt-8","flex","items-center"],[1,"mt-px","flex-auto","border-t"],[1,"text-secondary","mx-2"],[1,"w-full"],["matInput","","formControlName","secretKey","autocomplete","secretKey"],["matInput","","type","password","autocomplete","current-password-seckey",3,"formControlName"],["mat-icon-button","","type","button","matSuffix","",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["mat-flat-button","","color","primary",1,"angor-mat-button-large","mt-6","w-full",3,"disabled"],["diameter","24","mode","indeterminate",4,"ngIf"],["matInput","","formControlName","menemonic","autocomplete","menemonic"],["matInput","","type","password","autocomplete","current-passphrase-menemonic",3,"formControlName"],["matInput","","type","password","autocomplete","current-password-menemonic",3,"formControlName"],[1,"relative","hidden","h-full","w-1/2","flex-auto","items-center","justify-center","overflow-hidden","bg-gray-800","p-16","dark:border-l","md:flex","lg:px-28"],["viewBox","0 0 960 540","width","100%","height","100%","preserveAspectRatio","xMidYMax slice","xmlns","http://www.w3.org/2000/svg",1,"absolute","inset-0","pointer-events-none"],["fill","none","stroke","currentColor","stroke-width","100",1,"text-gray-700","opacity-25"],["r","234","cx","196","cy","23"],["r","234","cx","790","cy","491"],["viewBox","0 0 220 192","width","220","height","192","fill","none",1,"absolute","-top-16","-right-16","text-gray-700"],["id","837c3e70-6c3a-44e6-8854-cc48c737b659","x","0","y","0","width","20","height","20","patternUnits","userSpaceOnUse"],["x","0","y","0","width","4","height","4","fill","currentColor"],["width","220","height","192","fill","url(#837c3e70-6c3a-44e6-8854-cc48c737b659)"],[1,"relative","z-10","w-full","max-w-2xl"],[1,"text-7xl","font-bold","leading-none","text-gray-100"],[1,"mt-6","text-lg","leading-6","tracking-tight","text-gray-400"],[1,"mt-8",3,"appearance","showIcon","type"],[1,"mt-8","flex","items-center","space-x-4"],["type","button","mat-stroked-button","",1,"flex-auto","space-x-2",3,"click"],[1,"icon-size-5",3,"svgIcon"],["diameter","24","mode","indeterminate"]],template:function(d,r){if(d&1){let u=L();i(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6),s(4," Login "),t(),i(5,"div",7)(6,"div"),s(7,"Don't have an account?"),t(),i(8,"a",8),s(9,"Register"),t()(),c(10,ce,2,5,"angor-alert",9)(11,pe,16,1,"div",10),i(12,"form",11),y("ngSubmit",function(){return h(u),_(r.loginWithSecretKey())}),i(13,"div",12),a(14,"div",13),i(15,"div",14),s(16,"Enter secret key"),t(),a(17,"div",13),t(),i(18,"mat-form-field",15)(19,"mat-label"),s(20,"Secret Key"),t(),a(21,"input",16),c(22,de,2,0,"mat-error"),t(),i(23,"mat-form-field",15)(24,"mat-label"),s(25,"Password"),t(),a(26,"input",17,0),i(28,"button",18),y("click",function(){h(u);let l=v(27);return _(l.type==="password"?l.type="text":l.type="password")}),c(29,ge,1,1,"mat-icon",19)(30,ue,1,1,"mat-icon",19),t(),c(31,fe,2,0,"mat-error",10),t(),i(32,"button",20),c(33,he,2,0,"span",10)(34,_e,1,0,"mat-progress-spinner",21),t()(),i(35,"div",12),a(36,"div",13),i(37,"div",14),s(38,"Or enter menemonic"),t(),a(39,"div",13),t(),c(40,ye,2,5,"angor-alert",9),i(41,"form",11),y("ngSubmit",function(){return h(u),_(r.loginWithMenemonic())}),i(42,"mat-form-field",15)(43,"mat-label"),s(44,"Menemonic"),t(),a(45,"input",22),c(46,ve,2,0,"mat-error"),t(),i(47,"mat-form-field",15)(48,"mat-label"),s(49,"Passphrase (Optional)"),t(),a(50,"input",23,1),i(52,"button",18),y("click",function(){h(u);let l=v(51);return _(l.type==="password"?l.type="text":l.type="password")}),c(53,xe,1,1,"mat-icon",19)(54,we,1,1,"mat-icon",19),t(),c(55,Se,2,0,"mat-error",10),t(),i(56,"mat-form-field",15)(57,"mat-label"),s(58,"Password"),t(),a(59,"input",24,2),i(61,"button",18),y("click",function(){h(u);let l=v(60);return _(l.type==="password"?l.type="text":l.type="password")}),c(62,Ee,1,1,"mat-icon",19)(63,Le,1,1,"mat-icon",19),t(),c(64,Ie,2,0,"mat-error",10),t(),i(65,"button",20),c(66,Ce,2,0,"span",10)(67,be,1,0,"mat-progress-spinner",21),t()()()(),i(68,"div",25),M(),i(69,"svg",26)(70,"g",27),a(71,"circle",28)(72,"circle",29),t()(),i(73,"svg",30)(74,"defs")(75,"pattern",31),a(76,"rect",32),t()(),a(77,"rect",33),t(),F(),i(78,"div",34)(79,"div",35)(80,"div"),s(81,"Angor Hub"),t()(),i(82,"div",36),s(83," Angor Hub is a Nostr client customized around the Angor protocol, a decentralized crowdfunding platform. "),t()()()()}if(d&2){let u=v(27),f=v(51),l=v(60);o(8),n("routerLink",k(26,le)),o(2),n("ngIf",r.showSecAlert),o(),n("ngIf",r.isInstalledExtension),o(),n("formGroup",r.SecretKeyLoginForm),o(10),E(r.SecretKeyLoginForm.get("secretKey").hasError("required")?22:-1),o(4),n("formControlName","password"),o(3),n("ngIf",u.type==="password"),o(),n("ngIf",u.type==="text"),o(),n("ngIf",r.SecretKeyLoginForm.get("password").hasError("required")),o(),n("disabled",r.SecretKeyLoginForm.invalid),o(),n("ngIf",!r.loading),o(),n("ngIf",r.loading),o(6),n("ngIf",r.showMenemonicAlert),o(),n("formGroup",r.MenemonicLoginForm),o(5),E(r.MenemonicLoginForm.get("menemonic").hasError("required")?46:-1),o(4),n("formControlName","passphrase"),o(3),n("ngIf",f.type==="password"),o(),n("ngIf",f.type==="text"),o(),n("ngIf",r.MenemonicLoginForm.get("passphrase").hasError("required")),o(4),n("formControlName","password"),o(3),n("ngIf",l.type==="password"),o(),n("ngIf",l.type==="text"),o(),n("ngIf",r.MenemonicLoginForm.get("password").hasError("required")),o(),n("disabled",r.MenemonicLoginForm.invalid),o(),n("ngIf",!r.loading),o(),n("ngIf",r.loading)}},dependencies:[V,ne,$,J,R,H,Y,ee,Q,X,z,W,q,P,B,ie,te,U,j,G,O,D,re,se,ae,N,T],encapsulation:2});let e=m;return e})();var Xe=[{path:"",component:me}];export{Xe as default};
