"use strict";(self.webpackChunkangor=self.webpackChunkangor||[]).push([[76],{8098:(k,h,o)=>{o.d(h,{U:()=>s});var u=o(467),d=o(4412),c=o(4438),m=o(4930);let s=(()=>{class t{constructor(e){this._signerService=e,this.STORAGE_KEY="userBookmarkedProjects",this.bookmarksSubject=new d.t([]),this.bookmarks$=this.bookmarksSubject.asObservable(),this.currentUserPubKey=null,window.addEventListener("storage",r=>{r.key===this.STORAGE_KEY&&this.refreshBookmarksForCurrentUser()})}initializeForCurrentUser(){var e=this;return(0,u.A)(function*(){e.clearBookmarks(),e.currentUserPubKey=yield e._signerService.getPublicKey(),e.currentUserPubKey&&(yield e.loadBookmarksForCurrentUser())})()}clearBookmarks(){this.bookmarksSubject.next([])}loadBookmarksForCurrentUser(){var e=this;return(0,u.A)(function*(){if(!e.currentUserPubKey)return;const l=e.getUserBookmarks()[e.currentUserPubKey]||[];e.bookmarksSubject.next(l)})()}getUserBookmarks(){const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):{}}saveUserBookmarks(e){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}addBookmark(e){var r=this;return(0,u.A)(function*(){if(!r.currentUserPubKey&&(r.currentUserPubKey=yield r._signerService.getPublicKey(),!r.currentUserPubKey))return void console.warn("No public key found for the current user.");const l=r.getUserBookmarks(),n=l[r.currentUserPubKey]||[];n.includes(e)||(n.push(e),l[r.currentUserPubKey]=n,r.saveUserBookmarks(l),r.bookmarksSubject.next(n))})()}removeBookmark(e){var r=this;return(0,u.A)(function*(){if(!r.currentUserPubKey&&(r.currentUserPubKey=yield r._signerService.getPublicKey(),!r.currentUserPubKey))return void console.warn("No public key found for the current user.");const l=r.getUserBookmarks(),a=(l[r.currentUserPubKey]||[]).filter(y=>y!==e);l[r.currentUserPubKey]=a,r.saveUserBookmarks(l),r.bookmarksSubject.next(a)})()}isBookmarked(e){var r=this;return(0,u.A)(function*(){return r.currentUserPubKey||(r.currentUserPubKey=yield r._signerService.getPublicKey(),r.currentUserPubKey)?(r.getUserBookmarks()[r.currentUserPubKey]||[]).includes(e):(console.warn("No public key found for the current user."),!1)})()}getBookmarks(){var e=this;return(0,u.A)(function*(){return e.currentUserPubKey||(e.currentUserPubKey=yield e._signerService.getPublicKey(),e.currentUserPubKey)?e.getUserBookmarks()[e.currentUserPubKey]||[]:(console.warn("No public key found for the current user."),[])})()}removeAllBookmarks(){var e=this;return(0,u.A)(function*(){if(!e.currentUserPubKey&&(e.currentUserPubKey=yield e._signerService.getPublicKey(),!e.currentUserPubKey))return void console.warn("No public key found for the current user.");const r=e.getUserBookmarks();r[e.currentUserPubKey]=[],e.saveUserBookmarks(r),e.bookmarksSubject.next([])})()}refreshBookmarksForCurrentUser(){this.currentUserPubKey&&this.loadBookmarksForCurrentUser()}static{this.\u0275fac=function(r){return new(r||t)(c.KVO(m.A))}}static{this.\u0275prov=c.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})()},833:(k,h,o)=>{o.d(h,{F:()=>d});var u=o(4438);let d=(()=>{class c{constructor(){this.mainnetLocalStorageKey="mainnetIndexers",this.testnetLocalStorageKey="testnetIndexers",this.mainnetPrimaryIndexerKey="mainnetPrimaryIndexer",this.testnetPrimaryIndexerKey="testnetPrimaryIndexer",this.networkStorageKey="selectedNetwork",this.defaultMainnetIndexer="https://btc.indexer.angor.io/",this.defaultTestnetIndexer="https://tbtc.indexer.angor.io/",this.initializeDefaultIndexers()}initializeDefaultIndexers(){0===this.getIndexers("mainnet").length&&(this.addIndexer(this.defaultMainnetIndexer,"mainnet"),this.setPrimaryIndexer(this.defaultMainnetIndexer,"mainnet")),0===this.getIndexers("testnet").length&&(this.addIndexer(this.defaultTestnetIndexer,"testnet"),this.setPrimaryIndexer(this.defaultTestnetIndexer,"testnet"))}addIndexer(s,t){let i=this.getIndexers(t);i.includes(s)||(i.push(s),this.saveIndexers(i,t))}getIndexers(s){return JSON.parse(localStorage.getItem("mainnet"===s?this.mainnetLocalStorageKey:this.testnetLocalStorageKey)||"[]")}saveIndexers(s,t){localStorage.setItem("mainnet"===t?this.mainnetLocalStorageKey:this.testnetLocalStorageKey,JSON.stringify(s))}setPrimaryIndexer(s,t){this.getIndexers(t).includes(s)&&localStorage.setItem("mainnet"===t?this.mainnetPrimaryIndexerKey:this.testnetPrimaryIndexerKey,s)}getPrimaryIndexer(s){return localStorage.getItem("mainnet"===s?this.mainnetPrimaryIndexerKey:this.testnetPrimaryIndexerKey)}removeIndexer(s,t){let i=this.getIndexers(t);const e=i.indexOf(s);-1!==e&&(i.splice(e,1),this.saveIndexers(i,t),s===this.getPrimaryIndexer(t))&&localStorage.removeItem("mainnet"===t?this.mainnetPrimaryIndexerKey:this.testnetPrimaryIndexerKey)}clearAllIndexers(s){const i="mainnet"===s?this.mainnetPrimaryIndexerKey:this.testnetPrimaryIndexerKey;localStorage.removeItem("mainnet"===s?this.mainnetLocalStorageKey:this.testnetLocalStorageKey),localStorage.removeItem(i)}setNetwork(s){localStorage.setItem(this.networkStorageKey,s)}getNetwork(){return localStorage.getItem(this.networkStorageKey)||"testnet"}static{this.\u0275fac=function(t){return new(t||c)}}static{this.\u0275prov=u.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})()},4782:(k,h,o)=>{o.d(h,{a:()=>e});var u=o(467),d=o(1413),c=o(152),m=o(6977),s=o(4438),t=o(5645),i=o(7291);let e=(()=>{class r{constructor(n,a){this.subscriptionService=n,this.storageService=a,this.publicKeyQueue=new Set,this.updateSubject=new d.B,this._unsubscribeAll=new d.B,this.initializeService()}initializeService(){var n=this;return(0,u.A)(function*(){yield n.loadStoredPublicKeys(),n.updateSubject.pipe((0,c.B)(2e3),(0,m.Q)(n._unsubscribeAll)).subscribe(()=>n.processQueue())})()}addPublicKey(n){this.publicKeyQueue.has(n)||(this.publicKeyQueue.add(n),this.updateSubject.next())}loadStoredPublicKeys(){var n=this;return(0,u.A)(function*(){try{(yield n.storageService.getAllProfiles()).forEach(y=>{y.pubKey&&n.publicKeyQueue.add(y.pubKey)}),n.updateSubject.next()}catch(a){console.error("Error loading stored public keys:",a)}})()}processQueue(){if(0===this.publicKeyQueue.size)return;const n=Array.from(this.publicKeyQueue);this.publicKeyQueue.clear();const y=this.subscriptionService.addSubscriptions([{kinds:[0],authors:n}],_=>{const b=this.parseMetadataEvent(_);b&&this.storageService.saveProfile(_.pubkey,b),this.subscriptionService.removeSubscriptionById(y)})}parseMetadataEvent(n){try{return JSON.parse(n.content)}catch(a){return console.error("Error parsing metadata event:",a),null}}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}static{this.\u0275fac=function(a){return new(a||r)(s.KVO(t.n),s.KVO(i.n))}}static{this.\u0275prov=s.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()}}]);