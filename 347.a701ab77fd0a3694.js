(self.webpackChunkangor=self.webpackChunkangor||[]).push([[347],{1146:Ht=>{"use strict";for(var Bt="qpzry9x8gf2tvdw0s3jn54khce6mua7l",V={},gt=0;gt<32;gt++){var U=Bt.charAt(gt);if(void 0!==V[U])throw new TypeError(U+" is ambiguous");V[U]=gt}function z(q){var K=q>>25;return(33554431&q)<<5^996825010&-(1&K)^642813549&-(K>>1&1)^513874426&-(K>>2&1)^1027748829&-(K>>3&1)^705979059&-(K>>4&1)}function yt(q){for(var K=1,we=0;we<q.length;++we){var le=q.charCodeAt(we);if(le<33||le>126)return"Invalid prefix ("+q+")";K=z(K)^le>>5}for(K=z(K),we=0;we<q.length;++we){var he=q.charCodeAt(we);K=z(K)^31&he}return K}function oe(q,K){if(q.length<8)return q+" too short";if(q.length>(K=K||90))return"Exceeds length limit";var we=q.toLowerCase(),le=q.toUpperCase();if(q!==we&&q!==le)return"Mixed-case string "+q;var he=(q=we).lastIndexOf("1");if(-1===he)return"No separator character for "+q;if(0===he)return"Missing prefix for "+q;var de=q.slice(0,he),Ie=q.slice(he+1);if(Ie.length<6)return"Data too short";var ut=yt(de);if("string"==typeof ut)return ut;for(var ft=[],Ut=0;Ut<Ie.length;++Ut){var Nt=Ie.charAt(Ut),Re=V[Nt];if(void 0===Re)return"Unknown character "+Nt;ut=z(ut)^Re,!(Ut+6>=Ie.length)&&ft.push(Re)}return 1!==ut?"Invalid checksum for "+q:{prefix:de,words:ft}}function re(q,K,we,le){for(var he=0,de=0,Ie=(1<<we)-1,ut=[],ft=0;ft<q.length;++ft)for(he=he<<K|q[ft],de+=K;de>=we;)ut.push(he>>(de-=we)&Ie);if(le)de>0&&ut.push(he<<we-de&Ie);else{if(de>=K)return"Excess padding";if(he<<we-de&Ie)return"Non-zero padding"}return ut}Ht.exports={decodeUnsafe:function ne(){var q=oe.apply(null,arguments);if("object"==typeof q)return q},decode:function ae(q){var K=oe.apply(null,arguments);if("object"==typeof K)return K;throw new Error(K)},encode:function x(q,K,we){if(q.length+7+K.length>(we=we||90))throw new TypeError("Exceeds length limit");var le=yt(q=q.toLowerCase());if("string"==typeof le)throw new Error(le);for(var he=q+"1",de=0;de<K.length;++de){var Ie=K[de];if(Ie>>5)throw new Error("Non 5-bit word");le=z(le)^Ie,he+=Bt.charAt(Ie)}for(de=0;de<6;++de)le=z(le);for(le^=1,de=0;de<6;++de)he+=Bt.charAt(le>>5*(5-de)&31);return he},toWordsUnsafe:function Ue(q){var K=re(q,8,5,!0);if(Array.isArray(K))return K},toWords:function Ae(q){var K=re(q,8,5,!0);if(Array.isArray(K))return K;throw new Error(K)},fromWordsUnsafe:function be(q){var K=re(q,5,8,!1);if(Array.isArray(K))return K},fromWords:function bt(q){var K=re(q,5,8,!1);if(Array.isArray(K))return K;throw new Error(K)}}},6347:(Ht,Bt,V)=>{"use strict";V.r(Bt),V.d(Bt,{default:()=>Oc});var gt={};V.r(gt),V.d(gt,{OG:()=>an,My:()=>Ce,Ph:()=>mt,lX:()=>Oe,Id:()=>$t,fg:()=>_n,qj:()=>pe,aT:()=>Be,lq:()=>ke,z:()=>bn,Q5:()=>Ne});var U=V(467),z=V(5167),yt=V(7403),x=V(177),oe=V(9417),ne=V(8834),ae=V(1997),re=V(2102),Ue=V(9213),Ae=V(9042),be=V(9115),bt=V(9183),q=V(450),K=V(4823),we=V(5245),le=V(8865),he=V(3813),de=V(5398),Ie=V(7540),ut=V(1413),ft=V(5351),Ut=V(2798),Nt=V(882);V(6371);var w=V(6218),a=V(600);function u(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function p(t,...n){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(n.length>0&&!n.includes(t.length))throw new Error(`Expected Uint8Array of length ${n}, not of length=${t.length}`)}const l={number:u,bool:function d(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)},bytes:p,hash:function y(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");u(t.outputLen),u(t.blockLen)},exists:function E(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called")},output:function M(t,n){p(t);const e=n.outputLen;if(t.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}},v="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,H=t=>t instanceof Uint8Array,se=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ce=(t,n)=>t<<32-n|t>>>n;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");const Pt=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));function fe(t){if(!H(t))throw new Error("Uint8Array expected");let n="";for(let e=0;e<t.length;e++)n+=Pt[t[e]];return n}function _e(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const n=t.length;if(n%2)throw new Error("padded hex string expected, got unpadded hex of length "+n);const e=new Uint8Array(n/2);for(let r=0;r<e.length;r++){const o=2*r,s=t.slice(o,o+2),c=Number.parseInt(s,16);if(Number.isNaN(c)||c<0)throw new Error("Invalid byte sequence");e[r]=c}return e}function Se(t){if("string"==typeof t&&(t=function Dn(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),!H(t))throw new Error("expected Uint8Array, got "+typeof t);return t}function Pe(...t){const n=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let e=0;return t.forEach(r=>{if(!H(r))throw new Error("Uint8Array expected");n.set(r,e),e+=r.length}),n}class vn{clone(){return this._cloneInto()}}function yn(t){const n=r=>t().update(Se(r)).digest(),e=t();return n.outputLen=e.outputLen,n.blockLen=e.blockLen,n.create=()=>t(),n}function en(t=32){if(v&&"function"==typeof v.getRandomValues)return v.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class ze extends vn{constructor(n,e,r,o){super(),this.blockLen=n,this.outputLen=e,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(n),this.view=se(this.buffer)}update(n){l.exists(this);const{view:e,buffer:r,blockLen:o}=this,s=(n=Se(n)).length;for(let c=0;c<s;){const f=Math.min(o-this.pos,s-c);if(f!==o)r.set(n.subarray(c,c+f),this.pos),this.pos+=f,c+=f,this.pos===o&&(this.process(e,0),this.pos=0);else{const h=se(n);for(;o<=s-c;c+=o)this.process(h,c)}}return this.length+=n.length,this.roundClean(),this}digestInto(n){l.exists(this),l.output(n,this),this.finished=!0;const{buffer:e,view:r,blockLen:o,isLE:s}=this;let{pos:c}=this;e[c++]=128,this.buffer.subarray(c).fill(0),this.padOffset>o-c&&(this.process(r,0),c=0);for(let _=c;_<o;_++)e[_]=0;(function Ve(t,n,e,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(n,e,r);const o=BigInt(32),s=BigInt(4294967295),c=Number(e>>o&s),f=Number(e&s),g=r?0:4;t.setUint32(n+(r?4:0),c,r),t.setUint32(n+g,f,r)})(r,o-8,BigInt(8*this.length),s),this.process(r,0);const f=se(n),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const g=h/4,b=this.get();if(g>b.length)throw new Error("_sha2: outputLen bigger than state");for(let _=0;_<g;_++)f.setUint32(4*_,b[_],s)}digest(){const{buffer:n,outputLen:e}=this;this.digestInto(n);const r=n.slice(0,e);return this.destroy(),r}_cloneInto(n){n||(n=new this.constructor),n.set(...this.get());const{blockLen:e,buffer:r,length:o,finished:s,destroyed:c,pos:f}=this;return n.length=o,n.pos=f,n.finished=s,n.destroyed=c,o%e&&n.buffer.set(r),n}}const Wn=(t,n,e)=>t&n^~t&e,Ye=(t,n,e)=>t&n^t&e^n&e,He=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Rt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ee=new Uint32Array(64);class Fe extends ze{constructor(){super(64,32,8,!1),this.A=0|Rt[0],this.B=0|Rt[1],this.C=0|Rt[2],this.D=0|Rt[3],this.E=0|Rt[4],this.F=0|Rt[5],this.G=0|Rt[6],this.H=0|Rt[7]}get(){const{A:n,B:e,C:r,D:o,E:s,F:c,G:f,H:h}=this;return[n,e,r,o,s,c,f,h]}set(n,e,r,o,s,c,f,h){this.A=0|n,this.B=0|e,this.C=0|r,this.D=0|o,this.E=0|s,this.F=0|c,this.G=0|f,this.H=0|h}process(n,e){for(let _=0;_<16;_++,e+=4)Ee[_]=n.getUint32(e,!1);for(let _=16;_<64;_++){const I=Ee[_-15],A=Ee[_-2],S=ce(I,7)^ce(I,18)^I>>>3,k=ce(A,17)^ce(A,19)^A>>>10;Ee[_]=k+Ee[_-7]+S+Ee[_-16]|0}let{A:r,B:o,C:s,D:c,E:f,F:h,G:g,H:b}=this;for(let _=0;_<64;_++){const A=b+(ce(f,6)^ce(f,11)^ce(f,25))+Wn(f,h,g)+He[_]+Ee[_]|0,k=(ce(r,2)^ce(r,13)^ce(r,22))+Ye(r,o,s)|0;b=g,g=h,h=f,f=c+A|0,c=s,s=o,o=r,r=A+k|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,c=c+this.D|0,f=f+this.E|0,h=h+this.F|0,g=g+this.G|0,b=b+this.H|0,this.set(r,o,s,c,f,h,g,b)}roundClean(){Ee.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Vn extends Fe{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const xe=yn(()=>new Fe),$e=(yn(()=>new Vn),BigInt(0),BigInt(1)),Ze=BigInt(2),tn=t=>t instanceof Uint8Array,Xe=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));function Ce(t){if(!tn(t))throw new Error("Uint8Array expected");let n="";for(let e=0;e<t.length;e++)n+=Xe[t[e]];return n}function Ge(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function Be(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const n=t.length;if(n%2)throw new Error("padded hex string expected, got unpadded hex of length "+n);const e=new Uint8Array(n/2);for(let r=0;r<e.length;r++){const o=2*r,s=t.slice(o,o+2),c=Number.parseInt(s,16);if(Number.isNaN(c)||c<0)throw new Error("Invalid byte sequence");e[r]=c}return e}function mt(t){return Ge(Ce(t))}function Oe(t){if(!tn(t))throw new Error("Uint8Array expected");return Ge(Ce(Uint8Array.from(t).reverse()))}function ke(t,n){return Be(t.toString(16).padStart(2*n,"0"))}function bn(t,n){return ke(t,n).reverse()}function pe(t,n,e){let r;if("string"==typeof n)try{r=Be(n)}catch(s){throw new Error(`${t} must be valid hex string, got "${n}". Cause: ${s}`)}else{if(!tn(n))throw new Error(`${t} must be hex string or Uint8Array`);r=Uint8Array.from(n)}const o=r.length;if("number"==typeof e&&o!==e)throw new Error(`${t} expected ${e} bytes, got ${o}`);return r}function $t(...t){const n=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let e=0;return t.forEach(r=>{if(!tn(r))throw new Error("Uint8Array expected");n.set(r,e),e+=r.length}),n}const an=t=>(Ze<<BigInt(t-1))-$e,Le=t=>new Uint8Array(t),qe=t=>Uint8Array.from(t);function _n(t,n,e){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof n||n<2)throw new Error("qByteLen must be a number");if("function"!=typeof e)throw new Error("hmacFn must be a function");let r=Le(t),o=Le(t),s=0;const c=()=>{r.fill(1),o.fill(0),s=0},f=(..._)=>e(o,r,..._),h=(_=Le())=>{o=f(qe([0]),_),r=f(),0!==_.length&&(o=f(qe([1]),_),r=f())},g=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let _=0;const I=[];for(;_<n;){r=f();const A=r.slice();I.push(A),_+=r.length}return $t(...I)};return(_,I)=>{let A;for(c(),h(_);!(A=I(g()));)h();return c(),A}}const Ke={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,n)=>n.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function Ne(t,n,e={}){const r=(o,s,c)=>{const f=Ke[s];if("function"!=typeof f)throw new Error(`Invalid validator "${s}", expected function`);const h=t[o];if(!(c&&void 0===h||f(h,t)))throw new Error(`Invalid param ${String(o)}=${h} (${typeof h}), expected ${s}`)};for(const[o,s]of Object.entries(n))r(o,s,!1);for(const[o,s]of Object.entries(e))r(o,s,!0);return t}const De=BigInt(0),Me=BigInt(1),St=BigInt(2),xn=BigInt(3),nn=BigInt(4),ln=BigInt(5),cn=BigInt(8);function Je(t,n){const e=t%n;return e>=De?e:n+e}function Mn(t,n,e){if(e<=De||n<De)throw new Error("Expected power/modulo > 0");if(e===Me)return De;let r=Me;for(;n>De;)n&Me&&(r=r*t%e),t=t*t%e,n>>=Me;return r}function wt(t,n,e){let r=t;for(;n-- >De;)r*=r,r%=e;return r}function Zt(t,n){if(t===De||n<=De)throw new Error(`invert: expected positive integers, got n=${t} mod=${n}`);let e=Je(t,n),r=n,o=De,s=Me,c=Me,f=De;for(;e!==De;){const g=r/e,b=r%e,_=o-c*g,I=s-f*g;r=e,e=b,o=c,s=f,c=_,f=I}if(r!==Me)throw new Error("invert: does not exist");return Je(o,n)}BigInt(9),BigInt(16);const In=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function yr(t,n){const e=void 0!==n?n:t.toString(2).length;return{nBitLength:e,nByteLength:Math.ceil(e/8)}}const Ko=BigInt(0),wr=BigInt(1);function xi(t){return function Rn(t){Ne(t,In.reduce((r,o)=>(r[o]="function",r),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}(t.Fp),Ne(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...yr(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const{Ph:es,aT:ts}=gt,rn={Err:class extends Error{constructor(n=""){super(n)}},_parseInt(t){const{Err:n}=rn;if(t.length<2||2!==t[0])throw new n("Invalid signature integer tag");const e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new n("Invalid signature integer: wrong length");if(128&r[0])throw new n("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new n("Invalid signature integer: unnecessary leading zero");return{d:es(r),l:t.subarray(e+2)}},toSig(t){const{Err:n}=rn,e="string"==typeof t?ts(t):t;if(!(e instanceof Uint8Array))throw new Error("ui8a expected");let r=e.length;if(r<2||48!=e[0])throw new n("Invalid signature tag");if(e[1]!==r-2)throw new n("Invalid signature: incorrect length");const{d:o,l:s}=rn._parseInt(e.subarray(2)),{d:c,l:f}=rn._parseInt(s);if(f.length)throw new n("Invalid signature: left bytes after parsing");return{r:o,s:c}},hexFromSig(t){const n=g=>8&Number.parseInt(g[0],16)?"00"+g:g,e=g=>{const b=g.toString(16);return 1&b.length?`0${b}`:b},r=n(e(t.s)),o=n(e(t.r)),s=r.length/2,c=o.length/2,f=e(s),h=e(c);return`30${e(c+s+4)}02${h}${o}02${f}${r}`}},Tt=BigInt(0),Qe=BigInt(1),Hn=(BigInt(2),BigInt(3));function is(t){const n=function rs(t){const n=xi(t);return Ne(n,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...n})}(t),{Fp:e,n:r}=n,o=e.BYTES+1,s=2*e.BYTES+1;function f(B){return Je(B,r)}function h(B){return Zt(B,r)}const{ProjectivePoint:g,normPrivateKeyToScalar:b,weierstrassEquation:_,isWithinCurveOrder:I}=function ns(t){const n=function Qo(t){const n=xi(t);Ne(n,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:e,Fp:r,a:o}=n;if(e){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof e||"bigint"!=typeof e.beta||"function"!=typeof e.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...n})}(t),{Fp:e}=n,r=n.toBytes||((S,k,R)=>{const T=k.toAffine();return $t(Uint8Array.from([4]),e.toBytes(T.x),e.toBytes(T.y))}),o=n.fromBytes||(S=>{const k=S.subarray(1);return{x:e.fromBytes(k.subarray(0,e.BYTES)),y:e.fromBytes(k.subarray(e.BYTES,2*e.BYTES))}});function s(S){const{a:k,b:R}=n,T=e.sqr(S),N=e.mul(T,S);return e.add(e.add(N,e.mul(S,k)),R)}if(!e.eql(e.sqr(n.Gy),s(n.Gx)))throw new Error("bad generator point: equation left != right");function c(S){return"bigint"==typeof S&&Tt<S&&S<n.n}function f(S){if(!c(S))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function h(S){const{allowedPrivateKeyLengths:k,nByteLength:R,wrapPrivateKey:T,n:N}=n;if(k&&"bigint"!=typeof S){if(S instanceof Uint8Array&&(S=Ce(S)),"string"!=typeof S||!k.includes(S.length))throw new Error("Invalid key");S=S.padStart(2*R,"0")}let O;try{O="bigint"==typeof S?S:mt(pe("private key",S,R))}catch{throw new Error(`private key must be ${R} bytes, hex or bigint, not ${typeof S}`)}return T&&(O=Je(O,N)),f(O),O}const g=new Map;function b(S){if(!(S instanceof _))throw new Error("ProjectivePoint expected")}class _{constructor(k,R,T){if(this.px=k,this.py=R,this.pz=T,null==k||!e.isValid(k))throw new Error("x required");if(null==R||!e.isValid(R))throw new Error("y required");if(null==T||!e.isValid(T))throw new Error("z required")}static fromAffine(k){const{x:R,y:T}=k||{};if(!k||!e.isValid(R)||!e.isValid(T))throw new Error("invalid affine point");if(k instanceof _)throw new Error("projective point not allowed");const N=O=>e.eql(O,e.ZERO);return N(R)&&N(T)?_.ZERO:new _(R,T,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(k){const R=e.invertBatch(k.map(T=>T.pz));return k.map((T,N)=>T.toAffine(R[N])).map(_.fromAffine)}static fromHex(k){const R=_.fromAffine(o(pe("pointHex",k)));return R.assertValidity(),R}static fromPrivateKey(k){return _.BASE.multiply(h(k))}_setWindowSize(k){this._WINDOW_SIZE=k,g.delete(this)}assertValidity(){if(this.is0()){if(n.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:k,y:R}=this.toAffine();if(!e.isValid(k)||!e.isValid(R))throw new Error("bad point: x or y not FE");const T=e.sqr(R),N=s(k);if(!e.eql(T,N))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:k}=this.toAffine();if(e.isOdd)return!e.isOdd(k);throw new Error("Field doesn't support isOdd")}equals(k){b(k);const{px:R,py:T,pz:N}=this,{px:O,py:P,pz:G}=k,C=e.eql(e.mul(R,G),e.mul(O,N)),$=e.eql(e.mul(T,G),e.mul(P,N));return C&&$}negate(){return new _(this.px,e.neg(this.py),this.pz)}double(){const{a:k,b:R}=n,T=e.mul(R,Hn),{px:N,py:O,pz:P}=this;let G=e.ZERO,C=e.ZERO,$=e.ZERO,F=e.mul(N,N),L=e.mul(O,O),X=e.mul(P,P),W=e.mul(N,O);return W=e.add(W,W),$=e.mul(N,P),$=e.add($,$),G=e.mul(k,$),C=e.mul(T,X),C=e.add(G,C),G=e.sub(L,C),C=e.add(L,C),C=e.mul(G,C),G=e.mul(W,G),$=e.mul(T,$),X=e.mul(k,X),W=e.sub(F,X),W=e.mul(k,W),W=e.add(W,$),$=e.add(F,F),F=e.add($,F),F=e.add(F,X),F=e.mul(F,W),C=e.add(C,F),X=e.mul(O,P),X=e.add(X,X),F=e.mul(X,W),G=e.sub(G,F),$=e.mul(X,L),$=e.add($,$),$=e.add($,$),new _(G,C,$)}add(k){b(k);const{px:R,py:T,pz:N}=this,{px:O,py:P,pz:G}=k;let C=e.ZERO,$=e.ZERO,F=e.ZERO;const L=n.a,X=e.mul(n.b,Hn);let W=e.mul(R,O),Q=e.mul(T,P),ie=e.mul(N,G),ge=e.add(R,T),B=e.add(O,P);ge=e.mul(ge,B),B=e.add(W,Q),ge=e.sub(ge,B),B=e.add(R,N);let j=e.add(O,G);return B=e.mul(B,j),j=e.add(W,ie),B=e.sub(B,j),j=e.add(T,N),C=e.add(P,G),j=e.mul(j,C),C=e.add(Q,ie),j=e.sub(j,C),F=e.mul(L,B),C=e.mul(X,ie),F=e.add(C,F),C=e.sub(Q,F),F=e.add(Q,F),$=e.mul(C,F),Q=e.add(W,W),Q=e.add(Q,W),ie=e.mul(L,ie),B=e.mul(X,B),Q=e.add(Q,ie),ie=e.sub(W,ie),ie=e.mul(L,ie),B=e.add(B,ie),W=e.mul(Q,B),$=e.add($,W),W=e.mul(j,B),C=e.mul(ge,C),C=e.sub(C,W),W=e.mul(ge,Q),F=e.mul(j,F),F=e.add(F,W),new _(C,$,F)}subtract(k){return this.add(k.negate())}is0(){return this.equals(_.ZERO)}wNAF(k){return A.wNAFCached(this,g,k,R=>{const T=e.invertBatch(R.map(N=>N.pz));return R.map((N,O)=>N.toAffine(T[O])).map(_.fromAffine)})}multiplyUnsafe(k){const R=_.ZERO;if(k===Tt)return R;if(f(k),k===Qe)return this;const{endo:T}=n;if(!T)return A.unsafeLadder(this,k);let{k1neg:N,k1:O,k2neg:P,k2:G}=T.splitScalar(k),C=R,$=R,F=this;for(;O>Tt||G>Tt;)O&Qe&&(C=C.add(F)),G&Qe&&($=$.add(F)),F=F.double(),O>>=Qe,G>>=Qe;return N&&(C=C.negate()),P&&($=$.negate()),$=new _(e.mul($.px,T.beta),$.py,$.pz),C.add($)}multiply(k){f(k);let T,N,R=k;const{endo:O}=n;if(O){const{k1neg:P,k1:G,k2neg:C,k2:$}=O.splitScalar(R);let{p:F,f:L}=this.wNAF(G),{p:X,f:W}=this.wNAF($);F=A.constTimeNegate(P,F),X=A.constTimeNegate(C,X),X=new _(e.mul(X.px,O.beta),X.py,X.pz),T=F.add(X),N=L.add(W)}else{const{p:P,f:G}=this.wNAF(R);T=P,N=G}return _.normalizeZ([T,N])[0]}multiplyAndAddUnsafe(k,R,T){const N=_.BASE,O=(G,C)=>C!==Tt&&C!==Qe&&G.equals(N)?G.multiply(C):G.multiplyUnsafe(C),P=O(this,R).add(O(k,T));return P.is0()?void 0:P}toAffine(k){const{px:R,py:T,pz:N}=this,O=this.is0();null==k&&(k=O?e.ONE:e.inv(N));const P=e.mul(R,k),G=e.mul(T,k),C=e.mul(N,k);if(O)return{x:e.ZERO,y:e.ZERO};if(!e.eql(C,e.ONE))throw new Error("invZ was invalid");return{x:P,y:G}}isTorsionFree(){const{h:k,isTorsionFree:R}=n;if(k===Qe)return!0;if(R)return R(_,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:k,clearCofactor:R}=n;return k===Qe?this:R?R(_,this):this.multiplyUnsafe(n.h)}toRawBytes(k=!0){return this.assertValidity(),r(_,this,k)}toHex(k=!0){return Ce(this.toRawBytes(k))}}_.BASE=new _(n.Gx,n.Gy,e.ONE),_.ZERO=new _(e.ZERO,e.ONE,e.ZERO);const I=n.nBitLength,A=function Jo(t,n){const e=(o,s)=>{const c=s.negate();return o?c:s},r=o=>({windows:Math.ceil(n/o)+1,windowSize:2**(o-1)});return{constTimeNegate:e,unsafeLadder(o,s){let c=t.ZERO,f=o;for(;s>Ko;)s&wr&&(c=c.add(f)),f=f.double(),s>>=wr;return c},precomputeWindow(o,s){const{windows:c,windowSize:f}=r(s),h=[];let g=o,b=g;for(let _=0;_<c;_++){b=g,h.push(b);for(let I=1;I<f;I++)b=b.add(g),h.push(b);g=b.double()}return h},wNAF(o,s,c){const{windows:f,windowSize:h}=r(o);let g=t.ZERO,b=t.BASE;const _=BigInt(2**o-1),I=2**o,A=BigInt(o);for(let S=0;S<f;S++){const k=S*h;let R=Number(c&_);c>>=A,R>h&&(R-=I,c+=wr);const T=k,N=k+Math.abs(R)-1,P=R<0;0===R?b=b.add(e(S%2!=0,s[T])):g=g.add(e(P,s[N]))}return{p:g,f:b}},wNAFCached(o,s,c,f){const h=o._WINDOW_SIZE||1;let g=s.get(o);return g||(g=this.precomputeWindow(o,h),1!==h&&s.set(o,f(g))),this.wNAF(h,g,c)}}}(_,n.endo?Math.ceil(I/2):I);return{CURVE:n,ProjectivePoint:_,normPrivateKeyToScalar:h,weierstrassEquation:s,isWithinCurveOrder:c}}({...n,toBytes(B,j,Y){const te=j.toAffine(),D=e.toBytes(te.x),ue=$t;return Y?ue(Uint8Array.from([j.hasEvenY()?2:3]),D):ue(Uint8Array.from([4]),D,e.toBytes(te.y))},fromBytes(B){const j=B.length,Y=B[0],te=B.subarray(1);if(j!==o||2!==Y&&3!==Y){if(j===s&&4===Y)return{x:e.fromBytes(te.subarray(0,e.BYTES)),y:e.fromBytes(te.subarray(e.BYTES,2*e.BYTES))};throw new Error(`Point of length ${j} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}{const D=mt(te);if(!function c(B){return Tt<B&&B<e.ORDER}(D))throw new Error("Point is not on curve");const ue=_(D);let ye=e.sqrt(ue);return!(1&~Y)!=((ye&Qe)===Qe)&&(ye=e.neg(ye)),{x:D,y:ye}}}}),A=B=>Ce(ke(B,n.nByteLength));function S(B){return B>r>>Qe}const R=(B,j,Y)=>mt(B.slice(j,Y));class T{constructor(j,Y,te){this.r=j,this.s=Y,this.recovery=te,this.assertValidity()}static fromCompact(j){const Y=n.nByteLength;return j=pe("compactSignature",j,2*Y),new T(R(j,0,Y),R(j,Y,2*Y))}static fromDER(j){const{r:Y,s:te}=rn.toSig(pe("DER",j));return new T(Y,te)}assertValidity(){if(!I(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!I(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(j){return new T(this.r,this.s,j)}recoverPublicKey(j){const{r:Y,s:te,recovery:D}=this,ue=$(pe("msgHash",j));if(null==D||![0,1,2,3].includes(D))throw new Error("recovery id invalid");const ye=2===D||3===D?Y+n.n:Y;if(ye>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");const pt=g.fromHex((1&D?"03":"02")+A(ye)),_t=h(ye),Mt=f(-ue*_t),It=f(te*_t),xt=g.BASE.multiplyAndAddUnsafe(pt,Mt,It);if(!xt)throw new Error("point at infinify");return xt.assertValidity(),xt}hasHighS(){return S(this.s)}normalizeS(){return this.hasHighS()?new T(this.r,f(-this.s),this.recovery):this}toDERRawBytes(){return Be(this.toDERHex())}toDERHex(){return rn.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Be(this.toCompactHex())}toCompactHex(){return A(this.r)+A(this.s)}}const N={isValidPrivateKey(B){try{return b(B),!0}catch{return!1}},normPrivateKeyToScalar:b,randomPrivateKey:()=>{const j=function Xo(t,n,e=!1){const r=(t=pe("privateHash",t)).length,o=yr(n).nByteLength+8;if(o<24||r<o||r>1024)throw new Error(`hashToPrivateScalar: expected ${o}-1024 bytes of input, got ${r}`);return Je(e?Oe(t):mt(t),n-Me)+Me}(n.randomBytes(e.BYTES+8),r);return ke(j,n.nByteLength)},precompute:(B=8,j=g.BASE)=>(j._setWindowSize(B),j.multiply(BigInt(3)),j)};function P(B){const j=B instanceof Uint8Array,Y="string"==typeof B,te=(j||Y)&&B.length;return j?te===o||te===s:Y?te===2*o||te===2*s:B instanceof g}const C=n.bits2int||function(B){const j=mt(B),Y=8*B.length-n.nBitLength;return Y>0?j>>BigInt(Y):j},$=n.bits2int_modN||function(B){return f(C(B))},F=an(n.nBitLength);function L(B){if("bigint"!=typeof B)throw new Error("bigint expected");if(!(Tt<=B&&B<F))throw new Error(`bigint expected < 2^${n.nBitLength}`);return ke(B,n.nByteLength)}const W={lowS:n.lowS,prehash:!1},Q={lowS:n.lowS,prehash:!1};return g.BASE._setWindowSize(8),{CURVE:n,getPublicKey:function O(B,j=!0){return g.fromPrivateKey(B).toRawBytes(j)},getSharedSecret:function G(B,j,Y=!0){if(P(B))throw new Error("first arg must be private key");if(!P(j))throw new Error("second arg must be public key");return g.fromHex(j).multiply(b(B)).toRawBytes(Y)},sign:function ie(B,j,Y=W){const{seed:te,k2sig:D}=function X(B,j,Y=W){if(["recovered","canonical"].some(Et=>Et in Y))throw new Error("sign() legacy options not supported");const{hash:te,randomBytes:D}=n;let{lowS:ue,prehash:ye,extraEntropy:ve}=Y;null==ue&&(ue=!0),B=pe("msgHash",B),ye&&(B=pe("prehashed msgHash",te(B)));const pt=$(B),_t=b(j),Mt=[L(_t),L(pt)];if(null!=ve){const Et=!0===ve?D(e.BYTES):ve;Mt.push(pe("extraEntropy",Et,e.BYTES))}const It=$t(...Mt),xt=pt;return{seed:It,k2sig:function Gt(Et){const gn=C(Et);if(!I(gn))return;const Vo=h(gn),qt=g.BASE.multiply(gn).toAffine(),mn=f(qt.x);if(mn===Tt)return;const mr=f(Vo*f(xt+mn*_t));if(mr===Tt)return;let zo=(qt.x===mn?0:2)|Number(qt.y&Qe),Yo=mr;return ue&&S(mr)&&(Yo=function k(B){return S(B)?f(-B):B}(mr),zo^=1),new T(mn,Yo,zo)}}}(B,j,Y);return _n(n.hash.outputLen,n.nByteLength,n.hmac)(te,D)},verify:function ge(B,j,Y,te=Q){const D=B;if(j=pe("msgHash",j),Y=pe("publicKey",Y),"strict"in te)throw new Error("options.strict was renamed to lowS");const{lowS:ue,prehash:ye}=te;let ve,pt;try{if("string"==typeof D||D instanceof Uint8Array)try{ve=T.fromDER(D)}catch(qt){if(!(qt instanceof rn.Err))throw qt;ve=T.fromCompact(D)}else{if("object"!=typeof D||"bigint"!=typeof D.r||"bigint"!=typeof D.s)throw new Error("PARSE");{const{r:qt,s:mn}=D;ve=new T(qt,mn)}}pt=g.fromHex(Y)}catch(qt){if("PARSE"===qt.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(ue&&ve.hasHighS())return!1;ye&&(j=n.hash(j));const{r:_t,s:Mt}=ve,It=$(j),xt=h(Mt),Gt=f(It*xt),Et=f(_t*xt),gn=g.BASE.multiplyAndAddUnsafe(pt,Gt,Et)?.toAffine();return!!gn&&f(gn.x)===_t},ProjectivePoint:g,Signature:T,utils:N}}BigInt(4);class Mi extends vn{constructor(n,e){super(),this.finished=!1,this.destroyed=!1,l.hash(n);const r=Se(e);if(this.iHash=n.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?n.create().update(r).digest():r);for(let c=0;c<s.length;c++)s[c]^=54;this.iHash.update(s),this.oHash=n.create();for(let c=0;c<s.length;c++)s[c]^=106;this.oHash.update(s),s.fill(0)}update(n){return l.exists(this),this.iHash.update(n),this}digestInto(n){l.exists(this),l.bytes(n,this.outputLen),this.finished=!0,this.iHash.digestInto(n),this.oHash.update(n),this.oHash.digestInto(n),this.destroy()}digest(){const n=new Uint8Array(this.oHash.outputLen);return this.digestInto(n),n}_cloneInto(n){n||(n=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:o,destroyed:s,blockLen:c,outputLen:f}=this;return n.finished=o,n.destroyed=s,n.blockLen=c,n.outputLen=f,n.oHash=e._cloneInto(n.oHash),n.iHash=r._cloneInto(n.iHash),n}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const un=(t,n,e)=>new Mi(t,n).update(e).digest();function fs(t){return{hash:t,hmac:(n,...e)=>un(t,n,Pe(...e)),randomBytes:en}}un.create=(t,n)=>new Mi(t,n);const Zn=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Xn=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Si=BigInt(1),Kn=BigInt(2),Ai=(t,n)=>(t+n/Kn)/n;function Ii(t){const n=Zn,e=BigInt(3),r=BigInt(6),o=BigInt(11),s=BigInt(22),c=BigInt(23),f=BigInt(44),h=BigInt(88),g=t*t*t%n,b=g*g*t%n,_=wt(b,e,n)*b%n,I=wt(_,e,n)*b%n,A=wt(I,Kn,n)*g%n,S=wt(A,o,n)*A%n,k=wt(S,s,n)*S%n,R=wt(k,f,n)*k%n,T=wt(R,h,n)*R%n,N=wt(T,f,n)*k%n,O=wt(N,e,n)*b%n,P=wt(O,c,n)*S%n,G=wt(P,r,n)*g%n,C=wt(G,Kn,n);if(!_r.eql(_r.sqr(C),t))throw new Error("Cannot find square root");return C}const _r=function Zo(t,n,e=!1,r={}){if(t<=De)throw new Error(`Expected Fp ORDER > 0, got ${t}`);const{nBitLength:o,nByteLength:s}=yr(t,n);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const c=function An(t){if(t%nn===xn){const n=(t+Me)/nn;return function(r,o){const s=r.pow(o,n);if(!r.eql(r.sqr(s),o))throw new Error("Cannot find square root");return s}}if(t%cn===ln){const n=(t-ln)/cn;return function(r,o){const s=r.mul(o,St),c=r.pow(s,n),f=r.mul(o,c),h=r.mul(r.mul(f,St),c),g=r.mul(f,r.sub(h,r.ONE));if(!r.eql(r.sqr(g),o))throw new Error("Cannot find square root");return g}}return function Sn(t){const n=(t-Me)/St;let e,r,o;for(e=t-Me,r=0;e%St===De;e/=St,r++);for(o=St;o<t&&Mn(o,n,t)!==t-Me;o++);if(1===r){const c=(t+Me)/nn;return function(h,g){const b=h.pow(g,c);if(!h.eql(h.sqr(b),g))throw new Error("Cannot find square root");return b}}const s=(e+Me)/St;return function(f,h){if(f.pow(h,n)===f.neg(f.ONE))throw new Error("Cannot find square root");let g=r,b=f.pow(f.mul(f.ONE,o),e),_=f.pow(h,s),I=f.pow(h,e);for(;!f.eql(I,f.ONE);){if(f.eql(I,f.ZERO))return f.ZERO;let A=1;for(let k=f.sqr(I);A<g&&!f.eql(k,f.ONE);A++)k=f.sqr(k);const S=f.pow(b,Me<<BigInt(g-A-1));b=f.sqr(S),_=f.mul(_,S),I=f.mul(I,b),g=A}return _}}(t)}(t),f=Object.freeze({ORDER:t,BITS:o,BYTES:s,MASK:an(o),ZERO:De,ONE:Me,create:h=>Je(h,t),isValid:h=>{if("bigint"!=typeof h)throw new Error("Invalid field element: expected bigint, got "+typeof h);return De<=h&&h<t},is0:h=>h===De,isOdd:h=>(h&Me)===Me,neg:h=>Je(-h,t),eql:(h,g)=>h===g,sqr:h=>Je(h*h,t),add:(h,g)=>Je(h+g,t),sub:(h,g)=>Je(h-g,t),mul:(h,g)=>Je(h*g,t),pow:(h,g)=>function Tn(t,n,e){if(e<De)throw new Error("Expected power > 0");if(e===De)return t.ONE;if(e===Me)return n;let r=t.ONE,o=n;for(;e>De;)e&Me&&(r=t.mul(r,o)),o=t.sqr(o),e>>=Me;return r}(f,h,g),div:(h,g)=>Je(h*Zt(g,t),t),sqrN:h=>h*h,addN:(h,g)=>h+g,subN:(h,g)=>h-g,mulN:(h,g)=>h*g,inv:h=>Zt(h,t),sqrt:r.sqrt||(h=>c(f,h)),invertBatch:h=>function Ho(t,n){const e=new Array(n.length),r=n.reduce((s,c,f)=>t.is0(c)?s:(e[f]=s,t.mul(s,c)),t.ONE),o=t.inv(r);return n.reduceRight((s,c,f)=>t.is0(c)?s:(e[f]=t.mul(s,e[f]),t.mul(s,c)),o),e}(f,h),cmov:(h,g,b)=>b?g:h,toBytes:h=>e?bn(h,s):ke(h,s),fromBytes:h=>{if(h.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${h.length}`);return e?Oe(h):mt(h)}});return Object.freeze(f)}(Zn,void 0,void 0,{sqrt:Ii}),fn=function hs(t,n){const e=r=>is({...t,...fs(r)});return Object.freeze({...e(n),create:e})}({a:BigInt(0),b:BigInt(7),Fp:_r,n:Xn,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const n=Xn,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Si*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=e,c=BigInt("0x100000000000000000000000000000000"),f=Ai(s*t,n),h=Ai(-r*t,n);let g=Je(t-f*e-h*o,n),b=Je(-f*r-h*s,n);const _=g>c,I=b>c;if(_&&(g=n-g),I&&(b=n-b),g>c||b>c)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:_,k1:g,k2neg:I,k2:b}}}},xe),Jn=BigInt(0),Ri=t=>"bigint"==typeof t&&Jn<t&&t<Zn,Ti={};function Qn(t,...n){let e=Ti[t];if(void 0===e){const r=xe(Uint8Array.from(t,o=>o.charCodeAt(0)));e=$t(r,r),Ti[t]=e}return xe($t(e,...n))}const xr=t=>t.toRawBytes(!0).slice(1),Er=t=>ke(t,32),kr=t=>Je(t,Zn),Bn=t=>Je(t,Xn),Mr=fn.ProjectivePoint;function Sr(t){let n=fn.utils.normPrivateKeyToScalar(t),e=Mr.fromPrivateKey(n);return{scalar:e.hasEvenY()?n:Bn(-n),bytes:xr(e)}}function Ci(t){if(!Ri(t))throw new Error("bad x: need 0 < x < p");const n=kr(t*t);let r=Ii(kr(n*t+BigInt(7)));r%Kn!==Jn&&(r=kr(-r));const o=new Mr(t,r,Si);return o.assertValidity(),o}function Bi(...t){return Bn(mt(Qn("BIP0340/challenge",...t)))}function Ui(t,n,e){const r=pe("signature",t,64),o=pe("message",n),s=pe("publicKey",e,32);try{const c=Ci(mt(s)),f=mt(r.subarray(0,32));if(!Ri(f))return!1;const h=mt(r.subarray(32,64));if(!(t=>"bigint"==typeof t&&Jn<t&&t<Xn)(h))return!1;const g=Bi(Er(f),xr(c),o),b=((t,n,e)=>Mr.BASE.multiplyAndAddUnsafe(t,n,e))(c,h,Bn(-g));return!(!b||!b.hasEvenY()||b.toAffine().x!==f)}catch{return!1}}const hn={getPublicKey:function gs(t){return Sr(t).bytes},sign:function ms(t,n,e=en(32)){const r=pe("message",t),{bytes:o,scalar:s}=Sr(n),c=pe("auxRand",e,32),f=Er(s^mt(Qn("BIP0340/aux",c))),h=Qn("BIP0340/nonce",f,o,r),g=Bn(mt(h));if(g===Jn)throw new Error("sign failed: k is zero");const{bytes:b,scalar:_}=Sr(g),I=Bi(b,o,r),A=new Uint8Array(64);if(A.set(b,0),A.set(Er(Bn(_+I*s)),32),!Ui(A,r,o))throw new Error("sign: Invalid signature produced");return A},verify:Ui,utils:{randomPrivateKey:fn.utils.randomPrivateKey,lift_x:Ci,pointToBytes:xr,numberToBytesBE:ke,bytesToNumberBE:mt,taggedHash:Qn,mod:Je}};function on(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function Ct(...t){const n=(o,s)=>c=>o(s(c));return{encode:Array.from(t).reverse().reduce((o,s)=>o?n(o,s.encode):s.encode,void 0),decode:t.reduce((o,s)=>o?n(o,s.decode):s.decode,void 0)}}function jt(t){return{encode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("alphabet.encode input should be an array of numbers");return n.map(e=>{if(on(e),e<0||e>=t.length)throw new Error(`Digit index outside alphabet: ${e} (alphabet: ${t.length})`);return t[e]})},decode:n=>{if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("alphabet.decode input should be array of strings");return n.map(e=>{if("string"!=typeof e)throw new Error(`alphabet.decode: not string element=${e}`);const r=t.indexOf(e);if(-1===r)throw new Error(`Unknown letter: "${e}". Allowed: ${t}`);return r})}}}function Ot(t=""){if("string"!=typeof t)throw new Error("join separator should be string");return{encode:n=>{if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("join.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`join.encode: non-string input=${e}`);return n.join(t)},decode:n=>{if("string"!=typeof n)throw new Error("join.decode input should be string");return n.split(t)}}}function Un(t,n="="){if(on(t),"string"!=typeof n)throw new Error("padding chr should be string");return{encode(e){if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("padding.encode input should be array of strings");for(let r of e)if("string"!=typeof r)throw new Error(`padding.encode: non-string input=${r}`);for(;e.length*t%8;)e.push(n);return e},decode(e){if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("padding.encode input should be array of strings");for(let o of e)if("string"!=typeof o)throw new Error(`padding.decode: non-string input=${o}`);let r=e.length;if(r*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&e[r-1]===n;r--)if(!((r-1)*t%8))throw new Error("Invalid padding: string has too much padding");return e.slice(0,r)}}}function Ni(t){if("function"!=typeof t)throw new Error("normalize fn should be function");return{encode:n=>n,decode:n=>t(n)}}function Pi(t,n,e){if(n<2)throw new Error(`convertRadix: wrong from=${n}, base cannot be less than 2`);if(e<2)throw new Error(`convertRadix: wrong to=${e}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let r=0;const o=[],s=Array.from(t);for(s.forEach(c=>{if(on(c),c<0||c>=n)throw new Error(`Wrong integer: ${c}`)});;){let c=0,f=!0;for(let h=r;h<s.length;h++){const g=s[h],b=n*c+g;if(!Number.isSafeInteger(b)||n*c/n!==c||b-g!=n*c)throw new Error("convertRadix: carry overflow");if(c=b%e,s[h]=Math.floor(b/e),!Number.isSafeInteger(s[h])||s[h]*e+c!==b)throw new Error("convertRadix: carry overflow");f&&(s[h]?f=!1:r=h)}if(o.push(c),f)break}for(let c=0;c<t.length-1&&0===t[c];c++)o.push(0);return o.reverse()}const $i=(t,n)=>n?$i(n,t%n):t,er=(t,n)=>t+(n-$i(t,n));function Ar(t,n,e,r){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(n<=0||n>32)throw new Error(`convertRadix2: wrong from=${n}`);if(e<=0||e>32)throw new Error(`convertRadix2: wrong to=${e}`);if(er(n,e)>32)throw new Error(`convertRadix2: carry overflow from=${n} to=${e} carryBits=${er(n,e)}`);let o=0,s=0;const c=2**e-1,f=[];for(const h of t){if(on(h),h>=2**n)throw new Error(`convertRadix2: invalid data word=${h} from=${n}`);if(o=o<<n|h,s+n>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${n}`);for(s+=n;s>=e;s-=e)f.push((o>>s-e&c)>>>0);o&=2**s-1}if(o=o<<e-s&c,!r&&s>=n)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&s>0&&f.push(o>>>0),f}function Wt(t,n=!1){if(on(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(er(8,t)>32||er(t,8)>32)throw new Error("radix2: carry overflow");return{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return Ar(Array.from(e),8,t,!n)},decode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(Ar(e,t,8,n))}}}function Oi(t){if("function"!=typeof t)throw new Error("unsafeWrapper fn should be function");return function(...n){try{return t.apply(null,n)}catch{}}}Ct(Wt(4),jt("0123456789ABCDEF"),Ot("")),Ct(Wt(5),jt("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Un(5),Ot(""));const Vt=(Ct(Wt(5),jt("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Un(5),Ot("")),Ct(Wt(5),jt("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Ot(""),Ni(t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),Ct(Wt(6),jt("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Un(6),Ot(""))),Ir=(Ct(Wt(6),jt("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Un(6),Ot("")),t=>Ct(function ji(t){return on(t),{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Pi(Array.from(n),256,t)},decode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Pi(n,t,256))}}}(58),jt(t),Ot(""))),Rr=(Ir("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),Ir("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),Ir("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),Ct(jt("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Ot(""))),Gi=[996825010,642813549,513874426,1027748829,705979059];function Nn(t){const n=t>>25;let e=(33554431&t)<<5;for(let r=0;r<Gi.length;r++)1==(n>>r&1)&&(e^=Gi[r]);return e}function qi(t,n,e=1){const r=t.length;let o=1;for(let s=0;s<r;s++){const c=t.charCodeAt(s);if(c<33||c>126)throw new Error(`Invalid prefix (${t})`);o=Nn(o)^c>>5}o=Nn(o);for(let s=0;s<r;s++)o=Nn(o)^31&t.charCodeAt(s);for(let s of n)o=Nn(o)^s;for(let s=0;s<6;s++)o=Nn(o);return o^=e,Rr.encode(Ar([o%2**30],30,5,!1))}function Di(t){const n="bech32"===t?1:734539939,e=Wt(5),r=e.decode,o=e.encode,s=Oi(r);function f(b,_=90){if("string"!=typeof b)throw new Error("bech32.decode input should be string, not "+typeof b);if(b.length<8||!1!==_&&b.length>_)throw new TypeError(`Wrong string length: ${b.length} (${b}). Expected (8..${_})`);const I=b.toLowerCase();if(b!==I&&b!==b.toUpperCase())throw new Error("String must be lowercase or uppercase");const A=(b=I).lastIndexOf("1");if(0===A||-1===A)throw new Error('Letter "1" must be present between prefix and data only');const S=b.slice(0,A),k=b.slice(A+1);if(k.length<6)throw new Error("Data must be at least 6 characters long");const R=Rr.decode(k).slice(0,-6),T=qi(S,R,n);if(!k.endsWith(T))throw new Error(`Invalid checksum in ${b}: expected "${T}"`);return{prefix:S,words:R}}return{encode:function c(b,_,I=90){if("string"!=typeof b)throw new Error("bech32.encode prefix should be string, not "+typeof b);if(!Array.isArray(_)||_.length&&"number"!=typeof _[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof _);const A=b.length+7+_.length;if(!1!==I&&A>I)throw new TypeError(`Length ${A} exceeds limit ${I}`);return`${b=b.toLowerCase()}1${Rr.encode(_)}${qi(b,_,n)}`},decode:f,decodeToBytes:function g(b){const{prefix:_,words:I}=f(b,!1);return{prefix:_,words:I,bytes:r(I)}},decodeUnsafe:Oi(f),fromWords:r,fromWordsUnsafe:s,toWords:o}}const dn=Di("bech32");Di("bech32m"),Ct(Wt(4),jt("0123456789abcdef"),Ot(""),Ni(t=>{if("string"!=typeof t||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()}));var Vi=V(5693),Tr=V(9673),Es=V(9608);const Lt=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function Ur(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function Nr(t){if("string"==typeof t&&(t=Ur(t)),!(t=>t instanceof Uint8Array)(t))throw new Error("expected Uint8Array, got "+typeof t);return t}function Pr(t,n){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");if("number"==typeof n&&t.length!==n)throw new Error(`Uint8Array length ${n} expected`)}function $r(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function zi(t,...n){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(n.length>0&&!n.includes(t.length))throw new Error(`Expected Uint8Array of length ${n}, not of length=${t.length}`)}const kt={number:$r,bool:function Rs(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)},bytes:zi,hash:function Ts(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("hash must be wrapped by utils.wrapConstructor");$r(t.outputLen),$r(t.blockLen)},exists:function Cs(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called")},output:function Bs(t,n){zi(t);const e=n.outputLen;if(t.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}},vt=(t,n)=>255&t[n++]|(255&t[n++])<<8;class Us{constructor(n){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,Pr(n=Nr(n),32);const e=vt(n,0),r=vt(n,2),o=vt(n,4),s=vt(n,6),c=vt(n,8),f=vt(n,10),h=vt(n,12),g=vt(n,14);this.r[0]=8191&e,this.r[1]=8191&(e>>>13|r<<3),this.r[2]=7939&(r>>>10|o<<6),this.r[3]=8191&(o>>>7|s<<9),this.r[4]=255&(s>>>4|c<<12),this.r[5]=c>>>1&8190,this.r[6]=8191&(c>>>14|f<<2),this.r[7]=8065&(f>>>11|h<<5),this.r[8]=8191&(h>>>8|g<<8),this.r[9]=g>>>5&127;for(let b=0;b<8;b++)this.pad[b]=vt(n,16+2*b)}process(n,e,r=!1){const o=r?0:2048,{h:s,r:c}=this,f=c[0],h=c[1],g=c[2],b=c[3],_=c[4],I=c[5],A=c[6],S=c[7],k=c[8],R=c[9],T=vt(n,e+0),N=vt(n,e+2),O=vt(n,e+4),P=vt(n,e+6),G=vt(n,e+8),C=vt(n,e+10),$=vt(n,e+12),F=vt(n,e+14);let L=s[0]+(8191&T),X=s[1]+(8191&(T>>>13|N<<3)),W=s[2]+(8191&(N>>>10|O<<6)),Q=s[3]+(8191&(O>>>7|P<<9)),ie=s[4]+(8191&(P>>>4|G<<12)),ge=s[5]+(G>>>1&8191),B=s[6]+(8191&(G>>>14|C<<2)),j=s[7]+(8191&(C>>>11|$<<5)),Y=s[8]+(8191&($>>>8|F<<8)),te=s[9]+(F>>>5|o),D=0,ue=D+L*f+X*(5*R)+W*(5*k)+Q*(5*S)+ie*(5*A);D=ue>>>13,ue&=8191,ue+=ge*(5*I)+B*(5*_)+j*(5*b)+Y*(5*g)+te*(5*h),D+=ue>>>13,ue&=8191;let ye=D+L*h+X*f+W*(5*R)+Q*(5*k)+ie*(5*S);D=ye>>>13,ye&=8191,ye+=ge*(5*A)+B*(5*I)+j*(5*_)+Y*(5*b)+te*(5*g),D+=ye>>>13,ye&=8191;let ve=D+L*g+X*h+W*f+Q*(5*R)+ie*(5*k);D=ve>>>13,ve&=8191,ve+=ge*(5*S)+B*(5*A)+j*(5*I)+Y*(5*_)+te*(5*b),D+=ve>>>13,ve&=8191;let pt=D+L*b+X*g+W*h+Q*f+ie*(5*R);D=pt>>>13,pt&=8191,pt+=ge*(5*k)+B*(5*S)+j*(5*A)+Y*(5*I)+te*(5*_),D+=pt>>>13,pt&=8191;let _t=D+L*_+X*b+W*g+Q*h+ie*f;D=_t>>>13,_t&=8191,_t+=ge*(5*R)+B*(5*k)+j*(5*S)+Y*(5*A)+te*(5*I),D+=_t>>>13,_t&=8191;let Mt=D+L*I+X*_+W*b+Q*g+ie*h;D=Mt>>>13,Mt&=8191,Mt+=ge*f+B*(5*R)+j*(5*k)+Y*(5*S)+te*(5*A),D+=Mt>>>13,Mt&=8191;let It=D+L*A+X*I+W*_+Q*b+ie*g;D=It>>>13,It&=8191,It+=ge*h+B*f+j*(5*R)+Y*(5*k)+te*(5*S),D+=It>>>13,It&=8191;let xt=D+L*S+X*A+W*I+Q*_+ie*b;D=xt>>>13,xt&=8191,xt+=ge*g+B*h+j*f+Y*(5*R)+te*(5*k),D+=xt>>>13,xt&=8191;let Gt=D+L*k+X*S+W*A+Q*I+ie*_;D=Gt>>>13,Gt&=8191,Gt+=ge*b+B*g+j*h+Y*f+te*(5*R),D+=Gt>>>13,Gt&=8191;let Et=D+L*R+X*k+W*S+Q*A+ie*I;D=Et>>>13,Et&=8191,Et+=ge*_+B*b+j*g+Y*h+te*f,D+=Et>>>13,Et&=8191,D=(D<<2)+D|0,D=D+ue|0,ue=8191&D,D>>>=13,ye+=D,s[0]=ue,s[1]=ye,s[2]=ve,s[3]=pt,s[4]=_t,s[5]=Mt,s[6]=It,s[7]=xt,s[8]=Gt,s[9]=Et}finalize(){const{h:n,pad:e}=this,r=new Uint16Array(10);let o=n[1]>>>13;n[1]&=8191;for(let f=2;f<10;f++)n[f]+=o,o=n[f]>>>13,n[f]&=8191;n[0]+=5*o,o=n[0]>>>13,n[0]&=8191,n[1]+=o,o=n[1]>>>13,n[1]&=8191,n[2]+=o,r[0]=n[0]+5,o=r[0]>>>13,r[0]&=8191;for(let f=1;f<10;f++)r[f]=n[f]+o,o=r[f]>>>13,r[f]&=8191;r[9]-=8192;let s=(1^o)-1;for(let f=0;f<10;f++)r[f]&=s;s=~s;for(let f=0;f<10;f++)n[f]=n[f]&s|r[f];n[0]=65535&(n[0]|n[1]<<13),n[1]=65535&(n[1]>>>3|n[2]<<10),n[2]=65535&(n[2]>>>6|n[3]<<7),n[3]=65535&(n[3]>>>9|n[4]<<4),n[4]=65535&(n[4]>>>12|n[5]<<1|n[6]<<14),n[5]=65535&(n[6]>>>2|n[7]<<11),n[6]=65535&(n[7]>>>5|n[8]<<8),n[7]=65535&(n[8]>>>8|n[9]<<5);let c=n[0]+e[0];n[0]=65535&c;for(let f=1;f<8;f++)c=(n[f]+e[f]|0)+(c>>>16)|0,n[f]=65535&c}update(n){kt.exists(this);const{buffer:e,blockLen:r}=this,o=(n=Nr(n)).length;for(let s=0;s<o;){const c=Math.min(r-this.pos,o-s);if(c!==r)e.set(n.subarray(s,s+c),this.pos),this.pos+=c,s+=c,this.pos===r&&(this.process(e,0,!1),this.pos=0);else for(;r<=o-s;s+=r)this.process(n,s)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(n){kt.exists(this),kt.output(n,this),this.finished=!0;const{buffer:e,h:r}=this;let{pos:o}=this;if(o){for(e[o++]=1;o<16;o++)e[o]=0;this.process(e,0,!0)}this.finalize();let s=0;for(let c=0;c<8;c++)n[s++]=r[c]>>>0,n[s++]=r[c]>>>8;return n}digest(){const{buffer:n,outputLen:e}=this;this.digestInto(n);const r=n.slice(0,e);return this.destroy(),r}}!function Ns(t){const n=(r,o)=>t(o).update(Nr(r)).digest(),e=t(new Uint8Array(32));n.outputLen=e.outputLen,n.blockLen=e.blockLen,n.create=r=>t(r)}(t=>new Us(t));const Ps=Ur("expand 16-byte k"),$s=Ur("expand 32-byte k"),js=Lt(Ps),Os=Lt($s),Yi=t=>!(t.byteOffset%4),Z=(t,n)=>t<<n|t>>>32-n;const Hi=(t=>{const{core:n,rounds:e,counterRight:r,counterLen:o,allow128bitKeys:s,extendNonceFn:c,blockLen:f}=function As(t,n){if(void 0!==n&&("object"!=typeof n||!(t=>"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object)(n)))throw new Error("options must be object or undefined");return Object.assign(t,n)}({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},t);kt.number(o),kt.number(e),kt.number(f),kt.bool(r),kt.bool(s);const h=f/4;if(f%4!=0)throw new Error("Salsa/ChaCha: blockLen must be aligned to 4 bytes");return(g,b,_,I,A=0)=>{if(kt.bytes(g),kt.bytes(b),kt.bytes(_),I||(I=new Uint8Array(_.length)),kt.bytes(I),kt.number(A),A<0||A>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(I.length<_.length)throw new Error(`Salsa/ChaCha: output (${I.length}) is shorter than data (${_.length})`);const S=[];let k,R;if(32===g.length)k=g,R=Os;else{if(16!==g.length||!s)throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${g.length}`);k=new Uint8Array(32),k.set(g),k.set(g,16),R=js,S.push(k)}if(c){if(b.length<=16)throw new Error("Salsa/ChaCha: extended nonce must be bigger than 16 bytes");k=c(R,k,b.subarray(0,16),new Uint8Array(32)),S.push(k),b=b.subarray(16)}const T=16-o;if(b.length!==T)throw new Error(`Salsa/ChaCha: nonce must be ${T} or 16 bytes`);if(12!==T){const L=new Uint8Array(12);L.set(b,r?0:12-b.length),S.push(b=L)}const N=new Uint8Array(f),O=Lt(N),P=Lt(k),G=Lt(b),C=Yi(_)&&Lt(_),$=Yi(I)&&Lt(I);S.push(O);const F=_.length;for(let L=0,X=A;L<F;X++){if(n(R,P,G,O,X,e),X>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");const W=Math.min(f,F-L);if(W===f&&$&&C){const Q=L/4;if(L%4!=0)throw new Error("Salsa/ChaCha: invalid block position");for(let ie=0;ie<h;ie++)$[Q+ie]=C[Q+ie]^O[ie];L+=f}else{for(let Q=0;Q<W;Q++)I[L+Q]=_[L+Q]^N[Q];L+=W}}for(let L=0;L<S.length;L++)S[L].fill(0);return I}})({core:function $n(t,n,e,r,o,s=20){let c=t[0],f=t[1],h=t[2],g=t[3],b=n[0],_=n[1],I=n[2],A=n[3],S=n[4],k=n[5],R=n[6],T=n[7],N=o,O=e[0],P=e[1],G=e[2],C=c,$=f,F=h,L=g,X=b,W=_,Q=I,ie=A,ge=S,B=k,j=R,Y=T,te=N,D=O,ue=P,ye=G;for(let pt=0;pt<s;pt+=2)C=C+X|0,te=Z(te^C,16),ge=ge+te|0,X=Z(X^ge,12),C=C+X|0,te=Z(te^C,8),ge=ge+te|0,X=Z(X^ge,7),$=$+W|0,D=Z(D^$,16),B=B+D|0,W=Z(W^B,12),$=$+W|0,D=Z(D^$,8),B=B+D|0,W=Z(W^B,7),F=F+Q|0,ue=Z(ue^F,16),j=j+ue|0,Q=Z(Q^j,12),F=F+Q|0,ue=Z(ue^F,8),j=j+ue|0,Q=Z(Q^j,7),L=L+ie|0,ye=Z(ye^L,16),Y=Y+ye|0,ie=Z(ie^Y,12),L=L+ie|0,ye=Z(ye^L,8),Y=Y+ye|0,ie=Z(ie^Y,7),C=C+W|0,ye=Z(ye^C,16),j=j+ye|0,W=Z(W^j,12),C=C+W|0,ye=Z(ye^C,8),j=j+ye|0,W=Z(W^j,7),$=$+Q|0,te=Z(te^$,16),Y=Y+te|0,Q=Z(Q^Y,12),$=$+Q|0,te=Z(te^$,8),Y=Y+te|0,Q=Z(Q^Y,7),F=F+ie|0,D=Z(D^F,16),ge=ge+D|0,ie=Z(ie^ge,12),F=F+ie|0,D=Z(D^F,8),ge=ge+D|0,ie=Z(ie^ge,7),L=L+X|0,ue=Z(ue^L,16),B=B+ue|0,X=Z(X^B,12),L=L+X|0,ue=Z(ue^L,8),B=B+ue|0,X=Z(X^B,7);let ve=0;r[ve++]=c+C|0,r[ve++]=f+$|0,r[ve++]=h+F|0,r[ve++]=g+L|0,r[ve++]=b+X|0,r[ve++]=_+W|0,r[ve++]=I+Q|0,r[ve++]=A+ie|0,r[ve++]=S+ge|0,r[ve++]=k+B|0,r[ve++]=R+j|0,r[ve++]=T+Y|0,r[ve++]=N+te|0,r[ve++]=O+D|0,r[ve++]=P+ue|0,r[ve++]=G+ye|0},counterRight:!1,counterLen:4,allow128bitKeys:!1}),jr=new Uint8Array([0]),Ki=new Uint8Array;var Ws=Object.defineProperty,ht=(t,n)=>{for(var e in n)Ws(t,e,{get:n[e],enumerable:!0})};function Ji(){return fe(hn.utils.randomPrivateKey())}function Or(t){return fe(hn.getPublicKey(t))}ht({},{MessageNode:()=>Qi,MessageQueue:()=>eo,insertEventIntoAscendingList:()=>Ys,insertEventIntoDescendingList:()=>zs,normalizeURL:()=>Lr,utf8Decoder:()=>Ft,utf8Encoder:()=>At});var Ft=new TextDecoder("utf-8"),At=new TextEncoder;function Lr(t){let n=new URL(t);return n.pathname=n.pathname.replace(/\/+/g,"/"),n.pathname.endsWith("/")&&(n.pathname=n.pathname.slice(0,-1)),("80"===n.port&&"ws:"===n.protocol||"443"===n.port&&"wss:"===n.protocol)&&(n.port=""),n.searchParams.sort(),n.hash="",n.toString()}function zs(t,n){let o,e=0,r=t.length-1,s=e;if(r<0)s=0;else if(n.created_at<t[r].created_at)s=r+1;else if(n.created_at>=t[e].created_at)s=e;else for(;;){if(r<=e+1){s=r;break}if(o=Math.floor(e+(r-e)/2),t[o].created_at>n.created_at)e=o;else{if(!(t[o].created_at<n.created_at)){s=o;break}r=o}}return t[s]?.id!==n.id?[...t.slice(0,s),n,...t.slice(s)]:t}function Ys(t,n){let o,e=0,r=t.length-1,s=e;if(r<0)s=0;else if(n.created_at>t[r].created_at)s=r+1;else if(n.created_at<=t[e].created_at)s=e;else for(;;){if(r<=e+1){s=r;break}if(o=Math.floor(e+(r-e)/2),t[o].created_at<n.created_at)e=o;else{if(!(t[o].created_at>n.created_at)){s=o;break}r=o}}return t[s]?.id!==n.id?[...t.slice(0,s),n,...t.slice(s)]:t}var Qi=class{_value;_next;get value(){return this._value}set value(t){this._value=t}get next(){return this._next}set next(t){this._next=t}constructor(t){this._value=t,this._next=null}},eo=class{_first;_last;get first(){return this._first}set first(t){this._first=t}get last(){return this._last}set last(t){this._last=t}_size;get size(){return this._size}set size(t){this._size=t}constructor(){this._first=null,this._last=null,this._size=0}enqueue(t){const n=new Qi(t);return 0!==this._size&&this._last?(this._last.next=n,this._last=n):(this._first=n,this._last=n),this._size++,!0}dequeue(){if(0===this._size||!this._first)return null;let t=this._first;return this._first=t.next,t.next=null,this._size--,t.value}},pn=Symbol("verified");function zt(t,n){const e=t;return e.pubkey=Or(n),e.id=jn(e),e.sig=function to(t,n){return fe(hn.sign(jn(t),n))}(e,n),e[pn]=!0,e}function jn(t){let n=xe(At.encode(function Xs(t){if(!Fr(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}(t)));return fe(n)}var Ks=t=>t instanceof Object;function Fr(t){if(!Ks(t)||"number"!=typeof t.kind||"string"!=typeof t.content||"number"!=typeof t.created_at||"string"!=typeof t.pubkey||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let n=0;n<t.tags.length;n++){let e=t.tags[n];if(!Array.isArray(e))return!1;for(let r=0;r<e.length;r++)if("object"==typeof e[r])return!1}return!0}function rr(t){if("boolean"==typeof t[pn])return t[pn];const n=jn(t);if(n!==t.id)return t[pn]=!1;try{return t[pn]=hn.verify(t.sig,n,t.pubkey)}catch{return t[pn]=!1}}function Js(t,n){if(t.ids&&-1===t.ids.indexOf(n.id)&&!t.ids.some(e=>n.id.startsWith(e))||t.kinds&&-1===t.kinds.indexOf(n.kind)||t.authors&&-1===t.authors.indexOf(n.pubkey)&&!t.authors.some(e=>n.pubkey.startsWith(e)))return!1;for(let e in t)if("#"===e[0]){let o=t[`#${e.slice(1)}`];if(o&&!n.tags.find(([s,c])=>s===e.slice(1)&&-1!==o.indexOf(c)))return!1}return!(t.since&&n.created_at<t.since||t.until&&n.created_at>t.until)}function ir(t,n){let e=n.length+3,r=t.indexOf(`"${n}":`)+e,o=t.slice(r).indexOf('"')+r+1;return t.slice(o,o+64)}function ro(t,n){let e=n.length,r=t.indexOf(`"${n}":`)+e+3,o=t.slice(r),s=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,s),10)}function io(t){let n=t.slice(0,22).indexOf('"EVENT"');if(-1===n)return null;let e=t.slice(n+7+1).indexOf('"');if(-1===e)return null;let r=n+7+1+e,o=t.slice(r+1,80).indexOf('"');return-1===o?null:t.slice(r+1,r+1+o)}function ta(t,n){return n===ir(t,"id")}function na(t,n){return n===ir(t,"pubkey")}function ra(t,n){return n===ro(t,"kind")}function so(t,n={}){let{listTimeout:e=3e3,getTimeout:r=3e3,countTimeout:o=3e3}=n;var s,b,c={},f={connect:[],disconnect:[],error:[],notice:[],auth:[]},h={},g={};function I(){return(I=(0,U.A)(function*(){return b||(b=new Promise((P,G)=>{try{s=new WebSocket(t)}catch(L){G(L)}s.onopen=()=>{f.connect.forEach(L=>L()),P()},s.onerror=()=>{b=void 0,f.error.forEach(L=>L()),G()},s.onclose=(0,U.A)(function*(){b=void 0,f.disconnect.forEach(L=>L())});let $,C=new eo;function F(){if(0===C.size)return clearInterval($),void($=null);var L=C.dequeue();if(!L)return;let X=io(L);if(X){let W=c[X];if(W&&W.alreadyHaveEvent&&W.alreadyHaveEvent(ir(L,"id"),t))return}try{let W=JSON.parse(L);switch(W[0]){case"EVENT":{let B=W[1],j=W[2];return void(Fr(j)&&c[B]&&(c[B].skipVerification||rr(j))&&function no(t,n){for(let e=0;e<t.length;e++)if(Js(t[e],n))return!0;return!1}(c[B].filters,j)&&(h[B]?.event||[]).forEach(Y=>Y(j)))}case"COUNT":let Q=W[1],ie=W[2];return void(c[Q]&&(h[Q]?.count||[]).forEach(B=>B(ie)));case"EOSE":{let B=W[1];return void(B in h&&(h[B].eose.forEach(j=>j()),h[B].eose=[]))}case"OK":{let B=W[1],j=W[2],Y=W[3]||"";if(B in g){let{resolve:te,reject:D}=g[B];j?te(null):D(new Error(Y))}return}case"NOTICE":let ge=W[1];return void f.notice.forEach(B=>B(ge));case"AUTH":{let B=W[1];return void f.auth?.forEach(j=>j(B))}}}catch{return}}s.onmessage=L=>{C.enqueue(L.data),$||($=setInterval(F,0))}}))})).apply(this,arguments)}function A(){return 1===s?.readyState}function k(){return k=(0,U.A)(function*(){A()||(yield function _(){return I.apply(this,arguments)}())}),k.apply(this,arguments)}function R(P){return T.apply(this,arguments)}function T(){return(T=(0,U.A)(function*(P){let G=JSON.stringify(P);if(A()||(yield new Promise(C=>setTimeout(C,1e3)),A()))try{s.send(G)}catch(C){console.log(C)}})).apply(this,arguments)}const N=(P,{verb:G="REQ",skipVerification:C=!1,alreadyHaveEvent:$=null,id:F=Math.random().toString().slice(2)}={})=>{let L=F;c[L]={id:L,filters:P,skipVerification:C,alreadyHaveEvent:$},R([G,L,...P]);let X={sub:(W,Q={})=>N(W||P,{skipVerification:Q.skipVerification||C,alreadyHaveEvent:Q.alreadyHaveEvent||$,id:L}),unsub:()=>{delete c[L],delete h[L],R(["CLOSE",L])},on:(W,Q)=>{h[L]=h[L]||{event:[],count:[],eose:[]},h[L][W].push(Q)},off:(W,Q)=>{let ie=h[L],ge=ie[W].indexOf(Q);ge>=0&&ie[W].splice(ge,1)},get events(){return function ao(t){return Gr.apply(this,arguments)}(X)}};return X};function O(P,G){return new Promise((C,$)=>{if(!P.id)return void $(new Error(`event ${P} has no id`));let F=P.id;R([G,P]),g[F]={resolve:C,reject:$}})}return{url:t,sub:N,on:(P,G)=>{f[P].push(G),"connect"===P&&1===s?.readyState&&G()},off:(P,G)=>{let C=f[P].indexOf(G);-1!==C&&f[P].splice(C,1)},list:(P,G)=>new Promise(C=>{let $=N(P,G),F=[],L=setTimeout(()=>{$.unsub(),C(F)},e);$.on("eose",()=>{$.unsub(),clearTimeout(L),C(F)}),$.on("event",X=>{F.push(X)})}),get:(P,G)=>new Promise(C=>{let $=N([P],G),F=setTimeout(()=>{$.unsub(),C(null)},r);$.on("event",L=>{$.unsub(),clearTimeout(F),C(L)})}),count:P=>new Promise(G=>{let C=N(P,{...N,verb:"COUNT"}),$=setTimeout(()=>{C.unsub(),G(null)},o);C.on("count",F=>{C.unsub(),clearTimeout($),G(F)})}),publish:P=>(0,U.A)(function*(){yield O(P,"EVENT")})(),auth:P=>(0,U.A)(function*(){yield O(P,"AUTH")})(),connect:function S(){return k.apply(this,arguments)},close(){f={connect:[],disconnect:[],error:[],notice:[],auth:[]},h={},g={},s?.readyState===WebSocket.OPEN&&s.close()},get status(){return s?.readyState??3}}}function Gr(){return(Gr=(0,a.A)(function*(t){let n;const e=[],r=o=>{n?(n(o),n=void 0):e.push(o)};t.on("event",r);try{for(;;)e.length>0?yield e.shift():yield yield(0,w.A)(new Promise(s=>{n=s}))}finally{t.off("event",r)}})).apply(this,arguments)}ht({},{getHex64:()=>ir,getInt:()=>ro,getSubscriptionId:()=>io,matchEventId:()=>ta,matchEventKind:()=>ra,matchEventPubkey:()=>na});var qr={};ht(qr,{BECH32_REGEX:()=>co,decode:()=>On,naddrEncode:()=>ua,neventEncode:()=>ca,noteEncode:()=>aa,nprofileEncode:()=>la,npubEncode:()=>sa,nrelayEncode:()=>fa,nsecEncode:()=>oa});var lo=5e3,co=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function On(t){let{prefix:n,words:e}=dn.decode(t,lo),r=new Uint8Array(dn.fromWords(e));switch(n){case"nprofile":{let o=or(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(32!==o[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:fe(o[0][0]),relays:o[1]?o[1].map(s=>Ft.decode(s)):[]}}}case"nevent":{let o=or(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for nevent");if(32!==o[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(o[2]&&32!==o[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(o[3]&&4!==o[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:fe(o[0][0]),relays:o[1]?o[1].map(s=>Ft.decode(s)):[],author:o[2]?.[0]?fe(o[2][0]):void 0,kind:o[3]?.[0]?parseInt(fe(o[3][0]),16):void 0}}}case"naddr":{let o=or(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!o[2]?.[0])throw new Error("missing TLV 2 for naddr");if(32!==o[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!o[3]?.[0])throw new Error("missing TLV 3 for naddr");if(4!==o[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:Ft.decode(o[0][0]),pubkey:fe(o[2][0]),kind:parseInt(fe(o[3][0]),16),relays:o[1]?o[1].map(s=>Ft.decode(s)):[]}}}case"nrelay":{let o=or(r);if(!o[0]?.[0])throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:Ft.decode(o[0][0])}}case"nsec":case"npub":case"note":return{type:n,data:fe(r)};default:throw new Error(`unknown prefix ${n}`)}}function or(t){let n={},e=t;for(;e.length>0;){let r=e[0],o=e[1];if(!o)throw new Error(`malformed TLV ${r}`);let s=e.slice(2,2+o);if(e=e.slice(2+o),s.length<o)throw new Error(`not enough data to read on TLV ${r}`);n[r]=n[r]||[],n[r].push(s)}return n}function oa(t){return Dr("nsec",t)}function sa(t){return Dr("npub",t)}function aa(t){return Dr("note",t)}function Ln(t,n){let e=dn.toWords(n);return dn.encode(t,e,lo)}function Dr(t,n){return Ln(t,_e(n))}function la(t){return Ln("nprofile",sr({0:[_e(t.pubkey)],1:(t.relays||[]).map(e=>At.encode(e))}))}function ca(t){let n;return null!=t.kind&&(n=function ia(t){const n=new Uint8Array(4);return n[0]=t>>24&255,n[1]=t>>16&255,n[2]=t>>8&255,n[3]=255&t,n}(t.kind)),Ln("nevent",sr({0:[_e(t.id)],1:(t.relays||[]).map(r=>At.encode(r)),2:t.author?[_e(t.author)]:[],3:n?[new Uint8Array(n)]:[]}))}function ua(t){let n=new ArrayBuffer(4);return new DataView(n).setUint32(0,t.kind,!1),Ln("naddr",sr({0:[At.encode(t.identifier)],1:(t.relays||[]).map(r=>At.encode(r)),2:[_e(t.pubkey)],3:[new Uint8Array(n)]}))}function fa(t){return Ln("nrelay",sr({0:[At.encode(t)]}))}function sr(t){let n=[];return Object.entries(t).forEach(([e,r])=>{r.forEach(o=>{let s=new Uint8Array(o.length+2);s.set([parseInt(e)],0),s.set([o.length],1),s.set(o,2),n.push(s)})}),Pe(...n)}var Wr={};function uo(t,n,e){return Vr.apply(this,arguments)}function Vr(){return(Vr=(0,U.A)(function*(t,n,e){const o=fo(fn.getSharedSecret(t,"02"+n));let s=Uint8Array.from(en(16)),c=At.encode(e),f=yield crypto.subtle.importKey("raw",o,{name:"AES-CBC"},!1,["encrypt"]),h=yield crypto.subtle.encrypt({name:"AES-CBC",iv:s},f,c);return`${Vt.encode(new Uint8Array(h))}?iv=${Vt.encode(new Uint8Array(s.buffer))}`})).apply(this,arguments)}function da(t,n,e){return zr.apply(this,arguments)}function zr(){return(zr=(0,U.A)(function*(t,n,e){let[r,o]=e.split("?iv="),c=fo(fn.getSharedSecret(t,"02"+n)),f=yield crypto.subtle.importKey("raw",c,{name:"AES-CBC"},!1,["decrypt"]),h=Vt.decode(r),g=Vt.decode(o),b=yield crypto.subtle.decrypt({name:"AES-CBC",iv:g},f,h);return Ft.decode(b)})).apply(this,arguments)}function fo(t){return t.slice(1,33)}ht(Wr,{decrypt:()=>da,encrypt:()=>uo}),typeof crypto<"u"&&!crypto.subtle&&crypto.webcrypto&&(crypto.subtle=crypto.webcrypto.subtle),ht({},{NIP05_REGEX:()=>ho,queryProfile:()=>va,searchDomain:()=>ma,useFetchImplementation:()=>ga});var ar,ho=/^(?:([\w.+-]+)@)?([\w.-]+)$/;try{ar=fetch}catch{}function ga(t){ar=t}function ma(t){return Yr.apply(this,arguments)}function Yr(){return(Yr=(0,U.A)(function*(t,n=""){try{return(yield(yield ar(`https://${t}/.well-known/nostr.json?name=${n}`)).json()).names}catch{return{}}})).apply(this,arguments)}function va(t){return Hr.apply(this,arguments)}function Hr(){return(Hr=(0,U.A)(function*(t){const n=t.match(ho);if(!n)return null;const[e,r="_",o]=n;try{const s=yield ar(`https://${o}/.well-known/nostr.json?name=${r}`),{names:c,relays:f}=function ya(t){const n={names:{}};for(const[e,r]of Object.entries(t.names))"string"==typeof e&&"string"==typeof r&&(n.names[e]=r);if(t.relays){n.relays={};for(const[e,r]of Object.entries(t.relays))"string"==typeof e&&Array.isArray(r)&&(n.relays[e]=r.filter(o=>"string"==typeof o))}return n}(yield s.json()),h=c[r];return h?{pubkey:h,relays:f?.[h]}:null}catch{return null}})).apply(this,arguments)}function ba(t,n){let r=Es.c.fromMasterSeed((0,Tr.kw)(t,n)).derive("m/44'/1237'/0'/0/0").privateKey;if(!r)throw new Error("could not derive private key");return fe(r)}function _a(){return(0,Tr.we)(Vi.p)}function xa(t){return(0,Tr.JB)(t,Vi.p)}function ka(t){const n={reply:void 0,root:void 0,mentions:[],profiles:[]},e=[];for(const r of t.tags)"e"===r[0]&&r[1]&&e.push(r),"p"===r[0]&&r[1]&&n.profiles.push({pubkey:r[1],relays:r[2]?[r[2]]:[]});for(let r=0;r<e.length;r++){const o=e[r],[s,c,f,h]=o,g={id:c,relays:f?[f]:[]},_=r===e.length-1;"root"!==h?"reply"!==h?"mention"!==h?0===r?n.root=g:_?n.reply=g:n.mentions.push(g):n.mentions.push(g):n.reply=g:n.root=g}return n}function po(t){let n=0;for(let e=0;e<t.length;e++){const r=parseInt(t[e],16);if(0!==r){n+=Math.clz32(r)-28;break}n+=4}return n}function Sa(t,n){let e=0;const r=t,o=["nonce",e.toString(),n.toString()];for(r.tags.push(o);;){const s=Math.floor((new Date).getTime()/1e3);if(s!==r.created_at&&(e=0,r.created_at=s),o[1]=(++e).toString(),r.id=jn(r),po(r.id)>=n)break}return r}function Ia(t,n,e,r){return zt({kind:6,tags:[...t.tags??[],["e",n.id,e],["p",n.pubkey]],content:""===t.content?"":JSON.stringify(n),created_at:t.created_at},r)}function go(t){if(6!==t.kind)return;let n,e;for(let r=t.tags.length-1;r>=0&&(void 0===n||void 0===e);r--){const o=t.tags[r];o.length>=2&&("e"===o[0]&&void 0===n?n=o:"p"===o[0]&&void 0===e&&(e=o))}return void 0!==n?{id:n[1],relays:[n[2],e?.[2]].filter(r=>"string"==typeof r),author:e?.[1]}:void 0}function Ra(t,{skipVerification:n}={}){const e=go(t);if(void 0===e||""===t.content)return;let r;try{r=JSON.parse(t.content)}catch{return}return r.id===e.id&&(n||rr(r))?r:void 0}ht({},{generateSeedWords:()=>_a,privateKeyFromSeedWords:()=>ba,validateWords:()=>xa}),ht({},{parse:()=>ka}),ht({},{getPow:()=>po,minePow:()=>Sa}),ht({},{finishRepostEvent:()=>Ia,getRepostedEvent:()=>Ra,getRepostedEventPointer:()=>go}),ht({},{NOSTR_URI_REGEX:()=>lr,parse:()=>Ba,test:()=>Ca});var lr=new RegExp(`nostr:(${co.source})`);function Ca(t){return"string"==typeof t&&new RegExp(`^${lr.source}$`).test(t)}function Ba(t){const n=t.match(new RegExp(`^${lr.source}$`));if(!n)throw new Error(`Invalid Nostr URI: ${t}`);return{uri:n[0],value:n[1],decoded:On(n[1])}}function Na(t,n,e){const r=n.tags.filter(o=>o.length>=2&&("e"===o[0]||"p"===o[0]));return zt({...t,kind:7,tags:[...t.tags??[],...r,["e",n.id],["p",n.pubkey]],content:t.content??"+"},e)}function Pa(t){if(7!==t.kind)return;let n,e;for(let r=t.tags.length-1;r>=0&&(void 0===n||void 0===e);r--){const o=t.tags[r];o.length>=2&&("e"===o[0]&&void 0===n?n=o:"p"===o[0]&&void 0===e&&(e=o))}return void 0!==n&&void 0!==e?{id:n[1],relays:[n[2],e[2]].filter(r=>void 0!==r),author:e[1]}:void 0}function ja(t,n){let e=[];(n.kind||-1)>=0&&e.push(`kind=${n.kind}`),n.until&&e.push(`created_at<${n.until}`),n.since&&e.push(`created_at>${n.since}`);let r=e.join("&");if(""===r)throw new Error("refusing to create a delegation without any conditions");let o=xe(At.encode(`nostr:delegation:${n.pubkey}:${r}`)),s=fe(hn.sign(o,t));return{from:Or(t),to:n.pubkey,cond:r,sig:s}}function Oa(t){let n=t.tags.find(f=>"delegation"===f[0]&&f.length>=4);if(!n)return null;let e=n[1],r=n[2],o=n[3],s=r.split("&");for(let f=0;f<s.length;f++){let[h,g,b]=s[f].split(/\b/);if("kind"!==h||"="!==g||t.kind!==parseInt(b)){if("created_at"===h&&"<"===g&&t.created_at<parseInt(b))continue;if("created_at"===h&&">"===g&&t.created_at>parseInt(b))continue;return null}}let c=xe(At.encode(`nostr:delegation:${t.pubkey}:${r}`));return hn.verify(o,c,e)?e:null}ht({},{finishReactionEvent:()=>Na,getReactedEventPointer:()=>Pa}),ht({},{createDelegation:()=>ja,getDelegator:()=>Oa}),ht({},{matchAll:()=>Fa,regex:()=>Zr,replaceAll:()=>Ga});var Zr=()=>new RegExp(`\\b${lr.source}\\b`,"g");function*Fa(t){const n=t.matchAll(Zr());for(const e of n)try{const[r,o]=e;yield{uri:r,value:o,decoded:On(o),start:e.index,end:e.index+r.length}}catch{}}function Ga(t,n){return t.replaceAll(Zr(),(e,r)=>n({uri:e,value:r,decoded:On(r)}))}ht({},{channelCreateEvent:()=>Da,channelHideMessageEvent:()=>za,channelMessageEvent:()=>Va,channelMetadataEvent:()=>Wa,channelMuteUserEvent:()=>Ya});var Xr,Da=(t,n)=>{let e;if("object"==typeof t.content)e=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;e=t.content}return zt({kind:40,tags:[...t.tags??[]],content:e,created_at:t.created_at},n)},Wa=(t,n)=>{let e;if("object"==typeof t.content)e=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;e=t.content}return zt({kind:41,tags:[["e",t.channel_create_event_id],...t.tags??[]],content:e,created_at:t.created_at},n)},Va=(t,n)=>{const e=[["e",t.channel_create_event_id,t.relay_url,"root"]];return t.reply_to_channel_message_event_id&&e.push(["e",t.reply_to_channel_message_event_id,t.relay_url,"reply"]),zt({kind:42,tags:[...e,...t.tags??[]],content:t.content,created_at:t.created_at},n)},za=(t,n)=>{let e;if("object"==typeof t.content)e=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;e=t.content}return zt({kind:43,tags:[["e",t.channel_message_event_id],...t.tags??[]],content:e,created_at:t.created_at},n)},Ya=(t,n)=>{let e;if("object"==typeof t.content)e=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;e=t.content}return zt({kind:44,tags:[["p",t.pubkey_to_mute],...t.tags??[]],content:e,created_at:t.created_at},n)};ht({},{useFetchImplementation:()=>Za,validateGithub:()=>Xa});try{Xr=fetch}catch{}function Za(t){Xr=t}function Xa(t,n,e){return Kr.apply(this,arguments)}function Kr(){return(Kr=(0,U.A)(function*(t,n,e){try{return(yield(yield Xr(`https://gist.github.com/${n}/${e}/raw`)).text())===`Verifying that I control the following Nostr public key: ${t}`}catch{return!1}})).apply(this,arguments)}ht({},{authenticate:()=>Ja});var Ja=function(){var t=(0,U.A)(function*({challenge:n,relay:e,sign:r}){const o={kind:22242,created_at:Math.floor(Date.now()/1e3),tags:[["relay",e.url],["challenge",n]],content:""};return e.auth(yield r(o))});return function(e){return t.apply(this,arguments)}}();ht({},{decrypt:()=>tl,encrypt:()=>el,utils:()=>sn});var Qr,sn={v2:{maxPlaintextSize:65408,minCiphertextSize:100,maxCiphertextSize:102400,getConversationKey:(t,n)=>fn.getSharedSecret(t,"02"+n).subarray(1,33),getMessageKeys(t,n){const e=((t,n,e,r,o)=>function qs(t,n,e,r=32){if(l.hash(t),l.number(r),r>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/t.outputLen);void 0===e&&(e=Ki);const s=new Uint8Array(o*t.outputLen),c=un.create(t,n),f=c._cloneInto(),h=new Uint8Array(c.outputLen);for(let g=0;g<o;g++)jr[0]=g+1,f.update(0===g?Ki:h).update(e).update(jr).digestInto(h),s.set(h,t.outputLen*g),c._cloneInto(f);return c.destroy(),f.destroy(),h.fill(0),jr.fill(0),s.slice(0,r)}(t,function Gs(t,n,e){return l.hash(t),void 0===e&&(e=new Uint8Array(t.outputLen)),un(t,Se(e),Se(n))}(t,n,e),r,o))(xe,t,n,"nip44-v2",76);return{encryption:e.subarray(0,32),nonce:e.subarray(32,44),auth:e.subarray(44,76)}},calcPadding(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("expected positive integer");if(t<=32)return 32;const n=1<<Math.floor(Math.log2(t-1))+1,e=n<=256?32:n/8;return e*(Math.floor((t-1)/e)+1)},pad(t){const n=At.encode(t),e=n.length;if(e<1||e>=sn.v2.maxPlaintextSize)throw new Error("invalid plaintext length: must be between 1b and 64KB");const r=sn.v2.calcPadding(e),o=new Uint8Array(r-e),s=new Uint8Array(2);return new DataView(s.buffer).setUint16(0,e),Pe(s,n,o)},unpad(t){const n=new DataView(t.buffer).getUint16(0),e=t.subarray(2,2+n);if(0===n||e.length!==n||t.length!==2+sn.v2.calcPadding(n))throw new Error("invalid padding");return Ft.decode(e)}}};function el(t,n,e={}){const r=e.version??2;if(2!==r)throw new Error("unknown encryption version "+r);const o=e.salt??en(32);Pr(o,32);const s=sn.v2.getMessageKeys(t,o),c=sn.v2.pad(n),f=Hi(s.encryption,s.nonce,c),h=un(xe,s.auth,f);return Vt.encode(Pe(new Uint8Array([r]),o,f,h))}function tl(t,n){const e=sn.v2;Pr(t,32);const r=n.length;if(r<e.minCiphertextSize||r>=e.maxCiphertextSize)throw new Error("invalid ciphertext length: "+r);if("#"===n[0])throw new Error("unknown encryption version");let o;try{o=Vt.decode(n)}catch(I){throw new Error("invalid base64: "+I.message)}const s=o.subarray(0,1)[0];if(2!==s)throw new Error("unknown encryption version "+s);const c=o.subarray(1,33),f=o.subarray(33,-32),h=o.subarray(-32),g=e.getMessageKeys(t,c);if(!function Is(t,n){if(t.length!==n.length)throw new Error("equalBytes: Different size of Uint8Arrays");let e=!0;for(let r=0;r<t.length;r++)e&&(e=t[r]===n[r]);return e}(un(xe,g.auth,f),h))throw new Error("invalid MAC");const _=Hi(g.encryption,g.nonce,f);return e.unpad(_)}function rl(t){const{pathname:n,searchParams:e}=new URL(t),r=n,o=e.get("relay"),s=e.get("secret");if(!r||!o||!s)throw new Error("invalid connection string");return{pubkey:r,relay:o,secret:s}}function il(t){return Jr.apply(this,arguments)}function Jr(){return(Jr=(0,U.A)(function*({pubkey:t,secret:n,invoice:e}){const o=yield uo(n,t,JSON.stringify({method:"pay_invoice",params:{invoice:e}}));return zt({kind:23194,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",t]]},n)})).apply(this,arguments)}ht({},{makeNwcRequestEvent:()=>il,parseConnectionString:()=>rl}),ht({},{getZapEndpoint:()=>al,makeZapReceipt:()=>ul,makeZapRequest:()=>ll,useFetchImplementation:()=>sl,validateZapRequest:()=>cl});try{Qr=fetch}catch{}function sl(t){Qr=t}function al(t){return ei.apply(this,arguments)}function ei(){return(ei=(0,U.A)(function*(t){try{let n="",{lud06:e,lud16:r}=JSON.parse(t.content);if(e){let{words:c}=dn.decode(e,1e3),f=dn.fromWords(c);n=Ft.decode(f)}else{if(!r)return null;{let[c,f]=r.split("@");n=`https://${f}/.well-known/lnurlp/${c}`}}let s=yield(yield Qr(n)).json();if(s.allowsNostr&&s.nostrPubkey)return s.callback}catch{}return null})).apply(this,arguments)}function ll({profile:t,event:n,amount:e,relays:r,comment:o=""}){if(!e)throw new Error("amount not given");if(!t)throw new Error("profile not given");let s={kind:9734,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",t],["amount",e.toString()],["relays",...r]]};return n&&s.tags.push(["e",n]),s}function cl(t){let n;try{n=JSON.parse(t)}catch{return"Invalid zap request JSON."}if(!Fr(n))return"Zap request is not a valid Nostr event.";if(!rr(n))return"Invalid signature on zap request.";let e=n.tags.find(([s,c])=>"p"===s&&c);if(!e)return"Zap request doesn't have a 'p' tag.";if(!e[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=n.tags.find(([s,c])=>"e"===s&&c);return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":n.tags.find(([s,c])=>"relays"===s&&c)?null:"Zap request doesn't have a 'relays' tag."}function ul({zapRequest:t,preimage:n,bolt11:e,paidAt:r}){let s=JSON.parse(t).tags.filter(([f])=>"e"===f||"p"===f||"a"===f),c={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...s,["bolt11",e],["description",t]]};return n&&c.tags.push(["preimage",n]),c}ht({},{getToken:()=>hl,unpackEventFromToken:()=>vo,validateEvent:()=>yo,validateToken:()=>dl});var mo="Nostr ";function hl(t,n,e){return ti.apply(this,arguments)}function ti(){return(ti=(0,U.A)(function*(t,n,e,r=!1){if(!t||!n)throw new Error("Missing loginUrl or httpMethod");const o=function Zs(t=255){return{kind:t,content:"",tags:[],created_at:0}}(27235);o.tags=[["u",t],["method",n]],o.created_at=Math.round((new Date).getTime()/1e3);const s=yield e(o);return(r?mo:"")+Vt.encode(At.encode(JSON.stringify(s)))})).apply(this,arguments)}function dl(t,n,e){return ni.apply(this,arguments)}function ni(){return(ni=(0,U.A)(function*(t,n,e){const r=yield vo(t).catch(s=>{throw s});return yield yo(r,n,e).catch(s=>{throw s})})).apply(this,arguments)}function vo(t){return ri.apply(this,arguments)}function ri(){return(ri=(0,U.A)(function*(t){if(!t)throw new Error("Missing token");t=t.replace(mo,"");const n=Ft.decode(Vt.decode(t));if(!n||0===n.length||!n.startsWith("{"))throw new Error("Invalid token");return JSON.parse(n)})).apply(this,arguments)}function yo(t,n,e){return ii.apply(this,arguments)}function ii(){return(ii=(0,U.A)(function*(t,n,e){if(!t)throw new Error("Invalid nostr event");if(!rr(t))throw new Error("Invalid nostr event, signature invalid");if(27235!==t.kind)throw new Error("Invalid nostr event, kind invalid");if(!t.created_at)throw new Error("Invalid nostr event, created_at invalid");if(Math.round((new Date).getTime()/1e3)-t.created_at>60)throw new Error("Invalid nostr event, expired");const r=t.tags.find(s=>"u"===s[0]);if(1!==r?.length&&r?.[1]!==n)throw new Error("Invalid nostr event, url tag invalid");const o=t.tags.find(s=>"method"===s[0]);if(1!==o?.length&&o?.[1].toLowerCase()!==e.toLowerCase())throw new Error("Invalid nostr event, method tag invalid");return!0})).apply(this,arguments)}function me(){return me=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},me.apply(this,arguments)}const _o=t=>t.reduce((n,e)=>n+e.toString(16).padStart(2,"0"),"");class xo extends Error{constructor(n,e,r,o){let s=n.toString();e&&(s+=` ${e}`),s+=": ",s+=o.message?o.message:JSON.stringify(o),super(s),this.status=void 0,this.statusText=void 0,this.headers=void 0,this.error=void 0,this.status=n,this.statusText=e,this.headers=r,this.error=o}}const pl=["auth","endpoint","params","request_body","method","max_retries","base_url","user_agent","headers"],gl="https://api.getalby.com";function Eo(t,n){return si.apply(this,arguments)}function si(){return(si=(0,U.A)(function*(t,n,e=0){const r=yield fetch(t,n);if(429===r.status&&e>0){const o=Number(r.headers.get("x-rate-limit-reset")),s=Number(r.headers.get("x-rate-limit-remaining")),c=1e3*o-Date.now();let f=1e3;return 0===s&&(f=c),yield new Promise(h=>setTimeout(h,f)),Eo(t,n,e-1)}return r})).apply(this,arguments)}function ai(){return(ai=(0,U.A)(function*(t){let{auth:n,endpoint:e,params:r={},request_body:o,method:s,max_retries:c,base_url:f=gl,user_agent:h,headers:g}=t,b=function oi(t,n){if(null==t)return{};var e,r,o={},s=Object.keys(t);for(r=0;r<s.length;r++)n.indexOf(e=s[r])>=0||(o[e]=t[e]);return o}(t,pl);const _=new URL(f+e);_.search=function wo(t){return Object.entries(t).map(([n,e])=>n&&e?`${n}=${e}`:"").filter(n=>n).join("&")}(r);const I="POST"===s&&!!o,A=n?yield n.getAuthHeader(_.href,s):void 0,S=yield Eo(_.toString(),me({headers:me({},I?{"Content-Type":"application/json; charset=utf-8"}:void 0,A,g,{"User-Agent":h??"@getalby/sdk","X-User-Agent":h??"@getalby/sdk"}),method:s,body:I?JSON.stringify(o):void 0},b),c);if(!S.ok){const k=yield S.json();throw new xo(S.status,S.statusText,S.headers,k)}return S})).apply(this,arguments)}function dt(t){return li.apply(this,arguments)}function li(){return li=(0,U.A)(function*(t){return(yield function ml(t){return ai.apply(this,arguments)}(t)).json()}),li.apply(this,arguments)}class Mo{constructor(n){this.bearer_token=void 0,this.bearer_token=n}getAuthHeader(){return{Authorization:`Bearer ${this.bearer_token}`}}}class Jt extends Error{constructor(n,e){super(n),this.error=void 0,this.code=void 0,this.error=n,this.code=e}}class So extends Jt{}class ci extends Jt{}class ui extends ci{}class fi extends ci{}class hi extends Jt{}class di extends Jt{}class cr extends Jt{}class Ao extends Jt{}class Io extends Jt{}const Ro={alby:{authorizationUrl:"https://nwc.getalby.com/apps/new",relayUrl:"wss://relay.getalby.com/v1",walletPubkey:"69effe7b49a6dd5cf525bd0905917a5005ffe480b58eeb8e861418cf3ae760d9"}};class Fn{static parseWalletConnectUrl(n){n=n.replace("nostrwalletconnect://","http://").replace("nostr+walletconnect://","http://").replace("nostrwalletconnect:","http://").replace("nostr+walletconnect:","http://");const e=new URL(n),r=e.searchParams.get("relay");if(!r)throw new Error("No relay URL found in connection string");const o={walletPubkey:e.host,relayUrl:r},s=e.searchParams.get("secret");s&&(o.secret=s);const c=e.searchParams.get("lud16");return c&&(o.lud16=c),o}static withNewSecret(n){return(n=n||{}).secret=Ji(),new Fn(n)}constructor(n){var e;this.relay=void 0,this.relayUrl=void 0,this.secret=void 0,this.lud16=void 0,this.walletPubkey=void 0,this.options=void 0,n&&n.nostrWalletConnectUrl&&(n=me({},Fn.parseWalletConnectUrl(n.nostrWalletConnectUrl),n));const r=Ro[(null==(e=n)?void 0:e.providerName)||"alby"];this.options=me({},r,n||{}),this.relayUrl=this.options.relayUrl,this.relay=so(this.relayUrl),this.options.secret&&(this.secret=this.options.secret.toLowerCase().startsWith("nsec")?qr.decode(this.options.secret).data:this.options.secret),this.lud16=this.options.lud16,this.walletPubkey=this.options.walletPubkey.toLowerCase().startsWith("npub")?qr.decode(this.options.walletPubkey).data:this.options.walletPubkey,void 0===globalThis.WebSocket&&console.error("WebSocket is undefined. Make sure to `import websocket-polyfill` for nodejs environments")}get nostrWalletConnectUrl(){return this.getNostrWalletConnectUrl()}getNostrWalletConnectUrl(n=!0){let e=`nostr+walletconnect://${this.walletPubkey}?relay=${this.relayUrl}&pubkey=${this.publicKey}`;return n&&(e=`${e}&secret=${this.secret}`),e}get connected(){return 1===this.relay.status}get publicKey(){if(!this.secret)throw new Error("Missing secret key");return Or(this.secret)}getPublicKey(){return Promise.resolve(this.publicKey)}signEvent(n){if(!this.secret)throw new Error("Missing secret key");return Promise.resolve(zt(n,this.secret))}getEventHash(n){return jn(n)}close(){return this.relay.close()}encrypt(n,e){var r=this;return(0,U.A)(function*(){if(!r.secret)throw new Error("Missing secret");return yield Wr.encrypt(r.secret,n,e)})()}decrypt(n,e){var r=this;return(0,U.A)(function*(){if(!r.secret)throw new Error("Missing secret");return yield Wr.decrypt(r.secret,n,e)})()}getAuthorizationUrl(n){if(!this.options.authorizationUrl)throw new Error("Missing authorizationUrl option");const e=new URL(this.options.authorizationUrl);return null!=n&&n.name&&e.searchParams.set("name",n?.name),e.searchParams.set("pubkey",this.publicKey),null!=n&&n.returnTo&&e.searchParams.set("return_to",n.returnTo),null!=n&&n.budgetRenewal&&e.searchParams.set("budget_renewal",n.budgetRenewal),null!=n&&n.expiresAt&&e.searchParams.set("expires_at",Math.floor(n.expiresAt.getTime()/1e3).toString()),null!=n&&n.maxAmount&&e.searchParams.set("max_amount",n.maxAmount.toString()),void 0!==n?.editable&&e.searchParams.set("editable",n.editable.toString()),null!=n&&n.requestMethods&&e.searchParams.set("request_methods",n.requestMethods.join(" ")),e}initNWC(n={}){n.name||(n.name=document.location.host);const e=this.getAuthorizationUrl(n),r=window.outerHeight/2+window.screenY-300,o=window.outerWidth/2+window.screenX-200;return new Promise((s,c)=>{const f=window.open(e.toString(),`${document.title} - Wallet Connect`,`height=600,width=400,top=${r},left=${o}`);if(!f)return void c(new Error("failed to execute window.open"));const h=b=>{const _=b.data;_&&"nwc:success"===_.type&&b.origin===`${e.protocol}//${e.host}`&&(s(_),clearInterval(g),window.removeEventListener("message",h),f&&f.close())},g=setInterval(()=>{f&&f.closed&&(clearInterval(g),window.removeEventListener("message",h),c(new Error("Popup closed")))},500);window.addEventListener("message",h)})}getWalletServiceSupportedMethods(){var n=this;return(0,U.A)(function*(){return console.warn("getWalletServiceSupportedMethods is deprecated. Please use getWalletServiceInfo instead."),(yield n.getWalletServiceInfo()).capabilities})()}getWalletServiceInfo(){var n=this;return(0,U.A)(function*(){var e;yield n._checkConnected();const r=yield n.relay.list([{kinds:[13194],limit:1,authors:[n.walletPubkey]}],{eoseSubTimeout:1e4});if(!r.length)throw new Error("no info event (kind 13194) returned from relay");const o=r[0].content,s=r[0].tags.find(c=>"notifications"===c[0]);return{capabilities:o.split(/[ |,]/g),notifications:(null==s||null==(e=s[1])?void 0:e.split(" "))||[]}})()}getInfo(){var n=this;return(0,U.A)(function*(){try{return yield n.executeNip47Request("get_info",{},e=>!!e.methods)}catch(e){throw console.error("Failed to request get_info",e),e}})()}getBalance(){var n=this;return(0,U.A)(function*(){try{return yield n.executeNip47Request("get_balance",{},e=>void 0!==e.balance)}catch(e){throw console.error("Failed to request get_balance",e),e}})()}payInvoice(n){var e=this;return(0,U.A)(function*(){try{return yield e.executeNip47Request("pay_invoice",n,r=>!!r.preimage)}catch(r){throw console.error("Failed to request pay_invoice",r),r}})()}payKeysend(n){var e=this;return(0,U.A)(function*(){try{return yield e.executeNip47Request("pay_keysend",n,r=>!!r.preimage)}catch(r){throw console.error("Failed to request pay_keysend",r),r}})()}signMessage(n){var e=this;return(0,U.A)(function*(){try{return yield e.executeNip47Request("sign_message",n,r=>r.message===n.message&&!!r.signature)}catch(r){throw console.error("Failed to request sign_message",r),r}})()}multiPayInvoice(n){var e=this;return(0,U.A)(function*(){try{return{invoices:yield e.executeMultiNip47Request("multi_pay_invoice",n,n.invoices.length,r=>!!r.preimage),errors:[]}}catch(r){throw console.error("Failed to request multi_pay_invoice",r),r}})()}multiPayKeysend(n){var e=this;return(0,U.A)(function*(){try{return{keysends:yield e.executeMultiNip47Request("multi_pay_keysend",n,n.keysends.length,r=>!!r.preimage),errors:[]}}catch(r){throw console.error("Failed to request multi_pay_keysend",r),r}})()}makeInvoice(n){var e=this;return(0,U.A)(function*(){try{if(!n.amount)throw new Error("No amount specified");return yield e.executeNip47Request("make_invoice",n,r=>!!r.invoice)}catch(r){throw console.error("Failed to request make_invoice",r),r}})()}lookupInvoice(n){var e=this;return(0,U.A)(function*(){try{return yield e.executeNip47Request("lookup_invoice",n,r=>!!r.invoice)}catch(r){throw console.error("Failed to request lookup_invoice",r),r}})()}listTransactions(n){var e=this;return(0,U.A)(function*(){try{return yield e.executeNip47Request("list_transactions",n,r=>!!r.transactions)}catch(r){throw console.error("Failed to request list_transactions",r),r}})()}subscribeNotifications(n,e){var r=this;return(0,U.A)(function*(){var o=r;let s,c,f,h=!0;return(0,U.A)(function*(){for(;h;){try{yield o._checkConnected(),f=o.relay.sub([{kinds:[23196],authors:[o.walletPubkey],"#p":[o.publicKey]}]),console.info("subscribed to relay"),f.on("event",function(){var g=(0,U.A)(function*(b){const _=yield o.decrypt(o.walletPubkey,b.content);let I;try{I=JSON.parse(_)}catch(A){return void console.error("Failed to parse decrypted event content",A)}I.notification?(!e||e.indexOf(I.notification_type)>-1)&&n(I):console.error("No notification in response",I)});return function(b){return g.apply(this,arguments)}}()),yield new Promise(g=>{s=()=>{g()},c=()=>{console.info("relay disconnected"),s?.()},o.relay.on("disconnect",c)}),void 0!==c&&o.relay.off("disconnect",c)}catch(g){console.error("error subscribing to notifications",g||"unknown relay error")}h&&(yield new Promise(g=>setTimeout(g,1e3)))}})(),()=>{var g;h=!1,s?.(),null==(g=f)||g.unsub()}})()}executeNip47Request(n,e,r){var o=this;return(0,U.A)(function*(){var s=o;return yield o._checkConnected(),new Promise((c,f)=>{(0,U.A)(function*(){const h={method:n,params:e},g=yield s.encrypt(s.walletPubkey,JSON.stringify(h)),b={kind:23194,created_at:Math.floor(Date.now()/1e3),tags:[["p",s.walletPubkey]],content:g,pubkey:s.publicKey},_=yield s.signEvent(b),I=s.relay.sub([{kinds:[23195],authors:[s.walletPubkey],"#e":[_.id]}]),A=setTimeout(function(){I.unsub(),f(new fi(`reply timeout: event ${_.id}`,"INTERNAL"))},6e4);I.on("event",function(){var k=(0,U.A)(function*(R){clearTimeout(A),I.unsub();const T=yield s.decrypt(s.walletPubkey,R.content);let N;try{N=JSON.parse(T)}catch{return clearTimeout(A),I.unsub(),void f(new di("failed to deserialize response","INTERNAL"))}var O,P;N.result?r(N.result)?c(N.result):(clearTimeout(A),I.unsub(),f(new cr("response from NWC failed validation: "+JSON.stringify(N.result),"INTERNAL"))):(clearTimeout(A),I.unsub(),f(new So((null==(O=N.error)?void 0:O.message)||"unknown Error",(null==(P=N.error)?void 0:P.code)||"INTERNAL")))});return function(R){return k.apply(this,arguments)}}());const S=setTimeout(function(){I.unsub(),f(new ui(`publish timeout: ${_.id}`,"INTERNAL"))},5e3);try{yield s.relay.publish(_),clearTimeout(S)}catch(k){clearTimeout(S),f(new hi(`failed to publish: ${k}`,"INTERNAL"))}})()})})()}executeMultiNip47Request(n,e,r,o){var s=this;return(0,U.A)(function*(){var c=s;yield s._checkConnected();const f=[];return new Promise((h,g)=>{(0,U.A)(function*(){const b={method:n,params:e},_=yield c.encrypt(c.walletPubkey,JSON.stringify(b)),I={kind:23194,created_at:Math.floor(Date.now()/1e3),tags:[["p",c.walletPubkey]],content:_,pubkey:c.publicKey},A=yield c.signEvent(I),S=c.relay.sub([{kinds:[23195],authors:[c.walletPubkey],"#e":[A.id]}]),k=setTimeout(function(){S.unsub(),g(new fi(`reply timeout: event ${A.id}`,"INTERNAL"))},6e4);S.on("event",function(){var T=(0,U.A)(function*(N){const O=yield c.decrypt(c.walletPubkey,N.content);let P;try{P=JSON.parse(O)}catch{clearTimeout(k),S.unsub(),g(new di("failed to deserialize response","INTERNAL"))}if(P.result){var G;if(!o(P.result))return clearTimeout(k),S.unsub(),void g(new cr("Response from NWC failed validation: "+JSON.stringify(P.result),"INTERNAL"));const F=null==(G=N.tags.find(L=>"d"===L[0]))?void 0:G[1];if(void 0===F)return clearTimeout(k),S.unsub(),void g(new cr("No d tag found in response event","INTERNAL"));f.push(me({},P.result,{dTag:F})),f.length===r&&(clearTimeout(k),S.unsub(),h(f))}else{var C,$;clearTimeout(k),S.unsub(),g(new Ao(null==(C=P.error)?void 0:C.message,null==($=P.error)?void 0:$.code))}});return function(N){return T.apply(this,arguments)}}());const R=setTimeout(function(){S.unsub(),g(new ui(`Publish timeout: ${A.id}`,"INTERNAL"))},5e3);try{yield c.relay.publish(A),clearTimeout(R)}catch(T){clearTimeout(R),g(new hi(`Failed to publish: ${T}`,"INTERNAL"))}})()})})()}_checkConnected(){var n=this;return(0,U.A)(function*(){if(!n.secret)throw new Error("Missing secret key");try{yield n.relay.connect()}catch{throw console.error("failed to connect to relay",n.relayUrl),new Io("Failed to connect to "+n.relayUrl,"OTHER")}})()}}const wl={get_info:"getInfo",get_balance:"getBalance",make_invoice:"makeInvoice",pay_invoice:"sendPayment",pay_keysend:"payKeysend",lookup_invoice:"lookupInvoice",list_transactions:"listTransactions",multi_pay_invoice:"sendMultiPayment",multi_pay_keysend:"multiKeysend",sign_message:"signMessage"};class ur{get relay(){return console.warn("relay is deprecated. Please use client.relay instead."),this.client.relay}get relayUrl(){return console.warn("relayUrl is deprecated. Please use client.relayUrl instead."),this.client.relayUrl}get walletPubkey(){return console.warn("walletPubkey is deprecated. Please use client.walletPubkey instead."),this.client.walletPubkey}get options(){return this.client.options}get secret(){return console.warn("secret is deprecated. Please use client.secret instead."),this.client.secret}static withNewSecret(n){return(n=n||{}).secret=Ji(),new ur(n)}constructor(n){this._enabled=!1,this.client=void 0,this.subscribers=void 0,this.client=new Fn(n),this.subscribers={}}on(n,e){this.subscribers[n]=e}notify(n,e){const r=this.subscribers[n];r&&r(e)}getNostrWalletConnectUrl(n=!0){return console.warn("getNostrWalletConnectUrl is deprecated. Please use client.getNostrWalletConnectUrl instead."),this.client.getNostrWalletConnectUrl(n)}get nostrWalletConnectUrl(){return console.warn("nostrWalletConnectUrl is deprecated. Please use client.nostrWalletConnectUrl instead."),this.client.nostrWalletConnectUrl}get connected(){return console.warn("connected is deprecated. Please use client.connected instead."),this.client.connected}get publicKey(){return console.warn("publicKey is deprecated. Please use client.publicKey instead."),this.client.publicKey}getPublicKey(){return this.client.getPublicKey()}signEvent(n){return this.client.signEvent(n)}getEventHash(n){return console.warn("getEventHash is deprecated. Please use client.getEventHash instead."),this.client.getEventHash(n)}enable(){var n=this;return(0,U.A)(function*(){n._enabled=!0})()}close(){return this.client.close()}encrypt(n,e){var r=this;return(0,U.A)(function*(){return console.warn("encrypt is deprecated. Please use client.encrypt instead."),r.client.encrypt(n,e)})()}decrypt(n,e){var r=this;return(0,U.A)(function*(){return console.warn("decrypt is deprecated. Please use client.decrypt instead."),r.client.decrypt(n,e)})()}getAuthorizationUrl(n){return console.warn("getAuthorizationUrl is deprecated. Please use client.getAuthorizationUrl instead."),this.client.getAuthorizationUrl(n)}initNWC(n={}){return console.warn("initNWC is deprecated. Please use client.initNWC instead."),this.client.initNWC(n)}getInfo(){var n=this;return(0,U.A)(function*(){yield n.checkEnabled();const e=["lightning","nostr"],r="Alby JS SDK";try{const o=yield n.client.getInfo(),s={methods:o.methods.map(c=>wl[c]),node:{alias:o.alias,pubkey:o.pubkey,color:o.color},supports:e,version:r};return n.notify("getInfo",s),s}catch(o){return console.error("Using minimal getInfo",o),{methods:["sendPayment"],node:{},supports:e,version:r}}})()}getBalance(){var n=this;return(0,U.A)(function*(){yield n.checkEnabled();const e=yield n.client.getBalance(),r={balance:Math.floor(e.balance/1e3),currency:"sats"};return n.notify("getBalance",r),r})()}sendPayment(n){var e=this;return(0,U.A)(function*(){yield e.checkEnabled();const r={preimage:(yield e.client.payInvoice({invoice:n})).preimage};return e.notify("sendPayment",r),r})()}sendPaymentAsync(n){var e=this;return(0,U.A)(function*(){return yield e.checkEnabled(),e.client.payInvoice({invoice:n}),e.notify("sendPaymentAsync",{}),{}})()}keysend(n){var e=this;return(0,U.A)(function*(){yield e.checkEnabled();const r={preimage:(yield e.client.payKeysend(To(n))).preimage};return e.notify("keysend",r),r})()}signMessage(n){var e=this;return(0,U.A)(function*(){yield e.checkEnabled();const r=yield e.client.signMessage({message:n}),o={message:r.message,signature:r.signature};return e.notify("keysend",o),o})()}makeInvoice(n){var e=this;return(0,U.A)(function*(){var r;yield e.checkEnabled();const o="object"==typeof n?n:void 0,s=+(null!=(r=o?.amount)?r:n);if(!s)throw new Error("No amount specified");const c={paymentRequest:(yield e.client.makeInvoice({amount:1e3*s,description:o?.defaultMemo})).invoice};return e.notify("makeInvoice",c),c})()}lookupInvoice(n){var e=this;return(0,U.A)(function*(){yield e.checkEnabled();const r=yield e.client.lookupInvoice({invoice:n.paymentRequest,payment_hash:n.paymentHash}),o={preimage:r.preimage,paymentRequest:r.invoice,paid:!!r.settled_at};return e.notify("lookupInvoice",o),o})()}listTransactions(n){var e=this;return(0,U.A)(function*(){yield e.checkEnabled();const r={transactions:(yield e.client.listTransactions(n)).transactions.map(bl)};return e.notify("listTransactions",r),r})()}sendMultiPayment(n){var e=this;return(0,U.A)(function*(){yield e.checkEnabled();const o={payments:(yield e.client.multiPayInvoice({invoices:n.map((s,c)=>({invoice:s,id:c.toString()}))})).invoices.map(s=>{const c=n[parseInt(s.dTag)];if(!c)throw new Error("Could not find paymentRequest matching response d tag");return{paymentRequest:c,preimage:s.preimage}}),errors:[]};return e.notify("sendMultiPayment",o),o})()}multiKeysend(n){var e=this;return(0,U.A)(function*(){yield e.checkEnabled();const o={keysends:(yield e.client.multiPayKeysend({keysends:n.map((s,c)=>me({},To(s),{id:c.toString()}))})).keysends.map(s=>{const c=n[parseInt(s.dTag)];if(!c)throw new Error("Could not find keysend matching response d tag");return{keysend:c,preimage:s.preimage}}),errors:[]};return e.notify("multiKeysend",o),o})()}lnurl(n){throw new Error("Method not implemented.")}request(n,e){throw new Error("Method not implemented.")}verifyMessage(n,e){throw new Error("Method not implemented.")}checkEnabled(){var n=this;return(0,U.A)(function*(){if(!n._enabled)throw new Error("please call enable() and await the promise before calling this function")})()}}function bl(t){return me({},t,{amount:Math.floor(t.amount/1e3),fees_paid:t.fees_paid?Math.floor(t.fees_paid/1e3):0})}function To(t){return{amount:1e3*+t.amount,pubkey:t.destination,tlv_records:t.customRecords?Object.entries(t.customRecords).map(n=>({type:parseInt(n[0]),value:_o((new TextEncoder).encode(n[1]))})):[]}}const _l=ur;function Co(t){const n={};return t.recipient.customKey&&t.recipient.customValue&&(n[t.recipient.customKey]=t.recipient.customValue),n[7629169]=JSON.stringify(t.boostagram),{destination:t.recipient.address,amount:t.amount,custom_records:n}}class Bo{constructor(n,e){this.auth=void 0,this.defaultRequestOptions=void 0,this.auth="string"==typeof n?new Mo(n):n,this.defaultRequestOptions=me({},e,{user_agent:e?.user_agent})}accountBalance(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/balance",params:n,method:"GET"}))}accountSummary(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/user/summary",params:n,method:"GET"}))}accountInformation(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/user/me",params:n,method:"GET"}))}accountValue4Value(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/user/value4value",params:n,method:"GET"}))}incomingInvoices(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/invoices/incoming",params:n,method:"GET"}))}outgoingInvoices(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/invoices/outgoing",params:n,method:"GET"}))}invoices(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/invoices",params:n,method:"GET"}))}getInvoice(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:`/invoices/${n}`,method:"GET"}))}decodeInvoice(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:`/decode/bolt11/${n}`,method:"GET"}))}createInvoice(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/invoices",request_body:n,method:"POST"}))}keysend(n,e){let r,o;return Array.isArray(n)?(r="/payments/keysend/multi",o={keysends:n.map(s=>me({},s,{custom_records:s.customRecords}))}):(r="/payments/keysend",o=me({},n,{custom_records:n.customRecords})),dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:r,request_body:o,method:"POST"}))}sendPayment(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/payments/bolt11",request_body:n,method:"POST"}))}sendBoostagram(n,e){let r,o;return Array.isArray(n)?(r="/payments/keysend/multi",o={keysends:n.map(s=>Co(s))}):(r="/payments/keysend",o=Co(n)),dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:r,request_body:o,method:"POST"}))}sendToAlbyAccount(n,e){return console.warn("sendToAlbyAccount is deprecated. Please use sendBoostagramToAlbyAccount instead."),this.sendBoostagramToAlbyAccount(n,e)}sendBoostagramToAlbyAccount(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/payments/keysend",request_body:{destination:"030a58b8653d32b99200a2334cfe913e51dc7d155aa0116c176657a4f1722677a3",custom_records:{696969:n.account},amount:n.amount,memo:n.memo},method:"POST"}))}createWebhookEndpoint(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/webhook_endpoints",request_body:n,method:"POST"}))}deleteWebhookEndpoint(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:`/webhook_endpoints/${n}`,method:"DELETE"}))}getSwapInfo(n){return dt(me({auth:this.auth},this.defaultRequestOptions,n,{endpoint:"/swaps/info",method:"GET"}))}createSwap(n,e){return dt(me({auth:this.auth},this.defaultRequestOptions,e,{endpoint:"/swaps",method:"POST",request_body:n}))}}var fr={__proto__:null,NostrWebLNProvider:ur,NWC:_l,OauthWeblnProvider:class{constructor(t){this.client=void 0,this.auth=void 0,this.oauth=void 0,this.subscribers=void 0,this.isExecuting=void 0,this.auth=t.auth,this.client=new Bo(t.auth),this.oauth=!0,this.subscribers={},this.isExecuting=!1}on(t,n){this.subscribers[t]=n}notify(t,n){const e=this.subscribers[t];e&&e(n)}enable(){var t=this;return(0,U.A)(function*(){var n;if(!t.isExecuting){if(null!=(n=t.auth.token)&&n.access_token)return{enabled:!0};if(typeof window>"u"||void 0===window.document)throw new Error("Missing access token");try{t.isExecuting=!0,yield t.openAuthorization()}finally{t.isExecuting=!1}}})()}sendPayment(t){var n=this;return(0,U.A)(function*(){if(!n.isExecuting)try{n.isExecuting=!0;const e=yield n.client.sendPayment({invoice:t});return n.notify("sendPayment",e),{preimage:e.payment_preimage}}catch(e){let r="Unknown Error";throw e instanceof Error&&(r=e.message),new Error(r)}finally{n.isExecuting=!1}})()}keysend(t){var n=this;return(0,U.A)(function*(){if(!n.isExecuting)try{n.isExecuting=!0;const e=yield n.client.keysend(t);return n.notify("keysend",e),{preimage:e.payment_preimage}}catch(e){let r="Unknown Error";throw e instanceof Error&&(r=e.message),new Error(r)}finally{n.isExecuting=!1}})()}getInfo(){return(0,U.A)(function*(){return{alias:"Alby"}})()}makeInvoice(t){var n=this;return(0,U.A)(function*(){if(!n.isExecuting)try{n.isExecuting=!0;const e=yield n.client.createInvoice({amount:parseInt(t.amount.toString()),description:t.defaultMemo});return n.notify("makeInvoice",e),{paymentRequest:e.payment_request}}catch(e){let r="Unknown Error";throw e instanceof Error&&(r=e.message),new Error(r)}finally{n.isExecuting=!1}})()}openAuthorization(){var t=this;return(0,U.A)(function*(){var n=t;const e=window.outerHeight/2+window.screenY-350,r=window.outerWidth/2+window.screenX-300,o=yield t.auth.generateAuthURL({code_challenge_method:"S256"});return new Promise((s,c)=>{const f=window.open(o,`${document.title} - WebLN enable`,`height=700,width=600,top=${e},left=${r}`);let h=!1;window.addEventListener("message",function(){var g=(0,U.A)(function*(b){const _=b.data;if(_&&"alby:oauth:success"===_.type&&b.origin===`${document.location.protocol}//${document.location.host}`&&!h){h=!0,console.info("Processing OAuth code response");const I=_.payload.code;try{yield n.auth.requestAccessToken(I),n.client=new Bo(n.auth),f&&f.close(),n.notify("enable"),s({enabled:!0})}catch(A){console.error(A),c({enabled:!1})}}});return function(b){return g.apply(this,arguments)}}())})})()}}},i=V(4438),pi=V(5416);class xl{constructor(n,e){this._document=e;const r=this._textarea=this._document.createElement("textarea"),o=r.style;o.position="fixed",o.top=o.opacity="0",o.left="-999em",r.setAttribute("aria-hidden","true"),r.value=n,r.readOnly=!0,(this._document.fullscreenElement||this._document.body).appendChild(r)}copy(){const n=this._textarea;let e=!1;try{if(n){const r=this._document.activeElement;n.select(),n.setSelectionRange(0,n.value.length),e=this._document.execCommand("copy"),r&&r.focus()}}catch{}return e}destroy(){const n=this._textarea;n&&(n.remove(),this._textarea=void 0)}}let gi=(()=>{class t{constructor(e){this._document=e}copy(e){const r=this.beginCopy(e),o=r.copy();return r.destroy(),o}beginCopy(e){return new xl(e,this._document)}static{this.\u0275fac=function(r){return new(r||t)(i.KVO(x.qQ))}}static{this.\u0275prov=i.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function El(t,n){if(1&t){const e=i.RV6();i.j41(0,"button",10),i.bIt("click",function(){const o=i.eBV(e).$implicit,s=i.XpG(2);return i.Njj(s.invoiceAmount=o.value)}),i.j41(1,"mat-icon"),i.EFF(2),i.k0s(),i.j41(3,"span"),i.EFF(4),i.k0s()()}if(2&t){const e=n.$implicit;i.R7$(2),i.JRh(e.icon),i.R7$(2),i.JRh(e.label)}}function kl(t,n){if(1&t){const e=i.RV6();i.j41(0,"mat-dialog-content")(1,"div",4),i.DNE(2,El,5,2,"button",5),i.k0s(),i.nrm(3,"mat-divider"),i.j41(4,"mat-form-field",6)(5,"mat-label"),i.EFF(6,"Zap Amount"),i.k0s(),i.j41(7,"input",7),i.mxI("ngModelChange",function(o){i.eBV(e);const s=i.XpG();return i.DH7(s.invoiceAmount,o)||(s.invoiceAmount=o),i.Njj(o)}),i.k0s()(),i.j41(8,"mat-dialog-actions",8)(9,"button",9),i.bIt("click",function(){i.eBV(e);const o=i.XpG();return i.Njj(o.generateInvoice())}),i.EFF(10," Generate Invoice "),i.k0s()()()}if(2&t){const e=i.XpG();i.R7$(2),i.Y8G("ngForOf",e.zapButtons),i.R7$(5),i.R50("ngModel",e.invoiceAmount)}}function Ml(t,n){if(1&t){const e=i.RV6();i.j41(0,"div",12)(1,"span"),i.EFF(2),i.k0s(),i.nrm(3,"mat-divider")(4,"qrcode",13),i.j41(5,"mat-dialog-actions",14)(6,"button",15),i.bIt("click",function(){i.eBV(e);const o=i.XpG(2);return i.Njj(o.copyInvoice())}),i.nrm(7,"mat-icon",16),i.k0s()()()}if(2&t){const e=i.XpG(2);i.R7$(2),i.SpI("Scan with phone to pay (",e.invoiceAmount," sats)"),i.R7$(2),i.Y8G("qrdata",e.lightningInvoice)("matTooltip","Lightning Invoice")("errorCorrectionLevel","M"),i.R7$(2),i.Y8G("matTooltip","Copy Invoice"),i.R7$(),i.Y8G("svgIcon","heroicons_outline:clipboard-document")}}function Sl(t,n){if(1&t&&(i.j41(0,"mat-dialog-content"),i.DNE(1,Ml,8,6,"div",11),i.k0s()),2&t){const e=i.XpG();i.R7$(),i.Y8G("ngIf",e.displayQRCode)}}let Al=(()=>{class t{constructor(e,r,o){this._dialogRef=e,this._snackBar=r,this._clipboard=o,this.invoiceAmount="",this.lightningInvoice="",this.displayQRCode=!1,this.zapButtons=[{icon:"thumb_up",label:"50",value:50},{icon:"favorite",label:"100",value:100},{icon:"emoji_emotions",label:"500",value:500},{icon:"star",label:"1k",value:1e3},{icon:"celebration",label:"5k",value:5e3},{icon:"rocket",label:"10k",value:1e4},{icon:"local_fire_department",label:"100k",value:1e5},{icon:"flash_on",label:"500k",value:5e5},{icon:"diamond",label:"1M",value:1e6}]}generateInvoice(){var e=this;return(0,U.A)(function*(){if(!e.invoiceAmount||Number(e.invoiceAmount)<=0)e.openSnackBar("Please enter a valid amount","dismiss");else try{e.nwc=new fr.NostrWebLNProvider({nostrWalletConnectUrl:yield e.loadNWCUrl()}),yield e.nwc.enable();const r=yield e.nwc.makeInvoice({amount:Number(e.invoiceAmount)});e.lightningInvoice=r.paymentRequest,e.showQRCode()}catch(r){console.error("Error generating invoice:",r),e.openSnackBar("Failed to generate invoice","dismiss")}})()}loadNWCUrl(){return(0,U.A)(function*(){try{const e=fr.NostrWebLNProvider.withNewSecret();return yield e.initNWC({name:"Angor Hub"}),e.getNostrWalletConnectUrl()}catch(e){throw console.error("Error initializing NWC:",e),new Error("Failed to initialize NWC provider")}})()}showQRCode(){this.displayQRCode=!this.displayQRCode}copyInvoice(){this.lightningInvoice?(this._clipboard.copy(this.lightningInvoice),this.openSnackBar("Invoice copied","dismiss")):this.openSnackBar("No invoice available to copy","dismiss")}openSnackBar(e,r){this._snackBar.open(e,r,{duration:1300})}closeDialog(){this._dialogRef.close()}static{this.\u0275fac=function(r){return new(r||t)(i.rXU(ft.CP),i.rXU(pi.UG),i.rXU(gi))}}static{this.\u0275cmp=i.VBU({type:t,selectors:[["app-receive-dialog"]],standalone:!0,features:[i.aNF],decls:7,vars:4,consts:[[1,"absolute","right-0","top-0","pr-4","pt-4"],["mat-icon-button","",3,"matDialogClose"],[1,"text-secondary",3,"svgIcon"],[4,"ngIf"],[1,"preset-buttons"],["mat-mini-fab","","color","primary",3,"click",4,"ngFor","ngForOf"],["appearance","outline",1,"sats-input"],["matInput","","placeholder","e.g., 100","type","number",3,"ngModelChange","ngModel"],["align","end"],["mat-raised-button","","color","primary",3,"click"],["mat-mini-fab","","color","primary",3,"click"],["class","qrcode",4,"ngIf"],[1,"qrcode"],[1,"qrcode-image",3,"qrdata","matTooltip","errorCorrectionLevel"],["align","center"],["mat-icon-button","",3,"click","matTooltip"],[3,"svgIcon"]],template:function(r,o){1&r&&(i.j41(0,"div",0)(1,"button",1),i.nrm(2,"mat-icon",2),i.k0s()(),i.j41(3,"h2"),i.EFF(4,"\u26a1 Receive Zap"),i.k0s(),i.DNE(5,kl,11,2,"mat-dialog-content",3)(6,Sl,2,1,"mat-dialog-content",3)),2&r&&(i.R7$(),i.Y8G("matDialogClose",void 0),i.R7$(),i.Y8G("svgIcon","heroicons_outline:x-mark"),i.R7$(3),i.Y8G("ngIf",!o.displayQRCode),i.R7$(),i.Y8G("ngIf",o.displayQRCode))},dependencies:[Nt.vg,ne.Hl,ne.$z,ne.iY,ne.$0,Ue.m_,Ue.An,oe.YN,oe.me,oe.Q0,oe.BC,oe.vS,re.nJ,re.rl,oe.X1,x.MD,x.Sq,x.bT,Ut.Ve,re.RG,Ae.fS,Ae.fg,ft.Yi,ft.E7,de.f,de.c,ae.q,K.oV,ft.tx],styles:[".preset-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;justify-items:center;margin-bottom:20px}.preset-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px;font-weight:700;width:70px;height:60px;display:flex;flex-direction:column;align-items:center;justify-content:center;max-height:60px!important}.sats-input[_ngcontent-%COMP%]{margin-top:20px;width:100%}.lightning-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;margin:10px 0}.qrcode[_ngcontent-%COMP%]{text-align:center}.qrcode-image[_ngcontent-%COMP%]{width:100%!important}"]})}}return t})();for(var Uo=V(1146),Il=V(3838),Yt=V(917),No={bech32:"bc",pubKeyHash:0,scriptHash:5,validWitnessVersions:[0]},Po={bech32:"tb",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},$o={bech32:"tbs",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},jo={bech32:"bcrt",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},Oo={bech32:"sb",pubKeyHash:63,scriptHash:123,validWitnessVersions:[0]},Gn=["option_data_loss_protect","initial_routing_sync","option_upfront_shutdown_script","gossip_queries","var_onion_optin","gossip_queries_ex","option_static_remotekey","payment_secret","basic_mpp","option_support_large_channel"],Rl={m:new Yt.BN(1e3,10),u:new Yt.BN(1e6,10),n:new Yt.BN(1e9,10),p:new Yt.BN(1e12,10)},Tl=new Yt.BN("2100000000000000000",10),Lo=new Yt.BN(1e11,10),mi={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27},Fo={},hr=0,vi=Object.keys(mi);hr<vi.length;hr++){var Cl=vi[hr],Bl=mi[vi[hr]].toString();Fo[Bl]=Cl}var Ul={1:function(t){return Qt(t,!0)},16:function(t){return Qt(t,!0)},13:function(t){return Qt(t,!0).toString("utf8")},19:function(t){return Qt(t,!0)},23:function(t){return Qt(t,!0)},27:function(t){return Qt(t,!0)},6:dr,24:dr,3:function $l(t){for(var e,r,o,s,c,n=[],f=Qt(t,!0);f.length>0;)e=f.slice(0,33).toString("hex"),r=f.slice(33,41).toString("hex"),o=parseInt(f.slice(41,45).toString("hex"),16),s=parseInt(f.slice(45,49).toString("hex"),16),c=parseInt(f.slice(49,51).toString("hex"),16),f=f.slice(51),n.push({pubkey:e,short_channel_id:r,fee_base_msat:o,fee_proportional_millionths:s,cltv_expiry_delta:c});return n},5:function jl(t){for(var n=t.slice().reverse().map(function(o){return[!!(1&o),!!(2&o),!!(4&o),!!(8&o),!!(16&o)]}).reduce(function(o,s){return o.concat(s)},[]);n.length<2*Gn.length;)n.push(!1);var e={extra_bits:{}};if(Gn.forEach(function(o,s){var c;n[2*s]?c="required":n[2*s+1]&&(c="supported"),e[o]=c}),n.length>2*Gn.length){var r=n.slice(2*Gn.length);e.extra_bits={start_bit:2*Gn.length,bits:r,required:r.reduce(function(o,s,c){return c%2!=0?o||!1:o||s},!1)}}return e}};function Nl(t){return function(n){return{tagCode:parseInt(t),words:Uo.encode("unknown",n,Number.MAX_SAFE_INTEGER)}}}function dr(t){return t.reverse().reduce(function(n,e,r){return n+e*Math.pow(32,r)},0)}function Qt(t,n){var e=Il.hp.from(function Pl(t,n,e){for(var r=0,o=0,s=(1<<e)-1,c=[],f=0;f<t.length;++f)for(r=r<<n|t[f],o+=n;o>=e;)c.push(r>>(o-=e)&s);return o>0&&c.push(r<<e-o&s),c}(t,5,8));return n&&5*t.length%8!=0&&(e=e.slice(0,-1)),e}var yi=V(7673),wi=V(9437),Fl=V(1626);let Go=(()=>{class t{constructor(e){this.http=e}getLightning(e){return this.http.get(e).pipe((0,wi.W)(r=>(console.error("Failed to fetch Lightning response:",r),(0,yi.of)({status:"Failed"}))))}getLightningInvoice(e,r){return this.http.get(`${e}?amount=${r}`).pipe((0,wi.W)(s=>(console.error("Failed to fetch Lightning invoice:",s),(0,yi.of)({pr:"",status:"Failed"}))))}getLightningAddress(e){try{const[r,o]=e.split("@");return`https://${o}/.well-known/lnurlp/${r}`}catch{return console.error("Invalid Lightning address format:",e),""}}sendZapRequest(e,r,o,s){const c=encodeURIComponent(JSON.stringify(r));return this.http.get(`${e}?amount=${o}&nostr=${c}&lnurl=${s}`).pipe((0,wi.W)(h=>(console.error("Failed to send zap request:",h),(0,yi.of)({pr:"",status:"Failed"}))))}login(){return(0,U.A)(function*(){try{return window.webln&&!window.webln.isEnabled()&&(yield window.webln.enable()),!0}catch(e){return console.error("WebLN login failed:",e),!1}})()}hasWebln(){return!!window.webln}sendPayment(e){var r=this;return(0,U.A)(function*(){try{return r.hasWebln()?yield window.webln.sendPayment(e):(console.error("WebLN is not available"),null)}catch(o){throw console.error("Payment failed:",o),o}})()}payInvoice(e){var r=this;return(0,U.A)(function*(){if((yield r.login())&&r.hasWebln())try{return!!(yield r.sendPayment(e))}catch(s){return console.error("Failed to pay invoice:",s),!1}return console.error("WebLN not available or login failed"),!1})()}static{this.\u0275fac=function(r){return new(r||t)(i.KVO(Fl.Qq))}}static{this.\u0275prov=i.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Gl(t,n){if(1&t){const e=i.RV6();i.j41(0,"button",10),i.bIt("click",function(){const o=i.eBV(e).$implicit,s=i.XpG(2);return i.Njj(s.sats=o.value)}),i.j41(1,"mat-icon"),i.EFF(2),i.k0s(),i.j41(3,"span"),i.EFF(4),i.k0s()()}if(2&t){const e=n.$implicit;i.R7$(2),i.JRh(e.icon),i.R7$(2),i.JRh(e.label)}}function ql(t,n){if(1&t){const e=i.RV6();i.j41(0,"mat-dialog-content")(1,"div",4),i.DNE(2,Gl,5,2,"button",5),i.k0s(),i.nrm(3,"mat-divider"),i.j41(4,"mat-form-field",6)(5,"mat-label"),i.EFF(6,"Zap Amount"),i.k0s(),i.j41(7,"input",7),i.mxI("ngModelChange",function(o){i.eBV(e);const s=i.XpG();return i.DH7(s.sats,o)||(s.sats=o),i.Njj(o)}),i.k0s()(),i.j41(8,"mat-dialog-actions",8)(9,"button",9),i.bIt("click",function(){i.eBV(e);const o=i.XpG();return i.Njj(o.sendZap())}),i.EFF(10," Create invoice "),i.k0s()()()}if(2&t){const e=i.XpG();i.R7$(2),i.Y8G("ngForOf",e.zapButtons),i.R7$(5),i.R50("ngModel",e.sats)}}function Dl(t,n){if(1&t&&(i.j41(0,"div",16)(1,"span"),i.EFF(2),i.k0s(),i.nrm(3,"mat-divider")(4,"qrcode",17),i.k0s()),2&t){const e=i.XpG(2);i.R7$(2),i.SpI("Scan with phone to pay (",e.invoiceAmount," sats)"),i.R7$(2),i.Y8G("qrdata",e.lightningInvoice)("matTooltip","Lightning Invoice")("errorCorrectionLevel","M")}}function Wl(t,n){if(1&t){const e=i.RV6();i.j41(0,"mat-dialog-content"),i.DNE(1,Dl,5,4,"div",11),i.j41(2,"mat-dialog-actions",12)(3,"button",13),i.bIt("click",function(){i.eBV(e);const o=i.XpG();return i.Njj(o.copyInvoice())}),i.nrm(4,"mat-icon",14),i.k0s(),i.j41(5,"button",13),i.bIt("click",function(){i.eBV(e);const o=i.XpG();return i.Njj(o.payInvoice())}),i.nrm(6,"mat-icon",15),i.k0s()()()}if(2&t){const e=i.XpG();i.R7$(),i.Y8G("ngIf",e.displayQRCode),i.R7$(2),i.Y8G("matTooltip","Copy Invoice"),i.R7$(),i.Y8G("svgIcon","heroicons_outline:clipboard-document"),i.R7$(),i.Y8G("matTooltip","Pay Invoice"),i.R7$(),i.Y8G("svgIcon","feather:zap")}}let Vl=(()=>{class t{constructor(e,r,o,s,c){this._dialogRef=e,this._metadata=r,this._lightning=o,this._snackBar=s,this._clipboard=c,this.lightningInvoice="",this.showInvoiceSection=!1,this.displayQRCode=!1,this.invoiceAmount="?",this.zapButtons=[{icon:"thumb_up",label:"50",value:50},{icon:"favorite",label:"100",value:100},{icon:"emoji_emotions",label:"500",value:500},{icon:"star",label:"1k",value:1e3},{icon:"celebration",label:"5k",value:5e3},{icon:"rocket",label:"10k",value:1e4},{icon:"local_fire_department",label:"100k",value:1e5},{icon:"flash_on",label:"500k",value:5e5},{icon:"diamond",label:"1M",value:1e6}],this.getLightningInfo()}getLightningInfo(){let e="";if(this._metadata?.lud06){const{words:r}=he.I.decode(this._metadata.lud06,5e3),o=new Uint8Array(he.I.fromWords(r));e=(new TextDecoder).decode(Uint8Array.from(o))}else if(this._metadata?.lud16?.toLowerCase().startsWith("lnurl")){const{words:r}=he.I.decode(this._metadata.lud16,5e3),o=new Uint8Array(he.I.fromWords(r));e=(new TextDecoder).decode(Uint8Array.from(o))}else this._metadata?.lud16&&(e=this._lightning.getLightningAddress(this._metadata.lud16));""!==e?this._lightning.getLightning(e).subscribe(r=>{this.lightningResponse=r,"Failed"===this.lightningResponse.status?this.openSnackBar("Failed to lookup lightning address","dismiss"):this.lightningResponse.callback?this.showInvoiceSection=!0:this.openSnackBar("Couldn't find user's lightning address","dismiss")}):this.openSnackBar("No lightning address found","dismiss")}getLightningInvoice(e){var r=this;this.lightningResponse&&this.lightningResponse.callback&&this._lightning.getLightningInvoice(this.lightningResponse.callback,e).subscribe(function(){var o=(0,U.A)(function*(s){r.lightningInvoice=s.pr,r.setInvoiceAmount(r.lightningInvoice),r.showInvoiceSection=!0,r.showQRCode()});return function(s){return o.apply(this,arguments)}}())}setInvoiceAmount(e){if(e){const o=function Ll(t,n){if("string"!=typeof t)throw new Error("Lightning Payment Request must be string");if("ln"!==t.slice(0,2).toLowerCase())throw new Error("Not a proper lightning payment request");var e=[],r=Uo.decode(t,Number.MAX_SAFE_INTEGER);t=t.toLowerCase();var o=r.prefix,s=r.words,c=t.slice(o.length+1),f=s.slice(-104);s=s.slice(0,-104);var h=o.match(/^ln(\S+?)(\d*)([a-zA-Z]?)$/);if(h&&!h[2]&&(h=o.match(/^ln(\S+)$/)),!h)throw new Error("Not a proper lightning payment request");e.push({name:"lightning_network",letters:"ln"});var b,g=h[1];if(n){if(void 0===n.bech32||void 0===n.pubKeyHash||void 0===n.scriptHash||!Array.isArray(n.validWitnessVersions))throw new Error("Invalid network");b=n}else switch(g){case No.bech32:b=No;break;case Po.bech32:b=Po;break;case $o.bech32:b=$o;break;case jo.bech32:b=jo;break;case Oo.bech32:b=Oo}if(!b||b.bech32!==g)throw new Error("Unknown coin bech32 prefix");e.push({name:"coin_network",letters:g,value:b});var I,_=h[2];_?(I=function Ol(t,n){var e,r;if(t.slice(-1).match(/^[munp]$/))e=t.slice(-1),r=t.slice(0,-1);else{if(t.slice(-1).match(/^[^munp0-9]$/))throw new Error("Not a valid multiplier for the amount");r=t}if(!r.match(/^\d+$/))throw new Error("Not a valid human readable amount");var o=new Yt.BN(r,10),s=e?o.mul(Lo).div(Rl[e]):o.mul(Lo);if("p"===e&&!o.mod(new Yt.BN(10,10)).eq(new Yt.BN(0,10))||s.gt(Tl))throw new Error("Amount is outside of valid range");return n?s.toString():s}(_+h[3],!0),e.push({name:"amount",letters:h[2]+h[3],value:I})):I=null,e.push({name:"separator",letters:"1"});var k,R,T,N,S=dr(s.slice(0,7));for(s=s.slice(7),e.push({name:"timestamp",letters:c.slice(0,7),value:S}),c=c.slice(7);s.length>0;){var O=s[0].toString();k=Fo[O]||"unknown_tag",R=Ul[O]||Nl(O),T=dr((s=s.slice(1)).slice(0,2)),N=(s=s.slice(2)).slice(0,T),s=s.slice(T),e.push({name:k,tag:c[0],letters:c.slice(0,3+T),value:R(N)}),c=c.slice(3+T)}e.push({name:"signature",letters:c.slice(0,104),value:Qt(f,!0)}),c=c.slice(104),e.push({name:"checksum",letters:c});var P={paymentRequest:t,sections:e,get expiry(){var F=e.find(function(L){return"expiry"===L.name});if(F)return $("timestamp")+F.value},get route_hints(){return e.filter(function(F){return"route_hint"===F.name}).map(function(F){return F.value})}},G=function(F){if("route_hint"===F)return"continue";Object.defineProperty(P,F,{get:function(){return $(F)}})};for(var C in mi)G(C);return P;function $(F){var L=e.find(function(X){return X.name===F});return L?L.value:void 0}}(e).sections.find(s=>"amount"===s.name);o&&(this.invoiceAmount=String(Number(o.value)/1e3))}}showQRCode(){this.displayQRCode=!this.displayQRCode}sendZap(){this.getLightningInvoice(String(1e3*Number(this.sats)))}payInvoice(){var e=this;return(0,U.A)(function*(){if(!e.lightningInvoice)return void console.error("Lightning invoice is not set");const r=new fr.NostrWebLNProvider({nostrWalletConnectUrl:yield e.loadNWCUrl()});r.enable().then(()=>r.sendPayment(e.lightningInvoice)).then(o=>{o&&o.preimage?(console.log(`Payment successful, preimage: ${o.preimage}`),e.openSnackBar("Zapped!","dismiss"),e._dialogRef.close()):e.listenForPaymentStatus(r)}).catch(o=>{console.error("Payment failed:",o),e.openSnackBar("Failed to pay invoice","dismiss"),e.listenForPaymentStatus(r)})})()}loadNWCUrl(){const e=fr.NostrWebLNProvider.withNewSecret();return e.initNWC({name:"Angor Hub"}).then(()=>e.getNostrWalletConnectUrl()).catch(r=>{throw console.error("Error initializing NWC:",r),r})}listenForPaymentStatus(e){const r=()=>{e.sendPayment(this.lightningInvoice).then(o=>{o&&o.preimage?(console.log("Payment confirmed, preimage:",o.preimage),this.openSnackBar("Payment confirmed!","dismiss"),this._dialogRef.close()):setTimeout(r,5e3)}).catch(o=>{console.error("Error checking payment status:",o),setTimeout(r,5e3)})};r()}copyInvoice(){this.lightningInvoice?(this._clipboard.copy(this.lightningInvoice),this.openSnackBar("Invoice copied","dismiss")):this.openSnackBar("No invoice available to copy","dismiss")}openSnackBar(e,r){this._snackBar.open(e,r,{duration:1300})}closeDialog(){this._dialogRef.close()}static{this.\u0275fac=function(r){return new(r||t)(i.rXU(ft.CP),i.rXU(ft.Vh),i.rXU(Go),i.rXU(pi.UG),i.rXU(gi))}}static{this.\u0275cmp=i.VBU({type:t,selectors:[["app-send-dialog"]],standalone:!0,features:[i.aNF],decls:7,vars:4,consts:[[1,"absolute","right-0","top-0","pr-4","pt-4"],["mat-icon-button","",3,"matDialogClose"],[1,"text-secondary",3,"svgIcon"],[4,"ngIf"],[1,"preset-buttons"],["mat-mini-fab","","color","primary",3,"click",4,"ngFor","ngForOf"],["appearance","outline",1,"sats-input"],["matInput","","placeholder","e.g., 100","type","number",3,"ngModelChange","ngModel"],["align","end"],["mat-raised-button","","color","primary",3,"click"],["mat-mini-fab","","color","primary",3,"click"],["class","qrcode",4,"ngIf"],["align","center"],["mat-icon-button","",3,"click","matTooltip"],[3,"svgIcon"],["color","#f79318",3,"svgIcon"],[1,"qrcode"],[1,"qrcode-image",3,"qrdata","matTooltip","errorCorrectionLevel"]],template:function(r,o){1&r&&(i.j41(0,"div",0)(1,"button",1),i.nrm(2,"mat-icon",2),i.k0s()(),i.j41(3,"h1"),i.EFF(4,"\u26a1 Send Zap"),i.k0s(),i.DNE(5,ql,11,2,"mat-dialog-content",3)(6,Wl,7,5,"mat-dialog-content",3)),2&r&&(i.R7$(),i.Y8G("matDialogClose",void 0),i.R7$(),i.Y8G("svgIcon","heroicons_outline:x-mark"),i.R7$(3),i.Y8G("ngIf",!o.showInvoiceSection||!o.lightningInvoice),i.R7$(),i.Y8G("ngIf",o.showInvoiceSection&&o.lightningInvoice))},dependencies:[Nt.vg,ne.Hl,ne.$z,ne.iY,ne.$0,Ue.m_,Ue.An,oe.YN,oe.me,oe.Q0,oe.BC,oe.vS,re.nJ,re.rl,oe.X1,x.MD,x.Sq,x.bT,Ut.Ve,re.RG,Ae.fS,Ae.fg,ft.Yi,ft.E7,de.f,de.c,ae.q,K.oV,ft.tx],styles:[".preset-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;justify-items:center;margin-bottom:20px}.preset-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:14px;font-weight:700;width:70px;height:60px;display:flex;flex-direction:column;align-items:center;justify-content:center;max-height:60px!important}.sats-input[_ngcontent-%COMP%]{margin-top:20px;width:100%}.lightning-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;margin:10px 0}.qrcode[_ngcontent-%COMP%]{text-align:center}.qrcode-image[_ngcontent-%COMP%]{width:100%!important}"]})}}return t})();var zl=V(9454),Yl=V(8703),bi=V(4930),Hl=V(7291),Zl=V(345),qo=V(6231),Do=V(7343);let Xl=(()=>{class t{constructor(e,r,o){this.relayService=e,this.signerService=r,this.queueService=o,this.followersSubject=new ut.B,this.followingSubject=new ut.B}getFollowersObservable(){return this.followersSubject.asObservable()}getFollowingObservable(){return this.followingSubject.asObservable()}getFollowers(e){var r=this;return(0,U.A)(function*(){const o=[{kinds:[3],"#p":[e]}],s=[];return new Promise((c,f)=>{r.queueService.addRequestToQueue(o).subscribe({next:g=>{s.push(g),r.followersSubject.next(g)},error:g=>{console.error("Error fetching followers:",g),f(g)},complete:()=>{c(s)}})})})()}getFollowing(e){var r=this;return(0,U.A)(function*(){const o=[{kinds:[3],authors:[e]}],s=[];return new Promise((c,f)=>{r.queueService.addRequestToQueue(o).subscribe({next:g=>{g.tags.filter(_=>"p"===_[0]).forEach(_=>{s.push(_[1]),r.followingSubject.next(g)})},error:g=>{console.error("Error fetching following:",g),f(g)},complete:()=>{c(s)}})})})()}follow(e){var r=this;return(0,U.A)(function*(){const o=r.getFollowingList();if(o.includes(e))return void console.log(`Already following ${e}`);const s=[...o,e];r.setFollowingList(s);const c=r.signerService.getUnsignedEvent(3,s.map(f=>["p",f]),"");yield r.publishSignedEvent(c),console.log(`Now following ${e}`)})()}unfollow(e){var r=this;return(0,U.A)(function*(){const o=r.getFollowingList();if(!o.includes(e))return void console.log(`Not following ${e}`);const s=o.filter(f=>f!==e);r.setFollowingList(s);const c=r.signerService.getUnsignedEvent(3,s.map(f=>["p",f]),"");yield r.publishSignedEvent(c),console.log(`Unfollowed ${e}`)})()}publishSignedEvent(e){var r=this;return(0,U.A)(function*(){let s;if(yield r.signerService.isUsingExtension())s=yield r.signerService.signEventWithExtension(e);else{const c=yield r.signerService.getDecryptedSecretKey();if(!c)throw new Error("Secret key is missing. Unable to sign event.");s=r.signerService.getSignedEvent(e,c)}r.relayService.publishEventToWriteRelays(s)})()}getFollowingListAsTags(){const e=this.getFollowingList(),r=[],o=this.relayService.getConnectedRelays();return e.forEach(s=>{o.forEach(c=>{r.push(["p",s,c,localStorage.getItem(`${s}`)||""])})}),r}setFollowingListFromTags(e){const r=[];e.forEach(o=>{r.push(o[1])}),this.setFollowingList(r)}setFollowingList(e){const o=Array.from(new Set(e)).filter(s=>s).join(",");localStorage.setItem("following",o)}getFollowingList(){const e=localStorage.getItem("following");return null===e||""===e?[]:e.split(",").filter(o=>/[a-f0-9]{64}/.test(o))}static{this.\u0275fac=function(r){return new(r||t)(i.KVO(qo.b),i.KVO(bi.A),i.KVO(Do.F))}}static{this.\u0275prov=i.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Kl=V(881),Jl=V(9979),pr=V(5766);class Ql{constructor(n,e,r,o,s,c,f=[]){this.username="",this.picture="/images/avatars/avatar-placeholder.png",this.replyCount=0,this.likeCount=0,this.zapCount=0,this.repostCount=0,this.likedByMe=!1,this.replies=[],this.likers=[],this.reposters=[],this.zappers=[],this.relatedEventIds=[],this.rootEventId="",this.replyToEventId="",this.mentions=[],this.hashtags=[],this.repostedByMe=!1,this.tags=[],this.isAReply=!1,this.kind=e,this.pubkey=r,this.content=o,this.noteId=s,this.createdAt=c,this.date=new Date(1e3*this.createdAt),this.fromNow=this.calculateTimeFromNow(this.date),this.tags=f,this.id=n}calculateTimeFromNow(n){const r=Math.floor(((new Date).getTime()-n.getTime())/1e3);return r<60?`${r} seconds ago`:r<3600?`${Math.floor(r/60)} minutes ago`:r<86400?`${Math.floor(r/3600)} hours ago`:r<2592e3?`${Math.floor(r/86400)} days ago`:r<31536e3?`${Math.floor(r/2592e3)} months ago`:`${Math.floor(r/31536e3)} years ago`}}var gr=V(719),_i=V(4412),ec=V(3386),tc=V(2827);let nc=(()=>{class t{constructor(e,r,o,s){this.relayService=e,this.signerService=r,this.metadataService=o,this.queueService=s,this.eventsSubject=new _i.t([]),this.isLoading=new _i.t(!1),this.lastLoadedEventTime=null,this.pageSize=10,this.noMoreEvents=new _i.t(!1),this.seenEventIds=new Set,this.likesMap=new Map,this.repliesMap=new Map,this.zapsMap=new Map,this.repostsMap=new Map,this.hasLikedMap=new Map,this.hasRepostedMap=new Map,this.jobQueue=[],this.isProcessingQueue=!1,this.myLikedNoteIds=[]}subscribeToEvents(e){var r=this;return(0,U.A)(function*(){yield r.relayService.ensureConnectedRelays();const o=r.relayService.getConnectedRelays().slice(0,3);if(!o||0===o.length)return void console.error("No connected relays available.");const s=[{kinds:[1],authors:e,limit:r.pageSize},{"#p":e,limit:1}];r.relayService.getPool().subscribeMany(o,s,{onevent:f=>{r.isReply(f)||r.handleNewOrUpdatedEvent(f);const h=r.getParentEventId(f);switch(h&&r.enqueueJob(h),f.kind){case 7:case 9735:case 6:r.enqueueJob(h)}},oneose:()=>{}})})()}getParentEventId(e){const r=e.tags.find(o=>"e"===o[0]);return r?r[1]:null}handleNewOrUpdatedEvent(e){var r=this;return(0,U.A)(function*(){switch(e.kind){case 1:if(!r.seenEventIds.has(e.id)){r.seenEventIds.add(e.id);const o=yield r.createNewEvent(e);r.eventsSubject.next([o]),r.updateEventInSubject(e.id)}break;case 7:r.handleLikeEvent(e);break;case 9735:r.handleZapEvent(e);break;case 6:r.handleRepostEvent(e);break;case 4:r.handleReplyEvent(e)}})()}handleLikeEvent(e){const r=e.tags.find(o=>"e"===o[0])?.[1];if(r){const s=this.eventsSubject.getValue().find(c=>c.id===r);s&&(s.likeCount+=1,s.likers=[...s.likers||[],e.pubkey],this.eventsSubject.next([s]))}}handleZapEvent(e){const r=e.tags.find(o=>"e"===o[0])?.[1];if(r){const s=this.eventsSubject.getValue().find(c=>c.id===r);s&&(s.zapCount+=1,s.zappers=[...s.zappers||[],e.pubkey],this.eventsSubject.next([s]))}}handleRepostEvent(e){const r=e.tags.find(o=>"e"===o[0])?.[1];if(r){const s=this.eventsSubject.getValue().find(c=>c.id===r);s&&(s.repostCount+=1,s.reposters=[...s.reposters||[],e.pubkey],this.eventsSubject.next([s]))}}handleReplyEvent(e){var r=this;return(0,U.A)(function*(){const o=e.tags.find(s=>"e"===s[0])?.[1];if(o){const s=yield r.createNewEvent(e),f=r.eventsSubject.getValue().find(h=>h.id===o);f&&(f.replyCount+=1,f.replies=[...f.replies||[],s],r.eventsSubject.next([f]))}})()}isReply(e){return e.tags.filter(o=>"e"===o[0]||"p"===o[0]).length>0}getMyLikes(){var e=this;return(0,U.A)(function*(){const r={kinds:[7],authors:[e.signerService.getPublicKey()]};try{return(yield e.fetchFilteredEvents(r)).forEach(s=>{const c=s.tags.find(f=>"e"===f[0]);c&&e.myLikedNoteIds.push(c[1])}),e.myLikedNoteIds}catch(o){return console.error("Failed to get user likes:",o),[]}})()}loadMoreEvents(e){var r=this;return(0,U.A)(function*(){if(r.isLoading.value||r.noMoreEvents.value)return;r.isLoading.next(!0);const o={authors:e,kinds:[1],until:r.lastLoadedEventTime||Math.floor(Date.now()/1e3),limit:r.pageSize};try{const s=yield r.fetchFilteredEvents(o);if(s.length<r.pageSize&&r.noMoreEvents.next(!0),s.length>0){r.lastLoadedEventTime=s[s.length-1].created_at;const c=s.filter(h=>!r.seenEventIds.has(h.id)&&!r.isReply(h));c.forEach(h=>r.seenEventIds.add(h.id));const f=yield Promise.all(c.map(h=>r.createNewEvent(h)));r.eventsSubject.next([...r.eventsSubject.getValue(),...f].sort((h,g)=>g.createdAt-h.createdAt))}else r.noMoreEvents.next(!0)}catch(s){console.error("Error loading more events:",s)}finally{r.isLoading.next(!1)}})()}fetchFilteredEvents(e){var r=this;return(0,U.A)(function*(){return new Promise((o,s)=>{const c=new Map,f=[];r.queueService.addRequestToQueue([e]).subscribe({next:h=>{c.has(h.id)||(c.set(h.id,h),f.push(h))},error:h=>{console.error("Error fetching events:",h),s(h)},complete:()=>{console.log("All events fetched and completed"),o(f)}})})})()}createNewEvent(e){var r=this;return(0,U.A)(function*(){const o=new Ql(e.id,e.kind,e.pubkey,e.content,e.id,e.created_at,e.tags);r.enqueueJob(e.id),yield r.processJobQueue(),o.likedByMe=r.myLikedNoteIds.includes(e.id);const s=yield r.metadataService.fetchMetadataWithCache(e.pubkey);return s&&(o.username=s.name||o.npub,o.picture=s.picture||"/images/avatars/avatar-placeholder.png"),o})()}enqueueJob(e){this.jobQueue.some(r=>r.eventId===e)||(this.jobQueue.push({eventId:e}),this.isProcessingQueue||this.processJobQueue())}processJobQueue(){var e=this;return(0,U.A)(function*(){if(e.isProcessingQueue)return;e.isProcessingQueue=!0;const r=[];for(;e.jobQueue.length>0||r.length>0;){for(;e.jobQueue.length>0&&r.length<10;){const o=e.jobQueue.shift();if(!o)break;yield e.delay(1e3);const s=e.processJobWithQueueService(o);r.push(s),s.then(()=>{r.splice(r.indexOf(s),1)}).catch(c=>{console.error("Error processing job:",c),r.splice(r.indexOf(s),1)})}yield Promise.race(r)}e.isProcessingQueue=!1})()}processJobWithQueueService(e){var r=this;return(0,U.A)(function*(){try{const o=yield r.fetchMultiFilterEvents(e.eventId);r.repliesMap.set(e.eventId,o.replies),r.likesMap.set(e.eventId,o.likers),r.zapsMap.set(e.eventId,o.zappers),r.repostsMap.set(e.eventId,o.reposters),r.updateEventInSubject(e.eventId)}catch(o){throw console.error("Error processing job with QueueService:",o),o}})()}delay(e){return new Promise(r=>setTimeout(r,e))}updateEventInSubject(e){const o=this.eventsSubject.getValue().map(s=>(s.id===e&&(s.replyCount=this.getRepliesCount(e),s.replies=this.repliesMap.get(e)||[],s.likeCount=this.getLikesCount(e),s.likers=this.likesMap.get(e)||[],s.zapCount=this.getZapsCount(e),s.zappers=this.zapsMap.get(e)||[],s.repostCount=this.getRepostsCount(e),s.reposters=this.repostsMap.get(e)||[]),s));this.eventsSubject.next(o)}fetchMultiFilterEvents(e){var r=this;return(0,U.A)(function*(){const o=[{"#e":[e],kinds:[1]},{"#e":[e],kinds:[7]},{"#e":[e],kinds:[9735]},{"#e":[e],kinds:[6]}],s=new Map,c=[],f=[],h=[],g=[],b=r.queueService.addRequestToQueue(o);return new Promise((_,I)=>{var A;b.subscribe({next:(A=(0,U.A)(function*(S){if(s.has(S.id)||s.set(S.id,S),1===S.kind){const k=yield r.createNewEvent(S);c.push(k)}else 7===S.kind?f.push(S.pubkey):9735===S.kind?h.push(S.pubkey):6===S.kind&&g.push(S.pubkey)}),function(k){return A.apply(this,arguments)}),error:A=>{console.error("Error fetching events:",A),I(A)},complete:()=>{_({replies:c,likers:f,zappers:h,reposters:g})}})})})()}getRepliesCount(e){return(this.repliesMap.get(e)||[]).length}getLikesCount(e){return(this.likesMap.get(e)||[]).length}getZapsCount(e){return(this.zapsMap.get(e)||[]).length}getRepostsCount(e){return(this.repostsMap.get(e)||[]).length}hasUserLiked(e){return this.hasLikedMap.get(e)||!1}hasUserReposted(e){return this.hasRepostedMap.get(e)||!1}getEventStream(){return this.eventsSubject.asObservable().pipe((0,ec.c)(1e3))}hasMoreEvents(){return this.noMoreEvents.asObservable()}sendTextEvent(e){var r=this;return(0,U.A)(function*(){if(e)try{const s=r.signerService.getUnsignedEvent(1,[],e);let c;if(r.signerService.isUsingSecretKey()){const f=yield r.signerService.getDecryptedSecretKey(),h=(0,pr.aT)(f);c=(0,gr.pC)(s,h)}else c=yield r.signerService.signEventWithExtension(s);yield r.relayService.publishEventToWriteRelays(c)}catch(o){console.error("Failed to send text event:",o)}})()}sendLikeEvent(e){var r=this;return(0,U.A)(function*(){if(e)try{const c=r.signerService.getUnsignedEvent(7,[["e",e.id],["p",e.pubkey]],"+");let f;if(r.signerService.isUsingSecretKey()){const h=yield r.signerService.getDecryptedSecretKey(),g=(0,pr.aT)(h);f=(0,gr.pC)(c,g)}else f=yield r.signerService.signEventWithExtension(c);yield r.relayService.publishEventToWriteRelays(f),r.likesMap.set(e.id,[...r.likesMap.get(e.id)||[],r.signerService.getPublicKey()]),r.hasLikedMap.set(e.id,!0)}catch(o){console.error("Failed to send like event:",o)}})()}sendZapEvent(e,r){var o=this;return(0,U.A)(function*(){if(e&&!(r<=0))try{const s=[["e",e.id],["p",e.pubkey],["amount",r.toString()]],f=o.signerService.getUnsignedEvent(9735,s,`Zapped with ${r} sats`);let h;if(o.signerService.isUsingSecretKey()){const g=yield o.signerService.getDecryptedSecretKey(),b=(0,pr.aT)(g);h=(0,gr.pC)(f,b)}else h=yield o.signerService.signEventWithExtension(f);yield o.relayService.publishEventToWriteRelays(h)}catch(s){console.error("Failed to send zap event:",s)}})()}sendReplyEvent(e,r){var o=this;return(0,U.A)(function*(){if(e)try{const c=o.signerService.getUnsignedEvent(1,[["e",e.id],["p",e.pubkey]],r);let f;if(o.signerService.isUsingSecretKey()){const h=yield o.signerService.getDecryptedSecretKey(),g=(0,pr.aT)(h);f=(0,gr.pC)(c,g)}else f=yield o.signerService.signEventWithExtension(c);yield o.relayService.publishEventToWriteRelays(f)}catch(s){console.error("Failed to send reply event:",s)}})()}clearEvents(){this.eventsSubject.next([]),this.seenEventIds.clear(),this.lastLoadedEventTime=null,this.noMoreEvents.next(!1)}static{this.\u0275fac=function(r){return new(r||t)(i.KVO(qo.b),i.KVO(bi.A),i.KVO(tc.T),i.KVO(Do.F))}}static{this.\u0275prov=i.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var rc=V(5645),ic=V(2914);const oc=["eventInput"],sc=["commentInput"],ac=(t,n)=>({height:t,overflow:n}),lc=(t,n)=>({"white-space":t,"max-height":n,overflow:"hidden"}),Wo=t=>({"large-font":t});function cc(t,n){if(1&t&&(i.qex(0),i.nrm(1,"img",38),i.bVm()),2&t){const e=i.XpG();i.R7$(),i.FS9("alt",(null==e.profileUser?null:e.profileUser.display_name)||(null==e.profileUser?null:e.profileUser.name)||""),i.Y8G("src",e.getSafeUrl(null==e.profileUser?null:e.profileUser.picture),i.B4B)}}function uc(t,n){if(1&t&&i.nrm(0,"img",39),2&t){const e=i.XpG();i.FS9("alt",(null==e.profileUser?null:e.profileUser.display_name)||(null==e.profileUser?null:e.profileUser.name)||"")}}function fc(t,n){if(1&t&&(i.j41(0,"div",40)(1,"div",41)(2,"span",42),i.EFF(3),i.k0s(),i.j41(4,"span",43),i.EFF(5,"FOLLOWERS"),i.k0s()(),i.j41(6,"div",41)(7,"span",44),i.EFF(8),i.k0s(),i.j41(9,"span",45),i.EFF(10,"FOLLOWING"),i.k0s()()()),2&t){const e=n.ngIf;i.R7$(2),i.Y8G("matTooltip","Total contact: "+e.totalContacts),i.R7$(),i.JRh(e.followersCount),i.R7$(5),i.JRh(e.followingCount),i.R7$(),i.Y8G("matTooltip","Total contact: "+e.totalContacts)}}function hc(t,n){if(1&t){const e=i.RV6();i.j41(0,"div")(1,"button",46),i.bIt("click",function(){i.eBV(e);const o=i.XpG();return i.Njj(o.toggleFollow())}),i.nrm(2,"mat-icon",47),i.k0s()()}if(2&t){const e=i.XpG();i.R7$(),i.Y8G("matTooltip",e.isFollowing?"Unfollow":"Follow"),i.R7$(),i.Y8G("svgIcon",e.isFollowing?"heroicons_outline:user-minus":"heroicons_outline:user-plus")}}function dc(t,n){if(1&t){const e=i.RV6();i.j41(0,"button",24),i.bIt("click",function(){i.eBV(e);const o=i.XpG();return i.Njj(o.zap())}),i.j41(1,"span",25),i.nrm(2,"mat-icon",26),i.j41(3,"span"),i.EFF(4,"Send Zap"),i.k0s()()()}2&t&&(i.R7$(2),i.Y8G("svgIcon","feather:zap"))}function pc(t,n){if(1&t){const e=i.RV6();i.j41(0,"button",24),i.bIt("click",function(){i.eBV(e);const o=i.XpG();return i.Njj(o.openReceiveZapDialog())}),i.j41(1,"span",25),i.nrm(2,"mat-icon",26),i.j41(3,"span"),i.EFF(4,"Receive Zap"),i.k0s()()()}2&t&&(i.R7$(2),i.Y8G("svgIcon","heroicons_outline:qr-code"))}function gc(t,n){1&t&&(i.j41(0,"button",48)(1,"span",25),i.nrm(2,"mat-icon",26),i.j41(3,"span"),i.EFF(4,"Edit your profile"),i.k0s()()()),2&t&&(i.Y8G("routerLink","/settings/profile"),i.R7$(2),i.Y8G("svgIcon","heroicons_outline:pencil-square"))}function mc(t,n){1&t&&(i.j41(0,"button",49)(1,"span",25),i.nrm(2,"mat-icon",26),i.j41(3,"span"),i.EFF(4,"Report"),i.k0s()()()),2&t&&(i.R7$(2),i.Y8G("svgIcon","heroicons_solid:exclamation-triangle"))}function vc(t,n){1&t&&(i.j41(0,"button",49)(1,"span",25),i.nrm(2,"mat-icon",26),i.j41(3,"span"),i.EFF(4,"Turn on notifications"),i.k0s()()()),2&t&&(i.R7$(2),i.Y8G("svgIcon","heroicons_solid:bell"))}function yc(t,n){1&t&&(i.j41(0,"span",56),i.EFF(1,"..."),i.k0s())}function wc(t,n){if(1&t){const e=i.RV6();i.j41(0,"angor-card",50)(1,"div",51)(2,"div",52),i.EFF(3,"About"),i.k0s(),i.j41(4,"button",53),i.bIt("click",function(){i.eBV(e);const o=i.XpG();return i.Njj(o.toggleAbout())}),i.j41(5,"mat-icon"),i.EFF(6),i.k0s()()(),i.j41(7,"div",54),i.EFF(8),i.DNE(9,yc,2,0,"span",55),i.k0s()()}if(2&t){const e=i.XpG();i.Y8G("ngStyle",i.l_i(5,ac,e.aboutExpanded?"auto":"80px",e.aboutExpanded?"visible":"hidden")),i.R7$(6),i.JRh(e.aboutExpanded?"expand_less":"expand_more"),i.R7$(),i.Y8G("ngStyle",i.l_i(8,lc,e.aboutExpanded?"normal":"nowrap",e.aboutExpanded?"none":"1.5em")),i.R7$(),i.SpI(" ",(null==e.profileUser?null:e.profileUser.about)||""," "),i.R7$(),i.Y8G("ngIf",!e.aboutExpanded)}}function bc(t,n){if(1&t){const e=i.RV6();i.j41(0,"div",75)(1,"emoji-mart",76),i.bIt("emojiClick",function(o){i.eBV(e);const s=i.XpG(2);return i.Njj(s.addEmoji(o))}),i.k0s()()}if(2&t){const e=i.XpG(2);i.R7$(),i.Y8G("darkMode",e.darkMode)}}function _c(t,n){if(1&t){const e=i.RV6();i.j41(0,"angor-card",57)(1,"div",58)(2,"div",59),i.EFF(3,"Create Post"),i.k0s(),i.j41(4,"mat-slide-toggle",60),i.bIt("change",function(){i.eBV(e);const o=i.XpG();return i.Njj(o.togglePreview())}),i.EFF(5," Preview "),i.k0s()(),i.j41(6,"div",61)(7,"div",62),i.nrm(8,"img",63),i.j41(9,"div",64),i.EFF(10),i.k0s()(),i.j41(11,"mat-form-field",65),i.nrm(12,"textarea",66,2),i.k0s()(),i.j41(14,"div",67)(15,"div",25)(16,"button",68),i.bIt("click",function(){i.eBV(e);const o=i.XpG();return i.Njj(o.toggleEmojiPicker())}),i.nrm(17,"mat-icon",22),i.j41(18,"span",69),i.EFF(19,"Feeling"),i.k0s()(),i.DNE(20,bc,2,1,"div",70),i.j41(21,"button",71),i.nrm(22,"mat-icon",22),i.j41(23,"span",69),i.EFF(24,"Media"),i.k0s()(),i.j41(25,"button",71),i.nrm(26,"mat-icon",22),i.j41(27,"span",69),i.EFF(28,"Tag"),i.k0s()(),i.j41(29,"button",72),i.nrm(30,"mat-icon",22),i.k0s(),i.j41(31,"mat-menu",null,3)(33,"button",73)(34,"span",25),i.nrm(35,"mat-icon",26),i.j41(36,"span"),i.EFF(37,"Tag"),i.k0s()()(),i.j41(38,"button",73)(39,"span",25),i.nrm(40,"mat-icon",26),i.j41(41,"span"),i.EFF(42,"Feeling"),i.k0s()()(),i.j41(43,"button",49)(44,"span",25),i.nrm(45,"mat-icon",26),i.j41(46,"span"),i.EFF(47,"Live"),i.k0s()()(),i.j41(48,"button",49)(49,"span",25),i.nrm(50,"mat-icon",26),i.j41(51,"span"),i.EFF(52,"Gif"),i.k0s()()(),i.j41(53,"button",49)(54,"span",25),i.nrm(55,"mat-icon",26),i.j41(56,"span"),i.EFF(57,"Check in"),i.k0s()()()()(),i.j41(58,"button",74),i.bIt("click",function(){i.eBV(e);const o=i.XpG();return i.Njj(o.sendEvent())}),i.nrm(59,"mat-icon",22),i.j41(60,"span",69),i.EFF(61,"Send"),i.k0s()()()()}if(2&t){const e=i.sdS(32),r=i.XpG();i.R7$(4),i.Y8G("color","primary"),i.R7$(4),i.FS9("alt",(null==r.profileUser?null:r.profileUser.display_name)||(null==r.profileUser?null:r.profileUser.name)||""),i.Y8G("src",r.getSafeUrl(null==r.profileUser?null:r.profileUser.picture),i.B4B),i.R7$(2),i.SpI(" ",(null==r.profileUser?null:r.profileUser.display_name)||(null==r.profileUser?null:r.profileUser.name)||""," "),i.R7$(),i.Y8G("subscriptSizing","dynamic"),i.R7$(),i.Y8G("placeholder","What's on your mind?")("rows",3),i.R7$(5),i.Y8G("svgIcon","heroicons_solid:face-smile"),i.R7$(3),i.Y8G("ngIf",r.showEmojiPicker),i.R7$(2),i.Y8G("svgIcon","heroicons_solid:photo"),i.R7$(4),i.Y8G("svgIcon","heroicons_solid:user-circle"),i.R7$(3),i.Y8G("matMenuTriggerFor",e),i.R7$(),i.Y8G("svgIcon","heroicons_solid:ellipsis-horizontal"),i.R7$(5),i.Y8G("svgIcon","heroicons_solid:user-circle"),i.R7$(5),i.Y8G("svgIcon","heroicons_solid:face-smile"),i.R7$(5),i.Y8G("svgIcon","heroicons_solid:play"),i.R7$(5),i.Y8G("svgIcon","heroicons_solid:sparkles"),i.R7$(5),i.Y8G("svgIcon","heroicons_solid:map-pin"),i.R7$(4),i.Y8G("svgIcon","heroicons_solid:paper-airplane")}}function xc(t,n){if(1&t&&(i.qex(0),i.j41(1,"div",99),i.nrm(2,"iframe",100),i.k0s(),i.bVm()),2&t){const e=i.XpG().$implicit;i.R7$(2),i.Y8G("src",e.safeWord,i.f$h)}}function Ec(t,n){if(1&t&&(i.qex(0),i.j41(1,"div",99),i.nrm(2,"img",101),i.k0s(),i.bVm()),2&t){const e=i.XpG().$implicit;i.R7$(2),i.Y8G("src",e.safeWord,i.B4B)}}function kc(t,n){if(1&t&&(i.qex(0),i.j41(1,"div",99)(2,"video",102),i.nrm(3,"source",103),i.EFF(4," Your browser does not support the video tag. "),i.k0s()(),i.bVm()),2&t){const e=i.XpG().$implicit;i.R7$(3),i.Y8G("src",e.safeWord,i.B4B)}}function Mc(t,n){if(1&t&&(i.qex(0),i.j41(1,"div",99)(2,"audio",104),i.nrm(3,"source",105),i.EFF(4," Your browser does not support the audio element. "),i.k0s()(),i.bVm()),2&t){const e=i.XpG().$implicit;i.R7$(3),i.Y8G("src",e.safeWord,i.B4B)}}function Sc(t,n){if(1&t&&(i.qex(0),i.j41(1,"div",106)(2,"a",107)(3,"span",108),i.EFF(4),i.k0s()()(),i.bVm()),2&t){const e=i.XpG().$implicit;i.R7$(2),i.Y8G("href",e.word,i.B4B),i.R7$(2),i.JRh(e.word)}}function Ac(t,n){if(1&t&&(i.qex(0),i.j41(1,"div",106)(2,"span",109),i.EFF(3),i.k0s()(),i.bVm()),2&t){const e=i.XpG().$implicit,r=i.XpG(2);i.R7$(2),i.Y8G("ngClass",i.eq3(2,Wo,r.isSingleEmojiOrWord(e))),i.R7$(),i.SpI(" ",e.trim()," ")}}function Ic(t,n){if(1&t&&(i.j41(0,"div",98),i.DNE(1,xc,3,1,"ng-container",20)(2,Ec,3,1,"ng-container",20)(3,kc,5,1,"ng-container",20)(4,Mc,5,1,"ng-container",20)(5,Sc,5,2,"ng-container",20)(6,Ac,4,4,"ng-container",20),i.k0s()),2&t){const e=n.$implicit;i.R7$(),i.Y8G("ngIf","youtube"===e.token),i.R7$(),i.Y8G("ngIf","image"===e.token),i.R7$(),i.Y8G("ngIf","video"===e.token),i.R7$(),i.Y8G("ngIf","audio"===e.token),i.R7$(),i.Y8G("ngIf","link"===e.token),i.R7$(),i.Y8G("ngIf",!e.token)}}function Rc(t,n){if(1&t&&(i.j41(0,"angor-card",77,4)(2,"div",78),i.nrm(3,"img",79),i.j41(4,"div",80)(5,"span",81),i.EFF(6),i.k0s(),i.j41(7,"span",82),i.EFF(8,"1 minutes ago"),i.k0s()()(),i.DNE(9,Ic,7,6,"div",83),i.j41(10,"div",84)(11,"button",85),i.nrm(12,"mat-icon",86),i.j41(13,"span",69),i.EFF(14,"Unlike"),i.k0s()(),i.j41(15,"button",85),i.nrm(16,"mat-icon",87),i.j41(17,"span",69),i.EFF(18,"Comment"),i.k0s()(),i.j41(19,"button",85),i.nrm(20,"mat-icon",88),i.j41(21,"span",69),i.EFF(22,"Share"),i.k0s()(),i.j41(23,"button",85),i.nrm(24,"mat-icon",89),i.j41(25,"span",69),i.EFF(26,"Zap"),i.k0s()()(),i.nrm(27,"hr",90),i.j41(28,"div",91)(29,"div",25)(30,"div",92),i.EFF(31," 0 Zap "),i.k0s()(),i.nrm(32,"div",93),i.j41(33,"div",94)(34,"button",95),i.EFF(35," 0 Like "),i.k0s(),i.j41(36,"button",95),i.EFF(37," 0 shares "),i.k0s(),i.j41(38,"button",96)(39,"span",97),i.EFF(40,"0 Comments"),i.k0s()()()()()),2&t){const e=i.XpG();i.R7$(3),i.FS9("alt",(null==e.profileUser?null:e.profileUser.display_name)||(null==e.profileUser?null:e.profileUser.name)||""),i.Y8G("src",e.getSafeUrl(null==e.profileUser?null:e.profileUser.picture),i.B4B),i.R7$(3),i.JRh((null==e.profileUser?null:e.profileUser.display_name)||(null==e.profileUser?null:e.profileUser.name)||""),i.R7$(3),i.Y8G("ngForOf",e.parseContent.parseContent(e.eventInput.nativeElement.value))("ngForTrackBy",e.trackByFn),i.R7$(3),i.Y8G("svgIcon","heroicons_solid:heart"),i.R7$(4),i.Y8G("svgIcon","heroicons_solid:chat-bubble-left-ellipsis"),i.R7$(4),i.Y8G("svgIcon","heroicons_solid:share"),i.R7$(4),i.Y8G("svgIcon","heroicons_solid:bolt")}}function Tc(t,n){if(1&t&&(i.qex(0),i.j41(1,"div",99),i.nrm(2,"iframe",100),i.k0s(),i.bVm()),2&t){const e=i.XpG().$implicit;i.R7$(2),i.Y8G("src",e.safeWord,i.f$h)}}function Cc(t,n){if(1&t&&(i.qex(0),i.j41(1,"div",99),i.nrm(2,"img",101),i.k0s(),i.bVm()),2&t){const e=i.XpG().$implicit;i.R7$(2),i.Y8G("src",e.safeWord,i.B4B)}}function Bc(t,n){if(1&t&&(i.qex(0),i.j41(1,"div",99)(2,"video",102),i.nrm(3,"source",103),i.EFF(4," Your browser does not support the video tag. "),i.k0s()(),i.bVm()),2&t){const e=i.XpG().$implicit;i.R7$(3),i.Y8G("src",e.safeWord,i.B4B)}}function Uc(t,n){if(1&t&&(i.qex(0),i.j41(1,"div",99)(2,"audio",104),i.nrm(3,"source",105),i.EFF(4," Your browser does not support the audio element. "),i.k0s()(),i.bVm()),2&t){const e=i.XpG().$implicit;i.R7$(3),i.Y8G("src",e.safeWord,i.B4B)}}function Nc(t,n){if(1&t&&(i.qex(0),i.j41(1,"div",106)(2,"a",107)(3,"span",108),i.EFF(4),i.k0s()()(),i.bVm()),2&t){const e=i.XpG().$implicit;i.R7$(2),i.Y8G("href",e.word,i.B4B),i.R7$(2),i.JRh(e.word)}}function Pc(t,n){if(1&t&&(i.qex(0),i.j41(1,"div",106)(2,"span",109),i.EFF(3),i.k0s()(),i.bVm()),2&t){const e=i.XpG().$implicit,r=i.XpG(2);i.R7$(2),i.Y8G("ngClass",i.eq3(2,Wo,r.isSingleEmojiOrWord(e))),i.R7$(),i.SpI(" ",e.trim()," ")}}function $c(t,n){if(1&t&&(i.j41(0,"div",98),i.DNE(1,Tc,3,1,"ng-container",20)(2,Cc,3,1,"ng-container",20)(3,Bc,5,1,"ng-container",20)(4,Uc,5,1,"ng-container",20)(5,Nc,5,2,"ng-container",20)(6,Pc,4,4,"ng-container",20),i.k0s()),2&t){const e=n.$implicit;i.R7$(),i.Y8G("ngIf","youtube"===e.token),i.R7$(),i.Y8G("ngIf","image"===e.token),i.R7$(),i.Y8G("ngIf","video"===e.token),i.R7$(),i.Y8G("ngIf","audio"===e.token),i.R7$(),i.Y8G("ngIf","link"===e.token),i.R7$(),i.Y8G("ngIf",!e.token)}}function jc(t,n){if(1&t){const e=i.RV6();i.j41(0,"angor-card",35,5)(2,"div",78),i.nrm(3,"img",79),i.j41(4,"div",80)(5,"span",81),i.EFF(6),i.k0s(),i.j41(7,"span",82),i.EFF(8),i.nI1(9,"ago"),i.k0s()(),i.j41(10,"button",110),i.nrm(11,"mat-icon",22),i.k0s(),i.j41(12,"mat-menu",null,6)(14,"button",49)(15,"span",25),i.nrm(16,"mat-icon",26),i.j41(17,"span"),i.EFF(18,"Save post"),i.k0s()()(),i.j41(19,"button",49)(20,"span",25),i.nrm(21,"mat-icon",26),i.j41(22,"span"),i.EFF(23,"Hide post"),i.k0s()()(),i.j41(24,"button",49)(25,"span",25),i.nrm(26,"mat-icon",26),i.j41(27,"span"),i.EFF(28,"Snooze for 30 days"),i.k0s()()(),i.j41(29,"button",49)(30,"span",25),i.nrm(31,"mat-icon",26),i.j41(32,"span"),i.EFF(33,"Hide all"),i.k0s()()(),i.nrm(34,"mat-divider",27),i.j41(35,"button",49)(36,"span",25),i.nrm(37,"mat-icon",26),i.j41(38,"span"),i.EFF(39,"Report post"),i.k0s()()(),i.j41(40,"button",49)(41,"span",25),i.nrm(42,"mat-icon",26),i.j41(43,"span"),i.EFF(44,"Turn on notifications for this post"),i.k0s()()()()(),i.DNE(45,$c,7,6,"div",83),i.j41(46,"div",84)(47,"button",85),i.nrm(48,"mat-icon",86),i.j41(49,"span",69),i.EFF(50,"Unlike"),i.k0s()(),i.j41(51,"button",85),i.nrm(52,"mat-icon",87),i.j41(53,"span",69),i.EFF(54,"Comment"),i.k0s()(),i.j41(55,"button",85),i.nrm(56,"mat-icon",88),i.j41(57,"span",69),i.EFF(58,"Share"),i.k0s()(),i.j41(59,"button",85),i.nrm(60,"mat-icon",89),i.j41(61,"span",69),i.EFF(62,"Zap"),i.k0s()()(),i.nrm(63,"hr",90),i.j41(64,"div",91)(65,"div",25),i.nrm(66,"img",111)(67,"img",112)(68,"img",112)(69,"img",112),i.j41(70,"div",92),i.EFF(71," 24 Reactions "),i.k0s()(),i.nrm(72,"div",93),i.j41(73,"div",94)(74,"button",113),i.bIt("click",function(){const o=i.eBV(e).$implicit,s=i.XpG();return i.Njj(s.openPost(o.id))}),i.j41(75,"span",97),i.EFF(76,"Read More ..."),i.k0s()()()()()}if(2&t){const e=n.$implicit,r=i.sdS(13),o=i.XpG();i.R7$(3),i.FS9("alt",(null==o.profileUser?null:o.profileUser.display_name)||(null==o.profileUser?null:o.profileUser.name)||""),i.Y8G("src",o.getSafeUrl(null==o.profileUser?null:o.profileUser.picture),i.B4B),i.R7$(3),i.JRh((null==o.profileUser?null:o.profileUser.display_name)||(null==o.profileUser?null:o.profileUser.name)||""),i.R7$(2),i.JRh(i.bMT(9,18,e.created_at)),i.R7$(2),i.Y8G("matMenuTriggerFor",r),i.R7$(),i.Y8G("svgIcon","heroicons_solid:ellipsis-vertical"),i.R7$(5),i.Y8G("svgIcon","heroicons_solid:arrow-up-tray"),i.R7$(5),i.Y8G("svgIcon","heroicons_solid:eye-slash"),i.R7$(5),i.Y8G("svgIcon","heroicons_solid:clock"),i.R7$(5),i.Y8G("svgIcon","heroicons_solid:minus-circle"),i.R7$(6),i.Y8G("svgIcon","heroicons_solid:exclamation-triangle"),i.R7$(5),i.Y8G("svgIcon","heroicons_solid:bell"),i.R7$(3),i.Y8G("ngForOf",o.parseContent.parseContent(e.content))("ngForTrackBy",o.trackByFn),i.R7$(3),i.Y8G("svgIcon","heroicons_solid:heart"),i.R7$(4),i.Y8G("svgIcon","heroicons_solid:chat-bubble-left-ellipsis"),i.R7$(4),i.Y8G("svgIcon","heroicons_solid:share"),i.R7$(4),i.Y8G("svgIcon","heroicons_solid:bolt")}}const Oc=[{path:"",component:(()=>{class t{constructor(e,r,o,s,c,f,h,g,b,_,I,A,S,k,R,T){this._changeDetectorRef=e,this._signerService=r,this._storageService=o,this._sanitizer=s,this._route=c,this._router=f,this._socialService=h,this._snackBar=g,this._lightning=b,this._dialog=_,this._angorConfigService=I,this._angorConfirmationService=A,this._eventService=S,this._subscriptionService=k,this._clipboard=R,this.parseContent=T,this.darkMode=!1,this.isLoading=!0,this.errorMessage=null,this._unsubscribeAll=new ut.B,this.allPublicKeys=[],this.isCurrentUserProfile=!1,this.isFollowing=!1,this.showEmojiPicker=!1,this.showCommentEmojiPicker=!1,this.lightningResponse=null,this.lightningInvoice=null,this.paymentInvoice="",this.invoiceAmount="?",this.isLiked=!1,this.isPreview=!1,this.posts=[],this.likes=[],this.currentPage=1,this.loading=!1,this.myLikes=[],this.myLikedNoteIds=[],this.isLoadingPosts=!0,this.noEventsMessage="",this.totalContacts=0,this.followersCount=0,this.followingCount=0,this.aboutExpanded=!0}ngOnInit(){var e=this;return(0,U.A)(function*(){e._angorConfigService.config$.subscribe(r=>{"auto"===r.scheme?e.detectSystemTheme():e.darkMode="dark"===r.scheme}),e._route.paramMap.subscribe(r=>{const o=r.get("pubkey");if(o)e.routePubKey=o;else{e.isCurrentUserProfile=!0;const s=e._signerService.getPublicKey();e.routePubKey=s}e.loadProfileUser(e.routePubKey),e.stats$=e._storageService.getContactStats$(e.routePubKey)}),e.loadInitialPosts(),e.subscribeToNewPosts()})()}loadInitialPosts(){var e=this;return(0,U.A)(function*(){e.loading=!0;try{yield e._storageService.loadPosts(e.currentPage)}catch(r){console.error("Error loading posts:",r)}finally{e.loading=!1}e._changeDetectorRef.detectChanges()})()}subscribeToNewPosts(){this._storageService.posts$.subscribe(e=>{e&&!this.posts.some(r=>r.id===e.id)&&(this.posts.push(e),this.posts.sort((r,o)=>o.created_at-r.created_at),this._changeDetectorRef.detectChanges())})}loadNextPage(){this.loading||(this.currentPage++,this.loadInitialPosts())}toggleAbout(){this.aboutExpanded=!this.aboutExpanded}ngOnDestroy(){this.subscriptionId&&this._subscriptionService.removeSubscriptionById(this.subscriptionId),this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}loadProfileUser(e){var r=this;return(0,U.A)(function*(){if(r.isLoading=!0,r.errorMessage=null,r.profileUser=null,r._changeDetectorRef.detectChanges(),!e)return r.errorMessage="No public key found. Please log in again.",r.isLoading=!1,void r._changeDetectorRef.detectChanges();try{const o=yield r._storageService.getProfile(e);o&&(r.profileUser=o,r._changeDetectorRef.detectChanges()),r.subscribeToUserProfile(e)}catch(o){console.error("Error loading user profile:",o)}})()}subscribeToUserProfile(e){var r=this;this.subscriptionId=this._subscriptionService.addSubscriptions([{authors:[e],kinds:[0],limit:1}],function(){var s=(0,U.A)(function*(c){try{const f=JSON.parse(c.content);r.profileUser=f,r.followersCount=f.followersCount??0,r.followingCount=f.followingCount??0,yield r._storageService.saveProfile(e,f),r._changeDetectorRef.markForCheck()}catch(f){console.error("Error processing metadata event:",f)}});return function(c){return s.apply(this,arguments)}}())}getSafeUrl(e){return this._sanitizer.bypassSecurityTrustUrl(e)}toggleFollow(){var e=this;return(0,U.A)(function*(){try{const r=e._signerService.getPublicKey(),o=e.routePubKey||e.currentUserPubKey;if(!o||!r)return void console.error("Public key missing. Unable to toggle follow.");e.isFollowing?(yield e._socialService.unfollow(o),console.log(`Unfollowed ${o}`)):(yield e._socialService.follow(o),console.log(`Followed ${o}`)),e.isFollowing=!e.isFollowing,e._changeDetectorRef.detectChanges()}catch(r){console.error("Failed to toggle follow:",r)}})()}openSnackBar(e,r){this._snackBar.open(e,r,{duration:1300})}getLightningInfo(){let e="";if(this.profileUser?.lud06){const{words:r}=he.I.decode(this.profileUser.lud06,5e3),o=new Uint8Array(he.I.fromWords(r));e=(new TextDecoder).decode(Uint8Array.from(o))}else if(this.profileUser?.lud16?.toLowerCase().startsWith("lnurl")){const{words:r}=he.I.decode(this.profileUser.lud16,5e3),o=new Uint8Array(he.I.fromWords(r));e=(new TextDecoder).decode(Uint8Array.from(o))}else this.profileUser?.lud16&&(e=this._lightning.getLightningAddress(this.profileUser.lud16));""!==e?this._lightning.getLightning(e).subscribe(r=>{this.lightningResponse=r,"Failed"===this.lightningResponse.status?this.openSnackBar("Failed to lookup lightning address","dismiss"):this.lightningResponse.callback?this.openZapDialog():this.openSnackBar("couldn't find user's lightning address","dismiss")}):this.openSnackBar("No lightning address found","dismiss")}zap(){var e=this;return(0,U.A)(function*(){e.profileUser&&(e.profileUser.lud06||e.profileUser.lud16)?e.getLightningInfo():e.openSnackBar("user can't receive zaps","dismiss")})()}openZapDialog(){this._dialog.open(Vl,{width:"405px",maxHeight:"90vh",data:this.profileUser})}openReceiveZapDialog(){this._dialog.open(Al,{width:"405px",maxHeight:"90vh",data:this.profileUser})}toggleLike(){this.isLiked=!this.isLiked,this.isLiked&&setTimeout(()=>{this.isLiked=!1,this.isLiked=!0},300)}addEmoji(e){this.eventInput.nativeElement.value+=e.emoji.native,this.showEmojiPicker=!1}toggleEmojiPicker(){this.showCommentEmojiPicker=!1,this.showEmojiPicker=!this.showEmojiPicker}addEmojiTocomment(e){this.commentInput.nativeElement.value+=e.emoji.native,this.showCommentEmojiPicker=!1}detectSystemTheme(){const e=window.matchMedia("(prefers-color-scheme: dark)");this.darkMode=e.matches,e.addEventListener("change",r=>{this.darkMode=r.matches})}togglePreview(){this.isPreview=!this.isPreview}sendEvent(){""!=this.eventInput.nativeElement.value&&this._eventService.sendTextEvent(this.eventInput.nativeElement.value).then(()=>{this._changeDetectorRef.markForCheck()}).catch(e=>{console.error("Failed to send Event:",e)})}copyHex(){this._clipboard.copy(this.routePubKey),this.openSnackBar("hex public key copied","dismiss")}copyNpub(){var e=this._signerService.getNpubFromPubkey(this.routePubKey);this._clipboard.copy(e),this.openSnackBar("npub public key copied","dismiss")}isSingleEmojiOrWord(e){const r=e.trim(),o=/^\w+$/.test(r),s=/^[\p{Emoji}]+$/u.test(r);return o||s}openPost(e){this._router.navigate(["/post",e])}static{this.\u0275fac=function(r){return new(r||t)(i.rXU(i.gRc),i.rXU(bi.A),i.rXU(Hl.n),i.rXU(Zl.up),i.rXU(we.nX),i.rXU(we.Ix),i.rXU(Xl),i.rXU(pi.UG),i.rXU(Go),i.rXU(ft.bZ),i.rXU(Kl.P),i.rXU(Jl.m),i.rXU(nc),i.rXU(rc.n),i.rXU(gi),i.rXU(ic.m))}}static{this.\u0275cmp=i.VBU({type:t,selectors:[["profile"]],viewQuery:function(r,o){if(1&r&&(i.GBs(oc,5),i.GBs(sc,5)),2&r){let s;i.mGM(s=i.lsd())&&(o.eventInput=s.first),i.mGM(s=i.lsd())&&(o.commentInput=s.first)}},standalone:!0,features:[i.aNF],decls:52,vars:24,consts:[["defaultAvatar",""],["profileMenu","matMenu"],["eventInput",""],["postCardMenu01","matMenu"],["expandableComments","angorCard"],["expandableCard02","angorCard"],["postCardMenu02","matMenu"],[1,"flex","min-w-0","flex-auto","flex-col"],[1,"bg-card","flex","flex-col","shadow"],["onerror","this.onerror=null; this.src='/images/pages/profile/cover.jpg';",1,"h-40","object-cover","lg:h-80",3,"src","alt"],[1,"bg-card","mx-auto","flex","w-full","max-w-5xl","flex-0","flex-col","items-center","px-8","lg:h-18","lg:flex-row"],[1,"-mt-26","flex-shrink-0","rounded-full","lg:-mt-22"],[4,"ngIf","ngIfElse"],[1,"mt-4","flex","flex-grow","flex-col","items-center","lg:ml-8","lg:mt-0","lg:items-start"],[1,"max-w-full","truncate","text-lg","font-bold","leading-tight","lg:max-w-[25rem]",2,"white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"text-secondary","max-w-full","truncate","leading-tight","lg:max-w-[25rem]",2,"white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"mx-8","hidden","h-8","flex-shrink-0","border-l-2","lg:flex"],[1,"flex","flex-shrink-0","items-center","space-x-6","lg:mt-0"],["class","mt-6 flex flex-shrink-0 items-center space-x-6 lg:mt-0",4,"ngIf"],[1,"mb-4","mt-8","flex","flex-shrink-0","items-center","space-x-6","lg:m-0","lg:ml-auto"],[4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"icon-size-5",3,"svgIcon"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],[1,"flex","items-center"],[1,"mr-3","icon-size-5",3,"svgIcon"],[1,"my-2"],["mat-menu-item","",3,"routerLink",4,"ngIf"],["mat-menu-item","",4,"ngIf"],[1,"mx-auto","w-full","max-w-5xl","p-6","sm:p-8"],[1,"flex","w-full","max-w-140","m-auto","flex-col","items-start"],["class","about-section mb-8 flex flex-col items-start p-6 transition-all duration-300 w-full pb-6 sm:p-8","style","position: relative",3,"ngStyle",4,"ngIf"],["class","mb-8 flex w-full flex-col p-6 pb-6 sm:p-8",4,"ngIf"],["class","mb-8 flex w-full flex-col bg-primary-50 dark:bg-primary-800",4,"ngIf"],[1,"mb-8","flex","w-full","flex-col"],[1,"mt-10","m-auto","flex","justify-center"],["mat-raised-button","","color","primary",3,"click","disabled"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"ring-bg-card","h-32","min-h-32","w-32","min-w-32","max-w-fit","rounded-full","object-cover","ring-4",3,"src","alt"],["src","/images/avatars/avatar-placeholder.png","onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"ring-bg-card","h-32","min-h-32","w-32","min-w-32","rounded-full","object-cover","ring-4",3,"alt"],[1,"mt-6","flex","flex-shrink-0","items-center","space-x-6","lg:mt-0"],[1,"flex","flex-col","items-center"],[1,"font-bold",3,"matTooltip"],[1,"text-secondary","text-sm","font-medium"],[1,"font-bold"],[1,"text-secondary","text-sm","font-medium",3,"matTooltip"],["mat-icon-button","",3,"click","matTooltip"],[3,"svgIcon"],["mat-menu-item","",3,"routerLink"],["mat-menu-item",""],[1,"about-section","mb-8","flex","flex-col","items-start","p-6","transition-all","duration-300","w-full","pb-6","sm:p-8",2,"position","relative",3,"ngStyle"],[1,"mb-2","flex","w-full","items-center","justify-between"],[1,"text-2xl","font-semibold","leading-tight"],["mat-icon-button","","color","primary","aria-label","Toggle about section",2,"position","absolute","top","16px","right","16px",3,"click"],[1,"about-content","text-base","text-gray-700","transition-all","duration-300",3,"ngStyle"],["class","text-gray-500",4,"ngIf"],[1,"text-gray-500"],[1,"mb-8","flex","w-full","flex-col","p-6","pb-6","sm:p-8"],[1,"flex","justify-between"],[1,"text-xl","font-semibold"],[1,"-mr-4","ml-auto",3,"change","color"],[1,"mt-8","flex","flex-col","items-start","sm:flex-row"],[1,"mb-6","flex","items-center","sm:mb-0"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"mr-4","h-12","w-12","min-w-12","rounded-full","object-cover",3,"src","alt"],[1,"sm:hidden"],[1,"w-full",3,"subscriptSizing"],["matInput","","cdkTextareaAutosize","",3,"placeholder","rows"],[1,"-mx-3","mt-6","flex","items-center","justify-between","sm:mt-8"],["mat-button","",1,"mr-1","px-3",3,"click"],[1,"ml-2"],["class","emoji-picker-container-global",4,"ngIf"],["mat-button","",1,"mr-1","hidden","px-3","sm:inline-flex"],["mat-button","",1,"px-3",3,"matMenuTriggerFor"],["mat-menu-item","",1,"sm:hidden"],["mat-button","",1,"mr-1","flex","px-3",3,"click"],[1,"emoji-picker-container-global"],[3,"emojiClick","darkMode"],[1,"mb-8","flex","w-full","flex-col","bg-primary-50","dark:bg-primary-800"],[1,"mx-6","mb-4","mt-6","flex","items-center","sm:mx-8"],["onerror","this.onerror=null; this.src='/images/avatars/avatar-placeholder.png';",1,"mr-4","h-10","w-10","rounded-full",3,"src","alt"],[1,"flex","flex-col"],[1,"font-semibold","leading-none"],[1,"text-secondary","mt-1","text-sm","leading-none"],["class","inline-block break-words whitespace-pre-wrap",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mx-3","flex","items-center","sm:mx-5"],["mat-button","",1,"mr-1","px-3"],[1,"text-red-500","icon-size-5",3,"svgIcon"],[1,"text-blue-500","icon-size-5",3,"svgIcon"],[1,"text-green-500","icon-size-5",3,"svgIcon"],[1,"text-orange-500","icon-size-5",3,"svgIcon"],[1,"mx-6","mb-6","mt-4","border-b","sm:mx-8"],[1,"mx-6","mb-4","flex","flex-col","sm:mx-8","sm:mb-6","sm:flex-row","sm:items-center"],[1,"ml-3","text-md","tracking-tight"],[1,"hidden","flex-auto","sm:flex"],[1,"mt-4","flex","items-center","sm:mt-0"],["mat-button","",1,"-ml-2","mr-1","px-3","sm:ml-0"],["mat-button","",1,"px-3","sm:-mr-4"],[1,"mr-1"],[1,"inline-block","break-words","whitespace-pre-wrap"],[1,"relative","mb-4","block"],["width","560","height","315","frameborder","0","allowfullscreen","",3,"src"],["alt","Embedded Image",1,"max-h-140","object-cover",2,"width","100%",3,"src"],["controls","",2,"width","100%"],["type","video/mp4",3,"src"],["controls",""],["type","audio/mpeg",3,"src"],[1,"mx-6","mb-6","mt-2","sm:mx-8"],["target","_blank",1,"inline-block","break-words","break-all","text-blue-500","underline",3,"href"],[1,"inline-block","break-words","break-all"],[1,"inline-block","break-words","break-all",3,"ngClass"],["mat-icon-button","",1,"-mr-4","ml-auto",3,"matMenuTriggerFor"],["src","/images/avatars/avatar-placeholder.png","alt","Card cover image",1,"text-card","m-0.5","h-6","w-6","rounded-full","ring-2","ring-white"],["src","/images/avatars/avatar-placeholder.png","alt","Card cover image",1,"text-card","m-0.5","-ml-3","h-6","w-6","rounded-full","ring-2","ring-white"],["mat-button","",1,"px-3","sm:-mr-4",3,"click"]],template:function(r,o){if(1&r){const s=i.RV6();i.j41(0,"div",7)(1,"div",8)(2,"div"),i.nrm(3,"img",9),i.k0s(),i.j41(4,"div",10)(5,"div",11),i.DNE(6,cc,2,2,"ng-container",12)(7,uc,1,1,"ng-template",null,0,i.C5r),i.k0s(),i.j41(9,"div",13)(10,"div",14),i.EFF(11),i.k0s(),i.j41(12,"div",15),i.EFF(13),i.k0s()(),i.nrm(14,"div",16),i.j41(15,"div",17),i.DNE(16,fc,11,4,"div",18),i.nI1(17,"async"),i.nrm(18,"div",16),i.j41(19,"div",19),i.DNE(20,hc,3,2,"div",20),i.j41(21,"div")(22,"button",21),i.nrm(23,"mat-icon",22),i.k0s(),i.j41(24,"mat-menu",null,1),i.DNE(26,dc,5,1,"button",23),i.j41(27,"button",24),i.bIt("click",function(){return i.eBV(s),i.Njj(o.copyHex())}),i.j41(28,"span",25),i.nrm(29,"mat-icon",26),i.j41(30,"span"),i.EFF(31,"Copy Public key (hex)"),i.k0s()()(),i.j41(32,"button",24),i.bIt("click",function(){return i.eBV(s),i.Njj(o.copyNpub())}),i.j41(33,"span",25),i.nrm(34,"mat-icon",26),i.j41(35,"span"),i.EFF(36,"Copy Public key (npub)"),i.k0s()()(),i.DNE(37,pc,5,1,"button",23),i.nrm(38,"mat-divider",27),i.DNE(39,gc,5,2,"button",28)(40,mc,5,1,"button",29)(41,vc,5,1,"button",29),i.k0s()()()()()(),i.j41(42,"div",30)(43,"div",31),i.DNE(44,wc,10,11,"angor-card",32)(45,_c,62,19,"angor-card",33)(46,Rc,41,9,"angor-card",34),i.Z7z(47,jc,77,20,"angor-card",35,i.Vm6),i.j41(49,"div",36)(50,"button",37),i.bIt("click",function(){return i.eBV(s),i.Njj(o.loadNextPage())}),i.EFF(51),i.k0s()()()()()}if(2&r){const s=i.sdS(8),c=i.sdS(25);i.R7$(3),i.FS9("alt",(null==o.profileUser?null:o.profileUser.display_name)||(null==o.profileUser?null:o.profileUser.name)||"Banner"),i.Y8G("src",(null==o.profileUser?null:o.profileUser.banner)||"/images/pages/profile/cover.jpg",i.B4B),i.R7$(3),i.Y8G("ngIf",null==o.profileUser?null:o.profileUser.picture)("ngIfElse",s),i.R7$(5),i.SpI(" ",(null==o.profileUser?null:o.profileUser.display_name)||(null==o.profileUser?null:o.profileUser.name)||"Unknown User"," "),i.R7$(2),i.SpI(" ",(null==o.profileUser?null:o.profileUser.username)||(null==o.profileUser?null:o.profileUser.name)," "),i.R7$(3),i.Y8G("ngIf",i.bMT(17,22,o.stats$)),i.R7$(4),i.Y8G("ngIf",!o.isCurrentUserProfile),i.R7$(2),i.Y8G("matMenuTriggerFor",c),i.R7$(),i.Y8G("svgIcon","heroicons_solid:ellipsis-vertical"),i.R7$(3),i.Y8G("ngIf",!o.isCurrentUserProfile),i.R7$(3),i.Y8G("svgIcon","heroicons_outline:clipboard-document"),i.R7$(5),i.Y8G("svgIcon","heroicons_outline:clipboard-document"),i.R7$(3),i.Y8G("ngIf",o.isCurrentUserProfile),i.R7$(2),i.Y8G("ngIf",o.isCurrentUserProfile),i.R7$(),i.Y8G("ngIf",!o.isCurrentUserProfile),i.R7$(),i.Y8G("ngIf",!o.isCurrentUserProfile),i.R7$(3),i.Y8G("ngIf",(null==o.profileUser?null:o.profileUser.about)&&""!==o.profileUser.about.trim()),i.R7$(),i.Y8G("ngIf",o.isCurrentUserProfile),i.R7$(),i.Y8G("ngIf",o.isPreview),i.R7$(),i.Dyx(o.posts),i.R7$(3),i.Y8G("disabled",o.loading),i.R7$(),i.SpI(" ",o.loading?"Loading...":"Load More Posts"," ")}},dependencies:[we.Wk,z.n,Ue.m_,Ue.An,ne.Hl,ne.$z,ne.iY,be.Cn,be.kk,be.fb,be.Cp,re.RG,re.rl,Ae.fS,Ae.fg,yt.xb,yt.EE,ae.w,ae.q,K.uc,K.oV,x.YU,x.MD,x.Sq,x.bT,x.B3,x.Jj,oe.YN,de.f,le.Ic,q.sG,bt.D6,Ie.e,zl.MY,Nt.vg,Yl.g],styles:[".emoji-picker-container-global{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:9999;width:350px;max-width:100%}.heart-beat{animation:heartBeatAnimation .3s ease-in-out}@keyframes heartBeatAnimation{0%{transform:scale(1)}30%{transform:scale(2)}60%{transform:scale(1)}to{transform:scale(1)}}.loading-spinner{display:flex;justify-content:center;align-items:center;margin:20px 0}.loading-spinner .spinner{border:4px solid rgba(0,0,0,.1);border-left-color:#009fb5;border-radius:50%;width:30px;height:30px;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.about-section{overflow:hidden;transition:height .3s ease}.c-img,.c-video{max-width:100%;border-radius:10px}\n"],encapsulation:2,changeDetection:0})}}return t})()}]},917:function(Ht,Bt,V){!function(gt,U){"use strict";function z(w,a){if(!w)throw new Error(a||"Assertion failed")}function yt(w,a){w.super_=a;var u=function(){};u.prototype=a.prototype,w.prototype=new u,w.prototype.constructor=w}function x(w,a,u){if(x.isBN(w))return w;this.negative=0,this.words=null,this.length=0,this.red=null,null!==w&&(("le"===a||"be"===a)&&(u=a,a=10),this._init(w||0,a||10,u||"be"))}var oe;"object"==typeof gt?gt.exports=x:U.BN=x,x.BN=x,x.wordSize=26;try{oe=typeof window<"u"&&typeof window.Buffer<"u"?window.Buffer:V(7790).Buffer}catch{}function ne(w,a){var u=w.charCodeAt(a);return u>=65&&u<=70?u-55:u>=97&&u<=102?u-87:u-48&15}function ae(w,a,u){var d=ne(w,u);return u-1>=a&&(d|=ne(w,u-1)<<4),d}function re(w,a,u,d){for(var p=0,y=Math.min(w.length,u),E=a;E<y;E++){var M=w.charCodeAt(E)-48;p*=d,p+=M>=49?M-49+10:M>=17?M-17+10:M}return p}x.isBN=function(a){return a instanceof x||null!==a&&"object"==typeof a&&a.constructor.wordSize===x.wordSize&&Array.isArray(a.words)},x.max=function(a,u){return a.cmp(u)>0?a:u},x.min=function(a,u){return a.cmp(u)<0?a:u},x.prototype._init=function(a,u,d){if("number"==typeof a)return this._initNumber(a,u,d);if("object"==typeof a)return this._initArray(a,u,d);"hex"===u&&(u=16),z(u===(0|u)&&u>=2&&u<=36);var p=0;"-"===(a=a.toString().replace(/\s+/g,""))[0]&&(p++,this.negative=1),p<a.length&&(16===u?this._parseHex(a,p,d):(this._parseBase(a,u,p),"le"===d&&this._initArray(this.toArray(),u,d)))},x.prototype._initNumber=function(a,u,d){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[67108863&a],this.length=1):a<4503599627370496?(this.words=[67108863&a,a/67108864&67108863],this.length=2):(z(a<9007199254740992),this.words=[67108863&a,a/67108864&67108863,1],this.length=3),"le"===d&&this._initArray(this.toArray(),u,d)},x.prototype._initArray=function(a,u,d){if(z("number"==typeof a.length),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var y,E,M=0;if("be"===d)for(p=a.length-1,y=0;p>=0;p-=3)this.words[y]|=(E=a[p]|a[p-1]<<8|a[p-2]<<16)<<M&67108863,this.words[y+1]=E>>>26-M&67108863,(M+=24)>=26&&(M-=26,y++);else if("le"===d)for(p=0,y=0;p<a.length;p+=3)this.words[y]|=(E=a[p]|a[p+1]<<8|a[p+2]<<16)<<M&67108863,this.words[y+1]=E>>>26-M&67108863,(M+=24)>=26&&(M-=26,y++);return this.strip()},x.prototype._parseHex=function(a,u,d){this.length=Math.ceil((a.length-u)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var M,y=0,E=0;if("be"===d)for(p=a.length-1;p>=u;p-=2)M=ae(a,u,p)<<y,this.words[E]|=67108863&M,y>=18?(y-=18,this.words[E+=1]|=M>>>26):y+=8;else for(p=(a.length-u)%2==0?u+1:u;p<a.length;p+=2)M=ae(a,u,p)<<y,this.words[E]|=67108863&M,y>=18?(y-=18,this.words[E+=1]|=M>>>26):y+=8;this.strip()},x.prototype._parseBase=function(a,u,d){this.words=[0],this.length=1;for(var p=0,y=1;y<=67108863;y*=u)p++;p--,y=y/u|0;for(var E=a.length-d,M=E%p,m=Math.min(E,E-M)+d,l=0,v=d;v<m;v+=p)l=re(a,v,v+p,u),this.imuln(y),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(0!==M){var H=1;for(l=re(a,v,a.length,u),v=0;v<M;v++)H*=u;this.imuln(H),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}this.strip()},x.prototype.copy=function(a){a.words=new Array(this.length);for(var u=0;u<this.length;u++)a.words[u]=this.words[u];a.length=this.length,a.negative=this.negative,a.red=this.red},x.prototype.clone=function(){var a=new x(null);return this.copy(a),a},x.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},x.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},x.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},x.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var Ue=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],Ae=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],be=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function q(w,a,u){u.negative=a.negative^w.negative;var d=w.length+a.length|0;u.length=d,d=d-1|0;var p=0|w.words[0],y=0|a.words[0],E=p*y,m=E/67108864|0;u.words[0]=67108863&E;for(var l=1;l<d;l++){for(var v=m>>>26,H=67108863&m,J=Math.min(l,a.length-1),ee=Math.max(0,l-w.length+1);ee<=J;ee++)v+=(E=(p=0|w.words[l-ee|0])*(y=0|a.words[ee])+H)/67108864|0,H=67108863&E;u.words[l]=0|H,m=0|v}return 0!==m?u.words[l]=0|m:u.length--,u.strip()}x.prototype.toString=function(a,u){var d;if(u=0|u||1,16===(a=a||10)||"hex"===a){d="";for(var p=0,y=0,E=0;E<this.length;E++){var M=this.words[E],m=(16777215&(M<<p|y)).toString(16);d=0!=(y=M>>>24-p&16777215)||E!==this.length-1?Ue[6-m.length]+m+d:m+d,(p+=2)>=26&&(p-=26,E--)}for(0!==y&&(d=y.toString(16)+d);d.length%u!=0;)d="0"+d;return 0!==this.negative&&(d="-"+d),d}if(a===(0|a)&&a>=2&&a<=36){var l=Ae[a],v=be[a];d="";var H=this.clone();for(H.negative=0;!H.isZero();){var J=H.modn(v).toString(a);d=(H=H.idivn(v)).isZero()?J+d:Ue[l-J.length]+J+d}for(this.isZero()&&(d="0"+d);d.length%u!=0;)d="0"+d;return 0!==this.negative&&(d="-"+d),d}z(!1,"Base should be between 2 and 36")},x.prototype.toNumber=function(){var a=this.words[0];return 2===this.length?a+=67108864*this.words[1]:3===this.length&&1===this.words[2]?a+=4503599627370496+67108864*this.words[1]:this.length>2&&z(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-a:a},x.prototype.toJSON=function(){return this.toString(16)},x.prototype.toBuffer=function(a,u){return z(typeof oe<"u"),this.toArrayLike(oe,a,u)},x.prototype.toArray=function(a,u){return this.toArrayLike(Array,a,u)},x.prototype.toArrayLike=function(a,u,d){var p=this.byteLength(),y=d||Math.max(1,p);z(p<=y,"byte array longer than desired length"),z(y>0,"Requested array length <= 0"),this.strip();var m,l,E="le"===u,M=new a(y),v=this.clone();if(E){for(l=0;!v.isZero();l++)m=v.andln(255),v.iushrn(8),M[l]=m;for(;l<y;l++)M[l]=0}else{for(l=0;l<y-p;l++)M[l]=0;for(l=0;!v.isZero();l++)m=v.andln(255),v.iushrn(8),M[y-l-1]=m}return M},x.prototype._countBits=Math.clz32?function(a){return 32-Math.clz32(a)}:function(a){var u=a,d=0;return u>=4096&&(d+=13,u>>>=13),u>=64&&(d+=7,u>>>=7),u>=8&&(d+=4,u>>>=4),u>=2&&(d+=2,u>>>=2),d+u},x.prototype._zeroBits=function(a){if(0===a)return 26;var u=a,d=0;return 8191&u||(d+=13,u>>>=13),127&u||(d+=7,u>>>=7),15&u||(d+=4,u>>>=4),3&u||(d+=2,u>>>=2),1&u||d++,d},x.prototype.bitLength=function(){var u=this._countBits(this.words[this.length-1]);return 26*(this.length-1)+u},x.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,u=0;u<this.length;u++){var d=this._zeroBits(this.words[u]);if(a+=d,26!==d)break}return a},x.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},x.prototype.toTwos=function(a){return 0!==this.negative?this.abs().inotn(a).iaddn(1):this.clone()},x.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},x.prototype.isNeg=function(){return 0!==this.negative},x.prototype.neg=function(){return this.clone().ineg()},x.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},x.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var u=0;u<a.length;u++)this.words[u]=this.words[u]|a.words[u];return this.strip()},x.prototype.ior=function(a){return z(!(this.negative|a.negative)),this.iuor(a)},x.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},x.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},x.prototype.iuand=function(a){var u;u=this.length>a.length?a:this;for(var d=0;d<u.length;d++)this.words[d]=this.words[d]&a.words[d];return this.length=u.length,this.strip()},x.prototype.iand=function(a){return z(!(this.negative|a.negative)),this.iuand(a)},x.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},x.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},x.prototype.iuxor=function(a){var u,d;this.length>a.length?(u=this,d=a):(u=a,d=this);for(var p=0;p<d.length;p++)this.words[p]=u.words[p]^d.words[p];if(this!==u)for(;p<u.length;p++)this.words[p]=u.words[p];return this.length=u.length,this.strip()},x.prototype.ixor=function(a){return z(!(this.negative|a.negative)),this.iuxor(a)},x.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},x.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},x.prototype.inotn=function(a){z("number"==typeof a&&a>=0);var u=0|Math.ceil(a/26),d=a%26;this._expand(u),d>0&&u--;for(var p=0;p<u;p++)this.words[p]=67108863&~this.words[p];return d>0&&(this.words[p]=~this.words[p]&67108863>>26-d),this.strip()},x.prototype.notn=function(a){return this.clone().inotn(a)},x.prototype.setn=function(a,u){z("number"==typeof a&&a>=0);var d=a/26|0,p=a%26;return this._expand(d+1),this.words[d]=u?this.words[d]|1<<p:this.words[d]&~(1<<p),this.strip()},x.prototype.iadd=function(a){var u,d,p;if(0!==this.negative&&0===a.negative)return this.negative=0,u=this.isub(a),this.negative^=1,this._normSign();if(0===this.negative&&0!==a.negative)return a.negative=0,u=this.isub(a),a.negative=1,u._normSign();this.length>a.length?(d=this,p=a):(d=a,p=this);for(var y=0,E=0;E<p.length;E++)this.words[E]=67108863&(u=(0|d.words[E])+(0|p.words[E])+y),y=u>>>26;for(;0!==y&&E<d.length;E++)this.words[E]=67108863&(u=(0|d.words[E])+y),y=u>>>26;if(this.length=d.length,0!==y)this.words[this.length]=y,this.length++;else if(d!==this)for(;E<d.length;E++)this.words[E]=d.words[E];return this},x.prototype.add=function(a){var u;return 0!==a.negative&&0===this.negative?(a.negative=0,u=this.sub(a),a.negative^=1,u):0===a.negative&&0!==this.negative?(this.negative=0,u=a.sub(this),this.negative=1,u):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},x.prototype.isub=function(a){if(0!==a.negative){a.negative=0;var u=this.iadd(a);return a.negative=1,u._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var p,y,d=this.cmp(a);if(0===d)return this.negative=0,this.length=1,this.words[0]=0,this;d>0?(p=this,y=a):(p=a,y=this);for(var E=0,M=0;M<y.length;M++)E=(u=(0|p.words[M])-(0|y.words[M])+E)>>26,this.words[M]=67108863&u;for(;0!==E&&M<p.length;M++)E=(u=(0|p.words[M])+E)>>26,this.words[M]=67108863&u;if(0===E&&M<p.length&&p!==this)for(;M<p.length;M++)this.words[M]=p.words[M];return this.length=Math.max(this.length,M),p!==this&&(this.negative=1),this.strip()},x.prototype.sub=function(a){return this.clone().isub(a)};var K=function(a,u,d){var m,l,v,p=a.words,y=u.words,E=d.words,M=0,H=0|p[0],J=8191&H,ee=H>>>13,se=0|p[1],ce=8191&se,Te=se>>>13,Pt=0|p[2],fe=8191&Pt,_e=Pt>>>13,qn=0|p[3],et=8191&qn,je=qn>>>13,Dn=0|p[4],Se=8191&Dn,Pe=Dn>>>13,vn=0|p[5],We=8191&vn,tt=vn>>>13,yn=0|p[6],nt=8191&yn,rt=yn>>>13,en=0|p[7],Ve=8191&en,ze=en>>>13,Wn=0|p[8],Ye=8191&Wn,He=Wn>>>13,Rt=0|p[9],Ee=8191&Rt,Fe=Rt>>>13,Vn=0|y[0],xe=8191&Vn,it=Vn>>>13,wn=0|y[1],$e=8191&wn,Ze=wn>>>13,tn=0|y[2],Xe=8191&tn,Ce=tn>>>13,zn=0|y[3],Ge=8191&zn,Be=zn>>>13,mt=0|y[4],Oe=8191&mt,ke=mt>>>13,bn=0|y[5],ot=8191&bn,pe=bn>>>13,$t=0|y[6],st=8191&$t,at=$t>>>13,vr=0|y[7],lt=8191&vr,ct=vr>>>13,an=0|y[8],Le=8191&an,qe=an>>>13,_n=0|y[9],Ke=8191&_n,Ne=_n>>>13;d.negative=a.negative^u.negative,d.length=19;var De=(M+(m=Math.imul(J,xe))|0)+((8191&(l=(l=Math.imul(J,it))+Math.imul(ee,xe)|0))<<13)|0;M=((v=Math.imul(ee,it))+(l>>>13)|0)+(De>>>26)|0,De&=67108863,m=Math.imul(ce,xe),l=(l=Math.imul(ce,it))+Math.imul(Te,xe)|0,v=Math.imul(Te,it);var Me=(M+(m=m+Math.imul(J,$e)|0)|0)+((8191&(l=(l=l+Math.imul(J,Ze)|0)+Math.imul(ee,$e)|0))<<13)|0;M=((v=v+Math.imul(ee,Ze)|0)+(l>>>13)|0)+(Me>>>26)|0,Me&=67108863,m=Math.imul(fe,xe),l=(l=Math.imul(fe,it))+Math.imul(_e,xe)|0,v=Math.imul(_e,it),m=m+Math.imul(ce,$e)|0,l=(l=l+Math.imul(ce,Ze)|0)+Math.imul(Te,$e)|0,v=v+Math.imul(Te,Ze)|0;var St=(M+(m=m+Math.imul(J,Xe)|0)|0)+((8191&(l=(l=l+Math.imul(J,Ce)|0)+Math.imul(ee,Xe)|0))<<13)|0;M=((v=v+Math.imul(ee,Ce)|0)+(l>>>13)|0)+(St>>>26)|0,St&=67108863,m=Math.imul(et,xe),l=(l=Math.imul(et,it))+Math.imul(je,xe)|0,v=Math.imul(je,it),m=m+Math.imul(fe,$e)|0,l=(l=l+Math.imul(fe,Ze)|0)+Math.imul(_e,$e)|0,v=v+Math.imul(_e,Ze)|0,m=m+Math.imul(ce,Xe)|0,l=(l=l+Math.imul(ce,Ce)|0)+Math.imul(Te,Xe)|0,v=v+Math.imul(Te,Ce)|0;var xn=(M+(m=m+Math.imul(J,Ge)|0)|0)+((8191&(l=(l=l+Math.imul(J,Be)|0)+Math.imul(ee,Ge)|0))<<13)|0;M=((v=v+Math.imul(ee,Be)|0)+(l>>>13)|0)+(xn>>>26)|0,xn&=67108863,m=Math.imul(Se,xe),l=(l=Math.imul(Se,it))+Math.imul(Pe,xe)|0,v=Math.imul(Pe,it),m=m+Math.imul(et,$e)|0,l=(l=l+Math.imul(et,Ze)|0)+Math.imul(je,$e)|0,v=v+Math.imul(je,Ze)|0,m=m+Math.imul(fe,Xe)|0,l=(l=l+Math.imul(fe,Ce)|0)+Math.imul(_e,Xe)|0,v=v+Math.imul(_e,Ce)|0,m=m+Math.imul(ce,Ge)|0,l=(l=l+Math.imul(ce,Be)|0)+Math.imul(Te,Ge)|0,v=v+Math.imul(Te,Be)|0;var nn=(M+(m=m+Math.imul(J,Oe)|0)|0)+((8191&(l=(l=l+Math.imul(J,ke)|0)+Math.imul(ee,Oe)|0))<<13)|0;M=((v=v+Math.imul(ee,ke)|0)+(l>>>13)|0)+(nn>>>26)|0,nn&=67108863,m=Math.imul(We,xe),l=(l=Math.imul(We,it))+Math.imul(tt,xe)|0,v=Math.imul(tt,it),m=m+Math.imul(Se,$e)|0,l=(l=l+Math.imul(Se,Ze)|0)+Math.imul(Pe,$e)|0,v=v+Math.imul(Pe,Ze)|0,m=m+Math.imul(et,Xe)|0,l=(l=l+Math.imul(et,Ce)|0)+Math.imul(je,Xe)|0,v=v+Math.imul(je,Ce)|0,m=m+Math.imul(fe,Ge)|0,l=(l=l+Math.imul(fe,Be)|0)+Math.imul(_e,Ge)|0,v=v+Math.imul(_e,Be)|0,m=m+Math.imul(ce,Oe)|0,l=(l=l+Math.imul(ce,ke)|0)+Math.imul(Te,Oe)|0,v=v+Math.imul(Te,ke)|0;var ln=(M+(m=m+Math.imul(J,ot)|0)|0)+((8191&(l=(l=l+Math.imul(J,pe)|0)+Math.imul(ee,ot)|0))<<13)|0;M=((v=v+Math.imul(ee,pe)|0)+(l>>>13)|0)+(ln>>>26)|0,ln&=67108863,m=Math.imul(nt,xe),l=(l=Math.imul(nt,it))+Math.imul(rt,xe)|0,v=Math.imul(rt,it),m=m+Math.imul(We,$e)|0,l=(l=l+Math.imul(We,Ze)|0)+Math.imul(tt,$e)|0,v=v+Math.imul(tt,Ze)|0,m=m+Math.imul(Se,Xe)|0,l=(l=l+Math.imul(Se,Ce)|0)+Math.imul(Pe,Xe)|0,v=v+Math.imul(Pe,Ce)|0,m=m+Math.imul(et,Ge)|0,l=(l=l+Math.imul(et,Be)|0)+Math.imul(je,Ge)|0,v=v+Math.imul(je,Be)|0,m=m+Math.imul(fe,Oe)|0,l=(l=l+Math.imul(fe,ke)|0)+Math.imul(_e,Oe)|0,v=v+Math.imul(_e,ke)|0,m=m+Math.imul(ce,ot)|0,l=(l=l+Math.imul(ce,pe)|0)+Math.imul(Te,ot)|0,v=v+Math.imul(Te,pe)|0;var cn=(M+(m=m+Math.imul(J,st)|0)|0)+((8191&(l=(l=l+Math.imul(J,at)|0)+Math.imul(ee,st)|0))<<13)|0;M=((v=v+Math.imul(ee,at)|0)+(l>>>13)|0)+(cn>>>26)|0,cn&=67108863,m=Math.imul(Ve,xe),l=(l=Math.imul(Ve,it))+Math.imul(ze,xe)|0,v=Math.imul(ze,it),m=m+Math.imul(nt,$e)|0,l=(l=l+Math.imul(nt,Ze)|0)+Math.imul(rt,$e)|0,v=v+Math.imul(rt,Ze)|0,m=m+Math.imul(We,Xe)|0,l=(l=l+Math.imul(We,Ce)|0)+Math.imul(tt,Xe)|0,v=v+Math.imul(tt,Ce)|0,m=m+Math.imul(Se,Ge)|0,l=(l=l+Math.imul(Se,Be)|0)+Math.imul(Pe,Ge)|0,v=v+Math.imul(Pe,Be)|0,m=m+Math.imul(et,Oe)|0,l=(l=l+Math.imul(et,ke)|0)+Math.imul(je,Oe)|0,v=v+Math.imul(je,ke)|0,m=m+Math.imul(fe,ot)|0,l=(l=l+Math.imul(fe,pe)|0)+Math.imul(_e,ot)|0,v=v+Math.imul(_e,pe)|0,m=m+Math.imul(ce,st)|0,l=(l=l+Math.imul(ce,at)|0)+Math.imul(Te,st)|0,v=v+Math.imul(Te,at)|0;var En=(M+(m=m+Math.imul(J,lt)|0)|0)+((8191&(l=(l=l+Math.imul(J,ct)|0)+Math.imul(ee,lt)|0))<<13)|0;M=((v=v+Math.imul(ee,ct)|0)+(l>>>13)|0)+(En>>>26)|0,En&=67108863,m=Math.imul(Ye,xe),l=(l=Math.imul(Ye,it))+Math.imul(He,xe)|0,v=Math.imul(He,it),m=m+Math.imul(Ve,$e)|0,l=(l=l+Math.imul(Ve,Ze)|0)+Math.imul(ze,$e)|0,v=v+Math.imul(ze,Ze)|0,m=m+Math.imul(nt,Xe)|0,l=(l=l+Math.imul(nt,Ce)|0)+Math.imul(rt,Xe)|0,v=v+Math.imul(rt,Ce)|0,m=m+Math.imul(We,Ge)|0,l=(l=l+Math.imul(We,Be)|0)+Math.imul(tt,Ge)|0,v=v+Math.imul(tt,Be)|0,m=m+Math.imul(Se,Oe)|0,l=(l=l+Math.imul(Se,ke)|0)+Math.imul(Pe,Oe)|0,v=v+Math.imul(Pe,ke)|0,m=m+Math.imul(et,ot)|0,l=(l=l+Math.imul(et,pe)|0)+Math.imul(je,ot)|0,v=v+Math.imul(je,pe)|0,m=m+Math.imul(fe,st)|0,l=(l=l+Math.imul(fe,at)|0)+Math.imul(_e,st)|0,v=v+Math.imul(_e,at)|0,m=m+Math.imul(ce,lt)|0,l=(l=l+Math.imul(ce,ct)|0)+Math.imul(Te,lt)|0,v=v+Math.imul(Te,ct)|0;var kn=(M+(m=m+Math.imul(J,Le)|0)|0)+((8191&(l=(l=l+Math.imul(J,qe)|0)+Math.imul(ee,Le)|0))<<13)|0;M=((v=v+Math.imul(ee,qe)|0)+(l>>>13)|0)+(kn>>>26)|0,kn&=67108863,m=Math.imul(Ee,xe),l=(l=Math.imul(Ee,it))+Math.imul(Fe,xe)|0,v=Math.imul(Fe,it),m=m+Math.imul(Ye,$e)|0,l=(l=l+Math.imul(Ye,Ze)|0)+Math.imul(He,$e)|0,v=v+Math.imul(He,Ze)|0,m=m+Math.imul(Ve,Xe)|0,l=(l=l+Math.imul(Ve,Ce)|0)+Math.imul(ze,Xe)|0,v=v+Math.imul(ze,Ce)|0,m=m+Math.imul(nt,Ge)|0,l=(l=l+Math.imul(nt,Be)|0)+Math.imul(rt,Ge)|0,v=v+Math.imul(rt,Be)|0,m=m+Math.imul(We,Oe)|0,l=(l=l+Math.imul(We,ke)|0)+Math.imul(tt,Oe)|0,v=v+Math.imul(tt,ke)|0,m=m+Math.imul(Se,ot)|0,l=(l=l+Math.imul(Se,pe)|0)+Math.imul(Pe,ot)|0,v=v+Math.imul(Pe,pe)|0,m=m+Math.imul(et,st)|0,l=(l=l+Math.imul(et,at)|0)+Math.imul(je,st)|0,v=v+Math.imul(je,at)|0,m=m+Math.imul(fe,lt)|0,l=(l=l+Math.imul(fe,ct)|0)+Math.imul(_e,lt)|0,v=v+Math.imul(_e,ct)|0,m=m+Math.imul(ce,Le)|0,l=(l=l+Math.imul(ce,qe)|0)+Math.imul(Te,Le)|0,v=v+Math.imul(Te,qe)|0;var Je=(M+(m=m+Math.imul(J,Ke)|0)|0)+((8191&(l=(l=l+Math.imul(J,Ne)|0)+Math.imul(ee,Ke)|0))<<13)|0;M=((v=v+Math.imul(ee,Ne)|0)+(l>>>13)|0)+(Je>>>26)|0,Je&=67108863,m=Math.imul(Ee,$e),l=(l=Math.imul(Ee,Ze))+Math.imul(Fe,$e)|0,v=Math.imul(Fe,Ze),m=m+Math.imul(Ye,Xe)|0,l=(l=l+Math.imul(Ye,Ce)|0)+Math.imul(He,Xe)|0,v=v+Math.imul(He,Ce)|0,m=m+Math.imul(Ve,Ge)|0,l=(l=l+Math.imul(Ve,Be)|0)+Math.imul(ze,Ge)|0,v=v+Math.imul(ze,Be)|0,m=m+Math.imul(nt,Oe)|0,l=(l=l+Math.imul(nt,ke)|0)+Math.imul(rt,Oe)|0,v=v+Math.imul(rt,ke)|0,m=m+Math.imul(We,ot)|0,l=(l=l+Math.imul(We,pe)|0)+Math.imul(tt,ot)|0,v=v+Math.imul(tt,pe)|0,m=m+Math.imul(Se,st)|0,l=(l=l+Math.imul(Se,at)|0)+Math.imul(Pe,st)|0,v=v+Math.imul(Pe,at)|0,m=m+Math.imul(et,lt)|0,l=(l=l+Math.imul(et,ct)|0)+Math.imul(je,lt)|0,v=v+Math.imul(je,ct)|0,m=m+Math.imul(fe,Le)|0,l=(l=l+Math.imul(fe,qe)|0)+Math.imul(_e,Le)|0,v=v+Math.imul(_e,qe)|0;var Mn=(M+(m=m+Math.imul(ce,Ke)|0)|0)+((8191&(l=(l=l+Math.imul(ce,Ne)|0)+Math.imul(Te,Ke)|0))<<13)|0;M=((v=v+Math.imul(Te,Ne)|0)+(l>>>13)|0)+(Mn>>>26)|0,Mn&=67108863,m=Math.imul(Ee,Xe),l=(l=Math.imul(Ee,Ce))+Math.imul(Fe,Xe)|0,v=Math.imul(Fe,Ce),m=m+Math.imul(Ye,Ge)|0,l=(l=l+Math.imul(Ye,Be)|0)+Math.imul(He,Ge)|0,v=v+Math.imul(He,Be)|0,m=m+Math.imul(Ve,Oe)|0,l=(l=l+Math.imul(Ve,ke)|0)+Math.imul(ze,Oe)|0,v=v+Math.imul(ze,ke)|0,m=m+Math.imul(nt,ot)|0,l=(l=l+Math.imul(nt,pe)|0)+Math.imul(rt,ot)|0,v=v+Math.imul(rt,pe)|0,m=m+Math.imul(We,st)|0,l=(l=l+Math.imul(We,at)|0)+Math.imul(tt,st)|0,v=v+Math.imul(tt,at)|0,m=m+Math.imul(Se,lt)|0,l=(l=l+Math.imul(Se,ct)|0)+Math.imul(Pe,lt)|0,v=v+Math.imul(Pe,ct)|0,m=m+Math.imul(et,Le)|0,l=(l=l+Math.imul(et,qe)|0)+Math.imul(je,Le)|0,v=v+Math.imul(je,qe)|0;var wt=(M+(m=m+Math.imul(fe,Ke)|0)|0)+((8191&(l=(l=l+Math.imul(fe,Ne)|0)+Math.imul(_e,Ke)|0))<<13)|0;M=((v=v+Math.imul(_e,Ne)|0)+(l>>>13)|0)+(wt>>>26)|0,wt&=67108863,m=Math.imul(Ee,Ge),l=(l=Math.imul(Ee,Be))+Math.imul(Fe,Ge)|0,v=Math.imul(Fe,Be),m=m+Math.imul(Ye,Oe)|0,l=(l=l+Math.imul(Ye,ke)|0)+Math.imul(He,Oe)|0,v=v+Math.imul(He,ke)|0,m=m+Math.imul(Ve,ot)|0,l=(l=l+Math.imul(Ve,pe)|0)+Math.imul(ze,ot)|0,v=v+Math.imul(ze,pe)|0,m=m+Math.imul(nt,st)|0,l=(l=l+Math.imul(nt,at)|0)+Math.imul(rt,st)|0,v=v+Math.imul(rt,at)|0,m=m+Math.imul(We,lt)|0,l=(l=l+Math.imul(We,ct)|0)+Math.imul(tt,lt)|0,v=v+Math.imul(tt,ct)|0,m=m+Math.imul(Se,Le)|0,l=(l=l+Math.imul(Se,qe)|0)+Math.imul(Pe,Le)|0,v=v+Math.imul(Pe,qe)|0;var Zt=(M+(m=m+Math.imul(et,Ke)|0)|0)+((8191&(l=(l=l+Math.imul(et,Ne)|0)+Math.imul(je,Ke)|0))<<13)|0;M=((v=v+Math.imul(je,Ne)|0)+(l>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,m=Math.imul(Ee,Oe),l=(l=Math.imul(Ee,ke))+Math.imul(Fe,Oe)|0,v=Math.imul(Fe,ke),m=m+Math.imul(Ye,ot)|0,l=(l=l+Math.imul(Ye,pe)|0)+Math.imul(He,ot)|0,v=v+Math.imul(He,pe)|0,m=m+Math.imul(Ve,st)|0,l=(l=l+Math.imul(Ve,at)|0)+Math.imul(ze,st)|0,v=v+Math.imul(ze,at)|0,m=m+Math.imul(nt,lt)|0,l=(l=l+Math.imul(nt,ct)|0)+Math.imul(rt,lt)|0,v=v+Math.imul(rt,ct)|0,m=m+Math.imul(We,Le)|0,l=(l=l+Math.imul(We,qe)|0)+Math.imul(tt,Le)|0,v=v+Math.imul(tt,qe)|0;var Sn=(M+(m=m+Math.imul(Se,Ke)|0)|0)+((8191&(l=(l=l+Math.imul(Se,Ne)|0)+Math.imul(Pe,Ke)|0))<<13)|0;M=((v=v+Math.imul(Pe,Ne)|0)+(l>>>13)|0)+(Sn>>>26)|0,Sn&=67108863,m=Math.imul(Ee,ot),l=(l=Math.imul(Ee,pe))+Math.imul(Fe,ot)|0,v=Math.imul(Fe,pe),m=m+Math.imul(Ye,st)|0,l=(l=l+Math.imul(Ye,at)|0)+Math.imul(He,st)|0,v=v+Math.imul(He,at)|0,m=m+Math.imul(Ve,lt)|0,l=(l=l+Math.imul(Ve,ct)|0)+Math.imul(ze,lt)|0,v=v+Math.imul(ze,ct)|0,m=m+Math.imul(nt,Le)|0,l=(l=l+Math.imul(nt,qe)|0)+Math.imul(rt,Le)|0,v=v+Math.imul(rt,qe)|0;var An=(M+(m=m+Math.imul(We,Ke)|0)|0)+((8191&(l=(l=l+Math.imul(We,Ne)|0)+Math.imul(tt,Ke)|0))<<13)|0;M=((v=v+Math.imul(tt,Ne)|0)+(l>>>13)|0)+(An>>>26)|0,An&=67108863,m=Math.imul(Ee,st),l=(l=Math.imul(Ee,at))+Math.imul(Fe,st)|0,v=Math.imul(Fe,at),m=m+Math.imul(Ye,lt)|0,l=(l=l+Math.imul(Ye,ct)|0)+Math.imul(He,lt)|0,v=v+Math.imul(He,ct)|0,m=m+Math.imul(Ve,Le)|0,l=(l=l+Math.imul(Ve,qe)|0)+Math.imul(ze,Le)|0,v=v+Math.imul(ze,qe)|0;var Yn=(M+(m=m+Math.imul(nt,Ke)|0)|0)+((8191&(l=(l=l+Math.imul(nt,Ne)|0)+Math.imul(rt,Ke)|0))<<13)|0;M=((v=v+Math.imul(rt,Ne)|0)+(l>>>13)|0)+(Yn>>>26)|0,Yn&=67108863,m=Math.imul(Ee,lt),l=(l=Math.imul(Ee,ct))+Math.imul(Fe,lt)|0,v=Math.imul(Fe,ct),m=m+Math.imul(Ye,Le)|0,l=(l=l+Math.imul(Ye,qe)|0)+Math.imul(He,Le)|0,v=v+Math.imul(He,qe)|0;var In=(M+(m=m+Math.imul(Ve,Ke)|0)|0)+((8191&(l=(l=l+Math.imul(Ve,Ne)|0)+Math.imul(ze,Ke)|0))<<13)|0;M=((v=v+Math.imul(ze,Ne)|0)+(l>>>13)|0)+(In>>>26)|0,In&=67108863,m=Math.imul(Ee,Le),l=(l=Math.imul(Ee,qe))+Math.imul(Fe,Le)|0,v=Math.imul(Fe,qe);var Rn=(M+(m=m+Math.imul(Ye,Ke)|0)|0)+((8191&(l=(l=l+Math.imul(Ye,Ne)|0)+Math.imul(He,Ke)|0))<<13)|0;M=((v=v+Math.imul(He,Ne)|0)+(l>>>13)|0)+(Rn>>>26)|0,Rn&=67108863;var Tn=(M+(m=Math.imul(Ee,Ke))|0)+((8191&(l=(l=Math.imul(Ee,Ne))+Math.imul(Fe,Ke)|0))<<13)|0;return M=((v=Math.imul(Fe,Ne))+(l>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,E[0]=De,E[1]=Me,E[2]=St,E[3]=xn,E[4]=nn,E[5]=ln,E[6]=cn,E[7]=En,E[8]=kn,E[9]=Je,E[10]=Mn,E[11]=wt,E[12]=Zt,E[13]=Sn,E[14]=An,E[15]=Yn,E[16]=In,E[17]=Rn,E[18]=Tn,0!==M&&(E[19]=M,d.length++),d};function le(w,a,u){return(new he).mulp(w,a,u)}function he(w,a){this.x=w,this.y=a}Math.imul||(K=q),x.prototype.mulTo=function(a,u){var d,p=this.length+a.length;return d=10===this.length&&10===a.length?K(this,a,u):p<63?q(this,a,u):p<1024?function we(w,a,u){u.negative=a.negative^w.negative,u.length=w.length+a.length;for(var d=0,p=0,y=0;y<u.length-1;y++){var E=p;p=0;for(var M=67108863&d,m=Math.min(y,a.length-1),l=Math.max(0,y-w.length+1);l<=m;l++){var ee=(0|w.words[y-l])*(0|a.words[l]),se=67108863&ee;M=67108863&(se=se+M|0),p+=(E=(E=E+(ee/67108864|0)|0)+(se>>>26)|0)>>>26,E&=67108863}u.words[y]=M,d=E,E=p}return 0!==d?u.words[y]=d:u.length--,u.strip()}(this,a,u):le(this,a,u),d},he.prototype.makeRBT=function(a){for(var u=new Array(a),d=x.prototype._countBits(a)-1,p=0;p<a;p++)u[p]=this.revBin(p,d,a);return u},he.prototype.revBin=function(a,u,d){if(0===a||a===d-1)return a;for(var p=0,y=0;y<u;y++)p|=(1&a)<<u-y-1,a>>=1;return p},he.prototype.permute=function(a,u,d,p,y,E){for(var M=0;M<E;M++)p[M]=u[a[M]],y[M]=d[a[M]]},he.prototype.transform=function(a,u,d,p,y,E){this.permute(E,a,u,d,p,y);for(var M=1;M<y;M<<=1)for(var m=M<<1,l=Math.cos(2*Math.PI/m),v=Math.sin(2*Math.PI/m),H=0;H<y;H+=m)for(var J=l,ee=v,se=0;se<M;se++){var ce=d[H+se],Te=p[H+se],Pt=d[H+se+M],fe=p[H+se+M],_e=J*Pt-ee*fe;fe=J*fe+ee*Pt,d[H+se]=ce+(Pt=_e),p[H+se]=Te+fe,d[H+se+M]=ce-Pt,p[H+se+M]=Te-fe,se!==m&&(_e=l*J-v*ee,ee=l*ee+v*J,J=_e)}},he.prototype.guessLen13b=function(a,u){var d=1|Math.max(u,a),p=1&d,y=0;for(d=d/2|0;d;d>>>=1)y++;return 1<<y+1+p},he.prototype.conjugate=function(a,u,d){if(!(d<=1))for(var p=0;p<d/2;p++){var y=a[p];a[p]=a[d-p-1],a[d-p-1]=y,y=u[p],u[p]=-u[d-p-1],u[d-p-1]=-y}},he.prototype.normalize13b=function(a,u){for(var d=0,p=0;p<u/2;p++){var y=8192*Math.round(a[2*p+1]/u)+Math.round(a[2*p]/u)+d;a[p]=67108863&y,d=y<67108864?0:y/67108864|0}return a},he.prototype.convert13b=function(a,u,d,p){for(var y=0,E=0;E<u;E++)d[2*E]=8191&(y+=0|a[E]),d[2*E+1]=8191&(y>>>=13),y>>>=13;for(E=2*u;E<p;++E)d[E]=0;z(0===y),z(!(-8192&y))},he.prototype.stub=function(a){for(var u=new Array(a),d=0;d<a;d++)u[d]=0;return u},he.prototype.mulp=function(a,u,d){var p=2*this.guessLen13b(a.length,u.length),y=this.makeRBT(p),E=this.stub(p),M=new Array(p),m=new Array(p),l=new Array(p),v=new Array(p),H=new Array(p),J=new Array(p),ee=d.words;ee.length=p,this.convert13b(a.words,a.length,M,p),this.convert13b(u.words,u.length,v,p),this.transform(M,E,m,l,p,y),this.transform(v,E,H,J,p,y);for(var se=0;se<p;se++){var ce=m[se]*H[se]-l[se]*J[se];l[se]=m[se]*J[se]+l[se]*H[se],m[se]=ce}return this.conjugate(m,l,p),this.transform(m,l,ee,E,p,y),this.conjugate(ee,E,p),this.normalize13b(ee,p),d.negative=a.negative^u.negative,d.length=a.length+u.length,d.strip()},x.prototype.mul=function(a){var u=new x(null);return u.words=new Array(this.length+a.length),this.mulTo(a,u)},x.prototype.mulf=function(a){var u=new x(null);return u.words=new Array(this.length+a.length),le(this,a,u)},x.prototype.imul=function(a){return this.clone().mulTo(a,this)},x.prototype.imuln=function(a){z("number"==typeof a),z(a<67108864);for(var u=0,d=0;d<this.length;d++){var p=(0|this.words[d])*a,y=(67108863&p)+(67108863&u);u>>=26,u+=p/67108864|0,u+=y>>>26,this.words[d]=67108863&y}return 0!==u&&(this.words[d]=u,this.length++),this},x.prototype.muln=function(a){return this.clone().imuln(a)},x.prototype.sqr=function(){return this.mul(this)},x.prototype.isqr=function(){return this.imul(this.clone())},x.prototype.pow=function(a){var u=function bt(w){for(var a=new Array(w.bitLength()),u=0;u<a.length;u++){var p=u%26;a[u]=(w.words[u/26|0]&1<<p)>>>p}return a}(a);if(0===u.length)return new x(1);for(var d=this,p=0;p<u.length&&0===u[p];p++,d=d.sqr());if(++p<u.length)for(var y=d.sqr();p<u.length;p++,y=y.sqr())0!==u[p]&&(d=d.mul(y));return d},x.prototype.iushln=function(a){z("number"==typeof a&&a>=0);var y,u=a%26,d=(a-u)/26,p=67108863>>>26-u<<26-u;if(0!==u){var E=0;for(y=0;y<this.length;y++){var M=this.words[y]&p;this.words[y]=(0|this.words[y])-M<<u|E,E=M>>>26-u}E&&(this.words[y]=E,this.length++)}if(0!==d){for(y=this.length-1;y>=0;y--)this.words[y+d]=this.words[y];for(y=0;y<d;y++)this.words[y]=0;this.length+=d}return this.strip()},x.prototype.ishln=function(a){return z(0===this.negative),this.iushln(a)},x.prototype.iushrn=function(a,u,d){var p;z("number"==typeof a&&a>=0),p=u?(u-u%26)/26:0;var y=a%26,E=Math.min((a-y)/26,this.length),M=67108863^67108863>>>y<<y,m=d;if(p-=E,p=Math.max(0,p),m){for(var l=0;l<E;l++)m.words[l]=this.words[l];m.length=E}if(0!==E)if(this.length>E)for(this.length-=E,l=0;l<this.length;l++)this.words[l]=this.words[l+E];else this.words[0]=0,this.length=1;var v=0;for(l=this.length-1;l>=0&&(0!==v||l>=p);l--){var H=0|this.words[l];this.words[l]=v<<26-y|H>>>y,v=H&M}return m&&0!==v&&(m.words[m.length++]=v),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},x.prototype.ishrn=function(a,u,d){return z(0===this.negative),this.iushrn(a,u,d)},x.prototype.shln=function(a){return this.clone().ishln(a)},x.prototype.ushln=function(a){return this.clone().iushln(a)},x.prototype.shrn=function(a){return this.clone().ishrn(a)},x.prototype.ushrn=function(a){return this.clone().iushrn(a)},x.prototype.testn=function(a){z("number"==typeof a&&a>=0);var u=a%26,d=(a-u)/26;return!(this.length<=d||!(this.words[d]&1<<u))},x.prototype.imaskn=function(a){z("number"==typeof a&&a>=0);var u=a%26,d=(a-u)/26;return z(0===this.negative,"imaskn works only with positive numbers"),this.length<=d?this:(0!==u&&d++,this.length=Math.min(d,this.length),0!==u&&(this.words[this.length-1]&=67108863^67108863>>>u<<u),this.strip())},x.prototype.maskn=function(a){return this.clone().imaskn(a)},x.prototype.iaddn=function(a){return z("number"==typeof a),z(a<67108864),a<0?this.isubn(-a):0!==this.negative?1===this.length&&(0|this.words[0])<a?(this.words[0]=a-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},x.prototype._iaddn=function(a){this.words[0]+=a;for(var u=0;u<this.length&&this.words[u]>=67108864;u++)this.words[u]-=67108864,u===this.length-1?this.words[u+1]=1:this.words[u+1]++;return this.length=Math.max(this.length,u+1),this},x.prototype.isubn=function(a){if(z("number"==typeof a),z(a<67108864),a<0)return this.iaddn(-a);if(0!==this.negative)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var u=0;u<this.length&&this.words[u]<0;u++)this.words[u]+=67108864,this.words[u+1]-=1;return this.strip()},x.prototype.addn=function(a){return this.clone().iaddn(a)},x.prototype.subn=function(a){return this.clone().isubn(a)},x.prototype.iabs=function(){return this.negative=0,this},x.prototype.abs=function(){return this.clone().iabs()},x.prototype._ishlnsubmul=function(a,u,d){var y;this._expand(a.length+d);var E,M=0;for(y=0;y<a.length;y++){E=(0|this.words[y+d])+M;var m=(0|a.words[y])*u;M=((E-=67108863&m)>>26)-(m/67108864|0),this.words[y+d]=67108863&E}for(;y<this.length-d;y++)M=(E=(0|this.words[y+d])+M)>>26,this.words[y+d]=67108863&E;if(0===M)return this.strip();for(z(-1===M),M=0,y=0;y<this.length;y++)M=(E=-(0|this.words[y])+M)>>26,this.words[y]=67108863&E;return this.negative=1,this.strip()},x.prototype._wordDiv=function(a,u){var d,p=this.clone(),y=a,E=0|y.words[y.length-1];0!=(d=26-this._countBits(E))&&(y=y.ushln(d),p.iushln(d),E=0|y.words[y.length-1]);var l,m=p.length-y.length;if("mod"!==u){(l=new x(null)).length=m+1,l.words=new Array(l.length);for(var v=0;v<l.length;v++)l.words[v]=0}var H=p.clone()._ishlnsubmul(y,1,m);0===H.negative&&(p=H,l&&(l.words[m]=1));for(var J=m-1;J>=0;J--){var ee=67108864*(0|p.words[y.length+J])+(0|p.words[y.length+J-1]);for(ee=Math.min(ee/E|0,67108863),p._ishlnsubmul(y,ee,J);0!==p.negative;)ee--,p.negative=0,p._ishlnsubmul(y,1,J),p.isZero()||(p.negative^=1);l&&(l.words[J]=ee)}return l&&l.strip(),p.strip(),"div"!==u&&0!==d&&p.iushrn(d),{div:l||null,mod:p}},x.prototype.divmod=function(a,u,d){return z(!a.isZero()),this.isZero()?{div:new x(0),mod:new x(0)}:0!==this.negative&&0===a.negative?(E=this.neg().divmod(a,u),"mod"!==u&&(p=E.div.neg()),"div"!==u&&(y=E.mod.neg(),d&&0!==y.negative&&y.iadd(a)),{div:p,mod:y}):0===this.negative&&0!==a.negative?(E=this.divmod(a.neg(),u),"mod"!==u&&(p=E.div.neg()),{div:p,mod:E.mod}):this.negative&a.negative?(E=this.neg().divmod(a.neg(),u),"div"!==u&&(y=E.mod.neg(),d&&0!==y.negative&&y.isub(a)),{div:E.div,mod:y}):a.length>this.length||this.cmp(a)<0?{div:new x(0),mod:this}:1===a.length?"div"===u?{div:this.divn(a.words[0]),mod:null}:"mod"===u?{div:null,mod:new x(this.modn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new x(this.modn(a.words[0]))}:this._wordDiv(a,u);var p,y,E},x.prototype.div=function(a){return this.divmod(a,"div",!1).div},x.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},x.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},x.prototype.divRound=function(a){var u=this.divmod(a);if(u.mod.isZero())return u.div;var d=0!==u.div.negative?u.mod.isub(a):u.mod,p=a.ushrn(1),y=a.andln(1),E=d.cmp(p);return E<0||1===y&&0===E?u.div:0!==u.div.negative?u.div.isubn(1):u.div.iaddn(1)},x.prototype.modn=function(a){z(a<=67108863);for(var u=(1<<26)%a,d=0,p=this.length-1;p>=0;p--)d=(u*d+(0|this.words[p]))%a;return d},x.prototype.idivn=function(a){z(a<=67108863);for(var u=0,d=this.length-1;d>=0;d--){var p=(0|this.words[d])+67108864*u;this.words[d]=p/a|0,u=p%a}return this.strip()},x.prototype.divn=function(a){return this.clone().idivn(a)},x.prototype.egcd=function(a){z(0===a.negative),z(!a.isZero());var u=this,d=a.clone();u=0!==u.negative?u.umod(a):u.clone();for(var p=new x(1),y=new x(0),E=new x(0),M=new x(1),m=0;u.isEven()&&d.isEven();)u.iushrn(1),d.iushrn(1),++m;for(var l=d.clone(),v=u.clone();!u.isZero();){for(var H=0,J=1;!(u.words[0]&J)&&H<26;++H,J<<=1);if(H>0)for(u.iushrn(H);H-- >0;)(p.isOdd()||y.isOdd())&&(p.iadd(l),y.isub(v)),p.iushrn(1),y.iushrn(1);for(var ee=0,se=1;!(d.words[0]&se)&&ee<26;++ee,se<<=1);if(ee>0)for(d.iushrn(ee);ee-- >0;)(E.isOdd()||M.isOdd())&&(E.iadd(l),M.isub(v)),E.iushrn(1),M.iushrn(1);u.cmp(d)>=0?(u.isub(d),p.isub(E),y.isub(M)):(d.isub(u),E.isub(p),M.isub(y))}return{a:E,b:M,gcd:d.iushln(m)}},x.prototype._invmp=function(a){z(0===a.negative),z(!a.isZero());var H,u=this,d=a.clone();u=0!==u.negative?u.umod(a):u.clone();for(var p=new x(1),y=new x(0),E=d.clone();u.cmpn(1)>0&&d.cmpn(1)>0;){for(var M=0,m=1;!(u.words[0]&m)&&M<26;++M,m<<=1);if(M>0)for(u.iushrn(M);M-- >0;)p.isOdd()&&p.iadd(E),p.iushrn(1);for(var l=0,v=1;!(d.words[0]&v)&&l<26;++l,v<<=1);if(l>0)for(d.iushrn(l);l-- >0;)y.isOdd()&&y.iadd(E),y.iushrn(1);u.cmp(d)>=0?(u.isub(d),p.isub(y)):(d.isub(u),y.isub(p))}return(H=0===u.cmpn(1)?p:y).cmpn(0)<0&&H.iadd(a),H},x.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var u=this.clone(),d=a.clone();u.negative=0,d.negative=0;for(var p=0;u.isEven()&&d.isEven();p++)u.iushrn(1),d.iushrn(1);for(;;){for(;u.isEven();)u.iushrn(1);for(;d.isEven();)d.iushrn(1);var y=u.cmp(d);if(y<0){var E=u;u=d,d=E}else if(0===y||0===d.cmpn(1))break;u.isub(d)}return d.iushln(p)},x.prototype.invm=function(a){return this.egcd(a).a.umod(a)},x.prototype.isEven=function(){return!(1&this.words[0])},x.prototype.isOdd=function(){return!(1&~this.words[0])},x.prototype.andln=function(a){return this.words[0]&a},x.prototype.bincn=function(a){z("number"==typeof a);var u=a%26,d=(a-u)/26,p=1<<u;if(this.length<=d)return this._expand(d+1),this.words[d]|=p,this;for(var y=p,E=d;0!==y&&E<this.length;E++){var M=0|this.words[E];y=(M+=y)>>>26,this.words[E]=M&=67108863}return 0!==y&&(this.words[E]=y,this.length++),this},x.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},x.prototype.cmpn=function(a){var d,u=a<0;if(0!==this.negative&&!u)return-1;if(0===this.negative&&u)return 1;if(this.strip(),this.length>1)d=1;else{u&&(a=-a),z(a<=67108863,"Number is too big");var p=0|this.words[0];d=p===a?0:p<a?-1:1}return 0!==this.negative?0|-d:d},x.prototype.cmp=function(a){if(0!==this.negative&&0===a.negative)return-1;if(0===this.negative&&0!==a.negative)return 1;var u=this.ucmp(a);return 0!==this.negative?0|-u:u},x.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var u=0,d=this.length-1;d>=0;d--){var p=0|this.words[d],y=0|a.words[d];if(p!==y){p<y?u=-1:p>y&&(u=1);break}}return u},x.prototype.gtn=function(a){return 1===this.cmpn(a)},x.prototype.gt=function(a){return 1===this.cmp(a)},x.prototype.gten=function(a){return this.cmpn(a)>=0},x.prototype.gte=function(a){return this.cmp(a)>=0},x.prototype.ltn=function(a){return-1===this.cmpn(a)},x.prototype.lt=function(a){return-1===this.cmp(a)},x.prototype.lten=function(a){return this.cmpn(a)<=0},x.prototype.lte=function(a){return this.cmp(a)<=0},x.prototype.eqn=function(a){return 0===this.cmpn(a)},x.prototype.eq=function(a){return 0===this.cmp(a)},x.red=function(a){return new Re(a)},x.prototype.toRed=function(a){return z(!this.red,"Already a number in reduction context"),z(0===this.negative,"red works only with positives"),a.convertTo(this)._forceRed(a)},x.prototype.fromRed=function(){return z(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},x.prototype._forceRed=function(a){return this.red=a,this},x.prototype.forceRed=function(a){return z(!this.red,"Already a number in reduction context"),this._forceRed(a)},x.prototype.redAdd=function(a){return z(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},x.prototype.redIAdd=function(a){return z(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},x.prototype.redSub=function(a){return z(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},x.prototype.redISub=function(a){return z(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},x.prototype.redShl=function(a){return z(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},x.prototype.redMul=function(a){return z(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},x.prototype.redIMul=function(a){return z(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},x.prototype.redSqr=function(){return z(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},x.prototype.redISqr=function(){return z(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},x.prototype.redSqrt=function(){return z(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},x.prototype.redInvm=function(){return z(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},x.prototype.redNeg=function(){return z(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},x.prototype.redPow=function(a){return z(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var de={k256:null,p224:null,p192:null,p25519:null};function Ie(w,a){this.name=w,this.p=new x(a,16),this.n=this.p.bitLength(),this.k=new x(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function ut(){Ie.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function ft(){Ie.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function Ut(){Ie.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function Nt(){Ie.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function Re(w){if("string"==typeof w){var a=x._prime(w);this.m=a.p,this.prime=a}else z(w.gtn(1),"modulus must be greater than 1"),this.m=w,this.prime=null}function Dt(w){Re.call(this,w),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new x(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}Ie.prototype._tmp=function(){var a=new x(null);return a.words=new Array(Math.ceil(this.n/13)),a},Ie.prototype.ireduce=function(a){var d,u=a;do{this.split(u,this.tmp),d=(u=(u=this.imulK(u)).iadd(this.tmp)).bitLength()}while(d>this.n);var p=d<this.n?-1:u.ucmp(this.p);return 0===p?(u.words[0]=0,u.length=1):p>0?u.isub(this.p):void 0!==u.strip?u.strip():u._strip(),u},Ie.prototype.split=function(a,u){a.iushrn(this.n,0,u)},Ie.prototype.imulK=function(a){return a.imul(this.k)},yt(ut,Ie),ut.prototype.split=function(a,u){for(var d=4194303,p=Math.min(a.length,9),y=0;y<p;y++)u.words[y]=a.words[y];if(u.length=p,a.length<=9)return a.words[0]=0,void(a.length=1);var E=a.words[9];for(u.words[u.length++]=E&d,y=10;y<a.length;y++){var M=0|a.words[y];a.words[y-10]=(M&d)<<4|E>>>22,E=M}a.words[y-10]=E>>>=22,a.length-=0===E&&a.length>10?10:9},ut.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var u=0,d=0;d<a.length;d++){var p=0|a.words[d];a.words[d]=67108863&(u+=977*p),u=64*p+(u/67108864|0)}return 0===a.words[a.length-1]&&(a.length--,0===a.words[a.length-1]&&a.length--),a},yt(ft,Ie),yt(Ut,Ie),yt(Nt,Ie),Nt.prototype.imulK=function(a){for(var u=0,d=0;d<a.length;d++){var p=19*(0|a.words[d])+u,y=67108863&p;p>>>=26,a.words[d]=y,u=p}return 0!==u&&(a.words[a.length++]=u),a},x._prime=function(a){if(de[a])return de[a];var u;if("k256"===a)u=new ut;else if("p224"===a)u=new ft;else if("p192"===a)u=new Ut;else{if("p25519"!==a)throw new Error("Unknown prime "+a);u=new Nt}return de[a]=u,u},Re.prototype._verify1=function(a){z(0===a.negative,"red works only with positives"),z(a.red,"red works only with red numbers")},Re.prototype._verify2=function(a,u){z(!(a.negative|u.negative),"red works only with positives"),z(a.red&&a.red===u.red,"red works only with red numbers")},Re.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):a.umod(this.m)._forceRed(this)},Re.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},Re.prototype.add=function(a,u){this._verify2(a,u);var d=a.add(u);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},Re.prototype.iadd=function(a,u){this._verify2(a,u);var d=a.iadd(u);return d.cmp(this.m)>=0&&d.isub(this.m),d},Re.prototype.sub=function(a,u){this._verify2(a,u);var d=a.sub(u);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},Re.prototype.isub=function(a,u){this._verify2(a,u);var d=a.isub(u);return d.cmpn(0)<0&&d.iadd(this.m),d},Re.prototype.shl=function(a,u){return this._verify1(a),this.imod(a.ushln(u))},Re.prototype.imul=function(a,u){return this._verify2(a,u),this.imod(a.imul(u))},Re.prototype.mul=function(a,u){return this._verify2(a,u),this.imod(a.mul(u))},Re.prototype.isqr=function(a){return this.imul(a,a.clone())},Re.prototype.sqr=function(a){return this.mul(a,a)},Re.prototype.sqrt=function(a){if(a.isZero())return a.clone();var u=this.m.andln(3);if(z(u%2==1),3===u){var d=this.m.add(new x(1)).iushrn(2);return this.pow(a,d)}for(var p=this.m.subn(1),y=0;!p.isZero()&&0===p.andln(1);)y++,p.iushrn(1);z(!p.isZero());var E=new x(1).toRed(this),M=E.redNeg(),m=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new x(2*l*l).toRed(this);0!==this.pow(l,m).cmp(M);)l.redIAdd(M);for(var v=this.pow(l,p),H=this.pow(a,p.addn(1).iushrn(1)),J=this.pow(a,p),ee=y;0!==J.cmp(E);){for(var se=J,ce=0;0!==se.cmp(E);ce++)se=se.redSqr();z(ce<ee);var Te=this.pow(v,new x(1).iushln(ee-ce-1));H=H.redMul(Te),v=Te.redSqr(),J=J.redMul(v),ee=ce}return H},Re.prototype.invm=function(a){var u=a._invmp(this.m);return 0!==u.negative?(u.negative=0,this.imod(u).redNeg()):this.imod(u)},Re.prototype.pow=function(a,u){if(u.isZero())return new x(1).toRed(this);if(0===u.cmpn(1))return a.clone();var p=new Array(16);p[0]=new x(1).toRed(this),p[1]=a;for(var y=2;y<p.length;y++)p[y]=this.mul(p[y-1],a);var E=p[0],M=0,m=0,l=u.bitLength()%26;for(0===l&&(l=26),y=u.length-1;y>=0;y--){for(var v=u.words[y],H=l-1;H>=0;H--){var J=v>>H&1;E!==p[0]&&(E=this.sqr(E)),0!==J||0!==M?(M<<=1,M|=J,(4==++m||0===y&&0===H)&&(E=this.mul(E,p[M]),m=0,M=0)):m=0}l=26}return E},Re.prototype.convertTo=function(a){var u=a.umod(this.m);return u===a?u.clone():u},Re.prototype.convertFrom=function(a){var u=a.clone();return u.red=null,u},x.mont=function(a){return new Dt(a)},yt(Dt,Re),Dt.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},Dt.prototype.convertFrom=function(a){var u=this.imod(a.mul(this.rinv));return u.red=null,u},Dt.prototype.imul=function(a,u){if(a.isZero()||u.isZero())return a.words[0]=0,a.length=1,a;var d=a.imul(u),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),y=d.isub(p).iushrn(this.shift),E=y;return y.cmp(this.m)>=0?E=y.isub(this.m):y.cmpn(0)<0&&(E=y.iadd(this.m)),E._forceRed(this)},Dt.prototype.mul=function(a,u){if(a.isZero()||u.isZero())return new x(0)._forceRed(this);var d=a.mul(u),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),y=d.isub(p).iushrn(this.shift),E=y;return y.cmp(this.m)>=0?E=y.isub(this.m):y.cmpn(0)<0&&(E=y.iadd(this.m)),E._forceRed(this)},Dt.prototype.invm=function(a){return this.imod(a._invmp(this.m).mul(this.r2))._forceRed(this)}}(Ht=V.nmd(Ht),this)},6371:Ht=>{"use strict";var Bt=Object.prototype.hasOwnProperty,V="~";function gt(){}function U(oe,ne,ae){this.fn=oe,this.context=ne,this.once=ae||!1}function z(oe,ne,ae,re,Ue){if("function"!=typeof ae)throw new TypeError("The listener must be a function");var Ae=new U(ae,re||oe,Ue),be=V?V+ne:ne;return oe._events[be]?oe._events[be].fn?oe._events[be]=[oe._events[be],Ae]:oe._events[be].push(Ae):(oe._events[be]=Ae,oe._eventsCount++),oe}function yt(oe,ne){0==--oe._eventsCount?oe._events=new gt:delete oe._events[ne]}function x(){this._events=new gt,this._eventsCount=0}Object.create&&(gt.prototype=Object.create(null),(new gt).__proto__||(V=!1)),x.prototype.eventNames=function(){var ae,re,ne=[];if(0===this._eventsCount)return ne;for(re in ae=this._events)Bt.call(ae,re)&&ne.push(V?re.slice(1):re);return Object.getOwnPropertySymbols?ne.concat(Object.getOwnPropertySymbols(ae)):ne},x.prototype.listeners=function(ne){var re=this._events[V?V+ne:ne];if(!re)return[];if(re.fn)return[re.fn];for(var Ue=0,Ae=re.length,be=new Array(Ae);Ue<Ae;Ue++)be[Ue]=re[Ue].fn;return be},x.prototype.listenerCount=function(ne){var re=this._events[V?V+ne:ne];return re?re.fn?1:re.length:0},x.prototype.emit=function(ne,ae,re,Ue,Ae,be){var bt=V?V+ne:ne;if(!this._events[bt])return!1;var we,le,q=this._events[bt],K=arguments.length;if(q.fn){switch(q.once&&this.removeListener(ne,q.fn,void 0,!0),K){case 1:return q.fn.call(q.context),!0;case 2:return q.fn.call(q.context,ae),!0;case 3:return q.fn.call(q.context,ae,re),!0;case 4:return q.fn.call(q.context,ae,re,Ue),!0;case 5:return q.fn.call(q.context,ae,re,Ue,Ae),!0;case 6:return q.fn.call(q.context,ae,re,Ue,Ae,be),!0}for(le=1,we=new Array(K-1);le<K;le++)we[le-1]=arguments[le];q.fn.apply(q.context,we)}else{var de,he=q.length;for(le=0;le<he;le++)switch(q[le].once&&this.removeListener(ne,q[le].fn,void 0,!0),K){case 1:q[le].fn.call(q[le].context);break;case 2:q[le].fn.call(q[le].context,ae);break;case 3:q[le].fn.call(q[le].context,ae,re);break;case 4:q[le].fn.call(q[le].context,ae,re,Ue);break;default:if(!we)for(de=1,we=new Array(K-1);de<K;de++)we[de-1]=arguments[de];q[le].fn.apply(q[le].context,we)}}return!0},x.prototype.on=function(ne,ae,re){return z(this,ne,ae,re,!1)},x.prototype.once=function(ne,ae,re){return z(this,ne,ae,re,!0)},x.prototype.removeListener=function(ne,ae,re,Ue){var Ae=V?V+ne:ne;if(!this._events[Ae])return this;if(!ae)return yt(this,Ae),this;var be=this._events[Ae];if(be.fn)be.fn===ae&&(!Ue||be.once)&&(!re||be.context===re)&&yt(this,Ae);else{for(var bt=0,q=[],K=be.length;bt<K;bt++)(be[bt].fn!==ae||Ue&&!be[bt].once||re&&be[bt].context!==re)&&q.push(be[bt]);q.length?this._events[Ae]=1===q.length?q[0]:q:yt(this,Ae)}return this},x.prototype.removeAllListeners=function(ne){var ae;return ne?this._events[ae=V?V+ne:ne]&&yt(this,ae):(this._events=new gt,this._eventsCount=0),this},x.prototype.off=x.prototype.removeListener,x.prototype.addListener=x.prototype.on,x.prefixed=V,x.EventEmitter=x,Ht.exports=x},7790:()=>{}}]);